const H=f;(function(p,q){const R={p:0xeb,q:'M*UD',r:'5%(8',s:0xce,t:0xb1,u:']Z6@',v:0x7f,w:0xdb,x:0xb8,y:'V7it',z:'fsL4'},B=f,r=p();while(!![]){try{const s=parseInt(B(R.p,R.q))/0x1*(-parseInt(B(0xc9,R.r))/0x2)+-parseInt(B(R.s,'0!Ab'))/0x3+parseInt(B(R.t,R.u))/0x4+parseInt(B(R.v,'wryP'))/0x5*(-parseInt(B(R.w,'ckbk'))/0x6)+parseInt(B(R.x,'8t^8'))/0x7*(parseInt(B(0xcc,'ckbk'))/0x8)+-parseInt(B(0x8d,R.y))/0x9+parseInt(B(0xa7,R.z))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x5d6b7));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x11e,'V7it')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a2={p:'6)wI',q:0xff},a1={p:0xcd,q:0xfb,r:0x104,s:'GJGr',t:0xd8,u:'qDK('},D=f,p={'PtGIK':D(0xf5,a2.p),'kVZov':'init','OgCkc':function(q,r){return q+r;},'mxysz':function(q,r){return q+r;},'qDneM':'input','WAvjM':function(q,r){return q(r);},'YUzAv':function(q){return q();},'nBaWl':function(q,r,s){return q(r,s);}};p[D(a2.q,'1rCw')](d,this,function(){const E=D,q=new RegExp('function\x20*\x5c(\x20*\x5c)'),r=new RegExp(p[E(a1.p,'5%(8')],'i'),s=c(p[E(0xf9,'dwU*')]);!q['test'](p[E(0xf1,'VSe@')](s,E(0x8f,'0!Ab')))||!r[E(0x9e,'1oZ)')](p[E(0x86,'0!Ab')](s,p[E(a1.q,'!3(s')]))?p[E(a1.r,a1.s)](s,'0'):p[E(a1.t,a1.u)](c);})();}());function f(a,b){const c=e();return f=function(d,g){d=d-0x7e;let h=c[d];if(f['HanxEK']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['gztjAj']=m,a=arguments,f['HanxEK']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['SoZWbu']===undefined&&(f['SoZWbu']=!![]),h=f['gztjAj'](h,g),a[k]=h):h=l,h;},f(a,b);}const b=(function(){let p=!![];return function(q,r){const a3={p:'n6KB'},s=p?function(){const F=f;if(r){const t=r[F(0x111,a3.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ab={p:0xb6,q:'KzWH',r:0xef,s:0x118,t:'wS4c',u:0xa8,v:'$0Qd',w:'KzWH',x:'8t^8',y:0xbf,z:'nN8R',A:0x120,ac:'gh1J',ad:0x11d,ae:0x98,af:'*VMt',ag:0xe0,ah:'W8(5',ai:0xfd,aj:0x102,ak:'!3(s',al:0x87,am:']NL3',an:'fsL4',ao:0xbe,ap:0x88,aq:'5%(8',ar:'GJGr'},G=f,p={'XpgGM':function(t,u){return t(u);},'LHeDo':function(t,u){return t+u;},'fwqty':G(0xe9,'3bOH'),'pTsWC':function(t){return t();},'wwImr':G(0xac,'*VMt'),'zHPvH':G(ab.p,ab.q),'uakHY':G(0xda,'qDK('),'iKmah':G(ab.r,'M*UD'),'dCAqN':'exception','TAsGv':'table','BeMVZ':G(ab.s,ab.t),'QDGUw':function(t,u){return t<u;}};let q;try{const t=p['XpgGM'](Function,p[G(ab.u,ab.v)](p[G(0xc5,'ZXN6')](p[G(0xf2,ab.w)],G(0x101,ab.x)),');'));q=p['pTsWC'](t);}catch(u){q=window;}const r=q[G(ab.y,ab.z)]=q[G(ab.A,'ckbk')]||{},s=[p[G(0xd6,ab.ac)],p[G(ab.ad,'Blnk')],p[G(ab.ae,ab.af)],p[G(ab.ag,ab.af)],p[G(0xcf,ab.ah)],p['TAsGv'],p['BeMVZ']];for(let v=0x0;p['QDGUw'](v,s[G(0x9f,'GJGr')]);v++){const w=b['constructor'][G(ab.ai,'n6KB')][G(ab.aj,ab.ak)](b),x=s[v],y=r[x]||w;w[G(ab.al,ab.am)]=b[G(0x85,ab.an)](b),w[G(ab.ao,'nyot')]=y[G(ab.ap,ab.aq)][G(0xd1,ab.ar)](y),r[x]=w;}});a();import g from'dotenv';g[H(0xa3,'QJLR')]();import h from'express';function e(){const aH=['W5pdMq7cQM1VW7C','WOlcOdJdGYe','W7JdHNNdOSoUea','e8o7WOBdGa','W4RdRZtcMK9dW6O','iSoZWQ8mea','nHT/W4lcTmkcW7bjza8','WQ7dImolWPOS','fc4qFCkt','W6NcRCo5W5pdJH96WQpdOSoS','l8oRxxxdTwVcRNGued9LWRhcSSoAW54ShmkxWRpdQ8oGW5tdPdr1EmooW4WfhqC','W7RcTvumWOP7t8okW5mDeCozofG','ySkAfCkzWRS','tCkKEmo8pSk3uYjNWOTcjquTxa','W67cU8oOW5tcKra9W67dQSoTaWPnoSo1h1ddIYC','kSoiWRibaq','phJdNSkGdSkAFq','W6RcI8kSxCk5','aNVcO8o4W6rXWP8tW67dVCkD','wNmaW69oW6e','AhddRCk8ga','aX7dTsy','mSkpxSk4W6C','W6pdKWGpWPa','W4/dTSomu8k0','WRPzW6lcRZq','WO5dcCkXBSo3WRRdLXlcTSk6WOJcVCk8WPNdUCkGWQZcOSoRWQ3dKXOrW5tdQSoNWQqNW5aDzSkheG','W6RdO8kPW6H7','W7BcRCoZW48','bupcGwpdQa','dqtdL8ouWO0','imkXm8ko','W4unW77dVh8','t1CQW4fl','iabIW4xcR8kPW6DyBa','omoDWQWj','zmo+AwtdRW','g23cUmoF','oCkJECkuW699WQrXsmkOW7/cMhdcJ1BdSKmzuh1ntZrqWOxdKZy3W7P1z8op','W5yGW77dVq','WPVdOWFdIb8UWRtcUr9UcXNdTmk4pW','WRdcVJrRCa','pCoHo0ZdNa','W7ZdJwZdPmo0WPW','W6KvAqG','xCkRDmoI','aSovWQaFaG','W5pdQ8oArmk1WOFcImoRhq','WQVdRSkSWPtdKuzuWQRdJ8o5fce','gSkNtSk+W6C','bh3cGvW','r8oWWOeFbW','wu9IyWq','W73dGSkAWQRcPrldTa','mqj9W53cUq','z8o2W504WOie','W7pdH27dR8oLWPFdHCoCWRNcOG','WPXbWO4gWP0','W63dGrGFWOXtW5u','W7tcO8oPWPFdRfG','vG3dKcZcMq','W47dT8oiqSkI','rWy3rCkSACkk','nmomA8kDCmoD','C1eRW4TV','W6/cSSoW','W78aWPKZW4S','tmoTWOeNja','W7ddLXWjWPO','WOBdRdxcJK9AW7S','WPdcQW/dGW','WQhcNJxcT8kXW43cHmo2WPhcLSkHW6xdOW','z8oQW51+W4jb','WPW7imoPgW','rmkBjmkPWOy','C01UyGRcJ8oby0hcJI4','WOLEWPupWOO','eZumDG','a3BcL0hdTG','WPtdNHfnW5W7fCkLW6a','W6/dHmkNWRRcMbxdV8oU','D8kUomkvWOa','hwVcGfy','WRBdOCk/W5FcQbldGCk6CvC3W6FdHW','DmkdfCkeWQj0','gmkQW4z6BIldGNZdTsNcKSknW7W','B8oksHxdUq','dwBcJ1VdOG','qSo4uWO','W5VdVmofAmkS','WOrLW7FcQWJdLmkqW4ldS8o8Ba','smoVWOmKlW','jaBdLrC6','EhhdUSkH','kmoxWQ4bhCkdbJBdJee','FSotFIVdP1C','pSozWQKLiq','dJFdRmoFWP7dQvG','WRr5W7fXWRhcRgNcOSkYfrBdISok','AdldMd/cHG','EKL0cCoYamkaW7RcVCkIsSkTW7y','xHvSBmkLW7e','AGldMYe','WOVcMIXMssq','W6enW5NcMSosbIHWW7mFv8oEs8ktWRSRW7KfWQ3dH1LuWR0','wWRdItZcHNbwWPXfowjsgh3dObjuW4TpbKTDWRu','s8olxx3dKW','wrnLB8k/W6i','A2VdSCk3jCkWBW','W4ldMCkVW7Dq','BmovzLFdJmkztW','qgHwiCoybmowpe42W5fUW5/dLG','DSkeDmouna','WQFdIdlcTgS','uSoTxHldMxO','zmkygSkdWQn1aCksW60Fza','j8oxWQu','cmkyECkYW7b/','z0y7WOddS8oVW6DHxYVdRCo2','BghdQ8k6bCkW','wmoOWOhdH1ytWRi','hJnxWQOiWQddKaVcUbxdHSo+','eH0hDCky','y0DUDq','W6JdHmkxWQxcJWG','WP4EW4/cJSomgI5XWQe','W7ldHqSv','mrldMZdcMa','CCoTzSoeWRaMW6z/BCkNW7lcQ1u','WPdcUGddKXGQ','sv3cTCo/W65ZWPm','pJCFumky','W6alW73cV8ob','WPtcIYn1sd8','WPVdGmo+WRKRW7jbWO4','W6tcUmoMWPddTKFcKq','W6tdJxhdTW','W7NdVCk7WPZcRa','sHn4Fq','W687WQyR','W7dcJCoMW7FcUG','W6VcRmkIBmkZ','iCovWRi5iG','zHyQxCkRwW','W7mjDri','WQZcM8oeW7VdMetdMmoLtdJcLmk0','WRGYgSkKAq','hgVcMKFdVJ7cVSkOWR/dRahdJHTmWO/cR8kPfJ8','W53dGdNcS0raW7C','W4VdN8kZWOFcOq','xZ/dLGBcVMNcRmoWWPxdGX3dMdO','y8k0nCkbWPK','CCo4tbxdM2yrWP41a11rWQlcSCkAWQrjW4LUW5ZdMCkjW6DLW5NdMHJcRSkBFCogWPGaiaHnW5y','WOxcLIXL','WQr4W57cHWS','WPRcPatdNsC','zmoXF1xdJG','WRm1h8kJCW','iWtdNJ4n','aNVcUCov','hSoTCmkOCW','aX/dHCoSWPa','lSowBmkg'];e=function(){return aH;};return e();}import i from'bcryptjs';(function(){const ag={p:0xed},af={p:0xc6,q:0xcb,r:'0!Ab',s:0x117,t:'1oZ)'},I=H,p={'QgWVd':function(s,t){return s(t);},'jmpTZ':function(s,t){return s+t;},'Hjxys':I(0xe5,'a6Q!'),'AwUNP':function(s){return s();}},q=function(){const J=I;let s;try{s=p[J(0xbc,'X4F^')](Function,p[J(0x10e,'V7it')](p[J(af.p,'*VMt')](J(af.q,af.r),p[J(af.s,af.t)]),');'))();}catch(t){s=window;}return s;},r=p[I(0xa2,'1rCw')](q);r[I(ag.p,'2ENP')](c,0x9c4);}());import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[H(0xdd,'b*Po')]();router['post'](H(0xb5,'X4F^'),async(p,q)=>{const al={p:'UW9Q',q:0x11f,r:'KzWH',s:0xa1,t:0x95,u:'1oZ)',v:0x116,w:'nN8R',x:0xc0,y:0xaa,z:'3bOH',A:'fsL4',am:0x113,an:'Pb%!',ao:'0!Ab',ap:'wS4c',aq:'3bOH',ar:0xe3},K=H,r={'vUpjl':function(s,t){return s||t;},'FReyo':'Invalid\x20email\x20address','gOSmc':function(s,t){return s<t;},'Mokue':K(0xd0,al.p),'EtkPz':function(s,t){return s!=t;},'cAegy':K(0xa0,'X4F^'),'eMHWk':K(al.q,al.r),'xsNpQ':K(al.s,'1oZ)'),'lSzVY':K(al.t,'M*UD'),'AgfWu':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(r[K(0x9b,al.u)](!s,!t)||!u||!v||!w)return q[K(al.v,al.w)](0x190)['send']();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(al.x,'wryP')](s))return q[K(al.y,al.p)](0xc8)[K(0x100,'2ENP')]({'error':r['FReyo']});if(r[K(0x10c,'VSe@')](v['length'],0x8))return q[K(0xee,']Z6@')](0xc8)[K(0xf7,al.z)]({'error':r[K(0xec,'ZXN6')]});if(r['EtkPz'](v,w))return q['status'](0xc8)[K(0x107,'mIgo')]({'error':r[K(0xb2,al.A)]});const x=await k(),y=x[K(al.am,'wryP')](r[K(0xd9,'dwU*')]),z=await y[K(0xa6,'1rCw')]({'email':s});if(z)return l[K(0xf6,al.an)](r['xsNpQ']),q[K(0x97,'sZTu')](0x199)[K(0x8a,al.ao)]();return await y[K(0x10a,al.ap)]({'email':s,'first_name':t,'last_name':u,'role':r[K(0xc4,al.aq)],'password':r[K(0xe2,'nyot')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['status'](0xc9)['send']();}catch(A){l[K(al.ar,al.A)](A);}return q[K(0x11a,'qDK(')](0x1f4)['send']();}),router[H(0xc2,'QJLR')](H(0xc7,'%EH!'),n,async(p,q)=>{const aq={p:'QthA',q:0x11c,r:'8t^8',s:0xc1,t:']Z6@',u:0x110,v:0x8c,w:0xbb,x:'2ENP',y:'W8(5',z:'$7Uf',A:'dwU*',ar:0xc3,as:'V7it',at:0xbd},L=H,r={'iwHZF':function(s,t){return s||t;},'bVORF':function(s){return s();},'ZVJPT':'users','wMZjZ':function(s,t){return s!=t;},'fPKZp':function(s,t){return s(t);},'pYLeW':L(0x80,aq.p),'WwSEt':L(aq.q,'nN8R')};try{const {email:s,password:t}=p[L(0xfa,aq.r)];if(r[L(0x105,'a6Q!')](!s,!t))return q['status'](0x190)['send']();const u=await r[L(aq.s,'5%(8')](k),v=u['collection'](r[L(0x11b,aq.t)]),w=await v[L(aq.u,'5%(8')]({'email':s});if(!w)return q[L(aq.v,'W8(5')](0x194)[L(0xfe,'*VMt')]();if(r[L(aq.w,'%EH!')](r[L(0xfc,']Z6@')](o,t),w['password']))return q['status'](0x191)[L(0xd7,aq.x)]();addUserProfileToSession(w);const x=j['createHash'](r[L(0x89,aq.y)])[L(0xad,'VSe@')](generateUniqueId())[L(0x9d,'QJLR')](r[L(0x94,aq.z)]),y=p[L(0x115,'KzWH')][L(0x103,'OE&m')]||p[L(0xb4,'5%(8')]['remoteAddress'];return addSession(w,x,y,p[L(0x99,aq.A)][L(0xe4,'3bOH')]),q[L(0xb9,'OE&m')](0xc8)[L(aq.ar,'Blnk')]({'token':x});}catch(z){l[L(0x93,aq.as)](z);}return q[L(aq.at,'GJGr')](0x1f4)['send']();}),router['post'](H(0xb0,'RG@@'),m,function(p,q,r){const ar={p:0x116,q:0x10d,r:'0!Ab'},M=H;return q[M(ar.p,'nN8R')](0xc8)[M(ar.q,ar.r)]({'email':p['email']});}),router[H(0xf0,'$7Uf')](H(0xb7,'1oZ)'),m,async function(p,q,r){const at={p:0xd3,q:0x96,r:'*VMt',s:0xf3,t:'wS4c',u:0xa4,v:0xe7,w:'W8(5',x:'QthA',y:0xe1,z:'n6KB',A:'XBB$'},N=H,s={'yjezJ':function(t){return t();}};try{const t=await s[N(at.p,'OE&m')](k),u=t[N(at.q,at.r)](N(at.s,at.t)),v=await u[N(at.u,'M*UD')]({'email':p[N(at.v,at.w)]});return q[N(0x112,at.x)](0xc8)['json']({'user':{'email':v['email'],'first_name':v[N(at.y,at.z)],'last_name':v['last_name']}});}catch(w){l[N(0xca,'@B9a')](w);}return q['status'](0x1f4)[N(0xb3,at.A)]();}),router[H(0xc8,'mIgo')](H(0xdf,'ckbk'),m,function(p,q,r){const av={p:0xa9,q:'ckbk',r:'4uIx',s:'OE&m'},O=H,s={'BKiIK':function(t,u){return t(u);}};return s[O(av.p,av.q)](removeSession,p[O(0x114,av.r)]),q[O(0x116,'nN8R')](0xc8)[O(0x7e,av.s)]();});export default router;function c(p){const aG={p:'$0Qd',q:'$0Qd',r:0x92,s:'k@OX',t:0xf8,u:'0!Ab'},aF={p:'Pb%!',q:'@B9a',r:'wS4c',s:0x84,t:0x82,u:'W8(5',v:0xdc,w:'k@OX',x:'1rCw',y:0x8e,z:'UW9Q',A:0xaf,aG:'M*UD',aH:0x83,aI:'6)wI',aJ:'k@OX',aK:0x10f,aL:'XBB$',aM:0xea},P=H,q={'MHtpY':function(s,t){return s===t;},'nuwhh':'string','aylIk':P(0xe8,aG.p),'XhLAg':'counter','dNkir':function(s,t){return s!==t;},'NSusU':function(s,t){return s+t;},'ClPYQ':function(s,t){return s/t;},'anYdL':P(0x106,'wryP'),'nMwfM':function(s,t){return s%t;},'SiHXf':P(0xde,'RG@@'),'Imbrz':P(0x108,aG.q),'OUnKr':P(aG.r,aG.s),'kMoQd':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(0xa5,aF.p)](typeof s,q[Q(0xd5,aF.q)]))return function(t){}[Q(0xab,'W8(5')](q[Q(0x91,aF.r)])[Q(aF.s,'4uIx')](q['XhLAg']);else q['dNkir'](q['NSusU']('',q[Q(aF.t,aF.u)](s,s))[q[Q(aF.v,'OE&m')]],0x1)||q[Q(0xf4,aF.w)](q[Q(0xd4,aF.x)](s,0x14),0x0)?function(){return!![];}['constructor'](q[Q(aF.y,aF.z)](q['SiHXf'],q[Q(0x109,'*VMt')]))[Q(0x90,'UW9Q')](Q(aF.A,aF.aG)):function(){return![];}[Q(aF.aH,'XBB$')](q[Q(0x81,aF.aI)](q[Q(0xd2,aF.aJ)],q[Q(aF.aK,aF.aL)]))[Q(aF.aM,'*VMt')](q['OUnKr']);q['kMoQd'](r,++s);}try{if(p)return r;else q[P(aG.t,aG.u)](r,0x0);}catch(s){}}