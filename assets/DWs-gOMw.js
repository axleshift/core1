import{r as s,R as e,j as a}from"./B29SdWEC.js";import{R as t}from"./Cri8ushB.js";import{F as r,a0 as i}from"./CPF8VAmO.js";import{b as o,d as c}from"./DpLOkqtK.js";import{A as n}from"./RcibGCPl.js";import{p as l}from"./2aPQtUzY.js";import{d as m,a as d}from"./BFKNndIN.js";import{d as j,S as p,a as x,C as h,Q as u,R as f}from"./BYX7WaHQ.js";import"./ucIcx5RQ.js";import"./E8MUDNEF.js";import"./4RmQ9_ev.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./BmTZu7tj.js";import"./CxXfFpkk.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./BOgnOvQQ.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./FLTEVThY.js";import"./DPAjA2jz.js";import"./DWXbBa0z.js";import"./BVv0Fxeo.js";import"./CzGuHLZU.js";import"./B8Let_61.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const N=()=>{var N;const g=m(),{addToast:v}=o(),[k,b]=s.useState(!0),y=e.useRef(),[w,_]=s.useState([]),[S,P]=s.useState(1),[T,A]=s.useState(0),C=null==(N=d().state)?void 0:N.token,z=async s=>{axios.post("/auth/token/",{page:s}).then((s=>{_(s.data.data),A(s.data.totalPages)})).catch((s=>{var e,a;const t=(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.error)||("network error"===s.message?"Server is offline or restarting please wait":s.message);v(t)})).finally((()=>b(!1)))};return s.useEffect((()=>{z(S)}),[S]),k?a.jsx("div",{className:"loading-overlay",children:a.jsx(j,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[C&&a.jsxs("div",{children:["Make sure to copy your personal access token now. You wonâ€™t be able to see it again!",a.jsxs(p,{color:"info",className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{children:C}),a.jsx(x,{color:"primary",size:"sm",onClick:()=>{navigator.clipboard.writeText(C),v("Token copied to clipboard")},children:a.jsx(r,{icon:i})})]})]}),a.jsx(t,{ref:y,size:"invisible",sitekey:c}),a.jsxs("div",{className:"d-block d-sm-flex justify-content-between align-items-center mb-3",children:[a.jsx("h4",{children:"Access token"}),a.jsx(x,{color:"primary",size:"sm",onClick:s=>g("/security/access-token/new"),className:"ms-auto",children:"Generate new token"})]}),!w||0==w.length&&a.jsx(h,{className:"my-5",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"text-body-secondary",children:[a.jsx("h1",{className:"d-block text-danger",children:"No Access Tokens added yet."}),a.jsx("span",{children:'Please click "Generate New Token" to create a Token.'})]})})}),w&&w.map(((s,e)=>a.jsx(u,{className:"mb-3",children:a.jsxs(f,{children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("h3",{className:"text-primary text-truncate",children:s.note}),a.jsx(x,{color:"danger",onClick:e=>(async s=>{const e=await y.current.executeAsync();b(!0),axios.post("/auth/token/delete",{id:s,recaptcha_ref:e}).then((s=>z(1))).catch((s=>{var e,a;const t=(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.error)||("network error"===s.message?"Server is offline or restarting please wait":s.message);v(t)})).finally((()=>b(!1)))})(s._id),className:"ms-auto",children:"Delete"})]}),a.jsxs("div",{className:"d-block d-sm-flex",children:[a.jsxs("div",{className:"me-3 mb-2",children:[a.jsx("span",{className:"text-muted",children:"Last accessed"}),a.jsxs("span",{className:"d-block small",children:[s.last_accessed?l(s.last_accessed):"Never"," ","| ",s.user_agent?s.user_agent:"NaN"]})]}),a.jsxs("div",{className:"me-3 mb-2",children:[a.jsx("span",{className:"text-muted",children:"Date created"}),a.jsx("span",{className:"d-block small",children:new Date(s.created_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-muted",children:"IP Address"}),a.jsx("span",{className:"d-block small text-capitalize",children:"::1"===s.ip_address?"localhost":s.ip_address})]})]})]})},e))),T>1&&a.jsx(n,{currentPage:S,setCurrentPage:P,totalPages:T,setTotalPages:A})]})};export{N as default};
