(function(j,k){const G={j:0x19e,k:0x1a7,l:'qE(!',m:0x168,n:'Z$aQ',o:0x1cc,p:'eQRj',q:0x17b,r:'LF6[',s:0x181,H:0x1b7,I:0x1be,J:'Fo4d'},t=f,l=j();while(!![]){try{const m=parseInt(t(0x17a,'kDNi'))/0x1*(-parseInt(t(G.j,'ImF!'))/0x2)+parseInt(t(0x17f,'6FE]'))/0x3*(-parseInt(t(G.k,G.l))/0x4)+parseInt(t(G.m,G.n))/0x5*(-parseInt(t(G.o,G.p))/0x6)+parseInt(t(G.q,G.r))/0x7*(-parseInt(t(G.s,'nPpR'))/0x8)+parseInt(t(G.H,'HRxO'))/0x9*(-parseInt(t(G.I,G.J))/0xa)+-parseInt(t(0x1ca,'HRxO'))/0xb+parseInt(t(0x19c,'BD[j'))/0xc;if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0x7c1db));const d=(function(){let j=!![];return function(k,l){const H={j:0x194,k:'yP$L'},m=j?function(){const u=f;if(l){const n=l[u(H.j,H.k)](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());function f(a,b){const c=e();return f=function(d,g){d=d-0x167;let h=c[d];if(f['DsBHdv']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['XfgeGE']=m,a=arguments,f['DsBHdv']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['ShWKrM']===undefined&&(f['ShWKrM']=!![]),h=f['XfgeGE'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(){const P={j:'M2da'},O={j:0x16e,k:0x1bc,l:'WN&n',m:0x1b9,n:'nPpR'},v=f,j={'wassP':'function\x20*\x5c(\x20*\x5c)','mKshp':v(0x1c3,'U@Za'),'INnjB':function(k,l){return k(l);},'tWwNV':v(0x1a0,'PPv('),'NBfxO':v(0x1d4,P.j),'roaDG':function(k,l){return k+l;},'HXUeN':'input','LWvkw':function(k){return k();}};d(this,function(){const w=v,k=new RegExp(j[w(0x1a8,'ImF!')]),l=new RegExp(j[w(0x174,'yP$L')],'i'),m=j[w(O.j,'^pRB')](c,j['tWwNV']);!k['test'](m+j['NBfxO'])||!l[w(O.k,'qE(!')](j[w(0x187,O.l)](m,j[w(O.m,O.n)]))?m('0'):j['LWvkw'](c);})();}());function e(){const ah=['buOIzCk+','zu4qW5VcIa','ve3cSYVcPq','W7HCWPxcSXi','WQpdLd/dPCos','W6Tyohjs','WOVdHt7dG8k8','W5DnaSorWPJdLs/cMCkXW6zCW4m','WRJcJmkgxhVcOJzaWPy','W7ddNYurAq','af0IwSkrWOrwt2rBka','W6SxbZe','WOeOp8kxW5DtWPJdQbe','gSobW7xdPtvoW5xdPXz6','a8kAWOpdISolDSoOW5RdG3BcQW','W7xdSHxdM8ov','W4LsWP/cKc/dIry6','x8oWW7bWW4xcQWdcUZ3cR8owWPtdL8k7WRhcRY4veq','DCkCWRJcQ24tW65lW4hdNCk6ir5LWOPPgrZcScNdVJtcSKBdMSkDW4VcQ8osWOdcPmov','W4RcNLylaq','zmk7W4KrWRq','WR7dUHNcPCkK','WOVcVZtdShW','pCoCpSkAWQ4','WQFcMJ7dKG','WRRdM0GGCc/cUY3cLaGNWOWUCmkrcf54WOe','gSo/e8kz','c8k4z3VdGhJcSsS','A2OnW4dcJmkIW4OPgXTs','WRzNW7KPWPFdNG','WOGcW5tcMqNdJJa8W4a','z8oxla','W41VWRldHaRcGSkLsW','AxutW5/cGq','tSoYccJdPq','W6jYW5nM','WQJdQb/dUmk9','W5zVDCkcW6O','u8keB8oNWRFdVbm','vSkcB8oWWOZdOapcJNGUBq','p8otnW','WQdcNwfliGrFpKPWyuTwW4O','gCoRit/cKmkNWQldSCo4CuaXW5hdK8k6WQ/cP8k/WOPDW4RcTCo9WPBcLCo2WOPmxSoIn8ki','smoYW7pdVrjfW40','WOldVMHEWR/dU8o+','hSkIsHa','WQVdQdpdMmocnaxcSCoEW5pcPa','umkaymoQWPq','WOGcW57dKh7cKZ4NW40VvSkJ','zveKsvWaWO9JW4pcOG','W4nVAmkzW7DpWQNdRq0','W5j7pfnP','W5NcR01PW4JdLCkwnhNcUCkt','c8ojW7tdPre','W7a+h8ofWQerfmkRW4VcVSouWRhcOW','CmoBEmobCq','rwtcMIzeWORdMG','W6Log1v8','t1yrW73cNa','W7DYWP/cOGe','wmo9W6fRW7m','kSknF37dUq','WRVdINLjWQq','W4VcI1aq','WQVdKva5zYldR2ZcNrm','WPG1WQ7dPI/cLCkFqx5MW6y','h0WTsCkaWQm','DMNdGColwW','W4uEcx3cV2qBWRhcJSoYW6G6ha','W6ddNmokvLVcUq','ESoXW6tcNCkX','W7BdGJSsFLuyyubg','uCogW5/cI8kqxCoh','WP7dVG4K','uglcTs7cHq','W4PQWRFdHWRcG8kJBa','BSodWPTVW4q','WQVdQdhdH8otjqtcU8ofW5i','yvZcTqNcNSkcWPO','W5eIrmkjW7pcTb8','jmk9iCowW6BdL0BcR8k4WP/cQSogyLZdSYvKzfHtW7BcSLpcGHH0W5aJgf7cRt7dKSkp','WQRdKSoKW5VdVdSMWRxdSG','uCo/tmobEq','eLKZqSkn','ACkxW6ZcKfS','W6PSW4vLWQ8','fmk+h8kqkhLQf8kMW4ZcIa','W4OBaNhcUgaAWRdcPCo5W4mWga','qLBcSmovva','bSoDoCk0W4/cQGpcM00It8oz','W7tdObldHCod','qCoOt8ox','WPNdKY3dVSoo','W69vpW','w8oyWOLPW5u','uSopWRi','ma17haPqW4jMW6BcLCk7agu','W6OwcdZdLq','WR9WW6uHWPe','W4VdSZVdVSoN','W5hdPZ7dVSoE','d8omW7BdPbq','WOHpW48OumksAmk3ba','WRpcMcJdK3pcLqlcOW','W49hWOJcGJldGZCNW5W','W6PpW7b+WO4','q3NcNsDc','WRVdM08MAY7dTxy','maS6DgGgWRrJ','uSo1jYhdMW','WOTTW4e8rW','C1yTs30','W68xbZhdThFdLW','cSkNug7dHNtcKcjx','WRVdOXBcGCkT','FmoaqComsG','WPtdHq/dSmkA','CvyHsvXdW5n+W57cUCkCrGNdPmks','ymkkW73cUeu'];e=function(){return ah;};return e();}const b=(function(){let j=!![];return function(k,l){const m=j?function(){const x=f;if(l){const n=l[x(0x1c8,'vVq!')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const X={j:0x184,k:'dY7E',l:0x185,m:'lWvb',n:0x192,o:'6Qkz',p:0x1d9,q:'N$rH',r:0x1c5,s:'^pRB',Y:'1F3d',Z:0x1bd,a0:'EPJ)',a1:0x1bb,a2:'nPpR',a3:0x177,a4:'*D67',a5:0x196,a6:'vVq!',a7:0x1cb,a8:'yP$L',a9:'U5CO',aa:0x1a5,ab:'6FE]',ac:0x18d,ad:'U@Za',ae:'NW!r',af:0x17e,ag:'M2da'},y=f,j={'kyJSF':function(n,o){return n(o);},'LWaNK':function(n,o){return n+o;},'RhQoe':y(X.j,X.k),'WWnCT':y(X.l,X.m),'kSbNd':y(X.n,'G6He'),'QfNWx':y(0x1b2,X.o),'fZmqg':y(X.p,X.q),'sdqrU':y(0x1cd,'e5tP'),'htSnM':y(X.r,'1RXo'),'GSrNd':function(n,o){return n<o;}};let k;try{const n=j['kyJSF'](Function,j[y(0x188,X.s)](j[y(0x1b6,X.Y)](j[y(0x197,'h2Sy')],j[y(X.Z,X.a0)]),');'));k=n();}catch(o){k=window;}const l=k[y(X.a1,X.a2)]=k['console']||{},m=[j[y(X.a3,X.a4)],j[y(0x1d7,'e5tP')],y(X.a5,X.a6),y(X.a7,'miE%'),j[y(0x16a,'N$rH')],j[y(0x1d8,'ImF!')],j[y(0x1ac,'ZFyC')]];for(let p=0x0;j[y(0x1ad,X.a8)](p,m[y(0x190,X.a9)]);p++){const q=b[y(0x1a1,X.a4)][y(X.aa,X.ab)][y(X.ac,X.ad)](b),r=m[p],s=l[r]||q;q['__proto__']=b['bind'](b),q['toString']=s[y(0x18e,X.ae)][y(X.af,X.ag)](s),l[r]=q;}});a(),(function(){const a0={j:0x19d,k:'O!!%',l:'EPJ)',m:0x189},z=f,j={'jbpIc':function(l,m){return l(m);},'BkyPT':function(l,m){return l+m;},'SxhFt':z(0x18c,'hnfj'),'KBoPf':z(a0.j,'Yt7(')};let k;try{const l=j[z(0x178,'ZFyC')](Function,j[z(0x176,a0.k)](j[z(0x175,a0.l)]+j[z(a0.m,'G(Xt')],');'));k=l();}catch(m){k=window;}k['setInterval'](c,0x9c4);}());import g from'fs';import{ObjectId}from'mongodb';import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a1={j:0x1da,k:'G(Xt',l:0x1dc,m:'vVq!',n:'ZFyC',o:'BD[j'},A=f,n={'aSEwX':A(a1.j,a1.k)};try{const o=await h();o['collection'](n[A(a1.l,a1.m)])[A(0x1c4,'#N[L')]({'user_id':j['_id'],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[A(0x1d0,a1.n)]()});}catch(p){i[A(0x17c,a1.o)](p);}};export const getUser=async j=>{const a3={j:'[MV)',k:0x1c0,l:0x1b0,m:0x16c,n:0x186,o:'EPJ)',p:'@K6Z',q:0x198,r:'6FE]'},B=f,k={'Tkbjh':function(l){return l();},'UZKqK':'sessions','vttum':B(0x182,'e5tP')};try{const l=await k[B(0x1d1,a3.j)](h),m=await l[B(a3.k,'*D67')](k[B(a3.l,'NW!r')])[B(a3.m,'M2da')]({'token':j});if(!m)return null;const n=await l['collection'](k[B(a3.n,'6Qkz')])[B(0x1c1,a3.o)]({'_id':m[B(0x19f,a3.p)]});return{'_id':n[B(0x1d2,'A(b7')],'email':n[B(0x1a2,'eQRj')],'first_name':n[B(0x180,'ImF!')],'last_name':n['last_name'],'role':n['role'],'email_verify_at':n['email_verify_at']};}catch(o){i[B(a3.q,a3.r)](o);}return null;};export const removeSession=async j=>{const a4={j:0x1ba,k:0x1db,l:'O!!%'},C=f,k={'gvzXZ':C(0x183,'O!!%')};try{const l=await h();await l[C(a4.j,'BD[j')](k[C(0x1c7,'lWvb')])[C(a4.k,a4.l)]({'token':j},{'$set':{'active':![],'last_accessed':Date[C(0x19b,'2rpv')]()}});}catch(m){i[C(0x1d5,'U5CO')](m);}};export const isActiveToken=async j=>{const a6={j:0x167,k:'hnfj',l:'lWvb',m:'Z$aQ',n:0x195,o:0x1b3,p:0x18a,q:'ZFyC',r:0x1dd},D=f,k={'nkkpD':function(l){return l();},'EJCgh':D(a6.j,a6.k)};try{const l=await k[D(0x172,a6.l)](h),m=await l[D(0x1a4,a6.m)](k[D(a6.n,'G6He')])[D(0x199,'eQRj')]({'token':j});if(m['active'])l[D(a6.o,a6.k)](k[D(a6.p,'U@Za')])[D(0x16d,'NW!r')]({'token':j},{'$set':{'last_accessed':Date[D(0x1d0,a6.q)]()}});return m['active'];}catch(n){i[D(a6.r,'GB6R')](n);}return![];};function c(j){const ag={j:'Z$aQ',k:'D&O]',l:0x1ce,m:0x18b,n:'G(Xt',o:'D&O]',p:0x1af,q:'dY7E'},af={j:0x169,k:0x1b4,l:'e5tP',m:0x1c6,n:'D&O]',o:0x1ae,p:0x1aa,q:'1RXo',r:0x179,s:'h2Sy',ag:0x1b1,ah:'@K6Z',ai:'1RXo',aj:0x19a,ak:'eQRj',al:0x173,am:'D&O]',an:'*D67',ao:0x1a6,ap:'ZFyC',aq:'yP$L',ar:'Z$aQ'},E=f,k={'YMlnV':function(m,n){return m===n;},'nEAgB':'string','KrKWA':E(0x171,ag.j),'MEsAG':E(0x1ab,'GB6R'),'UVUcm':function(m,n){return m!==n;},'qEpTd':function(m,n){return m+n;},'LGteD':function(m,n){return m/n;},'YPTWC':E(0x1b5,ag.k),'vcaKJ':E(ag.l,'1RXo'),'QTpUx':E(ag.m,ag.n),'SAthX':E(0x1b8,'LF6['),'yPXqc':E(0x17d,ag.o),'uhenD':function(m,n){return m(n);}};function l(m){const F=E;if(k[F(af.j,'G6He')](typeof m,k[F(0x170,'h2Sy')]))return function(n){}[F(af.k,'Fo4d')](k[F(0x1d6,af.l)])[F(af.m,af.n)](k[F(af.o,'O!!%')]);else k[F(af.p,af.q)](k[F(af.r,af.s)]('',k[F(af.ag,af.ah)](m,m))[k['YPTWC']],0x1)||k[F(0x16f,af.ai)](m%0x14,0x0)?function(){return!![];}[F(af.aj,af.ak)](k[F(af.al,af.am)]+k[F(0x1cf,af.an)])['call'](k[F(af.ao,af.ap)]):function(){return![];}[F(0x18f,af.aq)](k['vcaKJ']+k['QTpUx'])[F(0x1bf,'[MV)')](k['yPXqc']);k[F(0x16b,af.ar)](l,++m);}try{if(j)return l;else k[E(ag.p,ag.q)](l,0x0);}catch(m){}}