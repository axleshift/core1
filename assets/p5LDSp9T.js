import{R as e,r as s,j as a}from"./Oq9P1Wj_.js";import{F as t,I as i}from"./DiHbz8XT.js";import{Q as n}from"./Cl7qhzEd.js";import{h as r}from"./DxFnCsxZ.js";import{R as o}from"./eGqyD3ZN.js";import{a as c,b as l,e as m}from"./D0k61Dph.js";import{S as d,C as p,a as h}from"./LiVAUOwm.js";import{A as j}from"./DisiNMo6.js";import{L as f}from"./CiGarMm9.js";import{S as u}from"./C5XVdaNx.js";import{E as x}from"./BGB82IPO.js";import{d as _,k as g}from"./Ce_fjdqS.js";import{c as y,a as b,b as v,d as w,e as S,g as D,h as C,i as k,Z as N}from"./B6RqIosd.js";import"./deeEeel3.js";import"./NdsU5MZw.js";import"./BXWkExu4.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./CewSaW8v.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./fHQ1LRrH.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./ChytwAMd.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";const I=()=>{const I={shipper:{shipper_company_name:"",shipper_contact_name:"",shipper_contact_email_address:"",shipper_contact_phone_number:"",shipper_company_address:""},consignee:{consignee_company_name:"",consignee_contact_name:"",consignee_contact_email_address:"",consignee_contact_phone_number:"",consignee_company_address:""},shipment:{shipment_description:"",shipment_weight:"",shipment_dimension_length:"",shipment_dimension_width:"",shipment_dimension_height:"",shipment_volume:"",shipment_value:"",shipment_instructions:""},recaptcha_ref:""},{user:R}=c(),A=e.useRef(),{addToast:E}=l(),[O,$]=s.useState(I),[B,F]=s.useState(I),[L,P]=s.useState(""),[Q,T]=s.useState(""),[q,z]=s.useState(!1),[H,J]=s.useState(!0),[K,U]=s.useState(!1),[Y,Z]=s.useState(!1),G=s.useRef(null),M=_(),{id:V}=g(),W=(e,s)=>{const{id:a,value:t}=e.target;F((e=>({...e,[s]:{...e[s],[a]:t}})))};return s.useEffect((()=>{(async()=>{z(!0),axios.get(`/freight/${V}`).then((e=>{P(e.data.data.type),T(e.data.data.status),$(e.data.data.data),F(e.data.data.data)})).catch((e=>{U(!0)})).finally((()=>z(!1)))})()}),[]),q?a.jsx("div",{className:"loading-overlay",children:a.jsx(y,{color:"primary",variant:"grow"})}):K?a.jsx(b,{className:"justify-content-center my-5",children:a.jsx(v,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no shipment found."}),a.jsx("p",{children:"Double check tracking id for any mistake."})]})})}):a.jsxs("div",{children:[Y&&a.jsxs(w,{visible:!0,onClose:()=>Z(!1),alignment:"center",scrollable:!0,children:[a.jsx(S,{closeButton:!0}),a.jsx(D,{children:a.jsx("div",{className:"d-flex justify-content-center align-items-center",children:a.jsx("div",{ref:G,className:"d-inline-block",children:a.jsx(n,{value:V})})})}),a.jsx(C,{className:"d-flex justify-content-center align-items-center",children:a.jsx(k,{color:"primary",onClick:()=>{Z(!1),r(G.current,{useCORS:!0}).then((e=>{const s=e.toDataURL("image/png"),a=document.createElement("a");a.href=s,a.download="qrcode.png",document.body.appendChild(a),a.click(),document.body.removeChild(a)}))},children:"Download"})})]}),a.jsx(o,{ref:A,size:"invisible",sitekey:m}),a.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4",children:[a.jsxs("span",{className:"d-block",children:["#",V]}),a.jsxs(N,{className:"mb-2 mb-sm-0",children:[a.jsx(k,{color:"primary",className:"me-2 rounded",onClick:e=>Z(!0),children:a.jsx(t,{icon:i})}),"cancelled"!==Q&&"received"!==Q&&a.jsxs(a.Fragment,{children:["to_pay"===Q&&"user"===R.role&&a.jsx(k,{color:"primary",className:"me-2 rounded",onClick:async()=>{z(!0);const e=await A.current.executeAsync();axios.post("/invoices",{id:V,recaptcha_ref:e}).then((e=>window.location.href=e.data.r_url)).catch((e=>{const s=x[e.status]||"Server is offline or restarting please wait";E(s)})).finally((()=>z(!1)))},children:"Book shipment"}),a.jsx(k,{color:"primary",className:"me-2 rounded",onClick:async()=>{if(H)return J(!1);z(!0);const e=await A.current.executeAsync(),s={...B,recaptcha_ref:e};axios.post(`/freight/u/${L}/${V}`,s).then((e=>E("Your changes has been saved."))).catch((e=>{const s=x[e.status]||"Server is offline or restarting please wait";E(s,"Submit failed!"),F(O)})).finally((()=>{z(!1),J(!0)}))},disabled:["to_receive","received"].includes(Q),children:H?"Edit":"Save"}),a.jsx(k,{color:H?"danger":"warn",className:"me-2 rounded",onClick:async()=>{if(!H)return J(!0),void F(O);z(!0);const e=await A.current.executeAsync();axios.post(`/freight/c/${V}`,{recaptcha_ref:e}).then((e=>{E("Shipment has been cancelled."),M("/dashboard")})).catch((e=>{const s=x[e.status]||"Server is offline or restarting please wait";E(s,"Submit failed!"),F(O)})).finally((()=>z(!1)))},disabled:["to_receive","received"].includes(Q),children:"Cancel"})]})]})]}),a.jsxs(b,{xs:{cols:1},sm:{cols:2},children:[a.jsx(v,{children:a.jsx(d,{isInfo:!0,formData:B,handleInputChange:W,isDisabled:H})}),a.jsx(v,{children:a.jsx(p,{isInfo:!0,formData:B,handleInputChange:W,isDisabled:H})})]}),a.jsxs(b,{xs:{cols:1},sm:{cols:2},children:[a.jsx(v,{children:a.jsx(h,{isInfo:!0,formData:B,handleInputChange:W,isDisabled:H})}),a.jsx(v,{children:(()=>{switch(L){case"air":return a.jsx(j,{isInfo:!0,formData:O,isDisabled:!0});case"land":return a.jsx(f,{isInfo:!0,formData:O,isDisabled:!0});case"sea":return a.jsx(u,{isInfo:!0,formData:O,isDisabled:!0});default:return null}})()})]})]})};export{I as default};
