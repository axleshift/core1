function f(a,b){const c=e();return f=function(d,g){d=d-0x111;let h=c[d];if(f['ejYAlk']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['qhsAje']=m,a=arguments,f['ejYAlk']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['BSxEmX']===undefined&&(f['BSxEmX']=!![]),h=f['qhsAje'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(h,i){const F={h:'4axS',i:0x14e,j:'4axS',k:'N#6c',l:0x139,m:0x13d,n:'Sreo',o:0x16c,p:0x188,q:'op!a',r:0x135,s:0x17d},v=f,j=h();while(!![]){try{const k=-parseInt(v(0x151,F.h))/0x1+-parseInt(v(0x186,F.h))/0x2*(parseInt(v(F.i,'n]vt'))/0x3)+parseInt(v(0x12c,F.j))/0x4*(parseInt(v(0x142,'iuJ)'))/0x5)+parseInt(v(0x15a,F.k))/0x6*(-parseInt(v(F.l,'!v[9'))/0x7)+-parseInt(v(F.m,F.n))/0x8*(-parseInt(v(F.o,'X[EG'))/0x9)+parseInt(v(F.p,'sOT!'))/0xa*(-parseInt(v(0x120,F.q))/0xb)+-parseInt(v(F.r,'VHq^'))/0xc*(-parseInt(v(F.s,'mrIX'))/0xd);if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0x1fd67),(function(){const K={h:0x16b,i:'5jLB',j:0x12f,k:'eojn',l:'BtG%',m:'G[%Z',n:'EVlI',o:0x15b,p:0x180},w=f,h={'SQVJZ':function(j,k){return j(k);},'GBpOG':function(j,k){return j+k;},'jhpKz':function(j,k){return j+k;},'TElYs':w(K.h,'G[%Z'),'wQDud':w(0x153,K.i),'isLcw':function(j){return j();}};let i;try{const j=h[w(0x132,'DnLX')](Function,h[w(K.j,K.k)](h[w(0x18d,K.l)](h[w(0x154,K.m)],h[w(0x113,K.n)]),');'));i=h[w(K.o,'7]Nd')](j);}catch(k){i=window;}i[w(K.p,'DQSm')](c,0x9c4);}()));const d=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const U={h:'G@5['},T={h:0x12e,i:0x134,j:'r]nd',k:0x14b,l:0x11f,m:'hG]D',n:'D$d(',o:0x112},x=f,h={'oZdHu':x(0x136,'VHq^'),'ELWed':function(i,j){return i(j);},'czaew':'init','WGdhq':function(i,j){return i+j;},'CxTju':x(0x175,'sOT!'),'QvJAG':x(0x152,U.h),'mCBgE':function(i){return i();},'RWStq':function(i,j,k){return i(j,k);}};h['RWStq'](d,this,function(){const y=x,i=new RegExp(h[y(T.h,'7dF$')]),j=new RegExp(y(0x144,'7S7)'),'i'),k=h['ELWed'](c,h[y(T.i,T.j)]);!i[y(T.k,'OEEq')](h['WGdhq'](k,h[y(T.l,'0qL7')]))||!j[y(0x138,'&!6y')](h['WGdhq'](k,h[y(0x14c,T.m)]))?h[y(0x115,T.n)](k,'0'):h[y(T.o,'D$d(')](c);})();}());const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const a4={h:0x128,i:'Uyu2',j:'G@5[',k:'hzgO',l:'0qL7',m:'iuJ)',n:0x127,o:0x17f,p:'big0',q:0x145,r:0x185,s:0x17a,t:0x163},a3={h:0x16d,i:0x160},z=f,h={'VTEbE':function(m,n){return m(n);},'BINIP':function(m,n){return m+n;},'WrJLW':'return\x20(function()\x20','dAyRR':function(m){return m();},'UvpSN':z(a4.h,'5jLB'),'lKikT':z(0x147,a4.i),'suGhB':z(0x15d,'eojn'),'UUKEy':function(m,n){return m<n;}},i=function(){const A=z;let m;try{m=h[A(0x17e,'iuJ)')](Function,h[A(a3.h,'q*iq')](h['BINIP'](h[A(0x14a,'ZjFB')],A(a3.i,'sAY4')),');'))();}catch(n){m=window;}return m;},j=h[z(0x179,'ZjFB')](i),k=j[z(0x133,a4.j)]=j[z(0x182,'iuJ)')]||{},l=[z(0x161,'r]nd'),z(0x150,a4.k),z(0x126,a4.l),h['UvpSN'],h[z(0x13c,'4axS')],z(0x11b,a4.m),h[z(0x174,'WzwE')]];for(let m=0x0;h['UUKEy'](m,l[z(0x15c,'qfDQ')]);m++){const n=b[z(a4.n,'DnLX')][z(a4.o,a4.p)]['bind'](b),o=l[m],p=k[o]||n;n[z(a4.q,'n]vt')]=b[z(a4.r,'eojn')](b),n[z(0x140,'BtG%')]=p[z(a4.s,'sAY4')][z(a4.t,'OEEq')](p),k[o]=n;}});a();import{getUser,getSession}from'../components/sessions.js';import g from'../models/db.js';import{ObjectId}from'mongodb';const adminRoute=[],auth=async(h,i,j)=>{const ad={h:0x165,i:0x184,j:'ZjFB',k:'7]Nd',l:'!v[9',m:'MF^F',n:0x172,o:'7S7)',p:0x183,q:'7dF$',r:'Sreo',s:0x170,t:'qfDQ',u:0x12b,ae:0x176,af:0x13e,ag:'hG]D',ah:0x189,ai:'&!6y',aj:'hG]D',ak:0x157,al:0x18e,am:0x18c,an:0x187,ao:0x129,ap:'Uyu2',aq:0x131,ar:0x167,as:'op!a',at:0x14f,au:'r]nd',av:0x149,aw:0x177},ac={h:0x17b,i:'qfDQ',j:0x171,k:'%ehl',l:0x17c,m:0x16f,n:'Svl9'},B=f,k={'JGmAi':function(t){return t();},'Ruuyu':B(ad.h,'!V&E'),'CdeXp':B(ad.i,ad.j),'kexhM':function(t,u){return t(u);},'WBBFP':function(t,u){return t(u);},'Xmcvk':'admin','Cxxmd':function(t,u){return t-u;},'inWyi':function(t,u){return t*u;},'KaCFm':function(t,u){return t>=u;},'uYwex':function(t){return t();}},l=h[B(0x178,ad.k)][k[B(0x16e,'n]vt')]];if(!l)return i[B(0x164,ad.l)](0x191)[B(0x173,ad.m)]();const m=l[B(0x169,'hzgO')]('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/['test'](m))return i['status'](0x191)[B(0x125,'k4#J')]();const [n,o]=await Promise[B(ad.n,ad.o)]([k['kexhM'](getUser,m),k['WBBFP'](getSession,m)]);if(!n||adminRoute[B(ad.p,ad.q)](h[B(0x181,ad.r)])&&n[B(ad.s,'hzgO')]!==k[B(0x117,'eojn')])return i[B(0x137,'big0')](0x191)[B(0x130,ad.t)]();if(!o['active'])return i[B(ad.u,'G@5[')](0x191)[B(ad.ae,'N#6c')]();let p=h['headers'][B(ad.af,ad.ag)]||h['socket'][B(ad.ah,ad.ai)];const q=new Date(o[B(0x168,ad.aj)]),r=k[B(ad.ak,'sOT!')](Date[B(ad.al,'n]vt')](),q),s=k['inWyi'](k[B(ad.am,'EVlI')](k[B(ad.an,'sAY4')](0x7*0x18,0x3c),0x3c),0x3e8);if(k[B(ad.ao,ad.ap)](r,s))p=0x0;Promise['all']([((async()=>{const C=B;try{const t=await k[C(ac.h,ac.i)](g);t[C(ac.j,ac.k)](k[C(ac.l,'MF^F')])[C(ac.m,'MF^F')]({'token':m},{'$set':{'active':o[C(0x11e,'hzgO')]===p,'last_accessed':Date[C(0x11c,'OEEq')]()}});}catch(u){logger[C(0x166,ac.n)](u);}})())]);if(o[B(ad.aq,'eojn')]!==p)return i[B(ad.ar,ad.as)](0x191)[B(ad.at,ad.au)]();return h[B(ad.av,'!V&E')]=m,h[B(0x13f,'qfDQ')]=n,k[B(ad.aw,'BDd7')](j);};function e(){const ar=['yGxdRZy','WO5CWQtcNCoZ','DuSwW7nqy8kTCCkV','W5jFtwZdKHCW','W5W9uWa','wCkyCmkc','WR4eWPnAtsH+pCk0WOrhvq','WPBcHZNdVxW','w8k2W7FdNeRdQdZcQ8kGW5yPhfP+eGDJW67dH8k/eZxcT8kAW4DIWRNcLq/dN1/dMG','W4nCW73dMmoO','i8kkvxyq','cSocAmktWRVdLdKYWR4x','WQJcRu/dU8oZ','FLzTdNW','WROcpSktW6VcLW','wCoIbHjwx8k8W6RdVq','vhm3d8k+','WOxdRtTHwgq','WO1OW5LPWRK','W6pdL2WXgvTzWPZcPW','W4HfvmkDfaO0WRS','W4byW5VcT8oOcXpdT8krp8kWaZbCdh5nWRlcULJdOGznC8k7nmkDW5tdTSk7oXq','W4m3wG','W5v3W4ZdGSkN','DaNdSIy','WQBcUG/dMSklWOm','lCojq8o0oSokruO','W74OW7CnFq','WOtcOdH+lfa','WRnlWP3cQmoRW6xcRCogW7VdKSkHlKC','xCkjBSkfuG','W7OiC8kBWQZcUSkA','W6v8W6xdTmoPFI/dIeqsWRZcRCoGW47dM2HZpIa','nmovW4xdH8oBCLzN','dZjSW5fj','WQjFA2BdUa','W7i9nXGmWO3dIwtdKG','xmkwBSkj','W73cRMddKmkeECoWWRG+tW','s8kcW6e','W7qOpr0','WQj0b2FcKG','WOJcVvBdV8o5','g8kXwHm','amkYWPJcKsC','vwuAcmkSW4/cKq','WRBcPYucga','W49kWQBcOmo1da7dPa','WQpdJZHhrq','W5u4jGan','W6aaW5xcOmozW6/dISoHWO4','E0lcLdZdUW','W6KvACkbWRFcQ8krW4dcGW','WOizDCkTfc0tWOhdSKj4','t8otWRlcVa','tNNcVY3dKqaK','BLvQicZdVSkjWPy','WRpcKYG4jxTjWPxcISkKWQGHWOW','WPTZW5zU','WR0nWPnzrYP+cmkoWOf+EG','W5jlWQlcRCoU','W5RdPaFdT8oeWRlcVSkOfa','WQKej8kvW7dcNe/cSmkbkSk6WRq0','fmklW5Ktoa','W71DW7yOeG','pComtJxdRq','jthdHceL','WO9uEq','iZZdMG0Rtq','WR4AWQenDa','i8oZxtNdOa','xxjdgh4','WPyvWRqpvq','u8kLWRFdR2W','WQf3W5T8WRC','gcxdOg3cIv4tW7hcLh5cDa','W4r1W7ldOmkP','uYBdMYFdUq','wxFcSZldMW','Ea/dQW','nGS7FwRcRmkeWP8+cSo6ya','r8kjxCknqSo4BdFcVua','W6z9W5BdPSkL','W4BdOg85ybRcJWNcG8kIWQlcVa','WOJcGsddPg3dNCkqkSo7dmkUjvpdGCoH','WOtcOcTJn0q','WPC8WRdcVSoPWQPuW73cN8o/W7Lw','cSocz8kvW4pcPcGOWOCvW74r','W5FdGCo0WQC','W4XRW6tdOW','gSkfaSkht8ohWRtdGLJdMmk8','rCk5WQVdKfC','jmkNbLqY','ldBdMHKRv03cMtqNWPO','WOZcNsJdVh3cJG','WRCeWPuan0zdnmkO','W5JcSxtdHmonWQNcJG','AgfTbcW','WR5yW4HfWPS','WPRdRtTI','WPbQW6DRWRJdLCkeW4NcRmo9','kSk7oSk+yq','WPZcHIFdU2FcKCoD','W4WIxafh','zmo+WQ9fs8k1ESozW5FdV8ozW7y','n8k4W7avcmoUr8ouWP/cS8o9WOLrw8kTW7q','W6Otz8kbWQ3cRa','WQ8eoCko','W6hdVvJcNCogWPmJhCoXtXy','fSkkWOpcMa','nmkej8kcDq','W6n/W4GakG','dSkbW77dOCofW6RdNNyBW43cKmkw','WQChWOJcS8ogW7pcR8oxW7RdHmk2zKxdJCoq','WPZdUZb0','oZBdPX4TtfBcNq','wwuzgq','hcldQgVdVYuLW7ZcIxu','WRv/W6fPWQy','DSofW5hcGfueFepdRJGeWPW2W6aLW53cLSoSWRnMWPuYtWDbu24yjubYWQ9uwa','WR5KFKZdPYOwWQTE','WOvEBeS','cSk+jNCVh3ymlq','wCoNdeiXpSkhW7hdM3ZcJvS','kSodw8oIpq','WOxcLbyChq'];e=function(){return ar;};return e();}export default auth;function c(h){const aq={h:0x122,i:'op!a',j:0x159,k:'DnLX'},ap={h:0x11a,i:'OEEq',j:0x12a,k:0x119,l:'bgG8',m:0x114,n:'VHq^',o:'0qL7',p:0x141,q:0x13a,r:'4axS',s:0x146,t:'n]vt',u:0x116,aq:'5jLB',ar:'eojn'},D=f,i={'EFGeD':function(k,l){return k===l;},'MhyyG':D(aq.h,aq.i),'PLjxO':D(0x16a,'big0'),'wNWAu':function(k,l){return k!==l;},'MmXFw':function(k,l){return k+l;},'nIvPu':function(k,l){return k/l;},'prNNw':function(k,l){return k%l;},'cNZsW':function(k,l){return k+l;},'snnPI':'gger','riWCl':D(aq.j,'&!6y'),'LeYcz':function(k,l){return k(l);},'MnKvN':function(k,l){return k(l);}};function j(k){const E=D;if(i[E(ap.h,ap.i)](typeof k,i['MhyyG']))return function(l){}[E(ap.j,'BtG%')](E(0x121,'G@5['))[E(ap.k,'0qL7')](i[E(0x155,ap.l)]);else i['wNWAu'](i[E(ap.m,'KdyJ')]('',i[E(0x158,'KdyJ')](k,k))[E(0x111,'BtG%')],0x1)||i[E(0x18a,ap.n)](i[E(0x162,ap.o)](k,0x14),0x0)?function(){return!![];}[E(0x127,'DnLX')](i['cNZsW'](E(ap.p,'7]Nd'),i['snnPI']))[E(ap.q,'BDd7')](i[E(0x18b,ap.r)]):function(){return![];}['constructor'](E(ap.s,ap.t)+i[E(ap.u,ap.aq)])['apply']('stateObject');i[E(0x143,ap.ar)](j,++k);}try{if(h)return j;else i[D(0x13b,aq.k)](j,0x0);}catch(k){}}