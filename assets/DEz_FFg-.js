import{j as e,r as s}from"./_LxKj9PG.js";import{F as o,Q as t}from"./GO_KNHZp.js";import{b as a}from"./DTlazO7w.js";import{P as r}from"./Itq7e1c5.js";import{a5 as i,a6 as n,q as l,r as c,b as d,c as m,a7 as p}from"./slvTtaAp.js";import"./C_9exQ7i.js";import"./BIw_sdFo.js";import"./BJRa5TG-.js";import"./c7OvE8pj.js";import"./yJGO6Amu.js";import"./tRrjmjzN.js";import"./BFk34ZWe.js";import"./lcqsW1nY.js";import"./DIrOWF5t.js";import"./D74OPSAh.js";import"./COFYN2eQ.js";import"./BJtv0x2K.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./ZZM5rHs7.js";import"./Dw1DiDGf.js";import"./YiBEvX-Q.js";import"./rRm29nvs.js";import"./CzGuHLZU.js";import"./B8Let_61.js";import"./CZm-rpfG.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const j=({color:s,title:o,value:t,data:a})=>e.jsx(i,{color:s,value:t,title:o,action:e.jsx(l,{alignment:"end",children:e.jsx(c,{color:"transparent",caret:!1,className:"text-white p-0"})}),chart:e.jsx(n,{className:"mt-3",style:{height:"70px"},data:{labels:Array(10).fill(""),datasets:[{label:"Data",backgroundColor:"rgba(255,255,255,.2)",borderColor:"rgba(255,255,255,.55)",data:a,fill:!0}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!1}},elements:{line:{borderWidth:2,tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4}},animation:{duration:0}}})});j.propTypes={color:r.string.isRequired,title:r.string.isRequired,value:r.any.isRequired,data:r.any.isRequired};const u=()=>{const[r,i]=s.useState({connections:[{current:0,available:0}],oplog:[{getMoreOps:0,networkBytes:0}],operations:[{insert:0,query:0,update:0,delete:0,getmore:0,command:0}]}),[n,l]=s.useState(null),[c,u]=s.useState(!0),{addToast:x}=a(),[g,h]=s.useState([]),[v,f]=s.useState([]),y=e=>{const s=e.filter((e=>0!==e)),o=s.reduce(((e,s)=>e+s),0),t=s.length;return 0===t?0:o/t},S=async()=>{axios.get("/metrics/prometheus").then((e=>{const s=e.data;((e,s,o,t)=>{const a=(e+s)/(Date.now()/1e3-t);f((e=>[...e,parseFloat(a.toFixed(2))]))})(parseFloat(s.process_cpu_user_seconds_total[0].value),parseFloat(s.process_cpu_system_seconds_total[0].value),parseFloat(s.process_cpu_seconds_total[0].value),parseFloat(s.process_start_time_seconds[0].value)),h((e=>[...e,parseFloat(s.process_cpu_seconds_total[0].value.toFixed(2))]))})).catch((e=>{var s,o;const t=(null==(o=null==(s=e.response)?void 0:s.data)?void 0:o.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);x(t)})),axios.get("/metrics/mongodb").then((e=>{i(e.data)})).catch((e=>{var s,o;const t=(null==(o=null==(s=e.response)?void 0:s.data)?void 0:o.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);x(t)})),axios.get("/metrics/redis").then((e=>{l(e.data)})).catch((e=>{var s,o;const t=(null==(o=null==(s=e.response)?void 0:s.data)?void 0:o.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);x(t)})).finally((()=>u(!1)))};return s.useEffect((()=>{S();const e=setInterval((()=>{S()}),5e3);return()=>clearInterval(e)}),[]),c?"":e.jsxs("div",{children:[e.jsx("h4",{children:"System"}),e.jsxs(d,{xs:{gutter:4},children:[e.jsx(m,{sm:6,xl:4,xxl:3,children:e.jsx(j,{color:"primary",title:"Average Load Time",value:`${y(v).toFixed(2)}ms`,data:v})}),e.jsx(m,{sm:6,xl:4,xxl:3,children:e.jsx(j,{color:"danger",title:"CPU Usage",value:`${y(g).toFixed(2)}%`,data:g})})]}),e.jsx("h4",{className:"mt-3",children:"Atlas"}),e.jsxs(d,{children:[e.jsx(m,{md:6,children:e.jsx(p,{padding:!1,color:"primary",className:"mb-3",icon:e.jsx(o,{icon:t,className:"fa-3x"}),title:`${r.connections[0].current.toLocaleString()} Connections`,value:(r.connections[0].current/r.connections[0].available*100).toFixed(2)+"%"})}),e.jsx(m,{md:6,children:e.jsx(p,{padding:!1,color:"secondary",className:"mb-3",icon:e.jsx(o,{icon:t,className:"fa-3x"}),value:`${r.oplog[0].getMoreOps.toLocaleString()} GetMore Ops`,title:`${r.oplog[0].networkBytes.toLocaleString()} Network Bytes`})})]}),e.jsxs(d,{children:[e.jsx(m,{md:6,children:e.jsx(p,{padding:!1,color:"warning",className:"mb-3",icon:e.jsx(o,{icon:t,className:"fa-3x"}),value:`${r.operations[0].insert.toLocaleString()} insertions`,title:`${r.operations[0].query.toLocaleString()} queries`})}),e.jsx(m,{md:6,children:e.jsx(p,{padding:!1,color:"info",className:"mb-3",icon:e.jsx(o,{icon:t,className:"fa-3x"}),title:`${r.operations[0].update.toLocaleString()} updates`,value:`${r.operations[0].delete.toLocaleString()} deletes`})})]}),e.jsx(d,{children:e.jsx(m,{md:6,children:e.jsx(p,{padding:!1,color:"danger",className:"mb-3",icon:e.jsx(o,{icon:t,className:"fa-3x"}),value:`${r.operations[0].getmore.toLocaleString()} operations`,title:`${r.operations[0].command.toLocaleString()} commands`})})}),e.jsx("h4",{className:"mt-3",children:"Redis"}),e.jsxs(d,{children:[e.jsx(m,{md:6,children:e.jsx(p,{padding:!1,color:"info",className:"mb-3",icon:e.jsx(o,{icon:t,className:"fa-3x"}),title:`${n.totalKeys.toLocaleString()} Total Keys`,value:`${n.keysWithExpiry.toLocaleString()} Keys Expiring`})}),e.jsx(m,{md:6,children:e.jsx(p,{padding:!1,color:"warning",className:"mb-3",icon:e.jsx(o,{icon:t,className:"fa-3x"}),title:`${function(e){if(e<=0||isNaN(e))return"0 ms";const s=Math.floor(e/1e3%60),o=Math.floor(e/6e4%60),t=Math.floor(e/36e5),a=[];return t&&a.push(`${t} hour${1!==t?"s":""}`),o&&a.push(`${o} minute${1!==o?"s":""}`),(s||!t&&!o)&&a.push(`${s} second${1!==s?"s":""}`),a.join(" ")}(n.avgTTLms)} Average TTL`,value:`${n.usedMemory.toLocaleString()} Used Memory`})})]}),e.jsx(d,{children:e.jsx(m,{md:6,children:e.jsx(p,{padding:!1,color:"primary",className:"mb-3",icon:e.jsx(o,{icon:t,className:"fa-3x"}),title:`${n.totalCommandsProcessed.toLocaleString()} Commands Processed`,value:`${n.opsPerSec.toLocaleString()} Ops per second`})})})]})};export{u as default};
