import{j as e,r as n}from"./D447H_JX.js";import{F as w,t as F}from"./Bf5fUEEs.js";import{a as O}from"./CCb-kr4I.js";import{a as P}from"./Cz0CWeBA.js";import{P as s}from"./NDWEpGI6.js";import{y as I,J as K,L as A,K as L,I as D,a4 as b,a5 as q,a6 as R,a7 as o,a8 as a,a9 as C,aa as i,C as E,ab as G,ac as H,ad as g,ae as M,af as y}from"./Dc-GyhDH.js";import{i as f}from"./W1cWR0I6.js";import{d as U}from"./BLMNyl0r.js";import"./Cs9MZ78u.js";import"./BQBsAJpH.js";import"./DONGgsY8.js";import"./CzFDRTuY.js";import"./CWmxXzlZ.js";import"./BZxJdD1U.js";import"./hQm3cgwF.js";import"./Bqduuf9F.js";import"./D3kAHpSt.js";const S=({query:d,setQuery:t,state:l,setState:u,priority:m,setPriority:h,order:x,setOrder:p,result:c})=>e.jsxs(e.Fragment,{children:[c.scm.length===0&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(I,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})}),c.scm.length!==0&&e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(A,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:r=>t(r.target.value)}),e.jsx(L,{id:"basic-addon",children:e.jsx(w,{icon:F})})]}),e.jsxs(D,{className:"d-flex justify-content-left my-2 my-lg-0 overflow-scroll no-scrollbar",children:[e.jsx(b,{value:l,onChange:r=>u(r.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(b,{value:m,onChange:r=>h(r.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(b,{value:x,onChange:r=>p(r.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"})]}),e.jsxs(q,{striped:!0,children:[e.jsx(R,{children:e.jsxs(o,{children:[e.jsx(a,{children:"#"}),e.jsx(a,{children:"State"}),e.jsx(a,{children:"Scope"}),e.jsx(a,{children:"Manifest"}),e.jsx(a,{children:"CVE"}),e.jsx(a,{children:"Summary"}),e.jsx(a,{children:"Severity"}),e.jsx(a,{children:"Updated At"})]})}),e.jsx(C,{children:c.scm.map(r=>e.jsxs(o,{children:[e.jsx(i,{children:r.number}),e.jsx(i,{children:r.state}),e.jsx(i,{children:r.scope}),e.jsx(i,{children:r.manifest}),e.jsx(i,{children:r.cve}),e.jsx(i,{children:r.summary}),e.jsx(i,{children:r.severity}),e.jsx(i,{children:new Date(r.updated_at).toLocaleString()})]},r.number))})]})]})]});S.propTypes={query:s.string.isRequired,setQuery:s.func.isRequired,state:s.string.isRequired,setState:s.func.isRequired,priority:s.string.isRequired,setPriority:s.func.isRequired,order:s.string.isRequired,setOrder:s.func.isRequired,result:s.shape({scm:s.arrayOf(s.shape({number:s.number.isRequired,state:s.string.isRequired,scope:s.string.isRequired,manifest:s.string.isRequired,cve:s.string.isRequired,summary:s.string.isRequired,severity:s.string.isRequired,created_at:s.string.isRequired,updated_at:s.string.isRequired})).isRequired}).isRequired};const T=({result:d})=>e.jsx(e.Fragment,{children:e.jsxs(q,{striped:!0,children:[e.jsx(R,{children:e.jsxs(o,{children:[e.jsx(a,{children:"#"}),f&&e.jsx(a,{children:"User"}),e.jsx(a,{children:"Location"}),e.jsx(a,{children:"Device"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Last Accessed"})]})}),e.jsx(C,{children:d.sessions.map((t,l)=>e.jsxs(o,{children:[e.jsx(i,{children:l+1}),f&&e.jsx(i,{children:t.user_id}),e.jsx(i,{children:t.ip_address}),e.jsx(i,{children:t.user_agent}),e.jsx(i,{children:t.active}),e.jsx(i,{children:t.last_accessed})]},l))})]})});T.propTypes={result:s.shape({sessions:s.arrayOf(s.shape({_id:s.string.isRequired,user_id:s.string,ip_address:s.string.isRequired,user_agent:s.string.isRequired,active:s.string.isRequired,last_accessed:s.string.isRequired})).isRequired}).isRequired};const k=()=>e.jsx(e.Fragment,{children:e.jsx("b",{children:"OTP 24252424 "})}),le=()=>{const[d,t]=n.useState(!1),[l,u]=n.useState("2"),[m,h]=n.useState("1"),[x,p]=n.useState("1"),[c,r]=n.useState(""),[v,N]=n.useState({scm:[],sessions:[]});U();const _=async()=>{t(!0),await O.get("https://backend-core1.axleshift.com//api/v1/threat/",{headers:{Authorization:`Bearer ${P.get("RCTSESSION")}`}}).then(j=>{N(j.data)}).catch(j=>{console.error(j)}).finally(()=>{t(!1)})};return n.useEffect(()=>{_()},[]),e.jsxs("div",{children:[d&&e.jsx("div",{className:"loading-overlay",children:e.jsx(E,{color:"primary",variant:"grow"})}),e.jsxs(G,{activeItemKey:1,className:"mb-4",children:[e.jsxs(H,{variant:"underline-border",children:[e.jsx(g,{"aria-controls":"home-tab-pane",itemKey:1,children:"Sessions"}),e.jsx(g,{"aria-controls":"profile-tab-pane",itemKey:2,children:"Dependabot"}),e.jsx(g,{"aria-controls":"profile-tab-pane",itemKey:3,children:"OTP"})]}),e.jsxs(M,{children:[e.jsx(y,{className:"py-3","aria-labelledby":"home-tab-pane",itemKey:1,children:e.jsx(T,{result:v})}),e.jsx(y,{className:"py-3","aria-labelledby":"profile-tab-pane",itemKey:2,children:e.jsx(S,{query:c,setQuery:r,state:l,setState:u,priority:m,setPriority:h,order:x,setOrder:p,result:v})}),e.jsx(y,{className:"py-3","aria-labelledby":"profile-tab-pane",itemKey:3,children:e.jsx(k,{})})]})]})]})};export{le as default};
