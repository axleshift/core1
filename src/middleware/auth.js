(function(h,i){const I={h:0x176,i:'ELxi',j:0x19b,k:'8zh7',l:0x165,m:0x16d,n:'bu%6',o:'MPd&'},x=f,j=h();while(!![]){try{const k=-parseInt(x(I.h,I.i))/0x1*(parseInt(x(0x19c,'WlC$'))/0x2)+-parseInt(x(I.j,'unpr'))/0x3*(-parseInt(x(0x11c,'8&HM'))/0x4)+parseInt(x(0x18b,I.k))/0x5+-parseInt(x(I.l,'I&%j'))/0x6+-parseInt(x(0x167,'X&mK'))/0x7*(parseInt(x(I.m,'WpPS'))/0x8)+-parseInt(x(0x174,I.n))/0x9+-parseInt(x(0x124,I.o))/0xa*(-parseInt(x(0x180,'8zh7'))/0xb);if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0xae4f0));const d=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const S={h:'*Xse',i:0x162},R={h:0x137,i:'nY!&',j:0x13a,k:'(LUX',l:0x157},y=f,h={'dsrsB':'function\x20*\x5c(\x20*\x5c)','cpClU':y(0x159,'[sDR'),'bqDik':function(i,j){return i(j);},'GOZwq':function(i,j){return i+j;},'IBrXb':y(0x184,S.h),'rBdLt':function(i){return i();},'KoGGH':function(i,j,k){return i(j,k);}};h[y(S.i,'h3i%')](d,this,function(){const z=y,i=new RegExp(h[z(0x19f,'uqiK')]),j=new RegExp(h['cpClU'],'i'),k=h[z(R.h,R.i)](c,'init');!i[z(0x177,'mBra')](h[z(0x193,'KU9m')](k,h['IBrXb']))||!j[z(R.j,'uqiK')](h[z(0x122,'h3i%')](k,z(0x145,R.k)))?h['bqDik'](k,'0'):h[z(R.l,'ELxi')](c);})();}());const b=(function(){const T={h:0x16a};let h=!![];return function(i,j){const k=h?function(){const A=f;if(j){const l=j[A(T.h,'v]R)')](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const a1={h:0x13b,i:'X&mK',j:'bu%6',k:0x152,l:'4km6',m:0x17e,n:0x17f,o:'KU9m',p:0x171,q:'5UYt',r:0x198,s:'uqiK',t:0x192,u:'5I$n',v:0x125,w:'uqiK',a2:'qcvu',a3:0x13d,a4:'WpPS',a5:0x16f,a6:'0poC'},a0={h:0x11d,i:0x129,j:0x155,k:'I@&^'},B=f,h={'LQDUg':function(m,n){return m+n;},'mFydV':B(0x118,'mBra'),'PsLWM':function(m){return m();},'HXNoo':B(a1.h,'8&HM'),'eRTUQ':B(0x12e,a1.i),'IopnL':B(0x19e,a1.j),'skrGt':B(a1.k,a1.l),'suhOS':'table','RExGy':'trace','OwMCv':function(m,n){return m<n;}},i=function(){const C=B;let m;try{m=Function(h[C(a0.h,'&9N%')](h[C(a0.i,'!cAm')](C(0x130,'P^Dr'),h[C(a0.j,a0.k)]),');'))();}catch(n){m=window;}return m;},j=h[B(a1.m,'*u&J')](i),k=j['console']=j[B(a1.n,'v]R)')]||{},l=[h[B(0x185,a1.o)],B(a1.p,a1.l),h[B(0x164,a1.q)],h[B(a1.r,'*Xse')],h['skrGt'],h[B(0x186,'Ddx*')],h[B(0x196,a1.s)]];for(let m=0x0;h[B(0x15b,'dedn')](m,l['length']);m++){const n=b[B(a1.t,a1.u)][B(a1.v,a1.w)][B(0x12c,'*(WF')](b),o=l[m],p=k[o]||n;n[B(0x187,a1.a2)]=b[B(a1.a3,a1.a4)](b),n[B(a1.a5,'8&HM')]=p[B(0x178,a1.a6)][B(0x141,'&9N%')](p),k[o]=n;}});a();import{getUser,getSession}from'../components/sessions.js';import g from'../models/db.js';function e(){const as=['WQSKW4H+W6/dPSkaWRzWWOWLW53cG0jT','WPldO08xqa','W6FdPCobtt90tSo7BSkX','WRrHueC1','F8kVW6VcSCoRDYu','W5ddR0JdJCoMWOlcQIdcHSk2','WRrMj30KyG','WPyOWQuWW54','cJT7q8kB','dtnxoNC','lqxdHSkbua','WRNcP3dcKmk/','aYXLuCo8WRlcLuBdLq','W7FdLSkqemk0','W65wvwT/','s8k1W4pcI8od','W5ddPKVdJmkdW6pdIZZcJSkzWOxdNmoi','W47dU2VdUSk2CmoogSoLW64AW4/cLG','W5ZdNSk2ySoe','W5JdGCkvgaCsW5tcLSoKxW','W6RdS8oQgWzMW6bXnSkKkmoieG','DKpcNvSUWPO','xG/dRhtcGG','WPtdJhOGWRaUWPFcQIxcRta','iHldKSkztG','W7/cQuSWWO4','WOX3FxqDWO7cUW','A8kHiSoUrW','tSkmm8ofw1L8W6ZcMaPfW4VdVHCm','jZrgpvu','uu/cSSkLfCkMB8oqW4G','fCkIWPNcI8kAW7DRW4dcQCo6ua','mZS9WRpcPCoNiWfzW4lcUq','lXlcQMyIWQhcU0u','hSoUWRCzW44kqajZCSktsKO','aSopCSoFta','xCkxkmoAFa','lJldRdZdPNRdHb8lWOtdLSo8WOXvmL7dHmkrWQFcRCoEWQVdUSkOxmonWRD1W4NdKGhcQG','zftcIey0WOC','yCogjvC','WRNdRKebWQG','k2VdG8knWOtcOwBdM8oW','AaBdG2xcRG','W4FdTSoXaW4','vSknn8kgdx0izXSmWRxcN8oj','WQO3aWy6WR9uDYXseG','EmoYWP9ig8kwWRpcQCoTWP/cNgNcK8kKWOu3vwTcW4fBomoDWQm+uColWO4dWQZdPSoo','umomCCo8yW','WQ5duwym','WO/cM8o1o8kmvCkanCohWRRdVGG','sCkwnCoDuq0TW6JcJW','WRRdMtHUW4/dN3ldICkyW75P','jIbKv8oe','vdBdS1G','jW5sF8ks','sJJdSa','W7hcVxG6WQi','W6NcHM44','DKHWW6xdNG','WPtdUxNdUG','e8oHWPCPW7K','WRegW7ldON5Sk8o/WOShWQNdQueSWOhcHmoUW5md','AIxcGSkbWO7cNq','yCoZsCoPwG','lXz7rW','WORcUt7cVCo3mG','vYpdPKtcVmk8','CCozW6b+e8kx','WONcGSoNsc0','umkwW7pcOCoY','WPdcVqdcQmoMjCkonCoIW54','tCkbkCoD','DtpcLG','FLdcTLmLWPdcP3ziWQm','jJijmW','kbX+rSo9','CmoQW59p','W6ddHLvE','rJ7dQvq','AJNcGSkgWOlcN2hdQG','W6e8WP0KWQZcOCkpWOjgWPS0WPG','W7ldOsZdRmouCCkvWRlcLSo2WOxdN3G','ASoHW4fEaa','e1/cQsxdQq','WRVdRKSEsG','WPxdVvJdLKu','FSotW6bQe8knW6C+WQRcIc4','WOBdQ8o7C8ob','cJXIq8kdW5G','W63dVmk0gq','W7/cN8o3W4JdNa','fMdcTuJcPSkECmkNW7y','WPRdShRdPW','A8oQW5bpeCkkWRm','W7ZdUCot','aeJcJqZdJmoQWRNdOCkF','W5xdI8kNASoyf8kD','uCkOW53cL8oq','AmoLpKBcLa','WOtdL3uNWReV','W6ZdM8k+mCk2','W64xW4zGWQ7cVa','WRRdQmoIW550WPdcJmoybComWPalWOlcUSkrBtr+WQxdU8kZA8oku1nxW5DZW6v1nSkprmoi','suxcJXiRoSkKimkRWOtdMq','WR0qWOSdW6u','DmoSWQWW','F8kVW6VcSCoWAtxdIM1MW4W','WRbOW4j9','WP7dUhhdPKTtq8onovfS','W5pdLSkZl8kN','W6JcN8oLW4BdRq','xmoSBmomwG','evxcNr0','WOz5xwyj','W4tcGmkKbmkYW78JzSosWOG4WRpcIW','W7pdUSoi','W47cPsNcRh5Mx8omfu0','W7tdRmkXmSkm','WOJcSCojCHy','FCkWW7xcRSo9','W63cJfC0WPO','bSorBa','DwjtyI/dPmostmoiW7dcPq','W5dcIwChAmoLWPNdOa','BtpcOSkbWPNcMwhdVG','EJpcNCkzWO7cK3VdSmo8WPK','eLhcNaC','lmkfWROUmCkMW4yZWPVcRG','WRemW6RdSG','umklnmkdcNqpxYiPWQdcPmo3','WRldVSotB8oz','WQZcRCoOsCo1hSkIWPj2W7vd','isRcSsS','W7ldVCokgYTUW611','DCkUW6BcRSoXFYxdMG','WPbghtK8'];e=function(){return as;};return e();}(function(){const a6={h:'(LUX',i:'EFJ]',j:0x11b,k:0x188,l:'ELxi',m:0x15a},D=f,h={'PABwl':function(j,k){return j(k);},'uXbXs':function(j,k){return j+k;},'NMURl':function(j,k){return j+k;},'iOJmv':'return\x20(function()\x20','nCmHW':D(0x121,a6.h),'fGbxt':function(j){return j();}};let i;try{const j=h['PABwl'](Function,h[D(0x189,a6.i)](h[D(a6.j,'5I$n')](h[D(a6.k,a6.l)],h['nCmHW']),');'));i=h['fGbxt'](j);}catch(k){i=window;}i[D(a6.m,'Kb46')](c,0x9c4);}());import{ObjectId}from'mongodb';const adminRoute=[],auth=async(h,i,j)=>{const ai={h:0x131,i:0x19d,j:0x183,k:0x17b,l:'d1[%',m:'(LUX',n:0x127,o:'qcvu',p:0x119,q:'(LUX',r:0x15c,s:'J0fD',t:0x16c,u:'nY!&',v:0x179,w:'P^Dr',aj:0x14b,ak:'&9N%',al:0x14c,am:0x153,an:0x18f,ao:'0poC',ap:0x148,aq:'X&mK',ar:'BeIt',as:0x14a,at:0x194,au:'*(WF',av:0x13c,aw:0x182,ax:0x17d,ay:0x158,az:'pP*Y',aA:0x140,aB:'5UYt'},ah={h:0x154,i:'v]R)',j:0x168,k:'ELxi',l:'VLw2',m:0x138,n:'8&HM',o:'^LcY',p:0x12a},E=f,k={'MhXUT':function(u){return u();},'jukON':function(u,v){return u===v;},'LVvcv':function(u,v){return u===v;},'SUoMA':E(ai.h,'8&HM'),'zSqtW':E(ai.i,'PXlN'),'cBjSP':function(u,v){return u(v);},'lzTXX':function(u,v){return u!==v;},'WuFIG':E(ai.j,'!cAm'),'LZtrX':E(ai.k,ai.l),'vkGaS':'user-agent','hjGCz':function(u,v){return u-v;},'zXkDK':function(u,v){return u*v;},'MOiRe':function(u,v){return u*v;},'tFKlu':function(u,v){return u>=v;},'dOcpM':function(u,v){return u!==v;}},l=h[E(0x150,ai.m)][k[E(ai.n,ai.o)]];if(!l)return i[E(ai.p,'WlC$')](0x191)[E(0x13f,ai.q)]();const m=l[E(0x17a,'4mBe')]('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/[E(0x163,'4km6')](m))return i[E(0x156,'5I$n')](0x191)[E(ai.r,ai.s)]();const [n,o]=await Promise[E(ai.t,'bu%6')]([k[E(0x169,ai.u)](getUser,m),k['cBjSP'](getSession,m)]);if(!n||adminRoute[E(ai.v,'v]R)')](h[E(0x128,'&9N%')])&&k[E(0x12f,'PXlN')](n[E(0x173,ai.w)],k[E(0x18a,'v]R)')]))return i[E(0x134,'VLw2')](0x191)[E(0x133,'qcvu')]();if(!o[E(ai.aj,'!cAm')])return i[E(0x135,ai.ak)](0x191)[E(ai.al,'ELxi')]();let p=h[E(ai.am,'MPd&')][k['LZtrX']]||h['socket']['remoteAddress'];const q=h[E(0x195,'*u&J')][k['vkGaS']],r=new Date(o[E(ai.an,ai.ao)]),s=k[E(ai.ap,ai.aq)](Date[E(0x151,ai.ar)](),r),t=k[E(ai.as,'I&%j')](k[E(0x17c,'N[6O')](k[E(0x191,'&9N%')](k[E(0x160,'ELxi')](0x7,0x18),0x3c),0x3c),0x3e8);if(k[E(ai.at,ai.au)](s,t))p=0x0;Promise[E(0x166,'BeIt')]([((async()=>{const F=E;try{const u=await k[F(ah.h,ah.i)](g),v=k[F(ah.j,ah.k)](o[F(0x139,ah.l)],p)&&k[F(ah.m,'v]R)')](o[F(0x17d,'BeIt')],q);u[F(0x170,ah.n)](F(0x142,ah.n))[F(0x199,ah.o)]({'token':m},{'$set':{'active':v,'compromised':v,'last_accessed':Date[F(ah.p,'&9N%')](),'modified_by':k[F(0x147,'N[6O')]}});}catch(w){logger['error'](w);}})())]);if(o[E(ai.av,'WlC$')]!==p||k[E(ai.aw,'dedn')](o[E(ai.ax,'BeIt')],q))return i[E(ai.ay,ai.az)](0x191)[E(ai.aA,'IfjI')]();return h[E(0x13e,'qcvu')]=m,h['user']=n,k[E(0x123,ai.aB)](j);};function f(a,b){const c=e();return f=function(d,g){d=d-0x118;let h=c[d];if(f['KeusoW']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['VPTRhL']=m,a=arguments,f['KeusoW']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['GrHSPl']===undefined&&(f['GrHSPl']=!![]),h=f['VPTRhL'](h,g),a[k]=h):h=l,h;},f(a,b);}export default auth;function c(h){const ar={h:0x197,i:'[t*w',j:0x14f,k:'X&mK'},aq={h:0x181,i:'tIAs',j:0x15d,k:'v]R)',l:0x16b,m:'*(WF',n:0x15f,o:'d1[%',p:0x12b,q:'*(WF',r:0x149,s:'[t*w',t:0x12d,u:'unpr',v:0x18d,w:'MPd&',ar:0x146,as:'4km6'},G=f,i={'NMCXS':G(ar.h,'uqiK'),'fcWha':function(k,l){return k+l;},'AdhlW':function(k,l){return k/l;},'ZUiDe':G(0x136,ar.i),'qOhsS':function(k,l){return k%l;},'tEudO':G(0x11a,'I@&^'),'vpbbH':G(ar.j,ar.k),'zRxfY':G(0x190,'WlC$'),'pisgC':function(k,l){return k+l;},'voGLU':'stateObject'};function j(k){const H=G;if(typeof k===H(aq.h,aq.i))return function(l){}[H(aq.j,aq.k)](i[H(0x175,'I&%j')])[H(0x161,'wl8Z')]('counter');else i[H(aq.l,aq.m)]('',i[H(0x11e,'0poC')](k,k))[i['ZUiDe']]!==0x1||i['qOhsS'](k,0x14)===0x0?function(){return!![];}[H(aq.n,'X&mK')](i['fcWha'](i['tEudO'],i[H(0x132,'h3i%')]))[H(0x15e,aq.o)](i[H(aq.p,aq.q)]):function(){return![];}[H(aq.r,aq.s)](i['pisgC'](i[H(aq.t,aq.u)],i[H(0x14d,'wl8Z')]))[H(aq.v,aq.w)](i[H(aq.ar,aq.as)]);j(++k);}try{if(h)return j;else j(0x0);}catch(k){}}