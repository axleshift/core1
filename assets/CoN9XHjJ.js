import{j as e,r as s}from"./Oq9P1Wj_.js";import{F as a,d as t,W as l,s as i,I as r,X as n,r as c,Y as d,Z as o}from"./Bi-OQx1y.js";import{P as m,Q as h,p as j,a2 as x,g as u,h as p,a3 as v,a as b,b as y,c as g,w as f,q as N,r as S,s as w,t as k,a9 as C,ad as _,ae as A,af as K,ag as q,ah as T,ai as L,aj as R,ak as D,al as F,am as $,an as P}from"./C7J1C3Pw.js";import{a as U,V as E,b as z}from"./CmJA4lJM.js";import{E as I}from"./BGB82IPO.js";import{P as B}from"./NdsU5MZw.js";import{p as M}from"./B51y9YVM.js";import{d as O}from"./Ce_fjdqS.js";import"./deeEeel3.js";import"./DoV6T4jL.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";import"./CewSaW8v.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./BKB6Vojr.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./BYNIthp4.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";const W=()=>e.jsx(e.Fragment,{children:"This will list down all user & admin activities"}),H=()=>e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Deactivate all apikeys"}),e.jsx(m,{className:"mb-3",children:e.jsxs(h,{children:[e.jsx("p",{children:"Clearing all active apikeys will deny future incoming requests."}),e.jsx(j,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:!0,children:"Deactivate all apikeys"})]})}),"This will list down all api auth token created by user, there last accessed and its allowed ip addresses."]}),J=({color:s,title:a,value:t,data:l})=>e.jsx(x,{color:s,value:t,title:a,action:e.jsx(u,{alignment:"end",children:e.jsx(p,{color:"transparent",caret:!1,className:"text-white p-0"})}),chart:e.jsx(v,{className:"mt-3",style:{height:"70px"},data:{labels:Array(10).fill(""),datasets:[{label:"Data",backgroundColor:"rgba(255,255,255,.2)",borderColor:"rgba(255,255,255,.55)",data:l,fill:!0}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!1}},elements:{line:{borderWidth:2,tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4}},animation:{duration:0}}})});J.propTypes={color:B.string.isRequired,title:B.string.isRequired,value:B.any.isRequired,data:B.any.isRequired};const Q=()=>{const[a,t]=s.useState(null),[l,i]=s.useState(!0),{addToast:r}=U(),[n,c]=s.useState(Array(10).fill(0)),[d,o]=s.useState(0),[m,h]=s.useState(Array(10).fill(0)),[j,x]=s.useState(0),u=(e,s,a,t)=>{const l=4*(Date.now()-t),i=parseFloat((a/l*100).toString().match(/^(\d+\.\d)/));h((e=>{const s=[...e,i];return s.length>10&&s.shift(),s}));const r=m.reduce(((e,s)=>e+s),0);x(r.toString().match(/^(\d+\.\d)/))},p=async()=>{await axios.get(`${E}/metrics/v1/prometheus`,{headers:{Authorization:`Bearer ${cookies.get(z)}`}}).then((e=>{const s=e.data;t(s),((e,s,a,t)=>{u(e,s,a,t);const l=Date.now()-t,i=parseFloat((s/l).toString().match(/^(\d+\.\d)/));c((e=>{const s=[...e,i];return s.length>10&&s.shift(),s}));const r=n.reduce(((e,s)=>e+s),0);o(r.toString().match(/^(\d+\.\d)/))})(s.process_cpu_user_seconds_total[0].value,s.process_cpu_system_seconds_total[0].value,s.process_cpu_seconds_total[0].value,s.process_start_time_seconds[0].value)})).catch((e=>{if(401==e.status)return window.location.reload();const s=I[e.status]||"Server is offline or restarting please wait";r(s,"Submit failed!")})).finally((()=>i(!1)))};return s.useEffect((()=>{p();const e=setInterval((()=>{p()}),1500);return()=>clearInterval(e)}),[]),e.jsx("div",{children:a&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{xs:{gutter:4},children:[e.jsx(y,{sm:6,xl:4,xxl:3,children:e.jsx(J,{color:"primary",title:"Average Load Time",value:d,data:n})}),e.jsx(y,{sm:6,xl:4,xxl:3,children:e.jsx(J,{color:"danger",title:"CPU Usage",value:`${j}%`,data:m})})]}),JSON.stringify(a,null,4)]})})},V=()=>{const{addToast:l}=U(),[i,r]=s.useState(!0),[n,c]=s.useState([]),[d,o]=s.useState(""),[m,h]=s.useState(0),[j,x]=s.useState(0),[u,p]=s.useState(0);return s.useEffect((()=>{(async()=>{await axios.get(`${E}/api/v1/sec/management/dependabot`,{headers:{Authorization:`Bearer ${cookies.get(z)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const s=I[e.status]||"Server is offline or restarting please wait";l(s)})).finally((()=>r(!1)))})()}),[]),e.jsxs("div",{children:[i&&e.jsx("div",{className:"loading-overlay",children:e.jsx(g,{color:"primary",variant:"grow"})}),0===n.length&&!i&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(f,{src:"/images/threat.png",fluid:!0,width:"50%",loading:"lazy"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})}),0!==n.length&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(S,{className:"mb-3",children:[e.jsx(w,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:e=>o(e.target.value)}),e.jsx(k,{id:"basic-addon",children:e.jsx(a,{icon:t})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(C,{value:u,onChange:e=>p(e.target.value),options:[{label:"All",value:0},{label:"Resolved",value:1},{label:"Unresolved",value:2},{label:"Not Plan",value:3}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(C,{value:j,onChange:e=>x(e.target.value),options:[{label:"All",value:0},{label:"High",value:1},{label:"Medium",value:2},{label:"Low",value:3}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(C,{value:m,onChange:e=>h(e.target.value),options:[{label:"Newer",value:1},{label:"Older",value:2}],required:!0,className:"mb-3"})]}),e.jsxs(_,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(A,{children:e.jsxs(K,{children:[e.jsx(q,{children:"#"}),e.jsx(q,{children:"State"}),e.jsx(q,{children:"Scope"}),e.jsx(q,{children:"Manifest"}),e.jsx(q,{children:"CVE"}),e.jsx(q,{children:"Summary"}),e.jsx(q,{children:"Severity"}),e.jsx(q,{children:"Last Updated"})]})}),e.jsx(T,{children:n.map((s=>e.jsxs(K,{children:[e.jsx(L,{children:s.number}),e.jsx(L,{children:s.state}),e.jsx(L,{children:s.scope}),e.jsx(L,{children:s.manifest}),e.jsx(L,{children:s.cve}),e.jsx(L,{children:s.summary}),e.jsx(L,{children:s.severity}),e.jsx(L,{children:M(new Date(s.updated_at).getTime())})]},s.number)))})]})]})]})},X=()=>e.jsx(e.Fragment,{children:"This will setup maintenance status to the system denying user access temporarily."}),Y=()=>{const{addToast:l}=U(),[i,r]=s.useState(!0),[n,c]=s.useState([]),[d,o]=s.useState(""),[m,h]=s.useState(0),[j,x]=s.useState(0),[u,p]=s.useState(0);return s.useEffect((()=>{(async()=>{await axios.get(`${E}/api/v1/sec/management/sentry`,{headers:{Authorization:`Bearer ${cookies.get(z)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const s=I[e.status]||"Server is offline or restarting please wait";l(s)})).finally((()=>r(!1)))})()}),[]),e.jsxs("div",{children:[i&&e.jsx("div",{className:"loading-overlay",children:e.jsx(g,{color:"primary",variant:"grow"})}),0===n.length&&!i&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(f,{src:"/images/threat.png",fluid:!0,width:"50%",loading:"lazy"}),e.jsx("h1",{children:"We couldn't find any issues."}),e.jsx("p",{children:"Should we add one? :)"})]})}),0!==n.length&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(S,{className:"mb-3",children:[e.jsx(w,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:e=>o(e.target.value)}),e.jsx(k,{id:"basic-addon",children:e.jsx(a,{icon:t})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(C,{value:u,onChange:e=>p(e.target.value),options:[{label:"All",value:0},{label:"Resolved",value:1},{label:"Unresolved",value:2},{label:"Not Plan",value:3}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(C,{value:j,onChange:e=>x(e.target.value),options:[{label:"All",value:0},{label:"High",value:1},{label:"Medium",value:2},{label:"Low",value:3}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(C,{value:m,onChange:e=>h(e.target.value),options:[{label:"Newer",value:1},{label:"Older",value:2}],required:!0,className:"mb-3"})]}),e.jsxs(_,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(A,{children:e.jsxs(K,{children:[e.jsx(q,{children:"#"}),e.jsx(q,{children:"Title"}),e.jsx(q,{children:"Culprit"}),e.jsx(q,{children:"Level"}),e.jsx(q,{children:"Status"}),e.jsx(q,{children:"Priority"}),e.jsx(q,{children:"Count"}),e.jsx(q,{children:"Last Updated"})]})}),e.jsx(T,{children:n.map((s=>e.jsxs(K,{children:[e.jsx(L,{children:s.id}),e.jsx(L,{children:s.title}),e.jsx(L,{children:s.culprit}),e.jsx(L,{children:s.level}),e.jsx(L,{children:s.status}),e.jsx(L,{children:s.priority}),e.jsx(L,{children:s.count}),e.jsx(L,{children:M(new Date(s.updated_at).getTime())})]},s.id)))})]})]})]})},Z=()=>{const{addToast:a}=U(),[t,l]=s.useState(!0),[i,r]=s.useState([]);return s.useEffect((()=>{(async()=>{await axios.get(`${E}/api/v1/sec/management/sessions`,{headers:{Authorization:`Bearer ${cookies.get(z)}`}}).then((e=>{e.data.error||r(e.data)})).catch((e=>{const s=I[e.status]||"Server is offline or restarting please wait";a(s)})).finally((()=>l(!1)))})()}),[]),e.jsxs("div",{children:[t&&e.jsx("div",{className:"loading-overlay",children:e.jsx(g,{color:"primary",variant:"grow"})}),i&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Logout all sessions"}),e.jsx(m,{className:"mb-3",children:e.jsxs(h,{children:[e.jsx("p",{children:"Clearing all active sessions will log everyone out."}),e.jsx(j,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:!0,children:"Logout all sessions"})]})}),e.jsxs(_,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(A,{children:e.jsxs(K,{children:[e.jsx(q,{children:"#"}),e.jsx(q,{children:"User"}),e.jsx(q,{children:"Location"}),e.jsx(q,{children:"Device"}),e.jsx(q,{children:"Status"}),e.jsx(q,{children:"Last Accessed"})]})}),e.jsx(T,{children:i.map(((s,a)=>e.jsxs(K,{children:[e.jsx(L,{children:a+1}),e.jsx(L,{children:s.user_id}),e.jsx(L,{children:s.ip_address}),e.jsx(L,{children:s.user_agent}),e.jsx(L,{children:s.active?"Active":"Inactive"}),e.jsx(L,{children:M(s.last_accessed)})]},a)))})]})]})]})},G=()=>{const[t,m]=s.useState(0),[h,j]=s.useState(!0),x=O(),u=new URLSearchParams(window.location.search),p=u.get("tab")?u.get("tab"):"",v=(e,s)=>{x(`?tab=${s}`)};return s.useEffect((()=>{switch(p||0!=p.length||v(0,"dashboard"),p){case"dashboard":m(0);break;case"sessions":m(1);break;case"dependabot":m(2);break;case"sentry":m(3);break;case"access-token":m(4);break;case"activity":m(5);break;case"maintenance":m(6)}j(!1)}),[]),e.jsxs("div",{children:[h&&e.jsx("div",{className:"loading-overlay",children:e.jsx(g,{color:"primary",variant:"grow"})}),!h&&e.jsxs(R,{activeItemKey:t,className:"mb-4",children:[e.jsxs(D,{variant:"underline-border",children:[e.jsxs(F,{"aria-controls":"dashboard-tab-pane",itemKey:0,onClick:()=>v(0,"dashboard"),children:[e.jsx(a,{icon:l,className:"me-1"})," Dashboard"]}),e.jsxs(F,{"aria-controls":"sessions-tab-pane",itemKey:1,onClick:()=>v(0,"sessions"),children:[e.jsx(a,{icon:i,className:"me-1"})," Sessions"]}),e.jsxs(F,{"aria-controls":"dependabot-tab-pane",itemKey:2,onClick:()=>v(0,"dependabot"),children:[e.jsx(a,{icon:r,className:"me-1"})," Dependabot"]}),e.jsxs(F,{"aria-controls":"sentry-tab-pane",itemKey:3,onClick:()=>v(0,"sentry"),children:[e.jsx(a,{icon:n,className:"me-1"})," Sentry"]}),e.jsxs(F,{"aria-controls":"access-token-tab-pane",itemKey:4,onClick:()=>v(0,"access-token"),children:[e.jsx(a,{icon:c,className:"me-1"})," Access Token"]}),e.jsxs(F,{"aria-controls":"activity-tab-pane",itemKey:5,onClick:()=>v(0,"activity"),children:[e.jsx(a,{icon:d,className:"me-1"})," Activity"]}),e.jsxs(F,{"aria-controls":"maintenance-tab-pane",itemKey:6,onClick:()=>v(0,"maintenance"),children:[e.jsx(a,{icon:o,className:"me-1"})," Maintenance"]})]}),e.jsxs($,{children:[e.jsx(P,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:e.jsx(Q,{})}),e.jsx(P,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:e.jsx(Z,{})}),e.jsx(P,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:e.jsx(V,{})}),e.jsx(P,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:e.jsx(Y,{})}),e.jsx(P,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:4,children:e.jsx(H,{})}),e.jsx(P,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:5,children:e.jsx(W,{})}),e.jsx(P,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:6,children:e.jsx(X,{})})]})]})]})};export{G as default};
