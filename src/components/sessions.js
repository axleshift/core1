(function(i,j){const G={i:0x133,j:'&@F7',k:'YL7b',l:0x164,m:'!@VH',n:'wlaN',o:0x153,p:0x149,q:'!@VH',r:0x16a,H:'!@VH',I:'VLR[',J:0x13a,K:'0HM0'},s=f,k=i();while(!![]){try{const l=-parseInt(s(G.i,G.j))/0x1*(-parseInt(s(0x146,G.k))/0x2)+parseInt(s(G.l,'wtkK'))/0x3*(-parseInt(s(0x184,G.m))/0x4)+parseInt(s(0x170,G.n))/0x5*(parseInt(s(0x16b,'le4('))/0x6)+parseInt(s(G.o,'xATJ'))/0x7+-parseInt(s(G.p,G.q))/0x8*(-parseInt(s(G.r,G.H))/0x9)+parseInt(s(0x191,'$]uz'))/0xa+-parseInt(s(0x17b,G.I))/0xb*(parseInt(s(G.J,G.K))/0xc);if(l===j)break;else k['push'](k['shift']());}catch(m){k['push'](k['shift']());}}}(e,0x4243f));const d=(function(){let i=!![];return function(j,k){const H={i:'yaLL'},l=i?function(){const t=f;if(k){const m=k[t(0x135,H.i)](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}());(function(){const P={i:0x130,j:'4**^',k:0x185,l:'yaLL',m:0x16d,n:0x182,o:'1gud'},O={i:'5PP*',j:0x189,k:'gKv$',l:0x144,m:'U9OZ'},u=f,i={'RCKVm':'function\x20*\x5c(\x20*\x5c)','WHWfJ':u(P.i,P.j),'ccolm':u(P.k,P.l),'QEyAm':function(j,k){return j+k;},'Ogfti':u(P.m,'l8kX'),'wQStt':function(j){return j();},'ejCxy':function(j,k,l){return j(k,l);}};i[u(P.n,P.o)](d,this,function(){const v=u,j=new RegExp(i['RCKVm']),k=new RegExp(i[v(0x175,O.i)],'i'),l=c(i[v(O.j,O.k)]);!j['test'](l+v(O.l,'j1^n'))||!k['test'](i[v(0x126,O.m)](l,i['Ogfti']))?l('0'):i['wQStt'](c);})();}()),(function(){const V={i:0x192,j:'rP@Q'},U={i:0x13c,j:'j1^n'},w=f,i={'DbOED':function(l,m){return l(m);},'EFyJi':function(l,m){return l+m;},'vLHCg':function(l,m){return l+m;},'yDQqa':w(V.i,V.j),'fhTdO':'{}.constructor(\x22return\x20this\x22)(\x20)','FyYLJ':function(l){return l();}},j=function(){const x=w;let l;try{l=i[x(0x157,'1V!o')](Function,i['EFyJi'](i['vLHCg'](i[x(U.i,U.j)],i[x(0x142,'%sqb')]),');'))();}catch(m){l=window;}return l;},k=i[w(0x178,'yaLL')](j);k['setInterval'](c,0x9c4);}());const b=(function(){let i=!![];return function(j,k){const l=i?function(){const y=f;if(k){const m=k[y(0x16e,'P9x^')](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),a=b(this,function(){const a2={i:'L^F*',j:0x177,k:'O[mS',l:0x15b,m:'&@F7',n:0x17a,o:0x150,p:'QZ&H',q:'3uww',r:0x14f,a3:'0HM0',a4:'hH[*',a5:0x158,a6:0x14a,a7:'O[mS',a8:'rP@Q',a9:0x160,aa:0x180},z=f,i={'SvdzE':function(m,n){return m(n);},'iUWsg':function(m,n){return m+n;},'iNUki':'{}.constructor(\x22return\x20this\x22)(\x20)','VaVgB':z(0x17e,a2.i),'ncKgS':z(a2.j,'1V!o'),'WhCGi':z(0x15c,a2.k),'cJXQg':z(a2.l,a2.m),'ioAHe':'table','uYuWD':z(a2.n,'$]uz')};let j;try{const m=i[z(0x137,'EMJn')](Function,i[z(0x195,'L^F*')](z(a2.o,'1V!o')+i['iNUki'],');'));j=m();}catch(n){j=window;}const k=j[z(0x138,a2.p)]=j['console']||{},l=[i[z(0x13d,'1V!o')],i[z(0x176,a2.q)],i[z(a2.r,a2.a3)],'error',i[z(0x15f,a2.a4)],i[z(a2.a5,'IeOM')],i[z(0x127,'hH[*')]];for(let o=0x0;o<l[z(0x13e,'l8kX')];o++){const p=b[z(0x129,'!@VH')][z(a2.a6,'g[5s')][z(0x166,a2.a7)](b),q=l[o],r=k[q]||p;p[z(0x167,a2.a8)]=b[z(a2.a9,'l8kX')](b),p['toString']=r[z(0x14c,'1V!o')][z(a2.aa,a2.q)](r),k[q]=p;}});a();import{ObjectId}from'mongodb';function f(a,b){const c=e();return f=function(d,g){d=d-0x125;let h=c[d];if(f['eIxsTX']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['MQFxjf']=m,a=arguments,f['eIxsTX']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['otbAYX']===undefined&&(f['otbAYX']=!![]),h=f['MQFxjf'](h,g),a[k]=h):h=l,h;},f(a,b);}import g from'../models/db.js';import h from'./logger.js';export const addSession=async(i,j,k,l)=>{const a3={i:0x125,j:0x14e,k:'0HM0',l:0x140,m:'$]uz',n:'rP@Q'},A=f,m={'wUmTQ':A(a3.i,'g[5s')};try{const n=await g();n[A(a3.j,a3.k)](m['wUmTQ'])[A(0x14d,'IeOM')]({'user_id':i[A(a3.l,a3.m)],'token':j,'active':!![],'ip_address':k,'user_agent':l,'compromised':![],'last_accessed':Date[A(0x186,'rV2o')]()});}catch(o){h[A(0x13b,a3.n)](o);}};export const getUser=async i=>{const a5={i:'U9OZ',j:'Y5*^',k:0x171,l:'QZ&H',m:0x17f,n:0x148,o:'ja]D',p:0x132,q:0x13f,r:'hH[*',a6:0x16c,a7:'&@F7',a8:0x161,a9:0x12e,aa:'U9OZ'},B=f,j={'lIGDE':function(k){return k();},'IXdQQ':B(0x18b,a5.i),'ZCMWc':B(0x159,a5.j)};try{const k=await j[B(a5.k,'Ct4Z')](g),l=await k[B(0x188,a5.l)](j[B(a5.m,'Np9K')])[B(a5.n,a5.o)]({'token':i});if(!l)return null;const m=await k[B(a5.p,'iwo1')](j['ZCMWc'])['findOne']({'_id':l[B(a5.q,a5.r)]});return{'_id':m['_id'],'email':m[B(0x136,'QZ&H')],'first_name':m[B(0x173,'g[5s')],'last_name':m[B(a5.a6,a5.a7)],'role':m[B(a5.a8,a5.r)],'email_verify_at':m[B(a5.a9,a5.aa)]};}catch(n){h[B(0x155,'gKv$')](n);}return null;};export const removeSession=async i=>{const a7={i:0x18e,j:'wo7t',k:0x152,l:'hH[*',m:0x162,n:'iwo1'},C=f,j={'bGfEK':function(k){return k();},'revkl':C(a7.i,a7.j),'jTrwj':C(0x190,'j1^n')};try{const k=await j[C(0x16f,'j1^n')](g);await k[C(a7.k,a7.l)](j['revkl'])['updateOne']({'token':i},{'$set':{'active':![],'last_accessed':Date['now'](),'modified_by':j[C(a7.m,'P9x^')]}});}catch(l){h[C(0x193,a7.n)](l);}};function e(){const aj=['WO/cGSolf8o6','WRxdN8oJyuFcGqFdSd3cOHrPeW','W4uUWR/cJmkkxmoNWQFdOq','s8kgW6/cULRdRutcN1O','EIDAl8k1','sSkiEmk5WQ8','WP/cK8o5kSoN','sSoLW5rlpSkSW6nTzCkiWRO','v3PnbSkc','WQvqcmoTsq','fCksv3XCWOddHCk5W5RcOW','WRhdMmoLye/dR3NdJdBcGJK','tGC6W5xcOq','WRZdSColumkN','rN/dOJi','b8knWPSTaW','mSkrWResimoYBN8','rCkwkSoPW4i','rY1ob8oOW7COW6ugWQVcRSkTda','WPpdIdTFfqi+mmk7tCkZ','mCkxvSkuWPm','nSk6zW','tthcQXb1','WRddU8oUuW','CZpcNbnf','WRKoW5jwWQe','WOzFeSkc','WRBdN8kLeXFdVehdKW','kmkAWQSv','WO9xaa','W7CcsmkpnvXYsmkIWPJcLSkOFW','WOG5emk0CSoJW6OffMO','WQKiWPLnwa','WRXjW5VcUCkg','W58FW4/cP8o5dhax','WORdOb9Vfq','fCkxwSoEWOjpWQf1WObVkG','nSoYWRZcHmkjW59Eoq','a8kUiSotW6RdImkx','WO7cRCoSg8ojta','amoCEmk8WPhcRColtfSCwSouWR8','CCoRzxGqW7JdVSoLzxCeWQfZaCoIBqpcJgq','WQK2j8oxrG','W4KRWRtdImojkSk6WPxdR8ouW7ZcU8oS','m8kav8k9WP4','amkEvNXbWRddHCkR','W70/W4xcLCo9','nmo3W7/dLt0','CWSReJDZp8kJWRu','W6FcGmk6jGVdHupdOcRcHH4','ehiBwCk4WQzKW7WXWOG','mSo/WQBcM8kfWPaypSoCW5HPtgVcMCkS','W70OW4pcLW','W5LMdCkEF8olW6K8','W4KxW53cVCo8pgGbWRjYmCotgWue','WQHwjSobyq','wLatwgm8wmoYW6PgnNyRW7VcJSkhWQNdTd7cMmoafCk8lmkkumkRWRlcHtqLWOKkjq','pftdG8oSWOtdNmkoyhldUmov','WQ8RoCouuCoSWODNxIy','fmoxWQ7dUZ3dPvBcO0KvWQa','W4WPWRxdJmojF8o7WOJdUSotW5C','imkeWRinma','WO47hCkXEW','vSo/jbxdUq','WOG5eSkREmoSW7S','WPK9b8ouwG','aCkHW61HdHtcTCoZ','zSo8y2iq','WOtcKmoohSon','z3/dHJTB','FYXepCk1W7e','nmoDW6/dScy2WPS','BSknlW','BGFcHCkWW4RdNW','W7GHW7VcN8k1','W6ldNqVcOH0UW5VdSab/W74','WP7cVmo+bSoc','CmocWRyZpCoeuwK','gCoeuMC4ygy','tSo8sveh','Aq3cN8k9W7pdLmky','WRxdMCkGbWVdRMFdPG','a8kjsNThWQVdKSkOW5i','h8kYWO4i','rxhdGYHRW4VcThq','W6edW6NdOSkMW4BcP2FcHq','umo6W4jajcBcL8oSbSoZ','zmo9W61Rka','q3VdPcLRW4ZdUJSkW4VdLmkarZrRWPKkwJG','FCkIW73cGCkwW7rvcmo4','iSobW6BdRHW8WOTIbaa','W4RdTLxdTNRcVmoOC8o7WPSAzwS','W7GGW4hcN8k1erC','WQ8zWOrorW','bCoCdWHgW6u','DxZdNXLD','W6ecW5VdJ8kX','WOxdLdbEeG','E8o6WRm2ru3cVmkRBmohWQtcPSkw','qSkFW7/cQ3xdT0ZcNve','W7JdHWZcUq','ycuGW7RcUG','uSopis7dVW','iSoKW5ldKX4','CsbepG','m8obW6BdPW','qCkSESkIWRW','uSoLW55aoa','bXBcPmkNW4dcOSkMW5WdWOjW','yCopuN0t','W7pdGatcSG','xmoryx8nW6lcSCksxa','EKhcQKOgWOpcMSok'];e=function(){return aj;};return e();}export const getSession=async i=>{const a9={i:0x179,j:0x12a,k:'VLR[',l:'L^F*',m:0x152,n:0x128,o:'4**^',p:0x147,q:'YL7b'},D=f,j={'JAiCf':function(k){return k();},'kBVZj':D(a9.i,'yaLL')};try{const k=await j[D(0x165,'YL7b')](g),l=await k[D(a9.j,a9.k)](j[D(0x17d,a9.l)])[D(0x154,'%sqb')]({'token':i});if(l[D(0x141,'ja]D')])k[D(a9.m,'hH[*')](j['kBVZj'])[D(a9.n,a9.o)]({'token':i},{'$set':{'last_accessed':Date['now']()}});return l;}catch(m){h[D(a9.p,a9.q)](m);}return null;};function c(i){const ai={i:0x14b,j:'wlaN',k:0x143,l:'O[mS'},ah={i:0x163,j:0x139,k:'iwo1',l:']gbf',m:0x18c,n:'Y5*^',o:0x18d,p:')TCc',q:'%sqb',r:0x12f,ai:0x172},E=f,j={'rVTxV':'string','WFaAC':'counter','ARVCz':function(l,m){return l+m;},'UyRln':function(l,m){return l/m;},'zGJCt':function(l,m){return l%m;},'yjMIQ':E(ai.i,ai.j),'wZSRa':E(0x183,'rV2o'),'ndYzl':'action','brAiJ':E(ai.k,ai.l),'cbwVD':function(l,m){return l(m);}};function k(l){const F=E;if(typeof l===j[F(0x169,'j1^n')])return function(m){}['constructor'](F(0x12b,'wo7t'))[F(ah.i,'0HM0')](j[F(0x15e,'EMJn')]);else j[F(0x18a,'le4(')]('',j[F(ah.j,ah.k)](l,l))[F(0x156,ah.l)]!==0x1||j[F(ah.m,ah.n)](l,0x14)===0x0?function(){return!![];}[F(ah.o,ah.p)](j['yjMIQ']+j['wZSRa'])[F(0x12c,ah.q)](j[F(ah.r,'bXfT')]):function(){return![];}[F(0x17c,'Y5*^')](j[F(0x15d,'5PP*')]+j[F(0x181,'Np9K')])['apply'](j['brAiJ']);j[F(ah.ai,'bXfT')](k,++l);}try{if(i)return k;else k(0x0);}catch(l){}}