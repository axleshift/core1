import{R as e,r as s,j as a}from"./Oq9P1Wj_.js";import{F as r,H as t}from"./IXMtX5d7.js";import{Q as i}from"./Cl7qhzEd.js";import{h as n}from"./DxFnCsxZ.js";import{R as o}from"./eGqyD3ZN.js";import{a as c,b as l,e as d}from"./Bf3kis8m.js";import{E as m}from"./BGB82IPO.js";import{S as p}from"./S14YABLN.js";import{d as j,k as u}from"./Ce_fjdqS.js";import{c as h,a as f,b as x,d as y,e as b,g,h as v,i as S,Y as w}from"./GAhPWFs0.js";import"./deeEeel3.js";import"./NdsU5MZw.js";import"./BXWkExu4.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./CewSaW8v.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./fHQ1LRrH.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./ChytwAMd.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";const N=()=>{const N={isImport:!1,isResidentialAddress:!1,containsDangerGoods:!1,containsDocuments:!1,from:[{name:"",company:"",country:"",countryCode:"",city:"",zipCode:"",address:"",address2:"",address3:"",phone:"",email:"",taxId:""}],to:[{name:"",company:"",country:"",countryCode:"",city:"",zipCode:"",address:"",address2:"",address3:"",phone:"",email:"",employerId:""}],type:"private",items:[]},{user:k}=c(),C=e.useRef(),{addToast:R}=l(),[_,D]=s.useState(N),[A,E]=s.useState(N);s.useState("");const[O,z]=s.useState(""),[F,I]=s.useState(!1),[T,$]=s.useState(!0),[B,H]=s.useState(!1),[L,P]=s.useState(!1),Q=s.useRef(null),Y=j(),{id:q}=u();return s.useEffect((()=>{(async()=>{I(!0),axios.get(`/freight/${q}`).then((e=>{D({...e.data,internal:!0}),E({...e.data,internal:!0})})).catch((e=>{H(!0)})).finally((()=>I(!1)))})()}),[]),F?a.jsx("div",{className:"loading-overlay",children:a.jsx(h,{color:"primary",variant:"grow"})}):B?a.jsx(f,{className:"justify-content-center my-5",children:a.jsx(x,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no shipment found."}),a.jsx("p",{children:"Double check tracking id for any mistake."})]})})}):a.jsxs("div",{children:[L&&a.jsxs(y,{visible:!0,onClose:()=>P(!1),alignment:"center",scrollable:!0,children:[a.jsx(b,{closeButton:!0}),a.jsx(g,{children:a.jsx("div",{className:"d-flex justify-content-center align-items-center",children:a.jsx("div",{ref:Q,className:"d-inline-block",children:a.jsx(i,{value:q})})})}),a.jsx(v,{className:"d-flex justify-content-center align-items-center",children:a.jsx(S,{color:"primary",onClick:()=>{P(!1),n(Q.current,{useCORS:!0}).then((e=>{const s=e.toDataURL("image/png"),a=document.createElement("a");a.href=s,a.download="qrcode.png",document.body.appendChild(a),a.click(),document.body.removeChild(a)}))},children:"Download"})})]}),a.jsx(o,{ref:C,size:"invisible",sitekey:d}),a.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4",children:[a.jsxs("span",{className:"d-block",children:[a.jsx("span",{className:"text-primary fw-bold small",children:"Tracking Number:"}),a.jsx("br",{}),q]}),a.jsxs(w,{className:"mb-2 mb-sm-0",children:[a.jsx(S,{color:"primary",className:"me-2 rounded",onClick:e=>P(!0),children:a.jsx(r,{icon:t})}),"cancelled"!==O&&"received"!==O&&a.jsxs(a.Fragment,{children:["to_pay"===O&&"user"===k.role&&a.jsx(S,{color:"primary",className:"me-2 rounded",onClick:async()=>{const e=await C.current.executeAsync();I(!0),axios.post("/invoices",{id:q,recaptcha_ref:e}).then((e=>window.location.href=e.data.r_url)).catch((e=>{const s=m[e.status]||"Server is offline or restarting please wait";R(s)})).finally((()=>I(!1)))},children:"Book shipment"}),a.jsx(S,{color:"primary",className:"me-2 rounded",onClick:async()=>{if(T)return $(!1);const e=await C.current.executeAsync();I(!0);const s={...A,recaptcha_ref:e};axios.post(`/freight/update/${q}`,s).then((e=>R("Your changes has been saved."))).catch((e=>{const s=m[e.status]||"Server is offline or restarting please wait";R(s,"Submit failed!"),E(_)})).finally((()=>{I(!1),$(!0)}))},disabled:["to_receive","received"].includes(O),children:T?"Edit":"Save"}),a.jsx(S,{color:T?"danger":"warn",className:"me-2 rounded",onClick:async()=>{if(!T)return $(!0),void E(_);const e=await C.current.executeAsync();I(!0),axios.post(`/freight/cancel/${q}`,{recaptcha_ref:e}).then((e=>{R("Shipment has been cancelled."),Y("/dashboard")})).catch((e=>{const s=m[e.status]||"Server is offline or restarting please wait";R(s,"Submit failed!"),E(_)})).finally((()=>I(!1)))},disabled:["to_receive","received"].includes(O),children:"Cancel"})]})]})]}),a.jsx(p,{data:{form:_,setForm:D,loading:F,setLoading:I}})]})};export{N as default};
