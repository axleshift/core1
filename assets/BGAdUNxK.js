import{r as s,R as v,j as e}from"./D3kDgYDB.js";import{R as w}from"./D0iU1EWp.js";import{F as p,O as E,P}from"./BlWyeQQ1.js";import{V as T,a as h,b as u}from"./Cl7e3D_B.js";import{E as x}from"./DYDFNPHr.js";import{C as R,y as S,O as j,L as _,M as N,N as f}from"./CRebGdRz.js";import"./CNSOrHVr.js";import"./WyM-ksIe.js";import"./dB90dn3U.js";import"./Dw8pycEM.js";import"./8JwjhRSi.js";import"./FDBtgKq2.js";import"./D3kAHpSt.js";import"./tpRZQFqq.js";import"./CzFDRTuY.js";import"./CQ-yZ3vu.js";import"./BmHAl9XU.js";import"./t_wxcTun.js";import"./DiDpq0UU.js";import"./CHUBTVDa.js";import"./CXnULsF_.js";import"./CCb-kr4I.js";import"./Cz0CWeBA.js";import"./Cp7XljvA.js";import"./BQBsAJpH.js";import"./CWmxXzlZ.js";import"./BZxJdD1U.js";const ne=()=>{const[y,a]=s.useState(!1),c=v.useRef(),[g,I]=s.useState(!0),[o,d]=s.useState(null),[m,t]=s.useState(""),k=()=>{I(r=>!r)},A=async()=>{try{await navigator.clipboard.writeText(o),t("API Key copied!")}catch(r){console.log(r),t("Failed... no idea why.")}},l=async()=>{a(!0);const r=await c.current.executeAsync(),i=new FormData;i.append("recaptcha_ref",r),await axios.post(`${h}/api/v1/auth/token/new`,i,{headers:{Authorization:`Bearer ${cookies.get(u)}`}}).then(n=>{d(n.data.token),t("")}).catch(n=>{console.error(n);const b=x[n.status]||"An unexpected error occurred";t(b)}).finally(()=>{a(!1)})},C=async()=>{a(!0),await axios.get(`${h}/api/v1/auth/token/`,{headers:{Authorization:`Bearer ${cookies.get(u)}`}}).then(r=>{d(r.data.token),t("")}).catch(r=>{console.error(r);const i=x[r.status]||"An unexpected error occurred";t(i)}).finally(()=>{a(!1)})};return s.useEffect(()=>{C()},[]),e.jsxs("div",{children:[y&&e.jsx("div",{className:"loading-overlay",children:e.jsx(R,{color:"primary",variant:"grow"})}),e.jsx(w,{ref:c,size:"invisible",sitekey:T}),e.jsx("h3",{children:"Auth token"}),!o&&e.jsx("div",{className:"text-center border rounded mb-4",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(S,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"There was no API Token"}),e.jsx(j,{color:"primary",onClick:l,children:"Generate Token"}),e.jsx("p",{children:m})]})}),o&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-center border rounded mb-4",children:e.jsxs("div",{className:"p-2 p-md-5 my-5 my-md-0",children:[e.jsxs(_,{className:"mb-3",children:[e.jsx(N,{className:g?"blurred":"",value:o,"aria-describedby":"basic-addon"}),e.jsx(f,{id:"basic-addon",onClick:k,children:e.jsx(p,{icon:E})}),e.jsx(f,{id:"basic-addon",onClick:A,children:e.jsx(p,{icon:P})})]}),e.jsx(j,{color:"secondary",onClick:l,children:"Generate new token"}),e.jsx("p",{children:m})]})})}),e.jsx("h3",{children:"Whitelisted IP address"})]})};export{ne as default};
