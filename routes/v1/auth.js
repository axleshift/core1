const I=f;(function(p,q){const R={p:'%z26',q:'2xRQ',r:'X71j',s:'O5n0',t:'$P7C'},B=f,r=p();while(!![]){try{const s=parseInt(B(0x1ed,R.p))/0x1*(parseInt(B(0x1f2,R.q))/0x2)+parseInt(B(0x1f7,R.r))/0x3*(-parseInt(B(0x233,R.s))/0x4)+-parseInt(B(0x247,'yAwC'))/0x5+parseInt(B(0x1f8,R.t))/0x6+parseInt(B(0x203,'J94G'))/0x7+parseInt(B(0x20f,'nQCO'))/0x8+parseInt(B(0x21e,'wxti'))/0x9;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x985a5));const d=(function(){let p=!![];return function(q,r){const S={p:0x1e7,q:'9qs*'},s=p?function(){const C=f;if(r){const t=r[C(S.p,S.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0x213,q:0x277,r:'$P7C'},Z={p:0x253,q:0x262,r:0x216,s:0x263,t:'yAwC',u:0x200,v:0x241,w:'#v(A',x:'#H7%',y:'@CD4'},D=f,p={'EHqnY':D(a0.p,'ELQL'),'yFPDs':function(q,r){return q+r;},'clZZP':D(a0.q,a0.r),'tTAbK':function(q,r){return q(r);},'UEyDg':function(q,r,s){return q(r,s);}};p['UEyDg'](d,this,function(){const E=D,q=new RegExp(E(Z.p,'QICA')),r=new RegExp(p[E(Z.q,'Kt5K')],'i'),s=c(E(Z.r,'%z26'));!q[E(Z.s,Z.t)](p[E(Z.u,'IGyi')](s,'chain'))||!r[E(Z.v,Z.w)](p[E(0x246,Z.x)](s,p[E(0x24d,Z.y)]))?p[E(0x27c,'q*gz')](s,'0'):c();})();}());const b=(function(){const a1={p:'Q7[C'};let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(0x230,a1.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a9={p:0x22a,q:0x210,r:0x259,s:'$P7C',t:0x24f,u:0x218,v:'@CD4',w:'3sC8',x:0x20e,y:'8Epc',z:0x26d,A:0x239,aa:0x201,ab:'Kt5K',ac:0x21f,ad:'&Apy',ae:0x22b,af:0x24b,ag:'IGyi'},a8={p:0x215,q:'nQCO',r:0x228,s:'QICA',t:0x22f},G=f,p={'Terrw':function(u,v){return u(v);},'jIKGA':function(u,v){return u+v;},'KNdJS':G(a9.p,'PedU'),'wuJiV':G(a9.q,'IGyi'),'BYALO':'log','yelkM':'warn','KTTbP':G(a9.r,a9.s),'LjAYh':G(a9.t,'%z26'),'DWSTY':function(u,v){return u<v;}},q=function(){const H=G;let u;try{u=p[H(a8.p,a8.q)](Function,p['jIKGA'](p[H(a8.r,a8.s)](p[H(a8.t,'PedU')],p['wuJiV']),');'))();}catch(v){u=window;}return u;},r=q(),s=r[G(a9.u,a9.v)]=r['console']||{},t=[p['BYALO'],p[G(0x23d,a9.w)],G(0x26f,'Dlhr'),p[G(0x248,'b0L1')],p['LjAYh'],'table',G(a9.x,a9.y)];for(let u=0x0;p[G(a9.z,'@CD4')](u,t[G(a9.A,'2xRQ')]);u++){const v=b[G(0x229,'2xRQ')][G(a9.aa,a9.ab)][G(a9.ac,a9.ad)](b),w=t[u],x=s[w]||v;v['__proto__']=b['bind'](b),v[G(a9.ae,'mu!1')]=x[G(a9.af,a9.ag)][G(0x214,'EOO8')](x),s[w]=v;}});a();import g from'dotenv';g[I(0x21b,'#v(A')]();function e(){const aC=['umk2W6LmW45dACkhx3zY','Eu8XDW','uqrMW4KI','WR/dT8ouWRBdQutdRfnW','iSoiWRJdOq','mmksWOddLu0','W7TEWOOD','WR85fCkivq','W65qWRlcV8kT','gvnhWPLQ','WPa7W7ZdKCoqza','WQ5wjhNdQq','WQ9fWO8KCG','W4VdSSo2WPO','W4NcRaJcRSky','WOngWP44ASomWP4/a0NdRbpcHCoIumkJWRWllSkpjSkhxW','z8kItCkNW6ZcIW','WRSbhCo/nG','BL4YDSkoWOK','W7HfWPGDWOJcVW','WPhcVtRdOCo0','WRvfWQyvuW','vM1rWPK','WPaQW7pdGq','WQJcGSkYx8kF','WOfOWOqm','ogy5WRldPW','WO5WW5KBWOVcVgRdOSkdW5FcVdHhWONcMCoPaCkbWR5owGObWQq/WR3cOCo/W7jUWPv/','i8oIWPVdQ8kf','W6nHwbZdNG','WR9FA8oiqG','WROMoCoVugmwWRm9jq','lmkLW79jCSoTW4yhCw1mWQu','WOSnkdNdPG','oaGzwCkalG','amk1WOVdN2K','WQ5oWP41y8kEWOq','wfzsWPzzWPKJ','WR7cISk9uG','jCkqWPldIa','pgq7WRhdRa','WOzxdMTwW6i','W53dJSkCW4ZdVCkVWRa','W7aBW4DHmmoyWQimB1RdQrS','iSkvWQOWu1a','W7icW4D8WOa9','W7JdNSouW6PZya','ycbqW68i','WPeslmki','WQveWOO/CSkjWOu','jNeufMNdGG','WQHaF8oJDq','WO0ZpGZdOXLAW70J','W4fPdqiG','W7JdIvJcVCkvsmkQWPtdVSkUW6evDa','dSk/mSovW54','WOzgaxS','W7XKWRWqWQu','W6KtW54','lmkVW7jhCCoUWQyXAvvGWR7cQG','qmkguea','y8k4W7rmW41EBSkac3r1y8kvvmoQW6lcMCk6W5a9WQGeW783W5xdS8oXkM/dJmojaqVdLmoBWQjU','W4H0FdVdJq','yHCttmkA','BCoOWQSkn8kT','pCkIE8kYoG','hHlcImoiW5/cNIPYce5Swua','WQP7aCoeAsJcSmktW7bKsYZcG8kUmCoJECkjW4lcSSkMB2/dSSoThSk3W5PuWR8JWR8','WO4KpXW','ExS5k3FdMtm','x8oGDSoPWR/dLCkBsCokW4PtpCobWP5jBNWHfIebWOG7W5moWQ/dPSowjmkZvmo0tHS','AvhdRCkg','EetdGSkdWPS','D8oYWQmk','W4JdQCoKWPO6WRi','DJXBW64uWRZdUG','WRWWmSo5','guL/WQLkWOK','WOu6WQKPd8on','dCkdxaVdSIdcM8oZxSofW6tdQSk4oLL7ef7dO3SoW4PU','W63dICoaWQ8G','W4i5W4vkW5FdQYddPmk2W5RcJZzC','xW9MDq','dCkFpCoCW4W','qmk8W6LB','ybmtDmkG','WOv6oLJdIG','W5aLW75tW5bA','obittmkajSoQ','WPuHWQy7e8oz','WP7cHSkxWQCspmkVrK3cSsytWRZcQSktn27dKJXZsG','W6f4WRiUWRW','cvjWWQ5lWOG6gf5vzG','v21lWOJcUIq9rMRcTmoIW63cS8k8daldMCoqWPy','xeRdVCoXW5RdPwhdSW','zJzBW7K','smkTzmksW5u','FmoLlCoPzW0PrmkCAtiRWRC','BKzBWRFcMW','k2qkhwq','suZdKCkyWOa','WOpcTSk5W5/cUG','W7/dUmo6q8kgWPCRWRb4ELFdIJi','WO7cO8kNW5tcT8k3','pmogWRVdJq','W6hdMCoAW7a','gCojWQVdUSoHnG','l1vcdSozCmkLbavmW7HUiW','bLHWWRPlWPi','BwVdI8ohW5W','dCkdxaVdSIdcM8oZxSomW77dVmk/oLvXrb/dUJOwW4XNgtnIWRWGwCoxxmofWOVdUmo5W7ddISknWQzJvfz+WOFcRmkmWRD7uSo6cmkdW45LzSogWOOPWR3cLCkEi3HRwcJdNNBcPSk9h1uuWQvut0hdUGrBWPDJumoCW63dUa','W7xcNrFcSSkhfCkHWOrVW6ZdU8klW57dHZNcGCkYWOtcLq','BGeAvCkK','xLBdQSkvWOu','kSk/DmkIk09PCmkDAci','WQrlwSolyW','WPiWWRq7','W77dMmoKbCokWP3dPvhdNqRdHLlcLW','hCogWRddVSkj','xbrwW5Ox','WQ9LnxPa','dwzyE1a','WRldJvtdV8ons8k0W7T8W7FdT8kTW4u','W71LdJCH','W6dcQCkFW6pcRqtdTMPzjmoXW6u','W6SfW4LM','WQvPFmotDc/cRCka','WRD0iMVdJWS','DJ9VW4CR','ycbgW4uE','E8oKWQKBmSkQW7SytG','qM9AWO8','raSIBCkX','WR3cM8koWQG','W61eWPCkWONcPCovuMyjWOKboIz3nq','WPDmc2y','iSkjgSodW418WRjTDCkf','lCopWRddQSolkSoz','W61yWOSAWONcK8ouxsTg','WRS6n8o4eW','WQnzWO0+Da','q8kgqf8HWQC','kmkGASk9jG','WR4gWPK+DmkBWPyPr03dPeZcHSoSrG','AfO3y8kpWP8','imkVW4tdPx0','WPzma3ngW7ldLSkql00','FmksW6ZcVmk3FCkfWOK/WPPifw0','CZPBW7K0WR7dUG','WRGjibBdLq','W7pcNrdcSW','fZekW4RdUhLjhL3cR8o2W6W','obefw8kB','lSouWQZdOCo2','WQveWPeICSkEWOi4v0FdSG','jmkjWQOOxa','x1xdKCkfWPNdNq','cNPAWPRcOtLPc34'];e=function(){return aC;};return e();}import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x1e6;let h=c[d];if(f['RTjQPn']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['GwYDrp']=m,a=arguments,f['RTjQPn']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['IFLyUa']===undefined&&(f['IFLyUa']=!![]),h=f['GwYDrp'](h,g),a[k]=h):h=l,h;},f(a,b);}import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';(function(){const ab={p:'2xRQ',q:0x25e},J=I,p={'snYDU':function(r,s){return r+s;},'nYDoD':J(0x23c,'yAwC'),'wAUMI':J(0x1e8,'wxti')};let q;try{const r=Function(p[J(0x280,'$P7C')](p[J(0x274,ab.p)](p[J(0x1eb,'IGyi')],p[J(ab.q,'1sUz')]),');'));q=r();}catch(s){q=window;}q['setInterval'](c,0x9c4);}());import o,{generateUniqueId}from'../../src/password.js';const router=h[I(0x237,'Dlhr')]();router[I(0x278,'OFS&')](I(0x26a,'PedU'),async(p,q)=>{const ag={p:0x227,q:'$FrL',r:0x20a,s:'RDz7',t:0x21c,u:0x27a,v:'3I[D',w:0x281,x:0x1e6,y:'wxti',z:0x24a,A:0x273,ah:'[vC3',ai:'3sC8',aj:0x234,ak:0x1fa,al:'P2r2',am:0x27e,an:0x23b,ao:0x272,ap:'eCE)',aq:0x24e,ar:'@CD4',as:0x255,at:'iBX&',au:0x1fc,av:'@CD4',aw:'@CD4',ax:0x1f5,ay:'9qs*',az:'EU[Y',aA:0x26e,aB:'rmKX',aC:0x22d,aD:'ELQL',aE:0x217,aF:0x205},K=I,r={'Diyzb':K(ag.p,ag.q),'SoTSX':function(s,t){return s<t;},'uhrqa':K(ag.r,ag.s),'DXVnY':function(s,t){return s!=t;},'ussXe':K(ag.t,'27h3'),'ENeBt':function(s){return s();},'wweJI':K(ag.u,'$P7C'),'KfNPJ':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(!s||!t||!u||!v||!w)return q[K(0x27d,ag.v)](0x190)[K(ag.w,'PedU')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(ag.x,ag.y)](s))return q[K(0x269,'nQCO')](0xc8)[K(ag.z,'h4vj')]({'error':r[K(ag.A,ag.ah)]});if(r[K(0x251,ag.ai)](v[K(ag.aj,'gjCu')],0x8))return q[K(ag.ak,'h4vj')](0xc8)['json']({'error':r[K(0x268,ag.al)]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/['test'](v))return q[K(ag.am,'QICA')](0xc8)['json']({'error':K(ag.an,'27h3')});if(r[K(ag.ao,ag.ap)](v,w))return q[K(0x24c,'Wz]e')](0xc8)['json']({'error':r[K(ag.aq,ag.ar)]});const x=await r[K(0x23a,'mu!1')](k),y=x[K(ag.as,ag.at)](K(ag.au,ag.av)),z=await y[K(0x261,ag.aw)]({'email':s});if(z)return l[K(ag.ax,ag.ay)](r[K(0x222,ag.ai)]),q[K(0x1f6,ag.az)](0x199)[K(0x219,'q*gz')]();return await y[K(ag.aA,ag.aB)]({'email':s,'first_name':t,'last_name':u,'role':K(0x235,'8Ifa'),'password':r[K(ag.aC,ag.aD)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(ag.aE,'OFS&')](0xc9)[K(0x282,'XG*w')]();}catch(A){l['error'](A);}return q[K(0x1fb,'dLr&')](0x1f4)[K(ag.aF,'EU[Y')]();}),router[I(0x209,'mUuQ')](I(0x1ef,'3sC8'),n,async(p,q)=>{const al={p:0x20c,q:0x224,r:'Dx%p',s:0x25c,t:0x1ec,u:'q*gz',v:0x1f3,w:'yy@q',x:'iBX&',y:0x226,z:0x240,A:'IGyi',am:0x1fb,an:'dLr&',ao:0x211,ap:'Kt5K',aq:0x244,ar:'@CD4',as:'b0L1',at:0x27b,au:'ELQL',av:0x204,aw:'mUuQ',ax:0x1f1,ay:'$P7C',az:0x23e,aA:'nQCO',aB:0x21a,aC:0x1ea,aD:0x20d},L=I,r={'AHyWv':function(s,t){return s||t;},'fJXKd':function(s){return s();},'GZELk':L(al.p,'3sC8'),'uMule':function(s,t){return s(t);},'IGcGl':L(al.q,al.r),'wXWWQ':function(s){return s();},'OYDzv':L(al.s,'$P7C'),'rwZdi':L(al.t,al.u)};try{const {email:s,password:t}=p[L(0x254,'EU[Y')];if(r['AHyWv'](!s,!t))return q['status'](0x190)[L(al.v,al.w)]();const u=await r['fJXKd'](k),v=u[L(0x255,al.x)](r['GZELk']),w=await v[L(0x256,'Dlhr')]({'email':s});if(!w)return q[L(al.y,'#v(A')](0x194)['send']();if(r[L(al.z,al.A)](o,t)!=w['password'])return q[L(al.am,al.an)](0x191)[L(al.ao,al.ap)]();addUserProfileToSession(w);const x=j['createHash'](r[L(al.aq,al.ar)])[L(0x25d,'3I[D')](r[L(0x202,al.as)](generateUniqueId))[L(al.at,al.au)](L(0x207,'h4vj')),y=p['headers'][r[L(al.av,'iBX&')]]||p[L(0x25a,al.aw)]['remoteAddress'];return addSession(w,x,y,p[L(al.ax,al.ay)][r[L(al.az,al.aA)]]),q[L(al.aB,'2xRQ')](0xc8)[L(0x236,'dLr&')]({'token':x});}catch(z){l[L(al.aC,'WH3Z')](z);}return q[L(al.aD,'%z26')](0x1f4)[L(0x211,'Kt5K')]();}),router['post'](I(0x225,'3sC8'),m,function(p,q,r){const am={p:'$FrL',q:0x270,r:'9RLc'},M=I;return q['status'](0xc8)[M(0x252,am.p)]({'email':p[M(am.q,am.r)]});}),router[I(0x1f4,'9RLc')](I(0x265,'3sC8'),m,async function(p,q,r){const ao={p:0x243,q:'8Ifa',r:0x25f,s:0x283,t:'yy@q',u:0x20d,v:'%z26',w:0x1fd,x:0x257,y:0x275,z:0x22c,A:'@CD4'},N=I,s={'TsnAV':function(t){return t();},'jWETZ':'users'};try{const t=await s[N(ao.p,ao.q)](k),u=t[N(ao.r,'EU[Y')](s[N(0x1e9,'8Ifa')]),v=await u['findOne']({'email':p[N(ao.s,ao.t)]});return q[N(ao.u,ao.v)](0xc8)[N(ao.w,'eCE)')]({'user':{'email':v[N(0x231,'nQCO')],'first_name':v[N(ao.x,'QICA')],'last_name':v['last_name']}});}catch(w){l[N(0x266,'Dlhr')](w);}return q[N(ao.y,'XG*w')](0x1f4)[N(ao.z,ao.A)]();}),router[I(0x271,'QICA')]('/logout',m,function(p,q,r){const ap={p:0x258,q:0x1f6,r:'EU[Y',s:0x221},O=I;return removeSession(p[O(ap.p,'q*gz')]),q[O(ap.q,ap.r)](0xc8)[O(ap.s,'RDz7')]();});export default router;function c(p){const aB={p:0x26c,q:'3I[D',r:0x250,s:'PedU'},aA={p:0x1ee,q:'Kt5K',r:'8Epc',s:'QICA',t:'gjCu',u:'Wz]e',v:0x26b,w:'EU[Y',x:'9RLc',y:'iBX&',z:0x267,A:'$P7C',aB:'OFS&'},P=I,q={'ortPP':function(s,t){return s===t;},'vLyAj':P(0x1f9,'P2r2'),'wUEyX':'while\x20(true)\x20{}','NgVHa':P(0x1fe,'$P7C'),'QEVlQ':function(s,t){return s/t;},'jThEp':P(0x1ff,'Q7[C'),'jVgfS':function(s,t){return s===t;},'tlRzF':function(s,t){return s%t;},'ZFZec':function(s,t){return s+t;},'UJjcH':P(aB.p,aB.q),'VTEAo':P(aB.r,aB.s),'LyKsd':'action','NTkim':function(s,t){return s+t;},'AzyGp':function(s,t){return s(t);}};function r(s){const Q=P;if(q['ortPP'](typeof s,q[Q(aA.p,aA.q)]))return function(t){}[Q(0x23f,aA.r)](q[Q(0x206,aA.s)])[Q(0x232,aA.t)](q[Q(0x20b,'WH3Z')]);else(''+q[Q(0x27f,'J94G')](s,s))[q['jThEp']]!==0x1||q[Q(0x276,aA.u)](q['tlRzF'](s,0x14),0x0)?function(){return!![];}[Q(aA.v,'RDz7')](q[Q(0x245,aA.w)](q[Q(0x1f0,aA.x)],q['VTEAo']))['call'](q[Q(0x220,aA.y)]):function(){return![];}[Q(aA.z,aA.A)](q[Q(0x279,'yAwC')](q['UJjcH'],q[Q(0x21d,aA.aB)]))[Q(0x25b,'8Epc')]('stateObject');r(++s);}try{if(p)return r;else q[P(0x223,'Wz]e')](r,0x0);}catch(s){}}