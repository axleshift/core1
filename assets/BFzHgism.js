import{r as e,R as s,j as a}from"./_LxKj9PG.js";import{R as t}from"./CD8lARB7.js";import{F as r,a0 as i}from"./GO_KNHZp.js";import{b as o,e as l}from"./__tmrO-Y.js";import{A as n}from"./kEzgLQ3J.js";import{p as c}from"./2aPQtUzY.js";import{d,a as m}from"./BJRa5TG-.js";import{d as j,S as p,a as x,C as h,Q as u,R as f,e as g,f as k,g as v,h as N,i as b}from"./slvTtaAp.js";import"./C_9exQ7i.js";import"./Itq7e1c5.js";import"./BGnBE-TB.js";import"./c7OvE8pj.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./tRrjmjzN.js";import"./BFk34ZWe.js";import"./lcqsW1nY.js";import"./DIrOWF5t.js";import"./D74OPSAh.js";import"./COFYN2eQ.js";import"./BJtv0x2K.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./ZZM5rHs7.js";import"./Dw1DiDGf.js";import"./YiBEvX-Q.js";import"./rRm29nvs.js";import"./CzGuHLZU.js";import"./B8Let_61.js";import"./CZm-rpfG.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const y=()=>{var y;const w=d(),{addToast:_}=o(),[C,S]=e.useState(!0),T=s.useRef(),[P,A]=e.useState([]),[D,z]=e.useState(1),[R,G]=e.useState(0),[L,M]=e.useState(null),[Q,E]=e.useState(!1),F=null==(y=m().state)?void 0:y.token,H=async e=>{axios.post("/auth/token/",{page:e}).then((e=>{A(e.data.data),G(e.data.totalPages)})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);_(t)})).finally((()=>S(!1)))};return e.useEffect((()=>{H(D)}),[D]),C?a.jsx("div",{className:"loading-overlay",children:a.jsx(j,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[F&&a.jsxs("div",{children:["Make sure to copy your personal access token now. You wonâ€™t be able to see it again!",a.jsxs(p,{color:"info",className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{children:F}),a.jsx(x,{color:"primary",size:"sm",onClick:()=>{navigator.clipboard.writeText(F),_("Token copied to clipboard")},children:a.jsx(r,{icon:i})})]})]}),a.jsx(t,{ref:T,size:"invisible",sitekey:l}),a.jsxs("div",{className:"d-block d-sm-flex justify-content-between align-items-center mb-3",children:[a.jsx("h4",{children:"Access token"}),a.jsx(x,{color:"primary",size:"sm",onClick:e=>w("/security/access-token/new"),className:"ms-auto",children:"Generate new token"})]}),!P||0==P.length&&a.jsx(h,{className:"my-5",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"text-body-secondary",children:[a.jsx("h1",{className:"d-block text-danger",children:"No Access Tokens added yet."}),a.jsx("span",{children:'Please click "Generate New Token" to create a Token.'})]})})}),P&&P.map(((e,s)=>a.jsx(u,{className:"mb-3",children:a.jsxs(f,{children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("h3",{className:"text-primary text-truncate",children:e.note}),a.jsx(x,{color:"danger",onClick:s=>(e=>{M(e),E(!0)})(e),className:"ms-auto",children:"Delete"})]}),a.jsxs("div",{className:"d-block d-sm-flex",children:[a.jsxs("div",{className:"me-3 mb-2",children:[a.jsx("span",{className:"text-muted",children:"Last accessed"}),a.jsxs("span",{className:"d-block small",children:[e.last_accessed?c(e.last_accessed):"Never"," ","| ",e.user_agent?e.user_agent:"NaN"]})]}),a.jsxs("div",{className:"me-3 mb-2",children:[a.jsx("span",{className:"text-muted",children:"Date created"}),a.jsx("span",{className:"d-block small",children:new Date(e.created_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-muted",children:"IP Address"}),a.jsx("span",{className:"d-block small text-capitalize",children:"::1"===e.ip_address?"localhost":e.ip_address})]})]})]})},s))),R>1&&a.jsx(n,{currentPage:D,setCurrentPage:z,totalPages:R,setTotalPages:G}),a.jsxs(g,{alignment:"center",scrollable:!0,visible:Q,onClose:()=>E(!1),"aria-labelledby":"M",children:[a.jsx(k,{children:a.jsxs(v,{children:["Confirm Delete ",null==L?void 0:L.note,"?"]})}),a.jsx(N,{children:"Are you sure you want to delete the selected Token? This action cannot be undone."}),a.jsxs(b,{className:"d-flex justify-content-end",children:[a.jsx(x,{color:"secondary",onClick:async()=>{E(!1);const e=await T.current.executeAsync();S(!0),axios.post("/auth/token/delete",{id:L._id,recaptcha_ref:e}).then((e=>H(1))).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);_(t)})).finally((()=>S(!1)))},children:"Delete"}),a.jsx(x,{color:"primary",onClick:()=>{E(!1)},className:"ms-2",children:"Cancel"})]})]})]})};export{y as default};
