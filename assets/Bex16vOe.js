import{r as e,j as a,R as s}from"./Oq9P1Wj_.js";import{F as t,T as r,k as l,r as i,G as n,W as c,q as d,X as o,Y as h}from"./egetR9Ty.js";import{b as p,V as x,c as m,d as j}from"./CW_6aHc1.js";import{E as u}from"./BGB82IPO.js";import{p as v}from"./BzOa6JrD.js";import{c as b,L as g,M as y,aj as f,ad as N,ae as w,af as S,ag as k,ah as A,ai as _,p as C,a2 as T,g as $,h as K,a3 as R,a as D,b as E,O as L,V as q,P as z,W as P,a9 as B,ak as I,al as O,am as U,an as F,ao as M}from"./DFI_Y7Nw.js";import{R as W}from"./eGqyD3ZN.js";import{P as V}from"./NdsU5MZw.js";import{d as H}from"./Ce_fjdqS.js";import"./deeEeel3.js";import"./CewSaW8v.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./BKB6Vojr.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./BYNIthp4.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";import"./BXWkExu4.js";const J=()=>{const{addToast:s}=p(),[t,r]=e.useState(!0),[l,i]=e.useState([]);return e.useEffect((()=>{(async()=>{await axios.get(`${x}/api/v1/sec/management/activity`,{headers:{Authorization:`Bearer ${cookies.get(m)}`}}).then((e=>i(e.data))).catch((e=>{const a=u[e.status]||"Server is offline or restarting please wait";s(a)})).finally((()=>r(!1)))})()}),[]),a.jsxs("div",{children:[t&&a.jsx("div",{className:"loading-overlay",children:a.jsx(b,{color:"primary",variant:"grow"})}),!t&&a.jsx(g,{children:a.jsxs(y,{children:[a.jsx(f,{children:"Activity Logs"}),a.jsxs(N,{hover:!0,responsive:!0,children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"User ID"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Session ID"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Event"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"IP Address"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Device"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Time"})]})}),a.jsx(A,{children:l.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.user_id}),a.jsx(_,{children:e.session_id}),a.jsx(_,{children:e.event}),a.jsx(_,{children:e.ip_address}),a.jsx(_,{children:e.user_agent}),a.jsx(_,{children:v(e.time)})]},s)))})]})]})})]})},G=()=>{const t=s.useRef(),{addToast:r}=p(),[l,i]=e.useState(!0),[n,c]=e.useState({apiToken:[],deny:!0});return e.useEffect((()=>{(async()=>{await axios.get(`${x}/api/v1/sec/management/apikeys`,{headers:{Authorization:`Bearer ${cookies.get(m)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const a=u[e.status]||"Server is offline or restarting please wait";r(a)})).finally((()=>i(!1)))})()}),[]),a.jsxs("div",{children:[l&&a.jsx("div",{className:"loading-overlay",children:a.jsx(b,{color:"primary",variant:"grow"})}),a.jsx(W,{ref:t,size:"invisible",sitekey:j}),!l&&a.jsxs(a.Fragment,{children:[a.jsx("h4",{children:"Deactivate all apikeys"}),a.jsx(g,{className:"mb-3",children:a.jsxs(y,{children:[a.jsx("p",{children:"Clearing all active apikeys will deny future incoming requests."}),a.jsx(C,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:n.deny,onClick:async()=>{i(!0);const e=await t.current.executeAsync();await axios.post(`${x}/api/v1/sec/management/apikeys/deactivate`,{recaptcha_ref:e},{headers:{Authorization:`Bearer ${cookies.get(m)}`}}).then((e=>{if(!e.data.error)return window.location.reload()})).catch((e=>{const a=u[e.status]||"Server is offline or restarting please wait";r(a)})).finally((()=>i(!1)))},children:"Deactivate all apikeys"})]})}),a.jsx(g,{children:a.jsxs(y,{children:[a.jsx(f,{children:"API keys"}),a.jsxs(N,{hover:!0,responsive:!0,children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"User"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Token"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Whitelist"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Last Accessed"})]})}),a.jsx(A,{children:n.apiToken.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.user_id}),a.jsx(_,{children:e.active?"Active":"Inactive"}),a.jsx(_,{children:e.token}),a.jsx(_,{children:e.whitelist_ip.map((e=>e.split(",")[0])).join(" ")}),a.jsx(_,{children:e.last_accessed?v(e.last_accessed):"Never"})]},s)))})]})]})})]})]})},Q=({color:e,title:s,value:t,data:r})=>a.jsx(T,{color:e,value:t,title:s,action:a.jsx($,{alignment:"end",children:a.jsx(K,{color:"transparent",caret:!1,className:"text-white p-0"})}),chart:a.jsx(R,{className:"mt-3",style:{height:"70px"},data:{labels:Array(10).fill(""),datasets:[{label:"Data",backgroundColor:"rgba(255,255,255,.2)",borderColor:"rgba(255,255,255,.55)",data:r,fill:!0}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!1}},elements:{line:{borderWidth:2,tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4}},animation:{duration:0}}})});Q.propTypes={color:V.string.isRequired,title:V.string.isRequired,value:V.any.isRequired,data:V.any.isRequired};const X=()=>{const[s,t]=e.useState(null),[r,l]=e.useState(!0),{addToast:i}=p(),[n,c]=e.useState(Array(10).fill(0)),[d,o]=e.useState(0),[h,j]=e.useState(Array(10).fill(0)),[v,b]=e.useState(0),g=cookies.get(m),y=(e,a,s,t)=>{const r=4*(Date.now()-t),l=parseFloat((s/r*100).toString().match(/^(\d+\.\d)/));j((e=>{const a=[...e,l];return a.length>10&&a.shift(),b(f(a)),a}))},f=e=>{const a=e.filter((e=>0!==e)),s=a.reduce(((e,a)=>e+a),0),t=a.length;return 0===t?0:s/t},N=async()=>{await axios.get(`${x}/metrics/v1/prometheus`,{headers:{Authorization:`Bearer ${g}`}}).then((e=>{const a=e.data;t(a),((e,a,s,t)=>{y(e,a,s,t);const r=Date.now()-t,l=parseFloat((a/r).toString().match(/^(\d+\.\d)/));c((e=>{const a=[...e,l];return a.length>10&&a.shift(),o(f(a)),a}))})(a.process_cpu_user_seconds_total[0].value,a.process_cpu_system_seconds_total[0].value,a.process_cpu_seconds_total[0].value,a.process_start_time_seconds[0].value)})).catch((e=>{if(401==e.status)return window.location.reload();const a=u[e.status]||"Server is offline or restarting please wait";i(a,"Submit failed!")})).finally((()=>l(!1)))};return e.useEffect((()=>{N();const e=setInterval((()=>{N()}),2e3);return()=>clearInterval(e)}),[]),a.jsx("div",{children:s&&a.jsxs(a.Fragment,{children:[a.jsxs(D,{xs:{gutter:4},children:[a.jsx(E,{sm:6,xl:4,xxl:3,children:a.jsx(Q,{color:"primary",title:"Average Load Time",value:d,data:n})}),a.jsx(E,{sm:6,xl:4,xxl:3,children:a.jsx(Q,{color:"danger",title:"CPU Usage",value:`${v}%`,data:h})})]}),JSON.stringify(s,null,4)]})})},Y=()=>{const{addToast:s}=p(),[l,i]=e.useState(!0),[n,c]=e.useState([]),[d,o]=e.useState(""),[h,j]=e.useState(0),[C,T]=e.useState(0),[$,K]=e.useState(0);return e.useEffect((()=>{(async()=>{await axios.get(`${x}/api/v1/sec/management/dependabot`,{headers:{Authorization:`Bearer ${cookies.get(m)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const a=u[e.status]||"Server is offline or restarting please wait";s(a)})).finally((()=>i(!1)))})()}),[]),a.jsxs("div",{children:[l&&a.jsx("div",{className:"loading-overlay",children:a.jsx(b,{color:"primary",variant:"grow"})}),0===n.length&&!l&&a.jsx(D,{className:"justify-content-center my-5",children:a.jsx(E,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no alerts yet."}),a.jsx("p",{children:"Check it out later"})]})})}),0!==n.length&&a.jsxs(a.Fragment,{children:[a.jsxs(L,{className:"d-flex justify-content-left my-2 my-lg-0",children:[a.jsxs(q,{className:"mb-3",children:[a.jsx(z,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:e=>o(e.target.value)}),a.jsx(P,{id:"basic-addon",children:a.jsx(t,{icon:r})})]}),a.jsx("div",{className:"mx-2"}),a.jsx(B,{value:$,onChange:e=>K(e.target.value),options:[{label:"All",value:0},{label:"Resolved",value:1},{label:"Unresolved",value:2},{label:"Not Plan",value:3}],required:!0,className:"mb-3"}),a.jsx("div",{className:"mx-2"}),a.jsx(B,{value:C,onChange:e=>T(e.target.value),options:[{label:"All",value:0},{label:"High",value:1},{label:"Medium",value:2},{label:"Low",value:3}],required:!0,className:"mb-3"}),a.jsx("div",{className:"mx-2"}),a.jsx(B,{value:h,onChange:e=>j(e.target.value),options:[{label:"Newer",value:1},{label:"Older",value:2}],required:!0,className:"mb-3"})]}),a.jsx(g,{children:a.jsxs(y,{children:[a.jsx(f,{children:"Vulnerability Alerts"}),a.jsxs(N,{hover:!0,responsive:!0,children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"#"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"State"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Scope"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Manifest"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"CVE"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Summary"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Severity"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Last Updated"})]})}),a.jsx(A,{children:n.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.number}),a.jsx(_,{children:e.state}),a.jsx(_,{children:e.scope}),a.jsx(_,{children:e.manifest}),a.jsx(_,{children:e.cve}),a.jsx(_,{children:e.summary}),a.jsx(_,{children:e.severity}),a.jsx(_,{children:v(new Date(e.updated_at).getTime())})]},s)))})]})]})})]})]})},Z=()=>{const t=s.useRef(),{addToast:r}=p(),[l,i]=e.useState(!0),[n,c]=e.useState(!1);return e.useEffect((()=>{(async()=>{await axios.get(`${x}/api/v1/sec/management/maintenance`,{headers:{Authorization:`Bearer ${cookies.get(m)}`}}).then((e=>c(e.data.maintenance||"a"))).catch((e=>{const a=u[e.status]||"Server is offline or restarting please wait";r(a)})).finally((()=>i(!1)))})()}),[]),a.jsxs("div",{children:[l&&a.jsx("div",{className:"loading-overlay",children:a.jsx(b,{color:"primary",variant:"grow"})}),a.jsx(W,{ref:t,size:"invisible",sitekey:j}),a.jsx("h4",{children:"Enable maintenance"}),a.jsx(g,{children:a.jsxs(y,{children:[a.jsx("p",{children:"When enabled, it prevents users from interacting with the platform until maintenance is complete."}),a.jsx(C,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:n,children:"Enable maintenance"})]})})]})},ee=()=>{const{addToast:s}=p(),[l,i]=e.useState(!0),[n,c]=e.useState([]),[d,o]=e.useState(""),[h,j]=e.useState(0),[C,T]=e.useState(0),[$,K]=e.useState(0);return e.useEffect((()=>{(async()=>{await axios.get(`${x}/api/v1/sec/management/sentry`,{headers:{Authorization:`Bearer ${cookies.get(m)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const a=u[e.status]||"Server is offline or restarting please wait";s(a)})).finally((()=>i(!1)))})()}),[]),a.jsxs("div",{children:[l&&a.jsx("div",{className:"loading-overlay",children:a.jsx(b,{color:"primary",variant:"grow"})}),0===n.length&&!l&&a.jsx(D,{className:"justify-content-center my-5",children:a.jsx(E,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no issues yet."}),a.jsx("p",{children:"Check it out later"})]})})}),0!==n.length&&a.jsxs(a.Fragment,{children:[a.jsxs(L,{className:"d-flex justify-content-left my-2 my-lg-0",children:[a.jsxs(q,{className:"mb-3",children:[a.jsx(z,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:e=>o(e.target.value)}),a.jsx(P,{id:"basic-addon",children:a.jsx(t,{icon:r})})]}),a.jsx("div",{className:"mx-2"}),a.jsx(B,{value:$,onChange:e=>K(e.target.value),options:[{label:"All",value:0},{label:"Resolved",value:1},{label:"Unresolved",value:2},{label:"Not Plan",value:3}],required:!0,className:"mb-3"}),a.jsx("div",{className:"mx-2"}),a.jsx(B,{value:C,onChange:e=>T(e.target.value),options:[{label:"All",value:0},{label:"High",value:1},{label:"Medium",value:2},{label:"Low",value:3}],required:!0,className:"mb-3"}),a.jsx("div",{className:"mx-2"}),a.jsx(B,{value:h,onChange:e=>j(e.target.value),options:[{label:"Newer",value:1},{label:"Older",value:2}],required:!0,className:"mb-3"})]}),a.jsx(g,{children:a.jsxs(y,{children:[a.jsx(f,{children:"Error Reports"}),a.jsxs(N,{hover:!0,responsive:!0,children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"#"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Title"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Culprit"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Level"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Priority"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Count"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Last Updated"})]})}),a.jsx(A,{children:n.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.id}),a.jsx(_,{children:e.title}),a.jsx(_,{children:e.culprit}),a.jsx(_,{children:e.level}),a.jsx(_,{children:e.status}),a.jsx(_,{children:e.priority}),a.jsx(_,{children:e.count}),a.jsx(_,{children:v(new Date(e.updated_at).getTime())})]},s)))})]})]})})]})]})},ae=()=>{const t=s.useRef(),{addToast:r}=p(),[l,i]=e.useState(!0),[n,c]=e.useState([]);return e.useEffect((()=>{(async()=>{await axios.get(`${x}/api/v1/sec/management/sessions`,{headers:{Authorization:`Bearer ${cookies.get(m)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const a=u[e.status]||"Server is offline or restarting please wait";r(a)})).finally((()=>i(!1)))})()}),[]),a.jsxs("div",{children:[l&&a.jsx("div",{className:"loading-overlay",children:a.jsx(b,{color:"primary",variant:"grow"})}),a.jsx(W,{ref:t,size:"invisible",sitekey:j}),a.jsx("h4",{children:"Logout all sessions"}),a.jsx(g,{className:"mb-3",children:a.jsxs(y,{children:[a.jsx("p",{children:"Clearing all active sessions will log everyone out."}),a.jsx(C,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",onClick:async()=>{i(!0);const e=await t.current.executeAsync();await axios.post(`${x}/api/v1/sec/management/sessions/logout`,{recaptcha_ref:e},{headers:{Authorization:`Bearer ${cookies.get(m)}`}}).then((e=>{if(!e.data.error)return window.location.reload()})).catch((e=>{const a=u[e.status]||"Server is offline or restarting please wait";r(a)})).finally((()=>i(!1)))},children:"Logout all sessions"})]})}),!l&&a.jsx(g,{children:a.jsxs(y,{children:[a.jsx(f,{children:"Sessions"}),a.jsxs(N,{hover:!0,responsive:!0,children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"User"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Location"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Device"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Last Accessed"})]})}),a.jsx(A,{children:n.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.user_id}),a.jsx(_,{children:e.ip_address}),a.jsx(_,{children:e.user_agent}),a.jsx(_,{children:e.active?"Active":"Inactive"}),a.jsx(_,{children:v(e.last_accessed)})]},s)))})]})]})})]})},se=()=>{const[s,r]=e.useState(0),[p,x]=e.useState(!0),m=H(),j=window.location.hash?window.location.hash.substring(1):"",u=(e,a)=>{m(`#${a}`)};return e.useEffect((()=>{switch(j||0!=j.length||u(0,"dashboard"),j){case"dashboard":r(0);break;case"sessions":r(1);break;case"dependabot":r(2);break;case"sentry":r(3);break;case"access-token":r(4);break;case"activity":r(5);break;case"maintenance":r(6)}x(!1)}),[]),a.jsxs("div",{children:[p&&a.jsx("div",{className:"loading-overlay",children:a.jsx(b,{color:"primary",variant:"grow"})}),!p&&a.jsxs(I,{activeItemKey:s,className:"mb-4",children:[a.jsxs(O,{variant:"underline-border",children:[a.jsxs(U,{"aria-controls":"dashboard-tab-pane",itemKey:0,onClick:()=>u(0,"dashboard"),children:[a.jsx(t,{icon:l,className:"me-1"})," Dashboard"]}),a.jsxs(U,{"aria-controls":"sessions-tab-pane",itemKey:1,onClick:()=>u(0,"sessions"),children:[a.jsx(t,{icon:i,className:"me-1"})," Sessions"]}),a.jsxs(U,{"aria-controls":"dependabot-tab-pane",itemKey:2,onClick:()=>u(0,"dependabot"),children:[a.jsx(t,{icon:n,className:"me-1"})," Dependabot"]}),a.jsxs(U,{"aria-controls":"sentry-tab-pane",itemKey:3,onClick:()=>u(0,"sentry"),children:[a.jsx(t,{icon:c,className:"me-1"})," Sentry"]}),a.jsxs(U,{"aria-controls":"access-token-tab-pane",itemKey:4,onClick:()=>u(0,"access-token"),children:[a.jsx(t,{icon:d,className:"me-1"})," Access Token"]}),a.jsxs(U,{"aria-controls":"activity-tab-pane",itemKey:5,onClick:()=>u(0,"activity"),children:[a.jsx(t,{icon:o,className:"me-1"})," Activity"]}),a.jsxs(U,{"aria-controls":"maintenance-tab-pane",itemKey:6,onClick:()=>u(0,"maintenance"),children:[a.jsx(t,{icon:h,className:"me-1"})," Maintenance"]})]}),a.jsxs(F,{children:[a.jsx(M,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:a.jsx(X,{})}),a.jsx(M,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:a.jsx(ae,{})}),a.jsx(M,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:a.jsx(Y,{})}),a.jsx(M,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:a.jsx(ee,{})}),a.jsx(M,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:4,children:a.jsx(G,{})}),a.jsx(M,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:5,children:a.jsx(J,{})}),a.jsx(M,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:6,children:a.jsx(Z,{})})]})]})]})};export{se as default};
