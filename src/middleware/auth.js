(function(h,i){const K={h:'rsY6',i:'F[!8',j:0x22a,k:'a2YP',l:'Og$z',m:0x1c7,n:0x218,o:0x1f0,p:'Og$z',q:0x1cb,r:0x214},x=f,j=h();while(!![]){try{const k=parseInt(x(0x1f7,K.h))/0x1+-parseInt(x(0x1e4,K.i))/0x2*(-parseInt(x(0x21c,'MDy['))/0x3)+-parseInt(x(K.j,K.k))/0x4*(-parseInt(x(0x213,K.l))/0x5)+-parseInt(x(K.m,K.h))/0x6+-parseInt(x(K.n,'qPCK'))/0x7+parseInt(x(K.o,K.p))/0x8+-parseInt(x(K.q,'LER9'))/0x9*(parseInt(x(K.r,'bLm0'))/0xa);if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0x29bd8));const d=(function(){const L={h:0x22d};let h=!![];return function(i,j){const k=h?function(){const y=f;if(j){const l=j[y(L.h,'13CZ')](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const S={h:0x20c,i:'8U8)'},R={h:'LER9',i:0x1e3,j:'5U*w',k:'(hh0',l:0x1e2},z=f,h={'XXAIL':z(S.h,S.i),'ZtmrL':function(i,j){return i+j;},'ZAbqC':function(i){return i();}};d(this,function(){const A=z,i=new RegExp(h[A(0x1c6,R.h)]),j=new RegExp(A(R.i,'Gjnw'),'i'),k=c('init');!i[A(0x207,'bLm0')](k+A(0x209,']A!J'))||!j[A(0x1d8,R.j)](h['ZtmrL'](k,A(0x20e,R.k)))?k('0'):h[A(R.l,'5U*w')](c);})();}());const b=(function(){let h=!![];return function(i,j){const T={h:0x22d,i:'13CZ'},k=h?function(){const B=f;if(j){const l=j[B(T.h,T.i)](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const a1={h:0x1c0,i:0x20b,j:0x1dd,k:'fiur',l:0x1da,m:0x1e1,n:'Jss^',o:0x226,p:0x1d1,q:0x20a,r:0x22c,s:'Gjnw',t:0x1be,u:'qPCK',v:0x223,w:0x212,a2:'6ZAO',a3:'6P*5',a4:'iN5a'},a0={h:0x21e},C=f,h={'bVlXy':function(m,n){return m(n);},'WRHtH':function(m,n){return m+n;},'ZSJFg':'return\x20(function()\x20','nLqOD':C(a1.h,'bLm0'),'murkq':C(a1.i,'%T7W'),'JAVjt':C(a1.j,'KYxP'),'lkeSb':'info','bomFI':C(0x217,a1.k),'Tafrv':C(a1.l,'l4pA'),'GJIaC':function(m,n){return m<n;}},i=function(){const D=C;let m;try{m=h[D(0x1c9,'13CZ')](Function,h[D(0x1db,']A!J')](h['WRHtH'](h[D(0x201,'(hh0')],h[D(a0.h,'F[!8')]),');'))();}catch(n){m=window;}return m;},j=i(),k=j[C(a1.m,a1.n)]=j[C(a1.o,'gl8H')]||{},l=[h[C(a1.p,'9g4L')],h[C(a1.q,'(hh0')],h[C(0x200,'JdUB')],h['bomFI'],h[C(a1.r,a1.s)],'table',C(0x21f,'KCEt')];for(let m=0x0;h[C(a1.t,a1.u)](m,l[C(a1.v,'LER9')]);m++){const n=b['constructor']['prototype'][C(0x224,'2dDt')](b),o=l[m],p=k[o]||n;n[C(a1.w,'ja@J')]=b[C(0x20f,a1.a2)](b),n[C(0x203,a1.a3)]=p['toString'][C(0x219,a1.a4)](p),k[o]=n;}});function f(a,b){const c=e();return f=function(d,g){d=d-0x1bd;let h=c[d];if(f['uBmevt']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['wCZVQf']=m,a=arguments,f['uBmevt']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['wVxjyX']===undefined&&(f['wVxjyX']=!![]),h=f['wCZVQf'](h,g),a[k]=h):h=l,h;},f(a,b);}a();import{getUser,getSession}from'../components/sessions.js';import g from'../models/db.js';import{ObjectId}from'mongodb';function e(){const as=['W4GhAmoSCCob','WRJdS3tcPW','WOC2bmki','W5ZdRdSLi8oduWDM','wCo4WR3dR24','jYFdMSkWW6ZcGvu+WP5H','vHiQW5q','FSo9W7vkpsldIZOTaSoL','WPWpW71w','rCkXimkTvq','W5CRp8klW5hcI1a','WPBdL2xcOKC','hSotlCoeWOPanG/dLN4oqSk/m8kqmHZdPsJcMxpcNCkXEmoZW4pcS8oJfY3cKCo0W7xcRa','bSk9qHFcISofnYhdPh5p','W5X8sSoopxHlW4pdSJK','W5aAx8o8AW','W7r4W5JdSmoC','yCoyW6NcRJiMb8kRW4NcQGjKAG','WQ7cJMJcPCkSiqJdICoxymk4m8oY','W61DELOBW4f3','lSkMWQmyuq','oCklhq','WRy5qSkwAMv8sq','WQtdTY/dJq','w8kJW7ztWRBcS2JdICkVda','WPJdHCkwFSo5W7mWWPFcKHPuW40v','W50SjCkhWPRdQa','pCkzWPldVedcHSo+WPK','t8oyWPFdLMK','W4yHpmkxW4RcGNqDWRXWW7STW7m','qCoIWRZdMxW','W4RdUZSRnSod','W5hcLWThFX/dVmoGWPSqW48F','jMe2hSox','W5OdECo0Fq','W4VdUZqL','ycW0FSkEW6y','WQldOstdM8o6W5pdTM3cMH4','mSkSoCo/bW','uCo8pIK','WOaOeSkAlfXT','sCoYka7dQa','wJ7dOSk+iW','W5CRp8klW4RcLuaAWQXTW6W','WQX5rLCrW4LxaG','guCSpWbqxuldHmognW','EwnYugJdQW','WQldOstdM8kiW5pdTM3cMH4','W5rWiau','fHzCqJqL','BCocWPtdSKG','sIZdVSksma','WRVdVsy','nchdKCkHW4FcIv01W5a/W7fKl8k7p8kB','hCoYWQ4e','AqpdMmknma','WOOKhCkA','W5jrW5ddQmowWPjWg8kFlG','W5hdUJtdHSoX','W4BcVaVdUMXVW6mXW5G','WP/cUSoan8k0WQjk','WPqKAKfOWOGdbSkiWR8','ygHypmkm','t8kkW4ZcUW','tCkFW5VcPMK','W4pdI1dcOSkUs0ThaCoWp8k7WQ0','WPOdW7fh','cw8ga8oiW7q','abbpwtm','sCo8W7baFHeYya','ebjzvZuZosVcSG','wSogb2NdTG','FmkBg8kpra','qdKVvmkP','W77cOd7dPJpcUG/dIxaXfSoE','vSoTlcNdV2e','p8kjWR7dUxn+','EMLOxq','W5GswSouzG','WODtsZldSSkHfW','rmoTlHVdIa','bmoGW5NcLNVdHsm','dLGAdIW','xgxcV0BdT8k3W6nNW47cIc/cRW','vCo4otu','fSkzf8kDW5W','CmoBpSkVW4W','eCkvk8oqiW','W4/cQYZdO0C','DwldUCoryq','WRxcSI/dSCoC','xCo7p1xdVG','W5TOFrjZWRaLnSkUWO8OW5zbESo+hSogxmoYzw/cImk8dSo8jKPBWRRdVSkhW4S','qamOW5zz','W43dUZmLpq','ySooimkN','A8kgd8kcvCk+Ea','ESk8hCkwAa','c8k0WPhdL0S','W5lcKWTfDr/dImo8WRuKW64o','W4hcUt4ViCoawXPSW6JdJ8kmumkJWPG','C8o9iSkBW4W','o8obW7ZdJCoR','zSoyW6BcRxrhCCkRW6xcGG','WQtdPIddNCoqW4e','xSoKyZ7dPxXjiITOW5BcQ8orW4pcMSoeWP0Ct8olW6XIdLJdR8o/tNmIc0ex','FmopWOhdRLtcM8kMW70cWQpcOmo7WP3dJSkmnmoCDsS','W4n0pX0','imkjWR7dUG','nCksa8oroW','ymofWOi','pSkCjW','cCk7W7ztFs0OrSkExeW','W4zKxmoBqSoZvCktb1BdVc8','A3L1txVdOW'];e=function(){return as;};return e();}const adminRoute=[];(function(){const a7={h:0x1fd,i:'9g4L',j:0x204},a6={h:0x227,i:'JdUB',j:0x1f3,k:']A!J',l:0x1cd},E=f,h={'MsLBM':function(k,l){return k(l);},'iXzIA':function(k,l){return k+l;},'atcFB':function(k,l){return k+l;},'ArbMO':E(0x1ce,']A!J'),'jKHEM':function(k){return k();}},i=function(){const F=E;let k;try{k=h['MsLBM'](Function,h['iXzIA'](h[F(a6.h,a6.i)](h[F(a6.j,a6.k)],F(a6.l,a6.i)),');'))();}catch(l){k=window;}return k;},j=h[E(a7.h,a7.i)](i);j[E(a7.j,'02zi')](c,0x9c4);}());const auth=async(h,i,j)=>{const ah={h:0x1d6,i:0x1c8,j:'l4pA',k:0x1ee,l:'%T7W',m:'0Ony',n:0x1c3,o:'13CZ',p:0x1ed,q:'Y3G@',r:0x22b,s:'JdUB',t:0x1fa,u:0x20d,v:0x1cc,w:0x1f4,ai:0x215,aj:0x1d3,ak:0x22f,al:'ja@J',am:'9g4L',an:0x1eb,ao:'dCpR',ap:'gG$2',aq:0x1d9,ar:'obHh',as:0x1c2},ag={h:0x1ca,i:'[^m$',j:'8U8)',k:'0Ony',l:0x1d2,m:']A!J'},G=f,k={'QYEQh':function(u,v){return u===v;},'CUGmY':G(ah.h,'2dDt'),'UHkKZ':function(u,v){return u(v);},'Ritjz':function(u,v){return u!==v;},'ilfbI':G(0x1bd,'n(0T'),'rUgzI':G(ah.i,ah.j),'NGjQl':G(0x206,'%T7W'),'YppeV':function(u,v){return u-v;},'LpuMC':function(u,v){return u*v;},'VHWkD':function(u,v){return u*v;},'PIoLk':function(u,v){return u>=v;},'blbcT':function(u,v){return u!==v;}},l=h[G(0x1ff,'6ZAO')]['authorization'];if(!l)return i[G(0x1d7,'Ce#H')](0x191)[G(ah.k,ah.l)]();const m=l['split']('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/[G(0x1fe,'JdUB')](m))return i[G(0x208,ah.m)](0x191)[G(ah.n,ah.o)]();const [n,o]=await Promise['all']([getUser(m),k['UHkKZ'](getSession,m)]);if(!n||adminRoute[G(ah.p,ah.q)](h[G(ah.r,ah.s)])&&k['Ritjz'](n[G(ah.t,ah.j)],k['ilfbI']))return i[G(0x222,ah.s)](0x191)[G(ah.u,'MAsE')]();if(!o[G(0x205,'2dDt')])return i[G(ah.v,'%T7W')](0x191)[G(0x1d0,'LER9')]();let p=h[G(0x228,'%Yz$')][k[G(0x1c5,'KCEt')]]||h[G(0x1f6,'l4pA')][G(ah.w,'Jss^')];const q=h[G(0x1ff,'6ZAO')][k[G(0x211,'JbHF')]],r=new Date(o['last_accessed']),s=k[G(ah.ai,'QR@q')](Date[G(ah.aj,'zmi&')](),r),t=k[G(0x220,'5OV$')](k[G(ah.ak,ah.al)](0x7,0x18),0x3c)*0x3c*0x3e8;if(k['PIoLk'](s,t))p=0x0;Promise[G(0x1ec,ah.am)]([((async()=>{const H=G;try{const u=await g(),v=k[H(ag.h,ag.i)](o['ip_address'],p)&&o[H(0x1dc,ag.j)]===q;u['collection']('sessions')[H(0x21d,ag.k)]({'token':m},{'$set':{'active':v,'compromised':v,'last_accessed':Date[H(ag.l,ag.m)](),'modified_by':k['CUGmY']}});}catch(w){logger[H(0x21b,'0Ony')](w);}})())]);if(k[G(ah.an,ah.ao)](o[G(0x210,ah.ap)],p)||o[G(0x1fc,'%T7W')]!==q)return i['status'](0x191)[G(ah.aq,ah.ar)]();return h[G(ah.as,'l4pA')]=m,h['user']=n,j();};export default auth;function c(h){const ar={h:0x1c4,i:'KCEt',j:0x216,k:0x1df,l:'iN5a',m:0x1bf},aq={h:'gG$2',i:0x1f8,j:'d6Uk',k:'Ce#H',l:0x225,m:'Jss^',n:0x1e0,o:'bLm0',p:0x1c1,q:'KYxP',r:'02zi'},I=f,i={'paGHw':function(k,l){return k===l;},'OYWyn':'while\x20(true)\x20{}','NmDtp':I(ar.h,ar.i),'kiVdo':I(0x1fb,'5OV$'),'caSLb':function(k,l){return k===l;},'MXZAt':I(ar.j,'fiur'),'IrZji':function(k,l){return k+l;},'ayADK':I(ar.k,ar.l),'dzBxB':I(0x1d4,'MDy['),'OHIBZ':function(k,l){return k(l);},'iqIsL':function(k,l){return k(l);}};function j(k){const J=I;if(i['paGHw'](typeof k,J(0x1f1,'^a#7')))return function(l){}['constructor'](i[J(0x1e7,aq.h)])[J(0x1f9,'Ce#H')](i[J(aq.i,aq.j)]);else(''+k/k)[i[J(0x1e6,aq.k)]]!==0x1||i[J(aq.l,'Ce#H')](k%0x14,0x0)?function(){return!![];}[J(0x202,aq.m)]('debu'+i[J(aq.n,'KCEt')])[J(0x1cf,aq.o)](J(0x21a,aq.j)):function(){return![];}['constructor'](i[J(0x22e,'9g4L')](i['ayADK'],i['MXZAt']))[J(aq.p,aq.q)](i[J(0x229,aq.r)]);i[J(0x1f5,']A!J')](j,++k);}try{if(h)return j;else i[I(ar.m,'F[!8')](j,0x0);}catch(k){}}