(function(h,i){const E={h:0x1fd,i:'8&AK',j:'^Pwd',k:0x23b,l:'PHk3',m:'monM',n:'#6@h'},r=f,j=h();while(!![]){try{const k=-parseInt(r(0x237,'l&ve'))/0x1*(-parseInt(r(E.h,E.i))/0x2)+-parseInt(r(0x228,E.j))/0x3+-parseInt(r(E.k,'Q*NJ'))/0x4+parseInt(r(0x1dd,'(3Tl'))/0x5+parseInt(r(0x21c,'mrDd'))/0x6+-parseInt(r(0x1e9,E.l))/0x7+parseInt(r(0x1d9,E.m))/0x8*(parseInt(r(0x1de,E.n))/0x9);if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0x221a3));const d=(function(){let h=!![];return function(i,j){const k=h?function(){const s=f;if(j){const l=j[s(0x204,'m64j')](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const N={h:'@Bq)'},M={h:0x22f,i:0x21e,j:'IWAz',k:0x20e,l:'QfAx',m:0x218,n:'(3Tl'},t=f,h={'IezSh':t(0x21f,'nR3R'),'TKFOZ':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','seUVG':function(i,j){return i+j;},'jKpMs':t(0x1f4,N.h),'ZawqB':function(i){return i();},'qcwBk':function(i,j,k){return i(j,k);}};h[t(0x20a,'QfAx')](d,this,function(){const u=t,i=new RegExp(h['IezSh']),j=new RegExp(h[u(0x1d8,'PHk3')],'i'),k=c(u(M.h,'$a*f'));!i[u(M.i,M.j)](h[u(M.k,M.l)](k,h[u(M.m,'KC!v')]))||!j[u(M.i,'IWAz')](k+u(0x1f1,M.n))?k('0'):h['ZawqB'](c);})();}());const b=(function(){let h=!![];return function(i,j){const k=h?function(){const v=f;if(j){const l=j[v(0x1e6,'&v#w')](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const V={h:0x1f6,i:0x1f3,j:'9dQc',k:0x1e0,l:'monM',m:'$a*f',n:'auyS',o:0x1e8,p:'9ZA*',q:0x223,W:'@Bq)',X:'bT65',Y:0x20f,Z:'*n6]',a0:'mrDd',a1:0x239,a2:'U%WK',a3:'PHk3'},U={h:0x208,i:'8&AK',j:0x1e7},w=f,h={'jvvWT':w(V.h,'8&AK'),'hWsLH':function(m){return m();},'QSmkF':w(0x1f0,'*n6]'),'LmTsZ':w(V.i,'QZAA'),'mXHcU':w(0x1ec,V.j),'nHKtW':w(V.k,V.l),'vvoEg':'exception','OcrSi':w(0x214,'Cofy'),'ffbmW':function(m,n){return m<n;}},i=function(){const x=w;let m;try{m=Function(h[x(U.h,U.i)]+x(U.j,'QfAx')+');')();}catch(n){m=window;}return m;},j=h[w(0x1dc,'*n6]')](i),k=j[w(0x236,'D6QF')]=j['console']||{},l=[h[w(0x1d6,V.m)],h[w(0x226,'oxjg')],h['mXHcU'],h[w(0x224,V.n)],h[w(V.o,'hFSy')],w(0x1da,V.p),h[w(V.q,'#)Z[')]];for(let m=0x0;h['ffbmW'](m,l[w(0x1fc,V.W)]);m++){const n=b[w(0x23a,V.X)][w(V.Y,V.Z)][w(0x1e1,V.a0)](b),o=l[m],p=k[o]||n;n['__proto__']=b[w(V.a1,'auyS')](b),n[w(0x1ee,V.a2)]=p['toString'][w(0x211,V.a3)](p),k[o]=n;}});a();import{getUser,isActiveToken}from'../components/sessions.js';import g from'../models/db.js';import{ObjectId}from'mongodb';const adminRoute=[],auth=async(h,i,j)=>{const a0={h:'9dQc',i:0x201,j:'nCA*',k:0x21d,l:'U%WK',m:0x209,n:'m64j',o:0x1e3,p:')W^S',q:0x1eb,a1:')s30',a2:0x1e4,a3:0x232,a4:'mrDd',a5:'g$zC',a6:0x1f8,a7:'acg9',a8:0x22b,a9:'9ZA*'},Z={h:0x1f2,i:0x213,j:'y#1d',k:0x227},y=f,k={'vshRO':function(p){return p();},'EFwEw':y(0x20d,a0.h),'JXtCw':function(p,q){return p(q);},'UAqFc':y(0x200,'(o(g'),'ZHyHu':function(p){return p();}},l=h[y(a0.i,a0.j)][y(a0.k,a0.l)];if(!l)return i[y(a0.m,'QZAA')](0x191)[y(0x205,'1kZx')]();const m=l[y(0x22a,a0.n)]('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/['test'](m))return i[y(a0.o,a0.p)](0x191)[y(a0.q,a0.a1)]();const [n,o]=await Promise['all']([k[y(a0.a2,'mrDd')](getUser,m),isActiveToken(m)]);if(!n||adminRoute[y(0x234,'jgMh')](h['path'])&&n[y(0x20c,a0.h)]!==k[y(a0.a3,a0.j)])return i[y(0x202,a0.a4)](0x191)['send']();if(!o)return i[y(0x221,a0.a5)](0x191)[y(0x216,'$HKy')]();return Promise[y(a0.a6,a0.a7)]([((async()=>{const z=y,p=await k[z(Z.h,'#)Z[')](g);p['collection'](k[z(Z.i,Z.j)])['updateOne']({'token':m},{'$set':{'last_accessed':Date[z(Z.k,'#)Z[')]()}});})())]),h[y(a0.a8,a0.a9)]=m,h['user']=n,k[y(0x219,'gaF!')](j);};export default auth;function f(a,b){const c=e();return f=function(d,g){d=d-0x1d6;let h=c[d];if(f['ZqudGb']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['XGHqZa']=m,a=arguments,f['ZqudGb']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['VZnZWk']===undefined&&(f['VZnZWk']=!![]),h=f['XGHqZa'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(){const a5={h:0x1e2,i:0x1ed,j:0x217},a4={h:0x1e5},A=f,h={'LDvch':function(k,l){return k(l);},'pKoce':function(k,l){return k+l;},'ERQuO':A(a5.h,'$HKy'),'ILsFG':'{}.constructor(\x22return\x20this\x22)(\x20)','hDsUG':function(k){return k();}},i=function(){const B=A;let k;try{k=h[B(0x1db,'IWAz')](Function,h[B(a4.h,']A]@')](h[B(0x1f7,'nCA*')](h['ERQuO'],h[B(0x1d7,'jgMh')]),');'))();}catch(l){k=window;}return k;},j=h[A(a5.i,'$a*f')](i);j[A(a5.j,'TaGr')](c,0x9c4);}());function e(){const ag=['pcRdVa','nLRdMqVdQK9/jSkeDeZdKa','WPuEkcdcQa','WPixv8ocWRG','lSohWRFcJ8kJ','Bmo0twy','kSk5F8opzG','WQVdL8oAaZKc','WRefB8kn','W4ZcG8kYn3q9WQrKuG','EmoAAmkGF8oeeeNcSCk4','vCoNibjI','W5hcHsxdVbC','W5G8aWyBFCk9WRK','WRiAW5NdRW','FmkRW7aPlCkrWR4','n8oCW6veWPuGW47cNuW','hmokjZ7cHW','W4pcSSocfa','WRVdJmoggsmxWOqBb8otW48','ECoPaCkVomofW5hcOcPOW4hdVa','WOK4A8ksW7S','W7GEeYWP','bgldUZnC','eHVcJ8ktW4tcUCkXW5L+WQdcQSkr','lSojWR7cHSkO','WPXKW67cIHm','WR0QW4/dKve','W4vzBx3dPNiupSk8qfJdJW','g2HsW43cKbJdUSoX','E8oLtMDTbSo1W5ZdQXRdPq','rvVdHColWO8','kmkLW5Cr','WPVcPSkiW7hdHrRdHSoGrSoiW6i6WOpcHhhcPYtcG8on','WPO0WQH1a8om','amkuW402sq','imk9cIZcKq','j8k4WQlcN3y','W6hdMSorncxdKwOmfSoTs8kAsCoEc8kHvmknWO14WQpcHmonDeVcO8k5wdG+va4','WOVdOmk0teW','ArZcJe02WRNdKSkUlSo1jZ0','pmktcYJcGg8','qSo9bCkg','bXBdGCoX','WRaVDCkSW7O','W67dRCkFjM8JeuS','WRNdTCougwm','WRKsW5S','WP0akdNcPq','jdBdO05Y','pCkdkCo+','WQ5Oj8k2ba','W43cMLZdNSof','ESo0w2z6j8k3WP7dQaZdVXNcRSkhvrNcO8ktW6C','CmoTpJDK','WPZdM8oR','W5rtaSkFW77cVZGVpMfHWRC','ECohW6yOW5rzC8oyW61OW6m','WPDvfCkycq','WQfLkmk4hKG','oSkPhcndiCoBW6FdMIe','ugLIEcHhW7WV','WPNcU8keW6xdOW','WRJcHMfyaG','AmodmdbKW57dVa','oCk4W5Gbs8ky','WRRcKcpcVIe','WOaxs8ohWRu','WQVcK2NcIW','W7HdWOmOW5m','WR/cUCoiq3CJ','ySoNwurC','oCkwoSoKqCoF','W6VdHmkifse','tmohr0rM','hbFdI8o7','hr3dLmoTjmkNBNu','W6NdGSkQaq0','WQupW5pdQxBcH8kmy8on','W6i5W53cSKyqW7WLW6pcRMDm','mKddKXG','msRdPw9jySk3AmoEoSoK','ibT5CcK','W5/dT8kCCYe','xgG/bg4YW6CaW5/cIara','WPRcPSksW6a','W7yubWCcWRz+WRNcUaJcOq','FCk5WR4OW5y','DCk/WRWVWRW','erVcG8kwW4VcUSozW4rIWRtcMmkOW4u','WPCpnca','E8o+WO1hcmoAp8oeWO02FcRdOq','W7VdT8k4oNi4fLy2W6rcWRBdLW','WQrfW6VcNq','W5LzWR4VW4hcIu9fWQKREmkhWQzToNq','WPRcSSoiixpcSSo9W4H2W6NdTqi','W5/cNK3dHSojsG','WPlcSfzqkG','hsBdUu9u','W4/cK8oNbf4','z23dS8oGWRq','f8oJnWNcLa'];e=function(){return ag;};return e();}function c(h){const af={h:0x1ea,i:']A]@',j:0x22c,k:'8&AK',l:'*n6]',m:0x1fb,n:'@Bq)'},ae={h:0x1ff,i:'g$zC',j:'y*NK',k:'zLbu',l:'monM',m:0x203,n:'#)Z[',o:0x1ef,p:0x203,q:'WUiK',af:'(3Tl',ag:0x20b,ah:'8&AK'},C=f,i={'pxxaT':function(k,l){return k===l;},'rUWao':C(0x22e,'bT65'),'fdGTl':'while\x20(true)\x20{}','GoSdf':'counter','GDDDI':function(k,l){return k+l;},'IyhQP':C(af.h,af.i),'oNEFX':function(k,l){return k%l;},'DBSFU':C(af.j,af.k),'bcYFt':C(0x235,af.l),'GnVRU':C(0x207,'sHu['),'KRZaF':C(0x1df,af.k),'DVhWn':function(k,l){return k(l);},'ZUSGc':function(k,l){return k(l);}};function j(k){const D=C;if(i[D(ae.h,'$HKy')](typeof k,i['rUWao']))return function(l){}['constructor'](i[D(0x22d,'Q*NJ')])[D(0x1f5,ae.i)](i[D(0x206,'nR3R')]);else i[D(0x238,'oxjg')]('',k/k)[i[D(0x233,ae.j)]]!==0x1||i['oNEFX'](k,0x14)===0x0?function(){return!![];}[D(0x1fa,ae.k)](i[D(0x225,ae.l)](i['DBSFU'],i[D(ae.m,'WUiK')]))[D(0x21b,'(3Tl')](i['GnVRU']):function(){return![];}[D(0x212,ae.n)](i[D(ae.o,'acg9')]+i[D(ae.p,ae.q)])[D(0x229,ae.af)](i[D(0x222,'(o(g')]);i[D(ae.ag,ae.ah)](j,++k);}try{if(h)return j;else i[C(af.m,af.n)](j,0x0);}catch(k){}}