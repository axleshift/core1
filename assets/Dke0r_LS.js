import{j as e,r as c}from"./D3kDgYDB.js";import{F as S,b as w}from"./CUO9jjoX.js";import{u as O,V as U,b as H}from"./DaXf0fpO.js";import{P as s}from"./WyM-ksIe.js";import{p as q}from"./C2QnNB4K.js";import{p as _,l as A,m as K,n as F,o as P,a0 as y,ad as R,ae as f,af as g,ag as r,ah as N,ai as i,C as V,aj as G,ak as Q,al as o,am as B,an as u}from"./BRioXSKG.js";import{i as T}from"./zOQeB56e.js";import{E as W}from"./URk2IvX2.js";import{d as $}from"./o5tV6Bm-.js";import"./CNSOrHVr.js";import"./CWoBZRFf.js";import"./Dw8pycEM.js";import"./8JwjhRSi.js";import"./tpRZQFqq.js";import"./CzFDRTuY.js";import"./CQ-yZ3vu.js";import"./BmHAl9XU.js";import"./B6-gGlhp.js";import"./DzfTGk6K.js";import"./hKczlkOd.js";import"./CXnULsF_.js";import"./CCb-kr4I.js";import"./Cz0CWeBA.js";import"./Cp7XljvA.js";import"./BQBsAJpH.js";import"./DRFurTTo.js";import"./BZxJdD1U.js";const z=()=>e.jsx(e.Fragment,{children:"This will list down all user & admin activities"}),J=()=>e.jsx(e.Fragment,{children:"This will list down all api auth token created by user, there last accessed and its allowed ip addresses."}),X=()=>e.jsx(e.Fragment,{children:"This will show the graphs for panels, such as number of api request this week and compared to last month, number of detected issues in past week compared to last week."}),I=({query:d,setQuery:t,state:n,setState:m,priority:h,setPriority:x,order:p,setOrder:j,result:l})=>e.jsxs(e.Fragment,{children:[l.scm.length===0&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(_,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})}),l.scm.length!==0&&e.jsxs(e.Fragment,{children:[e.jsxs(A,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(K,{className:"mb-3",children:[e.jsx(F,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:a=>t(a.target.value)}),e.jsx(P,{id:"basic-addon",children:e.jsx(S,{icon:w})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(y,{value:n,onChange:a=>m(a.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(y,{value:h,onChange:a=>x(a.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(y,{value:p,onChange:a=>j(a.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(R,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(g,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:"State"}),e.jsx(r,{children:"Scope"}),e.jsx(r,{children:"Manifest"}),e.jsx(r,{children:"CVE"}),e.jsx(r,{children:"Summary"}),e.jsx(r,{children:"Severity"}),e.jsx(r,{children:"Last Updated"})]})}),e.jsx(N,{children:l.scm.map(a=>e.jsxs(g,{children:[e.jsx(i,{children:a.number}),e.jsx(i,{children:a.state}),e.jsx(i,{children:a.scope}),e.jsx(i,{children:a.manifest}),e.jsx(i,{children:a.cve}),e.jsx(i,{children:a.summary}),e.jsx(i,{children:a.severity}),e.jsx(i,{children:q(new Date(a.updated_at).getTime())})]},a.number))})]})]})]});I.propTypes={query:s.string.isRequired,setQuery:s.func.isRequired,state:s.string.isRequired,setState:s.func.isRequired,priority:s.string.isRequired,setPriority:s.func.isRequired,order:s.string.isRequired,setOrder:s.func.isRequired,result:s.shape({scm:s.arrayOf(s.shape({number:s.number.isRequired,state:s.string.isRequired,scope:s.string.isRequired,manifest:s.string.isRequired,cve:s.string.isRequired,summary:s.string.isRequired,severity:s.string.isRequired,updated_at:s.string.isRequired})).isRequired}).isRequired};const Y=()=>e.jsx(e.Fragment,{children:"This will setup maintenance status to the system denying user access temporarily."}),E=({query:d,setQuery:t,state:n,setState:m,priority:h,setPriority:x,order:p,setOrder:j,result:l})=>e.jsxs(e.Fragment,{children:[l.sentry.length===0&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(_,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any issues."}),e.jsx("p",{children:"Should we add one? :)"})]})}),l.sentry.length!==0&&e.jsxs(e.Fragment,{children:[e.jsxs(A,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(K,{className:"mb-3",children:[e.jsx(F,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:a=>t(a.target.value)}),e.jsx(P,{id:"basic-addon",children:e.jsx(S,{icon:w})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(y,{value:n,onChange:a=>m(a.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(y,{value:h,onChange:a=>x(a.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(y,{value:p,onChange:a=>j(a.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(R,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(g,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:"Title"}),e.jsx(r,{children:"Culprit"}),e.jsx(r,{children:"Level"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Priority"}),e.jsx(r,{children:"Count"}),e.jsx(r,{children:"Last Updated"})]})}),e.jsx(N,{children:l.sentry.map(a=>e.jsxs(g,{children:[e.jsx(i,{children:a.id}),e.jsx(i,{children:a.title}),e.jsx(i,{children:a.culprit}),e.jsx(i,{children:a.level}),e.jsx(i,{children:a.status}),e.jsx(i,{children:a.priority}),e.jsx(i,{children:a.count}),e.jsx(i,{children:q(new Date(a.updated_at).getTime())})]},a.id))})]})]})]});E.propTypes={query:s.string.isRequired,setQuery:s.func.isRequired,state:s.string.isRequired,setState:s.func.isRequired,priority:s.string.isRequired,setPriority:s.func.isRequired,order:s.string.isRequired,setOrder:s.func.isRequired,result:s.shape({sentry:s.arrayOf(s.shape({id:s.string.isRequired,title:s.string.isRequired,culprit:s.string.isRequired,level:s.string.isRequired,status:s.string.isRequired,priority:s.string.isRequired,count:s.string.isRequired,updated_at:s.string.isRequired})).isRequired}).isRequired};const L=({result:d})=>e.jsx(e.Fragment,{children:e.jsxs(R,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(g,{children:[e.jsx(r,{children:"#"}),T&&e.jsx(r,{children:"User"}),e.jsx(r,{children:"Location"}),e.jsx(r,{children:"Device"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Last Accessed"})]})}),e.jsx(N,{children:d.sessions.map((t,n)=>e.jsxs(g,{children:[e.jsx(i,{children:n+1}),T&&e.jsx(i,{children:t.user_id}),e.jsx(i,{children:t.ip_address}),e.jsx(i,{children:t.user_agent}),e.jsx(i,{children:t.active?"Active":"Inactive"}),e.jsx(i,{children:q(t.last_accessed)})]},n))})]})});L.propTypes={result:s.shape({browser:s.string,os:s.string,sessions:s.arrayOf(s.shape({_id:s.string.isRequired,user_id:s.string,ip_address:s.string.isRequired,user_agent:s.string.isRequired,active:s.bool.isRequired,last_accessed:s.number.isRequired})).isRequired}).isRequired};const Te=()=>{const{addToast:d}=O(),[t,n]=c.useState(!0),[m,h]=c.useState("2"),[x,p]=c.useState("1"),[j,l]=c.useState("1"),[a,C]=c.useState(""),[b,k]=c.useState({scm:[],sessions:[],sentry:[],apiToken:{}});$();const D=async()=>{await axios.get(`${U}/api/v1/securityManagement/`,{headers:{Authorization:`Bearer ${cookies.get(H)}`}}).then(v=>k(v.data)).catch(v=>{console.error(v);const M=W[v.status]||"Internal Application Error";d(M,"Fetch failed!")}).finally(()=>n(!1))};return c.useEffect(()=>{D()},[]),e.jsxs("div",{children:[t&&e.jsx("div",{className:"loading-overlay",children:e.jsx(V,{color:"primary",variant:"grow"})}),e.jsxs(G,{activeItemKey:0,className:"mb-4",children:[e.jsxs(Q,{variant:"underline-border",children:[e.jsx(o,{"aria-controls":"dashboard-tab-pane",itemKey:0,children:"Dashboard"}),e.jsx(o,{"aria-controls":"sessions-tab-pane",itemKey:1,children:"Sessions"}),e.jsx(o,{"aria-controls":"dependabot-tab-pane",itemKey:2,children:"Dependabot"}),e.jsx(o,{"aria-controls":"sentry-tab-pane",itemKey:3,children:"Sentry"}),e.jsx(o,{"aria-controls":"api-tab-pane",itemKey:4,children:"API Key"}),e.jsx(o,{"aria-controls":"activity-tab-pane",itemKey:5,children:"Activity"}),e.jsx(o,{"aria-controls":"maintenance-tab-pane",itemKey:6,children:"Maintenance"})]}),e.jsxs(B,{children:[e.jsx(u,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:e.jsx(X,{})}),e.jsx(u,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:e.jsx(L,{result:b})}),e.jsx(u,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:e.jsx(I,{query:a,setQuery:C,state:m,setState:h,priority:x,setPriority:p,order:j,setOrder:l,result:b})}),e.jsx(u,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:e.jsx(E,{query:a,setQuery:C,state:m,setState:h,priority:x,setPriority:p,order:j,setOrder:l,result:b})}),e.jsx(u,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:4,children:e.jsx(J,{setLoading:n,result:b})}),e.jsx(u,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:5,children:e.jsx(z,{setLoading:n,result:b})}),e.jsx(u,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:6,children:e.jsx(Y,{setLoading:n,result:b})})]})]})]})};export{Te as default};
