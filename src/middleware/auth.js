(function(h,i){const G={h:0x188,i:'cv4t',j:'qg9n',k:'zmK[',l:'4OOG'},v=f,j=h();while(!![]){try{const k=parseInt(v(0x19a,'iXur'))/0x1+-parseInt(v(G.h,G.i))/0x2*(parseInt(v(0x1c7,'iXur'))/0x3)+-parseInt(v(0x1c5,G.j))/0x4+-parseInt(v(0x174,G.k))/0x5+-parseInt(v(0x1a6,G.l))/0x6+parseInt(v(0x1a4,'#vMy'))/0x7+parseInt(v(0x1cb,'$V2A'))/0x8;if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0x6774f),(function(){const K={h:0x1c3,i:'zmK[',j:0x170},J={h:'ggR@'},w=f,h={'hXvIl':function(k,l){return k(l);},'hNXrK':'return\x20(function()\x20','WnOKz':w(K.h,K.i),'APsAB':function(k){return k();}},i=function(){const x=w;let k;try{k=h[x(0x18f,'#!n$')](Function,h[x(0x1b5,J.h)]+h[x(0x1d2,'$SJ7')]+');')();}catch(l){k=window;}return k;},j=h[w(K.j,'4OOG')](i);j['setInterval'](c,0x9c4);}()));const d=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const U={h:'T0L0',i:0x1d4},T={h:0x176,i:'(GVl',j:0x16f,k:'Wg!D',l:0x17c,m:0x1a8},y=f,h={'qRhPY':y(0x1ac,U.h),'BxIri':function(i,j){return i(j);},'WrpAj':y(0x192,'3@9g'),'GvYAS':function(i,j){return i+j;},'REmqd':y(0x193,'S68g'),'YLixL':y(U.i,'A4YX'),'Mxsqv':function(i){return i();},'KbYpJ':function(i,j,k){return i(j,k);}};h['KbYpJ'](d,this,function(){const z=y,i=new RegExp(z(0x172,'1CQY')),j=new RegExp(h[z(T.h,'4OOG')],'i'),k=h[z(0x1ce,'1Gc&')](c,h['WrpAj']);!i[z(0x171,T.i)](h[z(0x198,'fWZ#')](k,h[z(T.j,T.k)]))||!j['test'](h['GvYAS'](k,h[z(T.l,'cv4t')]))?h['BxIri'](k,'0'):h[z(T.m,'$SJ7')](c);})();}());const b=(function(){const V={h:'$V2A'};let h=!![];return function(i,j){const k=h?function(){const A=f;if(j){const l=j[A(0x1bd,V.h)](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const a3={h:0x1c8,i:0x19c,j:'3@9g',k:'#!n$',l:0x1be,m:'cv4t',n:0x18c,o:'ow%&',p:0x177,q:'%E6V',r:0x178,s:0x1d1,t:'rkD0',u:0x19e,a4:'4R1k',a5:0x1ad,a6:'T0L0',a7:0x19b},B=f,h={'ESxcZ':function(l,m){return l(m);},'jBtRS':function(l,m){return l+m;},'CRzLr':B(0x1c4,'cv4t'),'QfbJt':function(l){return l();},'cQmXd':'log','WbkkP':B(a3.h,'A4YX'),'gfmHP':'info','CLhYA':B(a3.i,a3.j),'jYGjd':'table','cgEFY':function(l,m){return l<m;}};let i;try{const l=h[B(0x16e,'A4YX')](Function,h['jBtRS'](h['CRzLr']+'{}.constructor(\x22return\x20this\x22)(\x20)',');'));i=h['QfbJt'](l);}catch(m){i=window;}const j=i[B(0x1bf,a3.k)]=i['console']||{},k=[h[B(0x1d7,'VAii')],h['WbkkP'],h[B(a3.l,a3.m)],h[B(0x1b9,'eN8h')],B(a3.n,a3.o),h[B(a3.p,a3.q)],B(a3.r,'#vMy')];for(let n=0x0;h['cgEFY'](n,k[B(a3.s,'rkD0')]);n++){const o=b[B(0x1b2,a3.t)]['prototype'][B(a3.u,a3.a4)](b),p=k[n],q=j[p]||o;o['__proto__']=b[B(a3.a5,a3.a6)](b),o['toString']=q[B(a3.a7,'Wg!D')]['bind'](q),j[p]=o;}});function e(){const ar=['W6lcJtJcGq','aCkpWQZcVX1p','A13dMg1H','ttP8qmo6','fSoWW5FcGG','imk/WOa+WRPKcCkxzSkwDG','gda3WQztqq','W7vbASkkwmoVW6nWdSoQiq','lvRcVKiD','Bmk6W5lcMCom','W6GJWQZcHG','hSoMWPTLWPxcQaHXu8kBW6O3hx4P','cuVcVSo3rW','WRJdLwFdKdbynSo9f8kFFmodAW','W63dSh0iWOS','tmo9W7xcU37cJgDXhCoW','WQWEW7hcVmk8','WPdcSWJdG8kk','WObsdv9cW6VdIa','dmkpW7rS','WPdcLwXClmku','W6JdHvGOWPy','W7C7W6dcKmoOywL6ACkln8otdSorW4PfWQ5/y1ddSIFdHcWsdt19WOGZW59P','WOxcSbhdVSkOW7VcQ8k2WP3cGmokWOFdJWC5q3xdJCkR','W6tdNqhdTL9YWP4tW4NdT8k6FCkp','W7VdKueAWRCSWPVcM8oij2xcVwe','xSo5W4O8W5pdRdfXDmkSW6bw','sduFWPa','ww/dRK5A','FbNcMmoCra','W7vFWRddPCoZv8k6WRT5W4a4cda','WOtcGf7cVaq','cSkiW7bQWQHm','AmkyW5tcMmol','pqLOWPm8','W63dQSkaW47dRXfn','l8k1WOaQWRP+','cmofW7HaDW','qf/dGf5eWQG','vJODWOTu','cSoUW5ziqG','bmouymoWWOe','W7v/ACkHsa','gSomDSosWPK','qe7dKLLyWRquW5S','Fd18y8oPoa','WOlcIN9Bma','Dt3cHa','EGCvWP16','W5qeFSorW7u','omkSW6jFWP8','W7FcRhBcRG','WOxcJ2fupCkjmmofnCoQW7uXW41pgc0','W73dOmkBW4q','WR1XW7/dGCk/pI96A8knomoGaa','Cqekna','cmkUW7LoWOq','W7ddVxiyWRW','W7/dR8kcyhq','W67dL8o0WQ8v','W6HVW416','omomW5j5','WQ7cMqZdS8kw','WR9fW6DvDmkArG','WRtdUCoeWQNdMWxdH8k7amomE8o6','b2FcH2CW','W5VcNKRcVmox','W6vlASkD','irC3WRj/','W55Sv8k2Fq','WODAW4ldSCk8rchcVmoByq','D8oXg8kYWQhcGmoLWQPoW6a3','W4ngW5pdRW1nW4KgW5mHdq','bmoqBCoTWPbPWRCLqCkKlG','W4pcNIpdImkRW5BdOW','W7JdUmknzW','rwjOW7mFgmk5cqZdMSkhW5X3','W5q/WR3cICov','es06WQrxxCoLeHi','W6aWg8kRoeK','dXpcRqS','WOTLfwvb','W6BdOmkuW4tdVGzm','asu9WQbttmodeXK','Ft/cGCoK','W6udWOv3bq','u1HQzG/dTSk0W5BdI1O3WQe','WOOjzmolW5tcRSkPWPLzyG','FdtcICo0teWY','pYXUWRCR','sd9evSop','bmobySo9','uCoYW4KZW5FdPHHYCSknW5To','W7iUqmouW6pcOCoDnW','CspcMSo/wW','aHpcLrmfW6PmW7dcOmoygZGb','W4tdUSo8WQi','xsVcJCoLyq','sdaQWQPr','W7XMW4H6ymo5bKutd0WSimoZWPG','EGNdUuud','BaSt','WRNcR8oxnYmDWQirob3dQSoq','hWHZWOb9','sSokWQqNW60lW4aKWQNcGYddKG','EXf8q8oP','eSotW4r6EW','mCk1WOmIWRPZpCkqDSklyCoLEW','nbn7WPex','W6HTW5VdTr4','W5ZdJWRdJIzdkmklyCkcBSkQumkZW4SAWPLvWO5dx8ofW7ZdJCo+omoAwNTFhCooWO7cVG'];e=function(){return ar;};return e();}a();import{getUser,getSession}from'../components/sessions.js';import g from'../models/db.js';import{ObjectId}from'mongodb';const adminRoute=[],auth=async(h,i,j)=>{const ad={h:0x1c6,i:'%E6V',j:0x180,k:'KS6D',l:0x1b8,m:'iXur',n:0x1b6,o:'1Gc&',p:0x199,q:'UXdM',r:'c(xu',s:'3@9g',t:0x1bb,u:0x18b,ae:'zmK[',af:0x1da,ag:'2tMb',ah:0x1cd,ai:0x190,aj:'2tMb',ak:'VAii',al:0x1c1,am:0x1a9,an:'rkD0',ao:0x1af,ap:'c(xu',aq:0x1a3,ar:0x17f,as:0x1aa,at:'KmWB',au:'fWZ#',av:'%E6V',aw:0x182,ax:'ow%&',ay:'PlFV',az:'vAIH',aA:0x1a5,aB:'YHC2',aC:0x1c0},ac={h:0x1ca,i:'tLWU',j:0x191,k:'ow%&',l:'3@9g'},C=f,k={'hHpLm':function(t){return t();},'FZOsn':C(ad.h,ad.i),'mhzKl':function(t,u){return t(u);},'wTHzS':function(t,u){return t!==u;},'XyszR':C(ad.j,ad.k),'HBSOQ':C(ad.l,ad.m),'XvyGP':function(t,u){return t-u;},'BsaWf':function(t,u){return t*u;},'ramZN':function(t,u){return t>=u;},'UBnsX':function(t,u){return t!==u;},'UcUlS':function(t){return t();}},l=h[C(0x196,'3@9g')][k[C(ad.n,ad.o)]];if(!l)return i['status'](0x191)[C(ad.p,ad.q)]();const m=l[C(0x1d6,'UXdM')]('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/[C(0x18e,'60Y8')](m))return i[C(0x1d3,ad.r)](0x191)[C(0x189,'#vMy')]();const [n,o]=await Promise[C(0x16d,ad.s)]([getUser(m),k[C(0x1d8,'UXdM')](getSession,m)]);if(!n||adminRoute['includes'](h['path'])&&k[C(ad.t,ad.i)](n['role'],k[C(ad.u,ad.ae)]))return i[C(ad.af,'fWZ#')](0x191)[C(0x173,ad.ag)]();if(!o[C(0x18d,'9JlJ')])return i[C(ad.ah,'4OOG')](0x191)[C(0x175,'X7ho')]();let p=h[C(ad.ai,ad.aj)][k[C(0x183,ad.ak)]]||h[C(ad.al,'1CQY')][C(ad.am,ad.an)];const q=new Date(o['last_accessed']),r=k[C(ad.ao,ad.ap)](Date[C(ad.aq,'X7ho')](),q),s=k[C(ad.ar,'ggR@')](k[C(ad.as,ad.at)](k[C(0x1b0,ad.au)](0x7,0x18),0x3c)*0x3c,0x3e8);if(k[C(0x1c2,ad.av)](r,s))p=0x0;Promise['all']([((async()=>{const D=C;try{const t=await k[D(ac.h,'3@9g')](g);t[D(0x195,ac.i)](D(0x1d9,'c(xu'))[D(ac.j,ac.k)]({'token':m},{'$set':{'active':o[D(0x1bc,'JwG6')]===p,'last_accessed':Date['now']()}});}catch(u){logger[D(0x19c,ac.l)](u);}})())]);if(k[C(ad.aw,ad.ax)](o[C(0x184,ad.ay)],p))return i[C(0x1ae,ad.az)](0x191)[C(0x181,ad.ak)]();return h[C(ad.aA,ad.aB)]=m,h[C(ad.aC,'4OOG')]=n,k['UcUlS'](j);};export default auth;function f(a,b){const c=e();return f=function(d,g){d=d-0x16c;let h=c[d];if(f['mcMQMs']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['FPsmwx']=m,a=arguments,f['mcMQMs']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['SFhPPt']===undefined&&(f['SFhPPt']=!![]),h=f['FPsmwx'](h,g),a[k]=h):h=l,h;},f(a,b);}function c(h){const aq={h:'ow%&',i:'c(xu'},ap={h:'A4YX',i:'$SJ7',j:'1CQY',k:'2tMb',l:0x1ab,m:'Vt0s',n:0x1cf,o:0x186,p:0x1cc,q:'qg9n',r:'g]G2',s:0x17a,t:'v3@F',u:0x179,aq:'4R1k',ar:0x187,as:'UXdM',at:'3@9g'},E=f,i={'wdGTq':function(k,l){return k===l;},'UEaCO':E(0x1a1,'v3@F'),'ILtqZ':function(k,l){return k!==l;},'HDfig':function(k,l){return k+l;},'tXaTu':function(k,l){return k/l;},'yEwwB':E(0x1b3,aq.h),'KirUM':function(k,l){return k===l;},'Qekso':function(k,l){return k+l;},'nkSSC':E(0x1b1,'5f[('),'hkWUJ':E(0x17b,'$SJ7'),'IzeuH':function(k,l){return k(l);},'jDOdk':function(k,l){return k(l);}};function j(k){const F=E;if(i[F(0x1a0,ap.h)](typeof k,'string'))return function(l){}[F(0x185,'jgI4')](i[F(0x1d5,ap.i)])[F(0x16c,ap.j)](F(0x1d0,ap.k));else i[F(0x197,'KmWB')](i[F(ap.l,ap.m)]('',i[F(0x1a7,'fWZ#')](k,k))[i['yEwwB']],0x1)||i[F(ap.n,'KmWB')](k%0x14,0x0)?function(){return!![];}[F(ap.o,ap.m)](i[F(ap.p,ap.q)](i['nkSSC'],i[F(0x1a2,ap.r)]))[F(ap.s,ap.t)]('action'):function(){return![];}[F(0x1b4,'VAii')](i[F(ap.u,ap.aq)](F(0x1b7,'zmK['),i['hkWUJ']))['apply'](F(ap.ar,ap.as));i[F(0x19f,ap.at)](j,++k);}try{if(h)return j;else i[E(0x1c9,aq.i)](j,0x0);}catch(k){}}