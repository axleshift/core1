function e(){const aj=['rCkiW64bxqSKWRRdTbiOWOxcQfxcRCk7','smkTW5ldOgi','WQ3dGCkKWRpdKZGD','AGfyeeFcR8oizejD','W5jkWP58WRZcO8oqWPxdTSo0','W6enW7xdRCkTbuVcMW','rSkpW7inwW','mg7cIuZcQ8ocWR4jWPq8zCkY','WQBcGt3cVMpdLa3cHW','cgRdV8kEWO1iEa','rdzkW7G','EXNdUmoPW6RcKZNcLanllmkyWPT1WOm','WQz0W6/dQCkq','WP3dPSouCIK','wCknW4RdLKS','tCkDWQpdRbzkWQO','nwudn8kJvmoGW6VdRwK','W64kdaNcGMHIrSkWra','wSkLW57dQeJcIvu','WPybW5T8','BSk8W5i2BW','tbldSmoewhFdN8oNW4vz','WOWuW58GWQxcSConWR7dQq','eu/dS1O3','aKFcM2yn','cb95W5K','j8kdr8o6WQDfWPPuk8krWRZdVSoDhmkhW77dQfqpz8oNv27dQthdL311W7FcQSk/la','ybtdV8oIW7VdMW','WP9/qghcIq','yIfzWPC5','WRNcOmocpI4','tmoPwNS','Dd1qWOKVjCo8WQZdHf4','W4tdTCkElMO','AGPDfdRdT8kTtw9uws/cNW','WR3cHSovq2WKW7al','W5DlWPv9W6FdTCofWOddGmoLWOVcHa','WPRdRmkquWq','fSouW7DQ','W6VcG8oBDNu','t8kPW4pdV27cIf5r','jwueWRmVa8osWORdIa','oCo9W6rpWRa','WRNcHSo9iqq6','mw4VaMOmW7LdWO7cUSkcoCo8kmklugTlya','hCo2W7r3WPK','m2xcIKRcQSohW7KwWQOzDmkzxq','WOS3W64MWPu','g3ldRKmE','gSk3bZ3cMmk8W4FcO2mZW6Xkha','itZdVYJdPW','W4pcPCo9E1y0W63dJxL/','eNqbqNG','ySkJWO5SAI3cUmkZWOa','W7ddGrFcQwq','xxZcI1VcVCofWOqNWP9uW5tdMG','vmkCW7im','WRqgWRH6Aa','FSkMWOxcLSkd','pmouW7lcIGa','W4hdVSkapgRdIW','hN7cJCkgtq','kCoIptRdSNnAWR8','WPldU8kOlWnNW57dTfPyW6j/','W7ZcMCoYWPBdMreIWQLH','oedcPmk0WRRdQwBcTaLUmW','WRtdT8odzq','nCokW53cPHvgW7u','W5/dRSoVr30','BSk1fJy','Dd1sWPy+nmo9WQBdN19A','medcVCkLxq','ztKMW5nH','o3FdLw8','W6FcOSktkqn5W49HvCoX','zdDiWQWKmSoTWRFdNvfe','vrldS8oeW5C','E8kGfs7dVG','pCkDhCoWWR5o','nSoIW5u9kwRdP8kZWPFcRarElG','WOWuW4OQ','WRxcImoHjbK','WQ7cR8opeHS','WQVcGmo6oWi7WP7cRa','l0S8e8kU','gSoqW41nWPu','WR9KW7emWRjXafzwda','WO/cTYrEW5a5W7mV','f8kDWR0WW7qwW6hcOCo+W6pcSG','hmosW793WRq','W7VdM8oYENubW68R','vIflW6VdLCkgyCkdzG','WQBcNvZdMgW','W4pcQ8o9EW','nmk2WRvywW','ArZdSmoSW6m','xSkLW57dQa','gfTQWP41','o1Watg3cO8oRq1vj','mmomW53cSs5AW6v6W5H9W6S','W7miWOPjWR4','mmomW5/cRJ9lW6rWW4n8','v8oEW6LIWQq','mK12WOeOrmk5z8kI','WQNdPCkEWPBdTa','F8k/A8omWQjdWQdcUCk4DXFdLKtcTNRdNSkveSojvSkKta8EWONcG0PtBdCsrCkoWOK','dH9+W5GEsWuVsX8pW57cVmoRAdJdL8kcka','WPeAW4D3W7O'];e=function(){return aj;};return e();}(function(j,k){const F={j:0x179,k:0x18f,l:'ChOt',m:0x191,n:'(KOO',o:0x1c9,p:'2SY(',q:0x1a8,r:0x1c8},t=f,l=j();while(!![]){try{const m=parseInt(t(F.j,'UIEU'))/0x1*(parseInt(t(F.k,'ToiR'))/0x2)+-parseInt(t(0x1d3,'J(m&'))/0x3+parseInt(t(0x1d6,F.l))/0x4+parseInt(t(F.m,'%3)D'))/0x5*(-parseInt(t(0x1b4,F.n))/0x6)+-parseInt(t(F.o,'2SY('))/0x7*(-parseInt(t(0x1e3,'0kHE'))/0x8)+parseInt(t(0x1a9,F.p))/0x9*(parseInt(t(F.q,'(hdd'))/0xa)+-parseInt(t(F.r,'[nJS'))/0xb*(-parseInt(t(0x1dc,'bA6P'))/0xc);if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0x7ca7d));const d=(function(){let j=!![];return function(k,l){const m=j?function(){const u=f;if(l){const n=l[u(0x1de,'ozjX')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const P={j:0x1a5,k:'0)3B',l:0x1cb,m:'fRgU',n:0x1cf,o:'fRgU'},O={j:'v]7O',k:0x1d9,l:0x1c3,m:0x17d,n:'[nJS',o:'0kHE',p:0x18d,q:'22dA',r:0x18a,s:'Stx8',P:0x181,Q:'Xp@H',R:0x19d,S:'ToiR'},v=f,j={'YcbAX':v(P.j,P.k),'JGmbp':v(0x1a2,'V3[O'),'aEKvE':function(k,l){return k(l);},'PZNIz':v(P.l,'fRgU'),'VPNWc':v(0x192,P.m),'yASHh':function(k,l){return k+l;},'mmhlr':v(0x1c6,'dGCo'),'xTOqN':function(k){return k();},'FGzQj':function(k,l,m){return k(l,m);}};j[v(P.n,P.o)](d,this,function(){const w=v,k=new RegExp(j[w(0x185,O.j)]),l=new RegExp(j[w(O.k,'(hdd')],'i'),m=j[w(O.l,'Stx8')](c,j[w(O.m,O.n)]);!k[w(0x1be,'&iN6')](m+j['VPNWc'])||!l[w(0x17e,O.o)](j[w(O.p,O.q)](m,j[w(O.r,O.s)]))?j[w(O.P,O.Q)](m,'0'):j[w(O.R,O.S)](c);})();}());const b=(function(){let j=!![];return function(k,l){const m=j?function(){if(l){const n=l['apply'](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const Y={j:0x1d1,k:'U#YS',l:0x1bf,m:0x1dd,n:'2SY(',o:0x1da,p:'wnN@',q:'%3)D',r:0x1d2,s:'fRgU',Z:'O*ai',a0:0x1ae,a1:0x1c1,a2:'iC)e',a3:0x1e0,a4:'z2lN',a5:0x1e1,a6:0x19c,a7:0x1a0,a8:'nh@s',a9:'3KCW',aa:0x193,ab:'[nJS',ac:0x199,ad:'!r^3'},x=f,j={'bLjiC':function(n,o){return n(o);},'Ghqwr':function(n,o){return n+o;},'BqybT':x(Y.j,Y.k),'KTUdY':x(Y.l,'huPL'),'fTIvW':function(n){return n();},'CGxXD':'log','DMBMi':x(Y.m,'0)3B'),'cXqhY':x(0x189,Y.n),'VweyT':x(Y.o,Y.p),'nMBcB':x(0x1a6,'!r^3'),'SIike':x(0x19f,Y.q),'owAHZ':function(n,o){return n<o;}};let k;try{const n=j[x(Y.r,Y.s)](Function,j['Ghqwr'](j[x(0x1df,Y.Z)](j['BqybT'],j['KTUdY']),');'));k=j[x(0x1e2,'ACqP')](n);}catch(o){k=window;}const l=k[x(0x1a7,'UIEU')]=k[x(Y.a0,'EpuM')]||{},m=[j[x(Y.a1,Y.a2)],j['DMBMi'],j['cXqhY'],'error',j['VweyT'],j[x(0x1d4,'2SY(')],j['SIike']];for(let p=0x0;j[x(Y.a3,Y.a4)](p,m[x(Y.a5,'dGCo')]);p++){const q=b[x(Y.a6,'z2lN')]['prototype'][x(0x1b8,'*qrL')](b),r=m[p],s=l[r]||q;q[x(Y.a7,Y.a8)]=b[x(0x182,Y.a9)](b),q['toString']=s[x(Y.aa,Y.ab)][x(Y.ac,Y.ad)](s),l[r]=q;}});function f(a,b){const c=e();return f=function(d,g){d=d-0x178;let h=c[d];if(f['YgqTlH']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['aacBCn']=m,a=arguments,f['YgqTlH']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['LsdXAb']===undefined&&(f['LsdXAb']=!![]),h=f['aacBCn'](h,g),a[k]=h):h=l,h;},f(a,b);}a();import g from'fs';import{ObjectId}from'mongodb';import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a0={j:0x19e,k:0x19a,l:0x1bb},y=f,n={'IsgnY':function(o){return o();},'uIlmr':'sessions'};try{const o=await n['IsgnY'](h);await o[y(a0.j,'z2lN')](n[y(a0.k,'nh@s')])[y(a0.l,'2SY(')]({'user_id':j['_id'],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date['now']()});}catch(p){i[y(0x1ab,'0)3B')](p);}};export const getUser=async j=>{const a2={j:'22dA',k:'!r^3',l:0x1d8,m:'v69d',n:0x1d7,o:'bA6P',p:'z2lN',q:'v]7O',r:0x1db},z=f,k={'VEryj':function(l){return l();},'MrFAi':z(0x1c2,'@$7Y')};try{const l=await k['VEryj'](h),m=await l[z(0x1b5,a2.j)](z(0x190,'([fw'))[z(0x1b7,a2.k)]({'token':j});if(!m)return null;const n=await l[z(a2.l,a2.m)](k[z(a2.n,a2.o)])[z(0x17c,a2.p)]({'_id':m['user_id']});return{'_id':n['_id'],'email':n[z(0x198,a2.q)],'first_name':n['first_name'],'last_name':n['last_name'],'role':n['role']};}catch(o){i[z(a2.r,'uzXq')](o);}return null;};(function(){const a4={j:'v69d',k:0x184,l:'@$7Y'},A=f,j={'KIJaF':A(0x1a3,'&iN6'),'dfvKy':'{}.constructor(\x22return\x20this\x22)(\x20)','StZPr':function(l){return l();}};let k;try{const l=Function(j[A(0x1cc,a4.j)]+j['dfvKy']+');');k=j['StZPr'](l);}catch(m){k=window;}k[A(a4.k,a4.l)](c,0x9c4);}());export const removeSession=async j=>{const a6={j:0x19b,k:0x194},B=f,k={'kxlMr':function(l){return l();},'kJfDm':B(0x1cd,'!r^3')};try{const l=await k['kxlMr'](h);await l[B(a6.j,'(hdd')](k[B(0x197,'3Ns&')])[B(a6.k,'EqRb')]({'token':j},{'$set':{'active':![],'last_accessed':Date['now']()}});}catch(m){i['error'](m);}};export const isActiveToken=async j=>{const a8={j:0x18c,k:'Stx8'},C=f,k={'eAzZL':function(l){return l();},'vJFZp':C(a8.j,a8.k)};try{const l=await k[C(0x1b3,'!r^3')](h),m=await l[C(0x1c5,'@$7Y')](k[C(0x18b,'Stx8')])['findOne']({'token':j});return m[C(0x187,'huPL')];}catch(n){i[C(0x1a4,'*qrL')](n);}return![];};function c(j){const ai={j:'40fK',k:0x1af,l:0x1d0},ah={j:0x1bc,k:0x17f,l:'@$7Y',m:'1wXP',n:0x1a1,o:'UIEU',p:'3KCW',q:'G4NE',r:0x180,s:'ACqP',ai:0x1c0,aj:'v]7O',ak:'40fK',al:0x1ca,am:'iCdi',an:0x1b9,ao:'0)3B',ap:'v69d',aq:0x1c4,ar:0x186,as:'0kHE'},D=f,k={'HQHQh':'string','seuJK':D(0x1b0,'v]7O'),'gKTVH':'counter','BlUHA':function(m,n){return m!==n;},'uKnIV':function(m,n){return m+n;},'HjyUG':function(m,n){return m/n;},'MtubA':function(m,n){return m===n;},'ejXEr':function(m,n){return m+n;},'ejSSO':D(0x17b,ai.j),'MARTF':D(ai.k,'EqRb'),'aPolm':D(ai.l,'Stx8')};function l(m){const E=D;if(typeof m===k[E(ah.j,'3KCW')])return function(n){}[E(ah.k,ah.l)](k[E(0x1bd,ah.m)])['apply'](k[E(ah.n,ah.o)]);else k[E(0x1d5,ah.p)](k[E(0x1b1,ah.q)]('',k[E(ah.r,ah.s)](m,m))[E(ah.ai,ah.aj)],0x1)||k[E(0x1b2,ah.ak)](m%0x14,0x0)?function(){return!![];}['constructor'](k[E(ah.al,ah.am)](k[E(0x18e,'fRgU')],k[E(ah.an,ah.ao)]))[E(0x196,ah.ap)](k[E(0x195,'17KC')]):function(){return![];}['constructor'](k['ejSSO']+E(ah.aq,'ChOt'))[E(ah.ar,ah.as)]('stateObject');l(++m);}try{if(j)return l;else l(0x0);}catch(m){}}