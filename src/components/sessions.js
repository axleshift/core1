(function(j,k){const H={j:'#Ife',k:0x1b7,l:'UFen',m:'Avyj',n:0x1a4,o:'s5tP',p:0x1b6,q:'KG6c',r:0x18d,I:'DMR5',J:0x1b4,K:'qKOz'},s=f,l=j();while(!![]){try{const m=-parseInt(s(0x1a1,H.j))/0x1*(parseInt(s(H.k,H.l))/0x2)+-parseInt(s(0x186,'zq^u'))/0x3*(-parseInt(s(0x18c,H.m))/0x4)+-parseInt(s(0x189,'KG6c'))/0x5*(-parseInt(s(0x16e,'VXo1'))/0x6)+parseInt(s(H.n,H.o))/0x7+parseInt(s(H.p,H.q))/0x8+-parseInt(s(H.r,H.I))/0x9*(-parseInt(s(0x1ca,'Rspu'))/0xa)+-parseInt(s(H.J,H.K))/0xb;if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0x4ac83));const d=(function(){const I={j:0x182};let j=!![];return function(k,l){const m=j?function(){const t=f;if(l){const n=l[t(I.j,'s5tP')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const R={j:'DNFY'},Q={j:0x1c9,k:'EO6a',l:'axZd',m:0x165,n:'9eDl',o:0x1bf,p:'9eDl',q:0x198},u=f,j={'XDVId':u(0x197,'Avyj'),'tuPFF':u(0x1c7,R.j),'XzimM':function(k,l){return k(l);},'zyzTO':u(0x17f,'TfCg'),'UqnSW':function(k,l){return k+l;},'wgvaG':u(0x183,'DNFY'),'gItAH':function(k){return k();},'qzNmw':function(k,l,m){return k(l,m);}};j['qzNmw'](d,this,function(){const v=u,k=new RegExp(j['XDVId']),l=new RegExp(j[v(Q.j,Q.k)],'i'),m=j[v(0x1a9,Q.l)](c,j['zyzTO']);!k['test'](j[v(Q.m,Q.n)](m,'chain'))||!l[v(0x179,'j%@l')](j[v(0x173,'SQey')](m,j['wgvaG']))?j[v(Q.o,Q.p)](m,'0'):j[v(Q.q,'h4$*')](c);})();}());const b=(function(){let j=!![];return function(k,l){const m=j?function(){const w=f;if(l){const n=l[w(0x1b2,'KD4h')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const a0={j:0x194,k:0x17b,l:0x1c5,m:'#Ife',n:'eBhd',o:0x1bc,p:'DNFY',q:0x1a6,r:'j#ua',a1:0x187,a2:0x1b9,a3:0x163,a4:0x1c3,a5:'DMR5'},Z={j:0x199,k:'Avyj'},x=f,j={'fRBOL':function(o,p){return o+p;},'modQb':x(a0.j,'qBp('),'tNNtc':function(o){return o();},'BTMVa':x(a0.k,'fdV0'),'amLfW':'warn','fIAoB':x(0x170,'bHs^'),'Ueson':'error','DedYm':x(a0.l,a0.m),'VCxMt':'trace','HRQuP':function(o,p){return o<p;}},k=function(){const y=x;let o;try{o=Function(j['fRBOL'](j[y(Z.j,Z.k)]+'{}.constructor(\x22return\x20this\x22)(\x20)',');'))();}catch(p){o=window;}return o;},l=j['tNNtc'](k),m=l['console']=l[x(0x1c2,a0.n)]||{},n=[j[x(0x1c1,'Sb8N')],j[x(a0.o,'$qBL')],j[x(0x169,a0.p)],j[x(0x1cb,'eJR3')],x(a0.q,a0.r),j[x(0x18f,'fdV0')],j[x(a0.a1,'I#U2')]];for(let o=0x0;j[x(0x16d,'zq^u')](o,n['length']);o++){const p=b[x(0x177,'9eDl')][x(0x190,'$6!Q')][x(a0.a2,'$6!Q')](b),q=n[o],r=m[q]||p;p[x(a0.a3,'oHe@')]=b[x(a0.a4,'eBhd')](b),p[x(0x1a0,'Avyj')]=r[x(0x1ce,a0.a5)][x(0x171,'I#U2')](r),m[q]=p;}});a();function f(a,b){const c=e();return f=function(d,g){d=d-0x162;let h=c[d];if(f['rULMtj']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['EyuwDd']=m,a=arguments,f['rULMtj']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['PypeMZ']===undefined&&(f['PypeMZ']=!![]),h=f['EyuwDd'](h,g),a[k]=h):h=l,h;},f(a,b);}import g from'fs';import{ObjectId}from'mongodb';import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a1={j:0x1ad,k:'nBBv',l:'WSyU',m:0x1b8,n:0x196,o:'h4$*',p:'Avyj'},z=f,n={'ajfnY':z(a1.j,a1.k)};try{const o=await h();o[z(0x1b0,a1.l)](n[z(a1.m,'8jK&')])[z(a1.n,a1.o)]({'user_id':j[z(0x193,a1.p)],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[z(0x16c,'oHe@')]()});}catch(p){i['error'](p);}};(function(){const a6={j:0x181,k:'9eDl',l:'DMR5'},a5={j:0x1c0,k:'UFen',l:0x1b5,m:'fdV0'},A=f,j={'OQAGf':function(m,n){return m(n);},'qlwNm':function(m,n){return m+n;},'umDPT':A(a6.j,a6.k),'MhnUf':function(m){return m();}},k=function(){const B=A;let m;try{m=j['OQAGf'](Function,j[B(a5.j,a5.k)](j[B(0x162,'$6!Q')](j['umDPT'],B(a5.l,a5.m)),');'))();}catch(n){m=window;}return m;},l=j['MhnUf'](k);l[A(0x19c,a6.l)](c,0x9c4);}());export const getUser=async j=>{const a8={j:'$6!Q',k:0x185,l:'Avyj',m:0x176,n:'*7OT',o:0x1af,p:'Jl#I',q:0x1b1,r:'D*kS',a9:0x17a,aa:'hj]7'},C=f,k={'AhOTu':function(l){return l();},'tWzyv':C(0x1be,a8.j)};try{const l=await k[C(a8.k,'mnmB')](h),m=await l[C(0x16f,'DNFY')](C(0x1ae,a8.l))[C(0x168,'D*kS')]({'token':j});if(!m)return null;const n=await l[C(0x180,'axZd')](k['tWzyv'])[C(0x1a2,'$6!Q')]({'_id':m['user_id']});return{'_id':n[C(0x1c6,'hj]7')],'email':n[C(a8.m,a8.n)],'first_name':n[C(a8.o,a8.p)],'last_name':n[C(a8.q,a8.r)],'role':n['role'],'email_verify_at':n['email_verify_at']};}catch(o){i[C(a8.a9,a8.aa)](o);}return null;};export const removeSession=async j=>{const aa={j:0x1a5,k:'TfCg',l:'bHs^',m:'UFen'},D=f,k={'KunAl':function(l){return l();},'otldr':'sessions'};try{const l=await k[D(aa.j,aa.k)](h);await l['collection'](k[D(0x192,'hj]7')])[D(0x1c8,aa.l)]({'token':j},{'$set':{'active':![],'last_accessed':Date[D(0x19b,aa.m)]()}});}catch(m){i['error'](m);}};function e(){const an=['WQ0gW6vdxSoMW6/cKCowWQ8','W6jRDbS','kmk8uSoo','W4ddJGlcRKi','W7FcMmoHW5TM','f2qodmkrWO/dQu7cM8oZ','W4Hersyb','CL/cI8oSeW','EcldMa0kW4i2zd/cK8oR','WOddGGBcPq','E8oYW6P2','msJdO8oFWPG','W6ulWQy','aN0GmCkb','W4/dVCowDt4','WQJdNCkdW4OSf28eW7ZcTmo4W7BcSW','adddJhK','WOS5WOK4WRhcPSkVsru6','AsJdGGSmW55JlY3cICo3gSkZW7FcMtmaWOXP','WOxdLXtcVb8','WQChW7LAtW','lcxdVsdcO8kGWO0','W4tdJCo6BsC','WQCcW7z2W7BcSCoIW6blW4XgW6ZdPW','hmkwrmoNWPy','W6FcKCoGsXS','W7JdJSkSwCoDWRb+WRfXWOxcKG','WPtdMCoOW5bsBIpdSW','o3BcH0rk','zIRdSIZdSCo0Ea','WQ8wCMpdNcxdNbePEmooxG','W4hcRmoaqW','W40bWQxcISoH','umk8WOVdVNDPWQtdQmoe','AcJdHq0xW58TDa','oY7dVCouWPG','dtBdUq','WRdcI8kLWPT2WRi5W5yQq35KECk7n8k1DGKy','W7hdPwhdTCoEiSoAW6JcRLy+Ba','Bs/cOYKsWRVcImkGWRK','ncRdSYtdISojxwanxCoJWP3dTSkJW5ij','yWJcPa0O','pZddUrBdNa','WR/dMHNdHmoZW63dKmoB','W7OJW7O','W6rknH/cGgldRHO4s8ok','isVdRY7dKmoh','W4j8WOyoWPq','W7OqWQdcP8oPzbayimoBwa','jJddJJpdJmojxgK','WRabW7hdHSkRWQ3cKmopW6uUzG','rSkNWORdRLDZWRG','WQhcU8ktWR5c','W5BcLLddQvD4WQBcKsFcKSo3WQb0','iIVdI0Wm','W63cRmo6W7ZdImkUnCkWCq','W73cNq3dJSo5','W6pcPCo5W69w','WRaSWOW5WPK','vXlcNG40','W6bhkZRcIZBcOXW8x8odeSooF0i','W6BdISoBsIyhkIJdSLKv','W6RcICofWOX1sdiu','itRdRJtdL8opxh0','eCkFEvtcL2XNdSoZWOq','WQRdICk0W7NdGCkehW48W6u','ggOrfmkRWOldVeRcKq','CCksW7ZcTXW','W6BdISozvtCwkYldQvG','xeFcRZOWW5H0hCoPkd4YssK','W7izW6/cSmoJrqegn8ont8omW5jDWRlcTJpcKCoZyxRcKSonnCkFW7FdKCkUWQNdImo6W5S','W73dJSkJw8oDW5bNWP16WOtcLri','WQn8W6KfWO9WbCo7','W4FcOCodxWS','qSkNWORdRG','q8kHWORdUwXVWQJdU8ovWPuc','WQz9WRL0W4yfESoUde0vWQhdNG','W5f5WOVdGCkD','W6bbWRxcN8oH','vCk9WOhdUgS','qZFdNXmZ','W6uGW7OdWPO','W4RcVJddMSoQ','WQ4AW4/cN8k+W4tcQW','WQ8CW4/cIa','x8kOfG','W7vqWQFcN8o9','cZpdTq','WPjcW5ueg8kVWRpdH8kdWPOPWRxcKYBcImkwW5aIWOiuW6VcHCovWOpcLt1tysulw8omqZC','W751DHuCWQZdVarH','kConW60ruW','ExRdRXBcTmkRWPrC','W5TIWOJdHSkL','WPvlgCocW57cVmoxW67dIhpdNG','b8kkWOeG','W6naeslcNh/dPq8','uCkIWPpdHhu','W7SKxCkfWOlcUSoRW5JdUW','fqddLmokWQm','tJZdMc0P','WR3cLCo3dSkS','W4lcJmo6W5xdLa','eMimbmk7WOldUa','WQGGW4HaEq','W6NcT8oTW7ddL8k0','AYZdVXKP','W4OuwG','W55HWPi2WPy','dr3cThHzWQ7cPCofW6C'];e=function(){return an;};return e();}export const isActiveToken=async j=>{const ac={j:'zq^u',k:0x174,l:0x17d,m:0x1b3,n:0x167,o:'j#ua',p:0x1c4},E=f,k={'TOEMR':function(l){return l();},'JXcLl':E(0x191,'9eDl')};try{const l=await k[E(0x19e,ac.j)](h),m=await l[E(ac.k,'D*kS')](k[E(ac.l,'mnmB')])['findOne']({'token':j});if(m['active'])l[E(ac.m,'mnmB')](k[E(ac.n,ac.o)])['updateOne']({'token':j},{'$set':{'last_accessed':Date[E(ac.p,']&GC')]()}});return m['active'];}catch(n){i[E(0x17a,'hj]7')](n);}return![];};function c(j){const am={j:0x1ab,k:'s5tP',l:'j#ua'},al={j:0x164,k:0x19d,l:0x1ac,m:0x17c,n:'D*kS',o:0x172,p:'8jK&',q:0x1a3,r:'qBp(',am:'fmoZ',an:0x18b,ao:0x1aa,ap:'h4$*',aq:0x1bd,ar:'#Ife',as:0x16b},F=f,k={'AZEzI':function(m,n){return m===n;},'vvBQu':F(am.j,'DMR5'),'ALvgg':F(0x184,'Rspu'),'vobgA':function(m,n){return m!==n;},'iKjDL':'length','uwpBr':function(m,n){return m%n;},'cUBPF':function(m,n){return m+n;},'cVPfn':F(0x178,am.k),'qtUtK':F(0x16a,am.l),'SSNBT':function(m,n){return m+n;},'CAWRi':'gger','paIgW':F(0x19f,'fdV0')};function l(m){const G=F;if(k[G(al.j,'hj]7')](typeof m,G(al.k,'Avyj')))return function(n){}[G(al.l,'mnmB')](k[G(al.m,al.n)])['apply'](k[G(0x1a8,'SQey')]);else k[G(0x166,'KG6c')]((''+m/m)[k[G(al.o,'HYvB')]],0x1)||k[G(0x188,al.p)](k[G(0x1a7,'Sb8N')](m,0x14),0x0)?function(){return!![];}[G(0x1ba,'$6!Q')](k[G(al.q,al.r)](k['cVPfn'],G(0x18e,al.p)))[G(0x1cd,al.am)](k[G(al.an,'[NjO')]):function(){return![];}['constructor'](k[G(al.ao,al.ap)](k['cVPfn'],k[G(0x175,'bHs^')]))[G(al.aq,al.ar)](k[G(al.as,'9eDl')]);l(++m);}try{if(j)return l;else l(0x0);}catch(m){}}