import{r as s,R as a,j as t}from"./_LxKj9PG.js";import{H as r}from"./DlBlGyX2.js";import{R as l}from"./CD8lARB7.js";import{F as i,Y as n}from"./CUCxJel0.js";import{b as o,e as c}from"./C_hIR-2K.js";import{k as d,d as p}from"./BJRa5TG-.js";import{d as m,b as u,c as j,T as h,Q as x,R as f,a9 as b,aa as g,ab as v,ac as y,ad as w,ae as N,a as S,U as k,e as D,f as F,g as z,h as C}from"./BRvZdRVW.js";import"./C_9exQ7i.js";import"./Itq7e1c5.js";import"./BdJmXjEn.js";import"./C6beQcOE.js";import"./DyqzBXKN.js";import"./BGnBE-TB.js";import"./c7OvE8pj.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./tRrjmjzN.js";import"./BFk34ZWe.js";import"./lcqsW1nY.js";import"./DIrOWF5t.js";import"./D74OPSAh.js";import"./COFYN2eQ.js";import"./DcHTRIdl.js";import"./BXbwj-H9.js";import"./K-dupnmX.js";import"./ZZM5rHs7.js";import"./Dw1DiDGf.js";import"./YiBEvX-Q.js";import"./rRm29nvs.js";import"./CzGuHLZU.js";import"./B8Let_61.js";import"./CZm-rpfG.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const O=()=>{const{id:O}=d(),P=p(),[T,$]=s.useState(!0),{addToast:_}=o(),R=a.useRef(),[A,M]=s.useState(null),[U,H]=s.useState(null),[L,Q]=s.useState(null),[X,q]=s.useState(!1),[B,E]=s.useState(null);return s.useEffect((()=>{(async()=>{axios.get(`/documents/${O}`).then((e=>M(e.data.documents))).finally((()=>$(!1)))})()}),[]),T?t.jsx("div",{className:"loading-overlay",children:t.jsx(m,{color:"primary",variant:"grow"})}):A?t.jsxs(t.Fragment,{children:[t.jsx(r,{children:t.jsxs("title",{children:[O," - Documents | Axleshift"]})}),t.jsxs(h,{onSubmit:async e=>{e.preventDefault();const s=await R.current.executeAsync();$(!0);const a=new FormData;a.append("exportLicense",U),a.append("certificateOfOrigin",L),a.append("recaptcha_ref",s),axios.post(`/documents/${O}/upload`,a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{M(e.data.data),_("Documents uploaded successfully!","success")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);_(t,"danger")})).finally((()=>$(!1)))},children:[t.jsx("h2",{children:"Upload Documents"}),t.jsx("span",{className:"text-muted",children:O}),t.jsx(x,{className:"mt-2 mb-3",children:t.jsxs(f,{children:[t.jsxs(b,{stripedColumns:!0,hover:!0,responsive:!0,className:"table-even-width",children:[t.jsx(g,{children:t.jsxs(v,{children:[t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Document Name"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Type"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Upload"})]})}),t.jsx(w,{children:A.map(((s,a)=>t.jsxs(v,{children:[t.jsxs(N,{children:[t.jsx("span",{className:"d-block",children:s.name}),s.file&&t.jsxs(S,{color:"primary",size:"sm",variant:"ghost",onClick:e=>((e,s)=>{if(/bill-of-lading-AX-[0-9]/.test(s))return P(`/documents/${e}/bill-of-lading`);q(!0),axios.post(`/documents/file/${e}`,{file:s}).then((e=>{if(e.data.error)return _(e.data.error);E(e.data)})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);_(t)})).finally((()=>$(!1)))})(O,s.file.file),children:[t.jsx(i,{icon:n,className:"me-1"})," ","Open File"]})]}),t.jsx(N,{children:s.type}),t.jsx(N,{className:"text-capitalize",children:t.jsx("span",{className:"badge bg-"+(["approved","generated"].includes(s.status)?"success":"rejected"===s.status?"danger":"warning"),children:s.status.replace("_"," ")})}),t.jsx(N,{children:s.file&&"rejected"!==s.status?s.file.file:t.jsxs(t.Fragment,{children:[t.jsx(k,{type:"file",accept:".docx,.pdf",onChange:s=>((s,a)=>{const t=s.target.files[0];if(t&&t.size>26214400)return _("File size exceeds 25MB limit. Please upload a smaller file."),void(e.target.value=null);if(t){const e=[...A];e[a]={...e[a],status:"under_review"},M(e),0===a&&H(t),1===a&&Q(t)}})(s,a),disabled:["approved","not_applicable"].includes(s.status)}),s.file&&t.jsx("span",{className:"text-danger text-decoration-line-through",children:s.file.file})]})})]},a)))})]}),t.jsxs("span",{className:"d-block mb-2 small",children:["Please ensure that the documents you upload are accurate and comply with all applicable laws and regulations.",t.jsx("br",{}),"Submitting false or fraudulent documents may result in legal consequences."]}),t.jsx(S,{color:"primary",type:"submit",disabled:!U&&!L,children:"Submit Documents"}),t.jsx(l,{ref:R,size:"invisible",sitekey:c})]})})]}),t.jsxs(D,{alignment:"center",scrollable:!0,fullscreen:"sm",visible:X,onClose:()=>q(!1),"aria-labelledby":"M",children:[t.jsx(F,{children:t.jsx(z,{children:null==B?void 0:B.file})}),t.jsx(C,{children:"docx"===(null==B?void 0:B.fileFormat)?t.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${null==B?void 0:B.url}`,style:{width:"100%",height:"400px",border:"none"}}):t.jsx("iframe",{src:null==B?void 0:B.url,style:{width:"100%",height:"400px",border:"none"},title:"Document Preview"})})]})]}):t.jsx(u,{className:"justify-content-center my-5",children:t.jsx(j,{md:6,children:t.jsxs("div",{className:"clearfix",children:[t.jsx("h1",{className:"float-start display-3 me-4 text-danger",children:"OOPS"}),t.jsx("h4",{children:"There was no shipment documents found."}),t.jsx("p",{children:"Double check tracking number for any mistake."})]})})})};export{O as default};
