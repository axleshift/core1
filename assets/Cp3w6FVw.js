import{R as G,r as l,j as e}from"./D3kDgYDB.js";import{u as L}from"./B6-gGlhp.js";import{F as a,H as F,B as D,y as _,q as b,D as q,E as B,G as U}from"./DY2y_89w.js";import{R as V}from"./D0iU1EWp.js";import{c as E,b as H,d as $,V as z}from"./B1KJEzUT.js";import{E as M}from"./URk2IvX2.js";import{d as O}from"./o5tV6Bm-.js";import{c as W,C as X,M as I,N as C,U as Y,V as K,W as J,m as Q,n as c,p as m,o as d,Y as Z,X as ee,T as p}from"./0xvR-hIp.js";import"./CNSOrHVr.js";import"./WyM-ksIe.js";import"./dB90dn3U.js";import"./Dw8pycEM.js";import"./8JwjhRSi.js";import"./CWoBZRFf.js";import"./tpRZQFqq.js";import"./CzFDRTuY.js";import"./CQ-yZ3vu.js";import"./BmHAl9XU.js";import"./DzfTGk6K.js";import"./hKczlkOd.js";import"./CXnULsF_.js";import"./CCb-kr4I.js";import"./Cz0CWeBA.js";import"./Cp7XljvA.js";import"./BQBsAJpH.js";import"./DRFurTTo.js";import"./BZxJdD1U.js";const Ie=()=>{const u=O(),y=G.useRef(),[o,P]=l.useState({email:"",first_name:"",last_name:"",password:"",repeat_password:""}),[S,f]=l.useState(!1),[w,A]=l.useState(!1),[v,h]=l.useState({error:!1,message:""}),N=new URLSearchParams(window.location.search),x=N.get("n")?N.get("n"):"/",R=L({onSuccess:async s=>{k(null,"google",s.access_token)},onError:()=>{h({error:!0,message:"Please try again later"})}});l.useEffect(()=>{if(cookies.get(E)!==void 0)return window.location.href=x},[]);const i=s=>{const{id:n,value:j}=s.target;P(g=>({...g,[n]:j}))},k=async(s,n,j)=>{s&&s.preventDefault(),f(!0);const g=await y.current.executeAsync(),t=new FormData;if(n==="form")for(const r in o)t.append(r,o[r]);else if(n==="google")t.append("credential",j);else{f(!1),h({error:!0,message:"Internal Application Error"});return}t.append("type",n),t.append("recaptcha_ref",g),t.append("newsletter",w),await axios.post(`${z}/api/v1/auth/register`,t,{headers:{}}).then(r=>{if(r.data.error)return h({error:!0,message:r.data.error});if(r.data.type==="form")return u(`/login${x}`);cookies.set(E,r.data.token,{expires:30}),window.location.href=x}).catch(r=>{console.error(r);const T=M[r.status]||"Internal Application Error";h({error:!0,message:T})}).finally(()=>f(!1))};return e.jsxs("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"auth-bg"}),e.jsxs(W,{children:[S&&e.jsx("div",{className:"loading-overlay",children:e.jsx(X,{color:"primary",variant:"grow"})}),e.jsx(I,{className:"justify-content-center",children:e.jsx(C,{md:8,lg:6,xl:5,className:"my-2",children:e.jsx(Y,{className:"p-1 p-sm-4 shadow",children:e.jsxs(K,{children:[v.error&&e.jsxs(J,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(a,{className:"flex-shrink-0 me-2",icon:F,size:"xl"}),e.jsx("div",{children:v.message})]}),e.jsxs(Q,{onSubmit:s=>k(s,"form",null),children:[e.jsx("h1",{children:"Register"}),e.jsx("p",{className:"text-body-secondary",children:"Create your account"}),e.jsx(V,{ref:y,size:"invisible",sitekey:H}),e.jsxs(c,{className:"mb-3",children:[e.jsx(m,{children:e.jsx(a,{icon:D})}),e.jsx(d,{id:"email",type:"email",placeholder:"Email",autoComplete:"email",value:o.email,onChange:s=>i(s),required:!0})]}),e.jsxs(I,{children:[e.jsx(C,{md:6,className:"mb-3",children:e.jsxs(c,{children:[e.jsx(m,{children:e.jsx(a,{icon:_})}),e.jsx(d,{id:"first_name",type:"text",placeholder:"First Name",autoComplete:"given-name",value:o.first_name,onChange:s=>i(s),required:!0})]})}),e.jsx(C,{md:6,className:"mb-3",children:e.jsxs(c,{children:[e.jsx(m,{children:e.jsx(a,{icon:_})}),e.jsx(d,{id:"last_name",type:"text",placeholder:"Last Name",autoComplete:"family-name",value:o.last_name,onChange:s=>i(s),required:!0})]})})]}),e.jsxs(c,{className:"mb-3",children:[e.jsx(m,{children:e.jsx(a,{icon:b})}),e.jsx(d,{id:"password",type:"password",placeholder:"Password",autoComplete:"new-password",value:o.password,onChange:s=>i(s),required:!0})]}),e.jsxs(c,{className:"mb-3",children:[e.jsx(m,{children:e.jsx(a,{icon:b})}),e.jsx(d,{id:"repeat_password",type:"password",placeholder:"Repeat password",autoComplete:"new-password",value:o.repeat_password,onChange:s=>i(s),required:!0})]}),e.jsx(Z,{id:"newsletter",className:"mb-1",checked:w,onChange:s=>A(event.target.checked),label:"Subscribe to our newsletter"}),e.jsx("p",{children:e.jsxs("small",{children:["By continuing, you agree to our",e.jsxs("a",{className:"link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",onClick:()=>u("/privacy-policy"),children:[" ","Privacy Policy"," "]}),"and",e.jsxs("a",{className:"link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",onClick:()=>u("/terms-of-service"),children:[" ","Terms of Service"]}),"."]})}),e.jsx("div",{className:"d-grid mb-3",children:e.jsxs(ee,{children:[e.jsx(p,{type:"submit",color:"primary",className:"me-2 rounded",children:"Create Account"}),e.jsx(p,{color:"outline-primary",className:"me-2 rounded",onClick:()=>u(`/login?n=${x}`),children:"Login"})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-muted d-block mb-1",children:"Or continue with"}),e.jsx(p,{color:"outline-primary",className:"me-2",onClick:R,children:e.jsx(a,{icon:q})}),e.jsx(p,{color:"outline-primary",className:"me-2",onClick:()=>window.location.href=`https://github.com/login/oauth/authorize?client_id=${$}`,children:e.jsx(a,{icon:B})}),e.jsx(p,{color:"outline-primary",className:"me-2",disabled:!0,children:e.jsx(a,{icon:U})})]})]})]})})})})]})]})};export{Ie as default};
