const J=f;(function(p,q){const V={p:'V3Wv',q:0x143,r:'XR)&',s:0x153,t:0x194},C=f,r=p();while(!![]){try{const s=-parseInt(C(0x1bb,V.p))/0x1*(parseInt(C(V.q,V.r))/0x2)+parseInt(C(V.s,']V4i'))/0x3+parseInt(C(0x146,'5]%X'))/0x4*(parseInt(C(V.t,'KG%@'))/0x5)+parseInt(C(0x1bf,'qtnf'))/0x6*(-parseInt(C(0x123,'In(W'))/0x7)+parseInt(C(0x16b,'Xa5v'))/0x8*(-parseInt(C(0x166,'In(W'))/0x9)+parseInt(C(0x1d7,'WUJ)'))/0xa+-parseInt(C(0x1f6,'8XE^'))/0xb;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xbd6fd));const d=(function(){let p=!![];return function(q,r){const W={p:'5WgI'},s=p?function(){const D=f;if(r){const t=r[D(0x178,W.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a6={p:0x1a4},a5={p:0x19a,q:0x13a,r:'emRk',s:'g&FT',t:0x1f3,u:'R5n$',v:0x169,w:'5dWx'},E=f,p={'oXJTX':E(a6.p,'V3Wv'),'oNzCP':'init','fjSHG':function(q,r){return q+r;},'aiSUh':'chain','yEDOq':function(q,r){return q+r;},'tCmta':function(q,r){return q(r);},'isqlw':function(q){return q();},'jyAhb':function(q,r,s){return q(r,s);}};p['jyAhb'](d,this,function(){const F=E,q=new RegExp(F(a5.p,'knwc')),r=new RegExp(p['oXJTX'],'i'),s=c(p[F(a5.q,a5.r)]);!q[F(0x20a,'9N4(')](p[F(0x1b7,a5.s)](s,p[F(a5.t,a5.u)]))||!r['test'](p['yEDOq'](s,'input'))?p[F(a5.v,'R5n$')](s,'0'):p[F(0x1a7,a5.w)](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const G=f;if(r){const t=r[G(0x151,'ib(W')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ah={p:'ib(W',q:0x1ec,r:'In(W',s:0x1f1,t:0x1ef,u:0x1e9,v:'gWFU',w:0x14f,x:'9N4(',y:0x1a3,z:0x1db,A:0x1a5,B:0x144,ai:'6OTf',aj:0x177,ak:0x12d,al:'v^X4',am:'iqJ0',an:0x1f4,ao:'WUJ)',ap:0x189,aq:'Gxja'},ag={p:'3dLs',q:0x182,r:'zd4m'},H=f,p={'TjTnN':function(u,v){return u(v);},'bqaoJ':function(u,v){return u+v;},'UzjXd':function(u,v){return u+v;},'lGLRH':'return\x20(function()\x20','KFfPB':function(u){return u();},'zrtdn':'log','ckreh':H(0x136,ah.p),'ORsfC':H(ah.q,ah.r),'LKzYt':H(ah.s,'R5n$'),'bcizN':H(0x15f,'5]%X'),'Dpqlt':H(ah.t,'mJVi'),'Anzuo':'trace','MRvYO':function(u,v){return u<v;}},q=function(){const I=H;let u;try{u=p[I(0x174,ag.p)](Function,p['bqaoJ'](p[I(0x18b,'hXOz')](p[I(ag.q,'V3Wv')],I(0x1b4,ag.r)),');'))();}catch(v){u=window;}return u;},r=p[H(0x15d,'Xa5v')](q),s=r[H(ah.u,ah.v)]=r[H(ah.w,ah.x)]||{},t=[p[H(ah.y,'emRk')],p[H(ah.z,'I@vx')],p['ORsfC'],p['LKzYt'],p[H(ah.A,'WUJ)')],p[H(ah.B,'7I@1')],p[H(0x15a,ah.ai)]];for(let u=0x0;p[H(ah.aj,'4HAp')](u,t[H(0x18d,'zd4m')]);u++){const v=b[H(0x171,'s4ON')][H(ah.ak,ah.al)][H(0x1f9,ah.am)](b),w=t[u],x=s[w]||v;v[H(ah.an,ah.r)]=b[H(0x1df,ah.ao)](b),v[H(0x18c,'Xa5v')]=x[H(0x1ca,'hXOz')][H(ah.ap,ah.aq)](x),s[w]=v;}});function e(){const ba=['WRvMWO/cOCo1zW','W43dHCkrWRxcGG','W50ffqpcHW','WPLyW688','W7/cLI01W4Hn','BSkplCkplG','W4JcVM4muq','WRVdRCoWxmoJ','W6OqW7WSW6eIh8kCiq','WRZcNJTvW5Szk8kGWPldOmot','rCoxW7hdLmox','W40FpKa','W6RdHaLdzCkOm8oVW75/xq/dLSkdvSoqWQtcQqVcLsKhWQi','W5VcQwycWR8','W6JcThGCvG','WO9RWOmJW4a','WORcRSkLW6nECxRcSrW','WQeWwSo2CW','kCkqACoWwCkFErZcN0a','gCkLWQpdQxNcVmoHt8kIWQCAdG','xmo/W7VcVsq','yCogfXaR','W5xcGKau','WOJdKCoOW44RbqdcMtbCxa','W6JcJ0q5vsneW7qfWRW','dvJcOG','mmoTAhvdW4H+hmoGWOnGqSo6xbvqWOL4ja','W49bWRXpW78','rYdcUmk2pcJdMa','W5e5qCodph3dIG','WO9jW60+WRO','EHftW5K','aSkkWQVcGSkjzuysWQ7cGSktwfu','jXPpif/dMHCHW7/dHCo8WQ7dVSkLyaDYW4hcPwOnW68BcqBcKSkxWQ7dQumlwa','CwxdTSos','W5eHyCoGea','vmkDi8kWiSkG','WQzpW4KEWPS','A27cP8kkWQu','W67dHXjFzG','vZVcT8kXjJC','W73dJISGW6O','fSkHW5uNkG','nCkqu8oNgCkFDXxcRKlcHmkmW60vWPTjEq','tCoOW7pcVtRdVSobr8kB','m8kiW4q','ASk8fmo/dCk8WQS','WO1lW7GZWRFcTMFcJCo4W5i','W58mWQ5JW7ddPuRcTCooW6VdMmkH','jMNcQ8odWQ0','ymkUWR7cQq','W4ldK8oMW6WxpWC','WO/dJLFdTG','AmkYWRxcVG','WOhcSYbaW5y','schcQgu','zmoEWOrfwmkmWQWhmmkEfZ8','W7VcLLiRvrLLW7Sn','W4ZdL8k6WRm','WQVdI3DGWOOumdBcTLVcPGC','edm7duG','W4mgmb7cVq','W5hcIKSvWQZcOCostSk7WOK2','nCkxxmkEda','FSk4WQlcSW','rSojiabO','eCodW7RcKK8','W5hdLCkyWONcUSoz','qJbaW7ldNG','WP3dM0NdVGW','WO0hW6HLWRe','BCo+ExjyW4aNg8oPWOj+dSoGua0','W5C7W6XJWPi','z3NdV8omcmoTWPlcShBdGG','mSopW4SoWRpcHq','pXNdKsddKCkMWPpcOSkwjSo/','i8o8lKhcNXVcTSkvka','uCkHaCkkaa','eSk0W4ODoW','tSoxmdyh','fCo5uNrE','W7pcTCkasSkVkq','xudcHCk3WRa','W5nWy8oQzt4fWRG','W6XuWRe','WRi8W44tW70IqcqvaG','aXWwDa','qSomW7VdHComiG','W4BcIsKkW5G','kCkiW6adgSoDWQaU','lSoTCMDfW44','WRS9W4qC','WOGHW54aWQKOuaTuh8kdsW','W6dcIue','WPuVwmoU','W5K/wa','W7uzde8B','BvzujvxdUtiSW7K','j8oNW47cGW','mCoTCMq','WRHDWROhW6u','W412WOrsW50','W7pdTWi','W6jeWQDPW40XW7aRWQbUW43cQ8kyWRPyW6W','fa7dLG','jrSBxmkL','qmo1W7hcVc/dUmoB','W5HHvSkwWQBdTSkFeanMW7S','fralza','W57cH0u5vHnyW7fiWR3dIJDdbCoKW7TdW4usnXC8WQm','WQuPpCo5dGy2o8occrJdTCkbW7yn','sYBcUIpcRSk5','WQ7dKCo+E8oD','FSk7ie9VWQL3W45gWQddQmkKDCoDW5/dOSkYnrGBW4uJW6H+WRRdJqKgBYi0iSoeW5G','W5X8z8kDdq','WOTlW689WRe','ut3cQN3dRa','WP/dILxdVG','d8kiW4yddCog','WQD+WOi','j8o6BM9d','FSoIW4FcSIy','yCoxfrPtW7e','fbe1d2G','W7lcNY8','w8o1W77cVa','g8oHW44','FbzxW5/dPge','mmojW6NcP34','oCo1mMnEW4GTqmo0WOnTvCoHr1iCW5m0CcVdGI5dbCkuWOXqvSkddIKk','WOdcGcLvW4mvamoUWRG','WOWUwmo/DtSyWR0V','WP4KW4XoWQC','WR/cVqPGW5a','zSoCW7NdTmov','WPFdLCoVW7mAhWtcHIm','emkNs1WnW4KAWQyTWQe','WQiRW4uw','W5pdH1BdTrWz','yxVdSSojaq','W7aIWQBcPCoIzCo5lG','ggxcGmolWOC','qCkTWQtcGIO','W4uBnGtcVuK','ywtdOCophW','DuRcUa','WO7cGCkpWPZcO8odtw94WOJcGSkGtSoTbJ1YWOn+Cw8mbe4uW6lcPX8','W4iJsSov','ELxcV8ktWOu','W4H6wCkrWQFdTW','D2ldSSougmo9','W6FcNbaMW45mdqe','W4pdLSkNWRlcSW','WOBcHcXaW4id','W6uaeLqu','WRnDWRO','nIhcPmkyl8oeWQpcJKJdTG','rSoJW6JcTb4','lSkcySoMg8kt','z8oqerXv','W6FcOmkmjhe','WRi8W44tW70IBbOhhG','dSo9og/cHW','zCk+EXpdM0RdGCkZo1RcPXTH','WO8RnSoxE8kUt1D0WPnsueKO','W5VcI1ydWQRcP8oOq8kQ','W5tdGCkLWRhcOmouEG','WONdMfZdOay','Ee7cVCkAWPq','W4BcKSkKhvldNa','kvBcKmovWQu','Fmk6cCoV','W5X2ymkd','tmoheGeM','k8oiW4uu','W4RdGCk7WRRcTCoF','WOCMoCovC8kIhILiWOH0rW','W5igmbxcU04','W5mcnHNcPa','w8olW7xdNW','WPpcNcjBW4u','WP1nW7WMWRBcOa','aupcVmojWPldUCoh','oXSZySkR','Cv/dPmodpa','WPldMSo6W6G','pmo/ju4','nw/cSCodWPG','nCoAW4GwWQm','W4NdGbPzFCoxnmoQWRn7','WPdcGJ9BW4u','tCkAlCkQ','WPtcMr5HW58','WQtdQ8oSW7uQbqRcTbK','W78ziX3cJa','WP/cRvrNWOhdKmkZWRFdSgGbWPBcMG','EeRcO8ktWPNcMwdcLMCz','pWGpjvNdKW','WRaOoSoX','W4JdI8kI','nmoiW48i','WOS6W75YWPxdUq','j8oNW4BcILWyxu/dQSkw','qcRcTmkW','WQi6W4OgW7W0','WR/dLWmSrdf8W6WC','WPKDmHFcOuLLWObl','W4xdMGDe','ESkYWQlcSW','n8oTW4tcGG','mSkmvSkpf8oI','W4/dO8oYW5bGBG','WRRdJmo9','W5pdO8oJ','fSooW5K4WRq','ucRcPCkX','bSoTovpcNbhcI8kFBwdcSazeW4FcGt/cSmoDW7jcWOhcG8kJruJcUCkTxsWAWRRcHgnaWQJdVq0','W4pcJmkOWRvZqdBcUWLVD8kZ','WOJdKCoYW6m','W5/dUmo9W5DHB2lcNJNcGSo4','WPBdMfBdVa','vWpcLMFdNG','W4mdod/cSa','W4dcLSkHcfpdIG','o8keACoW','WOSVxa','jmkKB8oniq','nmo6W4xcKLypufBdOa','W4pdICk0WRtcRCoOACo+W6/cVvuzsLRdSq','W4yajaq','W5/dUWGZ','nmofW4xcHhm','eXavF8k+W5mYwYGvf8oqW7m'];e=function(){return ba;};return e();}a();import g from'dotenv';g[J(0x1f8,'KG%@')]();import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x123;let h=c[d];if(f['fWoUSi']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['YIHAjd']=m,a=arguments,f['fWoUSi']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['mRxMNV']===undefined&&(f['mRxMNV']=!![]),h=f['YIHAjd'](h,g),a[k]=h):h=l,h;},f(a,b);}const router=h[J(0x1a9,'Xa5v')]();router['post'](J(0x201,'1JHY'),async(p,q)=>{const an={p:0x13e,q:'3gAz',r:'M^Dp',s:0x173,t:0x15b,u:0x1e1,v:'1JHY',w:'jR93',x:0x1b2,y:'Mo69',z:0x19f,A:'Gxja',B:'1JHY',ao:0x1e6,ap:']V4i',aq:'8gzA',ar:'8gzA',as:'s4ON',at:0x175,au:'I@vx',av:'i9U3',aw:0x176},K=J,r={'lxJHi':function(s,t){return s||t;},'uignu':'Invalid\x20email\x20address','JpHmY':function(s,t){return s<t;},'SGffp':K(0x20b,'%6VW'),'LvRJI':'Password\x20must\x20be\x20at\x20least\x208\x20characters\x20long\x20and\x20contain\x20letters,\x20numbers,\x20and\x20symbols.','dtplO':function(s,t){return s!=t;},'iLCdg':K(0x1a0,'W)o8'),'SBIHj':function(s){return s();},'CVktd':'users','UKPtv':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[K(an.p,an.q)];if(r['lxJHi'](!s,!t)||!u||!v||!w)return q[K(0x157,an.r)](0x190)[K(0x167,'5WgI')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(an.s,'Mo69')](s))return q[K(an.t,'9N4(')](0xc8)[K(an.u,'mJVi')]({'error':r[K(0x170,an.v)]});if(r[K(0x1cd,'3gAz')](v[K(0x1e2,an.w)],0x8))return q[K(an.x,'4HAp')](0xc8)[K(0x165,an.y)]({'error':r['SGffp']});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[K(an.z,an.A)](v))return q[K(0x1c2,an.B)](0xc8)[K(an.ao,an.ap)]({'error':r['LvRJI']});if(r[K(0x197,an.aq)](v,w))return q['status'](0xc8)[K(0x165,'Mo69')]({'error':r[K(0x140,'s4ON')]});const x=await r[K(0x142,an.ar)](k),y=x['collection'](r[K(0x148,'V3Wv')]),z=await y['findOne']({'email':s});if(z)return l[K(0x1a6,'ib(W')](K(0x13f,'6OTf')),q[K(0x1fc,'g&FT')](0x199)['send']();return await y[K(0x1d8,an.as)]({'email':s,'first_name':t,'last_name':u,'role':'user','password':r[K(an.at,'v^X4')](o,v),'email_verify_at':'','created_at':Date[K(0x1c4,an.au)](),'update_at':Date[K(0x192,an.av)]()}),q[K(0x1ad,'3dLs')](0xc9)['send']();}catch(A){l['error'](A);}return q[K(an.aw,'toIN')](0x1f4)['send']();}),router[J(0x191,'7I@1')](J(0x1bd,'5WgI'),n,async(p,q)=>{const ar={p:0x1a2,q:'5dWx',r:'Mo69',s:0x14e,t:0x164,u:0x1cc,v:'Dcoe',w:'v^X4',x:0x206,y:'XR)&',z:0x1d3,A:0x129,B:'1JHY',as:'5]%X',at:0x1b9,au:']V4i',av:0x132,aw:0x1ea,ax:'Gxja',ay:0x1c9,az:'ib(W'},L=J,r={'KpuEF':function(s){return s();},'DEyyP':L(0x1da,'5WgI'),'tACAG':function(s,t){return s(t);},'RFIMV':L(ar.p,ar.q),'yxlSZ':L(0x187,'knwc'),'WdcEl':'x-forwarded-for','ZnKra':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[L(0x168,ar.r)];if(!s||!t)return q['status'](0x190)['send']();const u=await r[L(ar.s,'knwc')](k),v=await u['collection'](r[L(ar.t,'gWFU')])['findOne']({'email':s});if(!v)return q[L(ar.u,'R5n$')](0x194)[L(0x1bc,ar.v)]();if(r[L(0x1b3,ar.w)](o,t)!=v['password'])return q[L(ar.x,ar.y)](0x191)['send']();const w=j[L(0x1d4,ar.v)](r[L(ar.z,'&Yuy')])[L(ar.A,'&Yuy')](r[L(0x1c1,'Mo69')](generateUniqueId))[L(0x1e4,ar.B)](r['yxlSZ']),x=p[L(0x19d,ar.as)][r[L(ar.at,ar.au)]]||p['socket'][L(ar.av,'Gxja')];return r[L(ar.aw,ar.ax)](addSession,v,w,x,p['headers'][L(0x145,'fiC4')]),q[L(ar.ay,'DcSn')](0xc8)[L(0x202,'6OTf')]({'token':w});}catch(y){l[L(0x1a6,'ib(W')](y);}return q[L(0x1e8,ar.az)](0x1f4)['send']();}),router[J(0x1de,'Tv[W')]('/verify',m,async function(p,q,r){const ay={p:'gWFU',q:'mJVi',r:0x15e,s:0x1f5,t:'1JHY',u:0x12e,v:0x1c8,w:0x156,x:'i9U3',y:0x181,z:'Xa5v',A:0x161,B:0x162,az:'ib(W',aA:'W)o8',aB:0x1e0,aC:0x190,aD:'qtnf',aE:0x1ed,aF:0x1c0,aG:'gWFU',aH:0x1c9,aI:'DcSn',aJ:0x1f2},M=J,s={'IvtmD':function(z,A){return z!==A;},'fqNGc':function(z){return z();},'OSyjS':M(0x14c,ay.p),'JMGTg':function(z,A){return z*A;},'FXXFp':function(z,A){return z>A;},'nWnei':function(z,A){return z-A;},'zIRqz':function(z,A,B){return z(A,B);}},{_id:t,email_verify_at:u,...v}=p[M(0x1fb,ay.q)];v[M(ay.r,'fiC4')]=s['IvtmD'](u,'');if(s[M(ay.s,ay.t)](p['user'][M(ay.u,'jR93')],''))return q[M(ay.v,'bb22')](0xc8)[M(0x126,'5WgI')](v);const w=await s[M(ay.w,ay.x)](k),x=await w[M(0x17c,'DcSn')](s[M(ay.y,ay.z)]),y=await x[M(ay.A,'Tv[W')]({'token':p[M(0x13d,']V4i')],'verified':![]});if(y){const z=new Date(y[M(ay.B,ay.az)]),A=s[M(0x1b8,'R5n$')](0xa*0x3c,0x3e8);if(!s[M(0x139,ay.aA)](s[M(ay.aB,'V3Wv')](Date[M(ay.aC,ay.aA)](),z),A))return q[M(0x133,ay.aD)](0xc8)[M(ay.aE,'%6VW')]({'otp':!![]});}return s[M(ay.aF,ay.aG)](sendOTPEmail,p,x),q[M(ay.aH,ay.aI)](0xc8)[M(ay.aJ,'M^Dp')]({'otp':!![]});});const sendOTPEmail=(p,q)=>{const aC={p:'R5n$',q:0x1d1,r:'fiC4',s:'hXOz',t:'7I@1',u:0x147,v:'i9U3',w:0x183,x:'zd4m',y:0x1be,z:0x18f,A:0x152,B:'4HAp'},N=J,r={'PZBgo':function(t,u){return t+u;},'mDTeK':function(t,u){return t*u;},'WqNto':function(t,u,v){return t(u,v);}},s=Math[N(0x1e7,aC.p)](r['PZBgo'](0x186a0,r['mDTeK'](Math[N(aC.q,aC.r)](),0xdbba0)));Promise[N(0x1af,aC.s)]([q[N(0x1b6,aC.t)]({'user_id':p[N(0x1c6,'i9U3')]['_id'],'token':p[N(aC.u,'5]%X')],'code':s,'verified':![],'expired':![],'created_at':Date[N(0x192,aC.v)](),'updated_at':Date[N(0x160,'Xa5v')]()}),r[N(aC.w,aC.x)](send,{'to':p['user'][N(aC.y,'DcSn')],'subject':'One\x20Time\x20Password\x20(OTP)','text':N(aC.z,'Dcoe')+s+N(0x1c5,'toIN')},p[N(aC.A,aC.B)][N(0x14b,'W)o8')])]);};router[J(0x203,'Mo69')](J(0x17b,'g&FT'),m,async function(p,q,r){const aE={p:'okFI',q:0x18a,r:0x1ed,s:0x1e5,t:0x1f0,u:'In(W',v:0x1ab,w:'zd4m',x:'M%C1',y:0x130},O=J,s={'nyvPm':function(t,u){return t(u);}};try{const t=await s['nyvPm'](getUser,p[O(0x172,aE.p)]);return q[O(aE.q,']V4i')](0xc8)[O(aE.r,'%6VW')]({'user':{'email':t[O(aE.s,'1JHY')],'first_name':t[O(aE.t,'6OTf')],'last_name':t[O(0x1ba,aE.u)]}});}catch(u){l[O(aE.v,aE.w)](u);}return q[O(0x184,aE.x)](0x1f4)[O(aE.y,'8XE^')]();}),router[J(0x16a,'5dWx')]('/logout',m,function(p,q,r){const aG={p:0x147,q:'5]%X',r:0x1ff,s:'Dcoe'},P=J,s={'ZiVvV':function(t,u){return t(u);}};return s[P(0x193,'3gAz')](removeSession,p[P(aG.p,aG.q)]),q[P(aG.r,aG.s)](0xc8)[P(0x196,'zd4m')]();}),(function(){const aK={p:0x128,q:'5]%X',r:0x135,s:'1JHY',t:0x14a},Q=J,p={'uloOx':function(r,s){return r(s);},'nsxlT':function(r,s){return r+s;},'IfoKy':Q(0x154,'KG%@'),'kjBsO':function(r){return r();}};let q;try{const r=p[Q(aK.p,'1JHY')](Function,p[Q(0x1d0,aK.q)](Q(0x14d,'zd4m'),p[Q(0x138,'M^Dp')])+');');q=p[Q(aK.r,aK.s)](r);}catch(s){q=window;}q[Q(aK.t,'In(W')](c,0x9c4);}()),router[J(0x12f,'1JHY')](J(0x17a,'zd4m'),[m,n],async function(p,q,r){const aR={p:'KG%@',q:0x1fd,r:'v^X4',s:0x1ee,t:'gWFU',u:0x1ac,v:0x134,w:'emRk',x:0x16c,y:0x199,z:'%6VW',A:0x1cb,B:0x1cc,aS:'R5n$'},R=J,s={'LTZNx':function(t){return t();},'pMobJ':'otp','WCcye':function(t,u){return t*u;},'VrWjl':function(t,u){return t*u;},'odhHM':function(t,u){return t>u;},'hPiiF':function(t,u){return t-u;},'XqrOl':function(t,u,v){return t(u,v);}};try{const t=await s[R(0x16f,aR.p)](k),u=await t[R(aR.q,'v^X4')](s[R(0x131,aR.r)]),v=await u['findOne']({'token':p['token'],'verified':![],'expired':![]});if(v){const w=new Date(v['created_at']),x=s[R(aR.s,aR.t)](s[R(aR.u,'5]%X')](0xa,0x3c),0x3e8);s[R(aR.v,'toIN')](s['hPiiF'](Date[R(0x207,aR.w)](),w),x)&&(await u[R(aR.x,'W)o8')]({'_id':new ObjectId(v[R(aR.y,'8XE^')])},{'$set':{'verified':![],'expired':!![],'updated_at':Date[R(0x19b,'$g]t')]()}}),s[R(0x1d5,aR.z)](sendOTPEmail,p,u));}}catch(y){l[R(aR.A,'jR93')](y);}return q[R(aR.B,aR.aS)](0x1f4)['send']();}),router['post']('/verify/otp',[m,n],async function(p,q,r){const aW={p:0x1ce,q:0x17e,r:'$g]t',s:0x13c,t:'R5n$',u:'3dLs',v:0x208,w:0x206,x:'XR)&',y:0x204,z:'v^X4',A:0x150,B:'i9U3',aX:'Dcoe',aY:0x209,aZ:0x141,b0:0x16d,b1:'jR93',b2:0x185,b3:0x1d9,b4:0x1dc,b5:'&Yuy',b6:0x18e,b7:'qtnf',b8:0x12b,b9:0x190,ba:'DcSn'},S=J,s={'IGMXd':function(t){return t();},'pUSUJ':S(aW.p,'8gzA'),'PcKad':function(t,u){return t*u;},'WusBr':function(t,u){return t*u;},'fRNVw':function(t,u){return t>u;},'FeJHL':S(aW.q,aW.r),'MYBZl':S(aW.s,aW.t),'NLPiY':S(0x1d2,aW.u)};try{const t=p['body'][S(aW.v,'XR)&')];if(!t)return q[S(aW.w,aW.x)](0x190)[S(aW.y,aW.z)]();const u=await s[S(0x198,'knwc')](k),v=await u[S(0x1f7,'I@vx')](s['pUSUJ']),w=await v[S(aW.A,aW.B)]({'token':p['token'],'verified':![],'expired':![]});if(w){const x=new Date(w[S(0x188,aW.aX)]),y=s['PcKad'](s[S(aW.aY,'mJVi')](0xa,0x3c),0x3e8);if(s[S(aW.aZ,'W)o8')](Date[S(0x1fa,'jR93')]()-x,y))return q[S(0x17d,'mJVi')](0xc8)[S(aW.b0,aW.b1)]({'error':s[S(aW.b2,'I@vx')]});}if(w[S(0x195,'v^X4')]!==parseInt(t[S(aW.b3,'jR93')](/[^0-9]/g,'')))return q[S(aW.b4,aW.b5)](0xc8)[S(aW.b6,'Dcoe')]({'error':s['MYBZl']});return await Promise[S(0x1aa,aW.b7)]([v[S(0x17f,'%6VW')]({'_id':new ObjectId(w['_id'])},{'$set':{'verified':!![],'updated_at':Date['now']()}}),u['collection'](s['NLPiY'])[S(0x1b5,aW.t)]({'_id':new ObjectId(p[S(0x155,'DcSn')][S(0x1b1,aW.z)])},{'$set':{'email_verify_at':Date[S(aW.b8,'7I@1')](),'updated_at':Date[S(aW.b9,'W)o8')]()}})]),q[S(0x205,'okFI')](0xc8)[S(0x1b0,'5]%X')]();}catch(z){l[S(0x1c3,aW.ba)](z);}return q[S(0x133,aW.b7)](0x1f4)[S(0x124,'In(W')]();});export default router;function c(p){const b9={p:0x137,q:'hXOz',r:0x12a,s:0x158,t:'ib(W'},b8={p:'XR)&',q:0x159,r:0x180,s:'M^Dp',t:'fiC4',u:0x19e,v:0x1a8,w:'5WgI',x:0x1eb,y:'DcSn',z:'I@vx'},T=J,q={'DncLo':function(s,t){return s===t;},'rSaBX':T(0x1a1,'iqJ0'),'VSwZe':'counter','QPMwZ':function(s,t){return s!==t;},'uIwcQ':function(s,t){return s+t;},'pKhuY':function(s,t){return s/t;},'vHCNW':T(b9.p,b9.q),'eCHWQ':function(s,t){return s===t;},'xGcOU':function(s,t){return s%t;},'KAPIw':function(s,t){return s+t;},'lFGCI':T(0x1fe,'9N4('),'oMMvE':'action','KzBoX':T(b9.r,'fiC4'),'rRXlN':'stateObject','HvTLX':function(s,t){return s(t);}};function r(s){const U=T;if(q[U(0x19c,'Gxja')](typeof s,'string'))return function(t){}[U(0x125,b8.p)](q['rSaBX'])['apply'](q['VSwZe']);else q[U(0x15c,'8XE^')](q[U(0x179,'g&FT')]('',q[U(b8.q,'I@vx')](s,s))[q[U(b8.r,b8.s)]],0x1)||q['eCHWQ'](q[U(0x12c,b8.t)](s,0x14),0x0)?function(){return!![];}[U(b8.u,'bb22')](q['KAPIw'](q['lFGCI'],U(0x149,'s4ON')))[U(b8.v,b8.w)](q[U(0x127,'5dWx')]):function(){return![];}['constructor'](q[U(b8.x,b8.y)](q['lFGCI'],q[U(0x1dd,'gWFU')]))[U(0x1c7,b8.z)](q['rRXlN']);q[U(0x1ae,'KG%@')](r,++s);}try{if(p)return r;else q[T(b9.s,b9.t)](r,0x0);}catch(s){}}