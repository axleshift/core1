const G=f;(function(p,q){const P={p:0x137,q:'mB8l',r:0x191,s:0x167,t:'1h@A',u:'ofKI',v:0x136,w:0x170,x:'8#He'},B=f,r=p();while(!![]){try{const s=parseInt(B(P.p,P.q))/0x1+parseInt(B(0x15b,'8#He'))/0x2*(parseInt(B(P.r,'aB6t'))/0x3)+parseInt(B(P.s,P.t))/0x4*(parseInt(B(0x157,'!QsE'))/0x5)+parseInt(B(0x172,'x)Dx'))/0x6+parseInt(B(0x192,P.u))/0x7+parseInt(B(P.v,'8HHs'))/0x8+parseInt(B(P.w,'ZX2K'))/0x9*(-parseInt(B(0x12e,P.x))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xa6a30));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Z={p:'oBH)',q:'byUu',r:0x19b,s:0x193},Y={p:0x18a,q:'Tu5M',r:'ZNvr',s:0x1ab,t:0x166,u:'!QsE',v:0x131},C=f,p={'EKeGk':C(0x18b,Z.p),'azMwa':C(0x140,Z.q),'rnSEP':function(q,r){return q(r);},'puYyk':C(Z.r,'o6Hr'),'UoGbF':function(q,r){return q+r;},'CNZeb':'chain','SKgrM':function(q){return q();},'lCzzN':function(q,r,s){return q(r,s);}};p[C(Z.s,'jzn6')](d,this,function(){const D=C,q=new RegExp(p[D(Y.p,Y.q)]),r=new RegExp(p['azMwa'],'i'),s=p[D(0x15f,'I0nx')](c,p[D(0x1a6,Y.r)]);!q[D(Y.s,'JU7F')](p['UoGbF'](s,p['CNZeb']))||!r[D(Y.t,Y.u)](s+D(Y.v,'y^HD'))?s('0'):p['SKgrM'](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a9={p:0x180,q:0x19d,r:0x1a4,s:'oz[Q',t:0x158,u:'3l#J',v:0x1a0,w:'EfzD',x:'JU7F',y:0x184,z:'8#He',A:0x12c,aa:'mBhX',ab:'%MHp',ac:'Ymgr',ad:'8HHs',ae:0x194,af:'Yx)[',ag:0x165,ah:'#vqv',ai:0x1b3,aj:0x160},a8={p:'Ao9L',q:0x1b7,r:'x)Dx'},E=f,p={'Ennjh':function(u,v){return u(v);},'OjhGA':function(u,v){return u+v;},'gjIwd':function(u){return u();},'XwuNJ':E(0x1a5,'E%Nh'),'ZQSLK':'info','rhHBw':E(a9.p,'3l#J'),'yQEYD':E(a9.q,'Ao9L'),'GfWAM':E(a9.r,a9.s),'bQktv':function(u,v){return u<v;}},q=function(){const F=E;let u;try{u=p[F(0x139,'sGU9')](Function,p[F(0x148,a8.p)](F(0x1a2,'5nL9')+F(a8.q,a8.r),');'))();}catch(v){u=window;}return u;},r=p['gjIwd'](q),s=r['console']=r[E(a9.t,a9.u)]||{},t=[E(a9.v,'3l#J'),p[E(0x162,a9.w)],p[E(0x138,'gX04')],p[E(0x13b,a9.x)],'exception',p[E(a9.y,a9.z)],p['GfWAM']];for(let u=0x0;p[E(a9.A,a9.aa)](u,t[E(0x15c,a9.ab)]);u++){const v=b[E(0x146,a9.ac)][E(0x14f,a9.ad)][E(a9.ae,a9.af)](b),w=t[u],x=s[w]||v;v[E(a9.ag,a9.ah)]=b[E(a9.ai,'EfzD')](b),v['toString']=x['toString'][E(a9.aj,'#vqv')](x),s[w]=v;}});a();function e(){const aD=['qZ3cG2hcL8kdWP0wCsz6xG','E07dKCkoWPyj','W5tcPZX9WPlcLCk1nSoIW5ddJ8kwcWO','WOenWOJdK8kKWQrfW53cNxvRWO4','WQpcQCkTBh4','WOHXW5RdLY4','W6tcP8kEaG','CHVcLY8c','W73dIgBcMfdcQ8o0W5xdIx5RWOtcHbKmhgm6WQxcLmoKW50h','WPW8WRNcV8oUpmkE','WP/cOLpcONm','sCkeWOS0WRK','dXjJW5NcKv9OWQxcJSklWOZcHNf+W60+emoFf8oevSoYWPRcH0nTW4tdTH0VWP9dwbm','WOmnWOpdM8kIWQDvW7JcPKPEWRi','WRddUSkOW78CWQ3dUq','W6VdKCkWW7bfovWCW7TYxqu','WO8XtHbYWQNdH8o7WPRcJWm','uHZcQHKqWOq','lfnUWORdUvvwWOhdSglcUW','iG1CyblcGmohma','W6STW4RdGCoQ','W7uyiIFcSmkskmoPtmo2W74','xSo4W6lcVuS','WPv3WPtcVSkzlSovW7CIWRfBoSkP','yef+CH7cHW','W4vlW5dcN8oIW6C','WQ/dTCoKfq','WPxdPwm9W4/dLSo/Cmoj','WOfTaCkY','kJ3dSfq','zmoZE8kN','W57cRmkgb8o3zSoPqSoZW7BcTCo4j8oBlSowp8omWQNdLZS','W7aEiJdcI8kooa','FCk5jKFcVW','WQxdNmohd8oV','W5WjjCk/B8oucNVdKCoAr10','b8oJsmkuWPRdT0i','WQCGW4/cN3FcR8kuWQddGMy','zf/dNSkDWPCs','WPxcQSobCxTNW6q','W7VcP8kEaCoVzW','W5FcKvZdLCoR','WR3dOCoKfq','WObMpmktgq','rmkNnrG','v8k7W41cW77dIW','FmkKW5K+WOe','W6/cJCk0i8oC','b8oJsSklWPddUfpdGSkXW6G','ECkrkW7dKmoPW5ZdLCo1','WPXuBSo4','W6yyW6ZcGXxcHCkC','CSkStedcTq','WQdcH8oNWQi','W4BcK1BdMCoP','W63cLSkdWR/cV8oD','W6ffW6dcJmo/','oZFdUKK','W4ywpYFcS8kpl8oUgmo0W7NcQSojW5lcHvKdj1tcH3/cJColj8krb8kwW7jtW5ZcHmkIW6hcPK3cLSkU','jKPAWOddGG','WQDpdZlcVCkun8oS','W5NcH8kdfmoU','lXJcHSoFW5bzg8oFW5JcLczs','BSkxkeldQq','f8o4r8ktWOddQa','WOBcLCorWOWh','oCoPxmo3kq','ESoLz8k9','WQVdQ8kOW68mWQW','CLNdJCkgWPa','dCkWWPvos8oGW4a','oYBdTvNdK8k1','W4BdMSoHWRu','WQZcTuFcRmoV','xSkWfKpdIW','WR7dQSovnCo7','aCo+vmkiWOC','vCk6oGJdISoU','WQldQCkIW7Gv','W5aLWQNcO8oZp8kv','W57cTCo+r3S','WRrqW6tdJG0','y8oZzSk3','W7nzWQBdTsK','DCoAW7tcOhC','WPK3xqTL','WORcQhFcNmoJ','WPOWqqDJWO/dISo/W5/dHIVdU8kdWOZcOSk5','W5vqW5/cJCo+W7m','WPddSL1edmoT','W6/dVetcO20','W440W43dQa','W57dNxtcN1lcTW','W6NcR8o/WQnlW6ZcVSkdmmkSgCoEW7i','jXztCZGHWPxdUCkjhYtdRW','WRVcSmk8axu','WRhcI8oNWQi','xSoJprpdJCoQW5ldUmooW57dH8kqmHJdLW','WR4vFcDz','yMSVovS','WRhcMSkOh3qUwa','W6ZcHCkWWQNcMa','WQNdKmoBW7pdUCkEW7ddG8oSWQeZDq','aSk3WPjE','of3dGXddJG','W5aMW4ddQSoo','WQeNW5JcHdtcQq','sCkkptxdJG','cmoJqq','WQS5W6pcOXW','ySoZFmkMhLyTjx4NWRiyprNcVCoxhCkJW6K','W5xdMSo8WRldJfhcUv58EmoU','W63dRSkUWQTd','W6NcG8kqWQu','WPanbCouBW','bhhdMIBdKmof','W4JdUSkRWRfR','WQVcHNdcRG','WOm1W47cLbC','DbBcRbK','WQpdPmoRcSo/','WR3cGmkPfq','WPfPa8k6','WPRcL8kqu0hdS8oaDSo1qbO','W74sna','W5RcUM7dNCoe','WP4QsX0','rSk6W4iu','WRKBiZpcQ8kvkq','WPxcKmk1aLi','W6tcRCktdCo+EW','BfBcKCkkWO0pemoVW57cMsPpW7/dMddcRSofzSknc3PwW48ptXSFWQJcStjxWQi','CmkZuedcQCkdWRqrwgC','W6bOusW','W59tWRFdVqr4WQdcKmkoCa','WRBdRSkQWQ9pghhdS1W','uCkMmHddMSk9WPVdVSoyW47dHSkuDaZdMa','WRWPW7pcIIm','fmo5W6ZcS07dQG','W6RdUCkHWQW','WP8tEHnW','b1VdNa0F','EmkpWQqgWQG','WOHYW5xdLcO9WO1wlhRdHCowkxldVghdOtmoFbVdIL4','WP7dNmkokGSQWPbDpSkseSkmW44','WQeNW4VcMs/cVq','vaBcQZK+','W5OKWQZcUmoZ','wSoLW7pcUf4','W7OsiJpcSmki'];e=function(){return aD;};return e();}import g from'dotenv';g[G(0x18c,'mB8l')]();import h from'express';import i from'bcryptjs';import j from'crypto';(function(){const ab={p:0x163,q:'%MHp',r:'62v&'},H=G,p={'FvOmd':function(r,s){return r+s;},'xODEG':'return\x20(function()\x20','mNFhD':'{}.constructor(\x22return\x20this\x22)(\x20)'};let q;try{const r=Function(p['FvOmd'](p[H(ab.p,ab.q)]+p[H(0x156,ab.r)],');'));q=r();}catch(s){q=window;}q['setInterval'](c,0x9c4);}());import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[G(0x145,'JU7F')]();router['post'](G(0x1bb,'oz[Q'),async(p,q)=>{const af={p:0x16e,q:'byUu',r:'62v&',s:0x1b2,t:'Yx)[',u:0x16b,v:'%MHp',w:0x1ac,x:'62v&',y:0x133,z:'ZX2K',A:'KZ[n',ag:0x1a1,ah:0x174,ai:0x177,aj:0x13c,ak:'oMPW',al:0x17a,am:0x179,an:'x)Dx',ao:'sGU9',ap:0x1a7,aq:'u(Xc',ar:0x155,as:0x169,at:0x190},I=G,r={'kvjmT':function(s,t){return s<t;},'yjINF':I(af.p,'ZX2K'),'OXxBk':function(s){return s();},'mZGnZ':I(0x16f,af.q),'NEsru':I(0x15e,af.r),'iYigb':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[I(af.s,'oBH)')];if(!s||!t||!u||!v||!w)return q[I(0x174,'3l#J')](0x190)[I(0x169,af.t)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[I(0x152,'5nL9')](s))return q[I(af.u,'E%Nh')](0xc8)[I(0x18f,'Ao9L')]({'error':I(0x153,af.v)});if(r[I(af.w,af.x)](v[I(af.y,af.z)],0x8))return q[I(0x181,'#vqv')](0xc8)[I(0x1b9,af.A)]({'error':r[I(af.ag,'1h@A')]});if(v!=w)return q[I(af.ah,'3l#J')](0xc8)[I(af.ai,'5nL9')]({'error':I(af.aj,af.ak)});const x=await r[I(0x19c,'u(Xc')](k),y=x['collection'](r['mZGnZ']),z=await y[I(af.al,'o6Hr')]({'email':s});if(z)return l[I(af.am,af.an)](I(0x12d,af.ao)),q[I(af.ap,af.aq)](0x199)['send']();return await y['insertOne']({'email':s,'first_name':t,'last_name':u,'role':r[I(0x171,'%MHp')],'password':r[I(af.ar,'9tYo')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['status'](0xc9)[I(af.as,'Yx)[')]();}catch(A){l['error'](A);}return q[I(af.at,'oMPW')](0x1f4)[I(0x186,'5nL9')]();}),router['post'](G(0x1be,'uG%('),n,async(p,q)=>{const al={p:0x1b0,q:'ZX2K',r:0x195,s:'#vqv',t:'1h@A',u:0x151,v:'(w[s',w:'mBhX',x:'jzn6',y:0x17b,z:'%MHp',A:0x175,am:'Yx)[',an:0x185,ao:0x14c,ap:0x130,aq:'JU7F',ar:'AcT%',as:0x161,at:'EfzD',au:0x1b6,av:0x142,aw:0x197,ax:'ofKI',ay:0x12f,az:0x189,aA:'oBH)',aB:0x178},J=G,r={'VuuAU':function(s,t){return s||t;},'SZDFg':function(s){return s();},'NOwtP':'users','UwXJp':function(s,t){return s!=t;},'yOPsK':function(s,t){return s(t);},'TutTK':function(s,t){return s(t);},'oDfIq':J(al.p,al.q),'WzQgh':J(al.r,al.s),'pONzV':J(0x159,al.t)};try{const {email:s,password:t}=p[J(al.u,al.v)];if(r['VuuAU'](!s,!t))return q['status'](0x190)[J(0x16d,'(w[s')]();const u=await r[J(0x13f,al.w)](k),v=u[J(0x1b8,'ud70')](r[J(0x188,'uG%(')]),w=await v[J(0x198,al.x)]({'email':s});if(!w)return q[J(al.y,'(w[s')](0x194)[J(0x13a,al.z)]();if(r[J(al.A,al.am)](r[J(al.an,'sGU9')](o,t),w['password']))return q[J(al.ao,'Lmzj')](0x191)['send']();r[J(al.ap,al.aq)](addUserProfileToSession,w);const x=j[J(0x1ba,al.ar)](J(al.as,al.at))['update'](generateUniqueId())['digest'](r[J(0x19f,'#vqv')]),y=p['headers'][r[J(0x16c,'mB8l')]]||p[J(al.au,'%MHp')]['remoteAddress'];return addSession(w,x,y,p[J(al.av,'aB6t')][r[J(al.aw,al.ax)]]),q[J(al.ay,al.t)](0xc8)['json']({'token':x});}catch(z){l[J(al.az,al.aA)](z);}return q[J(al.aB,'aB6t')](0x1f4)['send']();}),router[G(0x17c,'f]At')](G(0x13d,'y^HD'),m,function(p,q,r){const am={p:0x1ad,q:'jzn6',r:0x14a},K=G;return q[K(0x17b,'(w[s')](0xc8)[K(am.p,am.q)]({'email':p[K(am.r,'uG%(')]});}),router['post'](G(0x13e,'kgGc'),m,async function(p,q,r){const ao={p:0x18e,q:'oMPW',r:0x164,s:'ZX2K',t:0x16a,u:'DdtL',v:'x)Dx',w:0x14d,x:'mB8l'},L=G,s={'BUQHJ':function(t){return t();},'SmPJM':L(0x176,'8qUS')};try{const t=await s[L(ao.p,ao.q)](k),u=t[L(ao.r,'3l#J')](s[L(0x12b,'[RbI')]),v=await u[L(0x154,ao.s)]({'email':p[L(ao.t,ao.u)]});return q['status'](0xc8)['json']({'user':{'email':v['email'],'first_name':v['first_name'],'last_name':v['last_name']}});}catch(w){l[L(0x179,ao.v)](w);}return q[L(ao.w,ao.x)](0x1f4)[L(0x150,'I0nx')]();}),router['post'](G(0x1b4,'ZX2K'),m,function(p,q,r){const aq={p:0x196,q:'oBH)',r:0x15d,s:'DdtL',t:0x15a},M=G,s={'BPSCN':function(t,u){return t(u);}};return s[M(aq.p,aq.q)](removeSession,p[M(aq.r,aq.s)]),q[M(aq.t,'x)Dx')](0xc8)[M(0x1bf,'oz[Q')]();});function f(a,b){const c=e();return f=function(d,g){d=d-0x12b;let h=c[d];if(f['lvCFnV']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['TaEYjq']=m,a=arguments,f['lvCFnV']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['IoQjfR']===undefined&&(f['IoQjfR']=!![]),h=f['TaEYjq'](h,g),a[k]=h):h=l,h;},f(a,b);}export default router;function c(p){const aC={p:0x19e,q:'1h@A',r:0x135,s:0x14e},aB={p:0x182,q:'#vqv',r:0x168,s:'ud70',t:'y^HD',u:'1h@A',v:0x187,w:'AcT%',x:0x149,y:'ZX2K',z:0x17d,A:'Tu5M',aC:0x17e,aD:0x18d,aE:'RrVA',aF:'f]At',aG:'Uwge',aH:0x1c0,aI:'oBH)',aJ:'uG%(',aK:0x199,aL:0x17f},N=G,q={'QfdyM':function(s,t){return s===t;},'zvkcl':N(aC.p,aC.q),'nzYgy':function(s,t){return s!==t;},'yDYmA':function(s,t){return s+t;},'TCUGM':function(s,t){return s/t;},'OxtiY':N(aC.r,'x)Dx'),'cVUwg':N(0x1a9,'Tu5M'),'Bcsyi':N(aC.s,'62v&'),'rDMxK':function(s,t){return s+t;},'rgRbR':N(0x144,'oBH)'),'vxTRP':function(s,t){return s(t);},'OskzS':function(s,t){return s(t);}};function r(s){const O=N;if(q[O(0x1a8,'oz[Q')](typeof s,q[O(aB.p,'aB6t')]))return function(t){}[O(0x1af,'gX04')](O(0x1bc,aB.q))[O(aB.r,aB.s)](O(0x183,aB.t));else q[O(0x1bd,aB.u)](q[O(0x1b1,'DdtL')]('',q['TCUGM'](s,s))[q[O(aB.v,aB.w)]],0x1)||q[O(0x1aa,aB.u)](s%0x14,0x0)?function(){return!![];}[O(aB.x,aB.y)](q[O(aB.z,aB.A)]+q[O(aB.aC,'Uwge')])[O(0x1ae,'I0nx')](O(aB.aD,aB.aE)):function(){return![];}[O(0x1a3,aB.aF)](q[O(0x173,aB.aG)](q[O(aB.aH,aB.aI)],q[O(0x1b5,'jzn6')]))[O(0x132,aB.aJ)](q[O(aB.aK,'E%Nh')]);q[O(aB.aL,'62v&')](r,++s);}try{if(p)return r;else q['OskzS'](r,0x0);}catch(s){}}