const G=f;(function(p,q){const Q={p:0x1a7,q:'F8za',r:0x198,s:'B[sy',t:0x17e,u:'SQN^',v:'Xa1n',w:0x191,x:0x140,y:'qm(*',z:0x182,A:'#!U3',R:0x1c5,S:'AtQQ'},B=f,r=p();while(!![]){try{const s=parseInt(B(0x134,'AtQQ'))/0x1+parseInt(B(Q.p,Q.q))/0x2+-parseInt(B(Q.r,Q.s))/0x3+parseInt(B(Q.t,'z#a7'))/0x4*(-parseInt(B(0x18d,Q.u))/0x5)+parseInt(B(0x1b5,'S4Il'))/0x6*(parseInt(B(0x179,Q.v))/0x7)+-parseInt(B(Q.w,Q.u))/0x8*(parseInt(B(Q.x,Q.y))/0x9)+parseInt(B(Q.z,Q.A))/0xa*(-parseInt(B(Q.R,Q.S))/0xb);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x8d6a5));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:')f3U',q:0x16a,r:'cmU]'},a0={p:'zkXw',q:0x15c,r:'Os!d',s:'YAYu'},C=f,p={'kFptt':C(0x18b,a1.p),'aTVOK':function(q,r){return q(r);},'mcbvJ':function(q,r){return q+r;},'CZETt':C(0x167,'k6TO'),'qcqZG':function(q,r){return q+r;},'XOjWL':C(a1.q,a1.r),'xZQYO':function(q,r){return q(r);},'WfDow':function(q){return q();}};d(this,function(){const D=C,q=new RegExp(p['kFptt']),r=new RegExp(D(0x13a,a0.p),'i'),s=p[D(a0.q,'HG]A')](c,'init');!q['test'](p['mcbvJ'](s,p[D(0x162,a0.r)]))||!r[D(0x1bc,'Os!d')](p[D(0x190,a0.s)](s,p[D(0x144,'YAYu')]))?p['xZQYO'](s,'0'):p['WfDow'](c);})();}());const b=(function(){const a2={p:0x16e};let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(a2.p,'cmU]')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aa={p:0x131,q:0x197,r:'8R4l',s:'cmU]',t:'Xa1n',u:0x187,v:'k6TO',w:0x14a,x:'#!U3',y:0x13e,z:'[HfN',A:']0W^',ab:0x135,ac:0x193},F=f,p={'zsSYu':function(t,u){return t(u);},'bXgjh':function(t,u){return t+u;},'ZLFTR':function(t,u){return t+u;},'ChUZX':'return\x20(function()\x20','nykcZ':function(t){return t();},'cbIzF':F(0x133,'T^N7'),'uVUmt':'warn','zcruH':F(aa.p,']0W^'),'CTwts':'error'};let q;try{const t=p['zsSYu'](Function,p[F(aa.q,aa.r)](p['ZLFTR'](p[F(0x18a,aa.s)],F(0x1c3,aa.t)),');'));q=p['nykcZ'](t);}catch(u){q=window;}const r=q['console']=q['console']||{},s=[p[F(aa.u,aa.v)],p[F(aa.w,aa.x)],p[F(0x1b1,'#!U3')],p['CTwts'],F(aa.y,aa.z),F(0x148,'Aaf0'),F(0x18e,'Ix2M')];for(let v=0x0;v<s[F(0x175,aa.A)];v++){const w=b[F(0x1a4,'YAYu')]['prototype'][F(aa.ab,'Os!d')](b),x=s[v],y=r[x]||w;w['__proto__']=b[F(0x17c,']0W^')](b),w[F(aa.ac,'YAYu')]=y[F(0x177,'J6jH')][F(0x1c2,'&t1[')](y),r[x]=w;}});a();function f(a,b){const c=e();return f=function(d,g){d=d-0x12f;let h=c[d];if(f['RPFYuy']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['ndZhMr']=m,a=arguments,f['RPFYuy']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['fTkIUc']===undefined&&(f['fTkIUc']=!![]),h=f['ndZhMr'](h,g),a[k]=h):h=l,h;},f(a,b);}import g from'dotenv';g[G(0x1b3,'Mex!')]();function e(){const aH=['W5pcSmonW6m1','W6xdL0VdI0K','csRdK8k1jJFdImkcDmkjW7i','emkayZ1LzGO','ELLUfLG','uCoQBXbo','W7ZdISkqyX0','rSoJWPSnW5e','iZ8DW6VcTa','d2eJk8opWR0odSoJW40','pSo/WO9HgvO','ESkOWOxcTSox','ACktWRpcKCouW6jfhhq1omocWOmVW515lvBcN8koiWyz','ESk7ghxdTa','hr4DW6VcRCkO','W6GJW7ddKsK','FCknvCo6ma','W7K/W7RdTsC','W6mxW7/dS8oqWP1K','ySkmdSonWQu','lCoziSoP','hmohWQztWP4','hmoyWRvvWOa','ASksdSouWQG','E8o4W6jNWQ3dPq','f8ktvmoAW54','W7pcJtvzFa','iCo6W6nHWRddS8k4W7WQ','jmkZW78SW697WO0','WR8vW7VdTComWOG','aG8sW7JcRmkZ','z8orWQ4P','FmolWPSaW5idvmo2','W6KjW6ddJZK','WQ7dTem5nNJcKburcqW','dw4IlSkxW6aidSokW4HbqG','B8k/WOhcIwq','damsW7S','wLGJW4y','aXL1WPRcR3T1FSokW6G','W5/cPZqKWOi','dJmzkG','ku7dISoppCo3aM7dVcq','A1OGWRfNwCoawGhdKq','WPRcHgNdMMa','aK86smktgY4yjCkNW4C','WRxdGSo7jmkmaCoNesRdN8kaWRpdHMdcO8ozW57cMqC','W5hdJNiOeG','FCkhFCoPga','qcn3B8om','WRSjW7pdRCoCW5S1W6tdT3OqsGFdRSkp','smkkk8oIWOK','ECk8bhNdSItdHtRcISkJsY/dV3hcU8on','sSkgWQhcLSowW74','iCkMk8kidmooWPW5ASok','WP/cImkBBmkZ','W5JcVIOSWRqtW7u','tSkpFqbn','iSkNkSknD8kEWP0nwmoHvve','DCk6WQrNfgqcxW','s8kdxY54EHdcRG','emkkDSoqW6C','W77cSWnTFW','DCkiBSoxbG','BmoqW6fSWRe','FXBcLSkwBSkJp33dVaBdSrW','fYuyia','WQldLCo9pSkm','xSkwWQddU1q','bqizoYy','adBdKSkO','zN9ybNVdIwe','xmkaWRlcJCor','d1tcUxtdU8oJWOm2F0rsomkSW4P1','r8k9xSoKW7aGbebdW4a','i8kgW5SkW7K','W6/dP1VdGvm','xmkdyIL+yqVcQSk5otC','WOhdRmk0tIS','W5pcG8oKW70AWPi','rKddRsVcUCkJW5a2te5CDmk5','c23dUvi','FmkMbgNdSJ/dNZFdNSoMzq','pSoUWObX','uCkoBSoGW5C','WRtdGSoHnq','W43dQL/dTvtdMCkwa3XsW7K','l8opnq','qmoQW4DsWPG','m2FdN1Dn','jGfJW7rb','ztnYnmo7','WQtdImoHn8kxca','W7hdOSk5pIruWOBcIvqh','WPfaWRZcRdvMyKbekq','WPxdTY80AG','zmoPvXP1','f8kcu8oC','WQ3dSuu4nvJcJZqenJW','W4b9kmkh','WPVcLCkjEW','tCkxWRpcLG','W53cTIGK','gIRdJSkY','D8oBWRuJdLhcNW','iINcHKpdNG','C8ozW6yxW48esCoLy8ooW73dKCkTW4b3hb8BomkIWOlcVqPca8kXtwhcNZzNdG','W4ZdSmkPtW','W6tcVL1IAvNcRquHeG7dJZZcIComwNhdSSk9dCkynSk7WO/dGv/dUGnzWQFcGSk4','avNdH3HM','W63cG31SdWxdVMqQD0O','W5BcSIuSWP4pW6m','W57dHSkTnqC','dHdcMCkU','bWqAW7a','W6NdU0u0jmoI','bIRdMG','W67cGxTLcf7cMfSLxL3cICow','w8kBWQ7cHG','yCooWQOAW4q','W6elW7RdIYS','W4lcMmoHW7a','t8kdFY4','W47cPSkjEweDW5RdNWeYimoyw8kBWPDWtmo9WRldQaJcKNxcI0zvAmoDp1JcTmo6W5Hn','nhWdha','W6f3m8kxW4Pj','B8oRW7jVWRBdRG','W4xcJ8oMW6WFWPueW7ddKG','omo4WOTNhW','WOSPdmkrW5D2W6Wn','xCkPWOVcSevB','WO3cJgxdNhJcOXXiWQfQEw7dJq','i0/dLCogkSoGowNdTG','z8kJzG1g','ccuspa','arL8WP3cQ0TBt8oMW6G','hJKBiG/dNmoHiSkZWP0','tdHWD8oe','WQVdGSoHnSkkbW','ktreW6X9','WQZdHsOHsrK','CCozWQeKfG','qaXRbmowjW','W73dVuGipW','fqXNW6bLwSoRacldTCkaW6jxhhBdJmkKySkeWR7cIq','pmk5W608','reVdPINdHCogWOqgyuG','oaT2W6r6rW','qSk4WOtcO0ra','WPldHSkZWRKAWQi9W5pdNSke','p1ldG8orDCo1ewldVt4','WPxcMMFdNq'];e=function(){return aH;};return e();}import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[G(0x13c,'qm(*')]();router[G(0x1bb,'Ix2M')](G(0x172,'8R4l'),async(p,q)=>{const af={p:0x145,q:'MiLw',r:0x1ba,s:'qm(*',t:'GEpi',u:'#!U3',v:'HG]A',w:0x174,x:0x19d,y:0x19c,z:'MiLw',A:0x17d,ag:'z#a7',ah:0x163,ai:'Os!d',aj:'zkXw',ak:'IX)9',al:'IOAH',am:0x143,an:'S4Il',ao:'vTLr',ap:0x18c,aq:'Mex!',ar:0x1a6,as:'[HfN',at:0x180},H=G,r={'qYINg':function(s,t){return s||t;},'TWnEp':function(s,t){return s<t;},'xTnuL':function(s,t){return s!=t;},'GuEeE':'users','KAVhC':'Email\x20id\x20already\x20exists','JxjSy':H(af.p,af.q),'tmKhq':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[H(0x138,'[HfN')];if(r['qYINg'](!s,!t)||!u||!v||!w)return q['status'](0x190)[H(af.r,af.s)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/['test'](s))return q['status'](0xc8)[H(0x156,af.t)]({'error':H(0x14f,af.u)});if(r[H(0x1b7,af.v)](v[H(0x149,'Mex!')],0x8))return q[H(af.w,'3Goq')](0xc8)[H(af.x,'T^N7')]({'error':'Password\x20must\x20be\x20greater\x20than\x208\x20digit'});if(r[H(af.y,af.z)](v,w))return q[H(0x161,'IOAH')](0xc8)[H(af.A,af.ag)]({'error':H(af.ah,af.ai)});const x=await k(),y=x[H(0x1b4,af.aj)](r['GuEeE']),z=await y[H(0x19e,af.ak)]({'email':s});if(z)return l[H(0x164,')f3U')](r[H(0x186,'PXAU')]),q[H(0x132,'PXAU')](0x199)[H(0x1aa,af.al)]();return await y[H(af.am,'B[sy')]({'email':s,'first_name':t,'last_name':u,'role':r[H(0x178,af.an)],'password':r[H(0x194,af.ao)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[H(af.ap,'Os!d')](0xc9)[H(0x1ac,'Mex!')]();}catch(A){l[H(0x19a,af.aq)](A);}return q[H(af.ar,af.as)](0x1f4)[H(af.at,af.z)]();}),router[G(0x13b,'VUNx')]('/login',n,async(p,q)=>{const ak={p:0x13f,q:'IOAH',r:0x1ae,s:0x165,t:'$(iE',u:0x181,v:'B[sy',w:'8R4l',x:0x18f,y:0x1b8,z:0x136,A:'J6jH',al:'zkXw',am:'qi0*',an:0x16f,ao:0x152,ap:'#!U3',aq:0x17b,ar:'iPvn',as:'F8za',at:0x142,au:0x14b,av:0x199,aw:'vofa'},I=G,r={'pZBwS':function(s){return s();},'NbATA':I(ak.p,ak.q),'ijbnd':function(s,t){return s!=t;},'LKxgF':function(s,t){return s(t);},'AbkMT':I(ak.r,'!9OX'),'MUatl':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[I(0x130,'X(3U')];if(!s||!t)return q[I(ak.s,']0W^')](0x190)['send']();const u=await r[I(0x1ab,ak.t)](k),v=u[I(ak.u,ak.v)](r[I(0x1af,ak.w)]),w=await v[I(ak.x,'K[6!')]({'email':s});if(!w)return q['status'](0x194)[I(ak.y,'vTLr')]();if(r[I(ak.z,ak.A)](r[I(0x12f,ak.al)](o,t),w['password']))return q[I(0x14d,ak.am)](0x191)[I(0x1ba,'qm(*')]();r['LKxgF'](addUserProfileToSession,w);const x=j['createHash']('sha256')[I(ak.an,'8R4l')](generateUniqueId())[I(ak.ao,ak.ap)](r[I(ak.aq,ak.ar)]),y=p[I(0x1c6,'K[6!')][I(0x1a0,ak.as)]||p['socket'][I(ak.at,'GEpi')];return r[I(0x15f,']0W^')](addSession,w,x,y,p[I(0x173,'%IXR')][I(0x155,'B[sy')]),q[I(ak.au,'AtQQ')](0xc8)[I(ak.av,'MiLw')]({'token':x});}catch(z){l[I(0x16c,ak.aw)](z);}return q['status'](0x1f4)[I(0x1a8,'8hTm')]();}),(function(){const aq={p:0x1c1,q:'J6jH',r:0x171,s:'Xa1n'},ap={p:'S4Il',q:0x157,r:'vTLr',s:'J6jH'},J=G,p={'BzpWk':function(s,t){return s(t);},'xzetm':function(s,t){return s+t;},'sGHjZ':function(s,t){return s+t;},'stibH':J(0x185,'Mex!'),'NGSyq':J(aq.p,aq.q),'lNFXz':function(s){return s();}},q=function(){const K=J;let s;try{s=p[K(0x137,ap.p)](Function,p[K(0x188,'Aaf0')](p[K(ap.q,'[HfN')](p[K(0x170,ap.r)],p[K(0x15e,ap.s)]),');'))();}catch(t){s=window;}return s;},r=p[J(aq.r,aq.s)](q);r['setInterval'](c,0x9c4);}()),router[G(0x150,'%IXR')](G(0x169,'3Goq'),m,function(p,q,r){const ar={p:'vofa'},L=G;return q['status'](0xc8)['json']({'email':p[L(0x16d,ar.p)]});}),router[G(0x139,'YAYu')](G(0x1a5,'&t1['),m,async function(p,q,r){const at={p:'IX)9',q:0x1c0,r:0x183,s:'GEpi',t:0x141,u:0x16b,v:'!9OX',w:0x14c,x:0x176},M=G,s={'zOXtl':function(t){return t();},'UPYXW':'users'};try{const t=await s[M(0x15b,at.p)](k),u=t[M(0x147,'MiLw')](s[M(at.q,'F8za')]),v=await u['findOne']({'email':p[M(at.r,at.s)]});return q[M(at.t,'iPvn')](0xc8)[M(at.u,at.v)]({'user':{'email':v[M(at.w,'J(Sb')],'first_name':v[M(0x1a1,'$(iE')],'last_name':v['last_name']}});}catch(w){l[M(0x19f,'Os!d')](w);}return q['status'](0x1f4)[M(at.x,'J(Sb')]();}),router[G(0x1be,'T^N7')](G(0x15a,'YAYu'),m,function(p,q,r){const av={p:0x1a2,q:'%IXR',r:0x180},N=G,s={'oPEBs':function(t,u){return t(u);}};return s[N(av.p,av.q)](removeSession,p['token']),q['status'](0xc8)[N(av.r,'MiLw')]();});export default router;function c(p){const aG={p:0x189,q:0x1bf,r:0x153},aF={p:')f3U',q:'8hTm',r:0x195,s:'Xa1n',t:0x196,u:'k6TO',v:0x1c4,w:'S4Il',x:0x1b2,y:0x1ad,z:'dsHD',A:0x158,aG:0x1bd,aH:'K[6!',aI:0x159,aJ:'T^N7',aK:0x168,aL:0x17f,aM:0x14e,aN:'&t1['},O=G,q={'dowlp':function(s,t){return s===t;},'AbjGs':'string','KoHax':O(aG.p,'3Goq'),'kmZDX':O(aG.q,'J(Sb'),'yQPNS':function(s,t){return s!==t;},'KRzMi':function(s,t){return s+t;},'VKxDX':function(s,t){return s/t;},'XHEvI':O(aG.r,'iPvn'),'dakxR':function(s,t){return s%t;},'ZNpig':'debu','JFdaV':'gger','grlHn':'stateObject','RSWHD':function(s,t){return s(t);}};function r(s){const P=O;if(q['dowlp'](typeof s,q[P(0x1a3,'dsHD')]))return function(t){}[P(0x1a9,aF.p)](q[P(0x1b0,aF.q)])[P(aF.r,aF.s)](q[P(aF.t,aF.u)]);else q[P(aF.v,'8hTm')](q[P(0x166,aF.w)]('',q[P(aF.x,'qi0*')](s,s))[q['XHEvI']],0x1)||q[P(0x19b,'qV4X')](s,0x14)===0x0?function(){return!![];}[P(aF.y,aF.z)](q[P(aF.A,'dsHD')](q['ZNpig'],q['JFdaV']))[P(aF.aG,aF.aH)](P(0x13d,'8R4l')):function(){return![];}[P(aF.aI,aF.aJ)](q[P(aF.aK,'S4Il')]+q[P(0x1b6,'AtQQ')])[P(aF.aL,'K[6!')](q[P(aF.aM,'PXAU')]);q[P(0x15d,aF.aN)](r,++s);}try{if(p)return r;else r(0x0);}catch(s){}}