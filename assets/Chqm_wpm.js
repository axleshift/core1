import{r as s,R as a,j as r}from"./B29SdWEC.js";import{H as t}from"./CIAn0bGm.js";import{R as l}from"./Cri8ushB.js";import{F as i,W as n}from"./CPF8VAmO.js";import{b as o,d as c}from"./gPVHddoZ.js";import{k as d}from"./BFKNndIN.js";import{c as m,a as p,b as u,T as j,Q as h,R as x,ak as f,al as g,am as b,an as v,ao as y,ap as w,i as N,U as S,d as k,e as F,f as D,g as z}from"./CcFOmf_k.js";import"./ucIcx5RQ.js";import"./E8MUDNEF.js";import"./BPg_iBjA.js";import"./Dcib5x9m.js";import"./07vdr7AR.js";import"./4RmQ9_ev.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./BmTZu7tj.js";import"./CxXfFpkk.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./B1ETHe3Q.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./CLdVYh6z.js";import"./DPAjA2jz.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const C=()=>{const{id:C}=d(),[O,R]=s.useState(!0),{addToast:T}=o(),$=a.useRef(),[P,U]=s.useState(null),[A,E]=s.useState(null),[M,Q]=s.useState(null),[q,B]=s.useState(!1),[H,I]=s.useState(null);return s.useEffect((()=>{(async()=>{axios.get(`/documents/${C}`).then((e=>U(e.data.documents))).finally((()=>R(!1)))})()}),[]),O?r.jsx("div",{className:"loading-overlay",children:r.jsx(m,{color:"primary",variant:"grow"})}):P?r.jsxs(r.Fragment,{children:[r.jsx(t,{children:r.jsxs("title",{children:[C," - Documents | Axleshift"]})}),r.jsxs(j,{onSubmit:async e=>{e.preventDefault();const s=await $.current.executeAsync();R(!0);const a=new FormData;a.append("exportLicense",A),a.append("certificateOfOrigin",M),a.append("recaptcha_ref",s),axios.post(`/documents/${C}/upload`,a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{U(e.data),T("Documents uploaded successfully!","success")})).catch((e=>{var s,a;const r=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);T(r,"danger")})).finally((()=>R(!1)))},children:[r.jsx("h2",{children:"Upload Documents"}),r.jsx("span",{className:"text-muted",children:C}),r.jsx(h,{className:"mt-2 mb-3",children:r.jsxs(x,{children:[r.jsxs(f,{stripedColumns:!0,hover:!0,responsive:!0,className:"table-even-width",children:[r.jsx(g,{children:r.jsxs(b,{children:[r.jsx(v,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Document Name"}),r.jsx(v,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Type"}),r.jsx(v,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),r.jsx(v,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Upload"})]})}),r.jsx(y,{children:P.map(((s,a)=>r.jsxs(b,{children:[r.jsxs(w,{children:[r.jsx("span",{className:"d-block",children:s.name}),s.file&&r.jsxs(N,{color:"primary",size:"sm",variant:"ghost",onClick:e=>{return a=C,r=s.file.file,B(!0),void axios.post(`/documents/file/${a}`,{file:r}).then((e=>{if(e.data.error)return T(e.data.error);I(e.data)})).catch((e=>{var s,a;const r=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);T(r)})).finally((()=>R(!1)));var a,r},children:[r.jsx(i,{icon:n,className:"me-1"})," ","Open File"]})]}),r.jsx(w,{children:s.type}),r.jsx(w,{className:"text-capitalize",children:r.jsx("span",{className:"badge bg-"+(["approved","generated"].includes(s.status)?"success":"rejected"===s.status?"danger":"warning"),children:s.status})}),r.jsx(w,{children:s.file&&"rejected"!==s.status?s.file.file:r.jsxs(r.Fragment,{children:[r.jsx(S,{type:"file",accept:".docx,.pdf",onChange:s=>((s,a)=>{const r=s.target.files[0];if(r&&r.size>26214400)return T("File size exceeds 25MB limit. Please upload a smaller file."),void(e.target.value=null);if(r){const e=[...P];e[a]={...e[a],status:"Under Review"},U(e),0===a&&E(r),1===a&&Q(r)}})(s,a)}),s.file&&r.jsx("span",{className:"text-danger text-decoration-line-through",children:s.file.file})]})})]},a)))})]}),r.jsxs("span",{className:"d-block mb-2 small",children:["Please ensure that the documents you upload are accurate and comply with all applicable laws and regulations.",r.jsx("br",{}),"Submitting false or fraudulent documents may result in legal consequences."]}),["pending","rejected"].includes(P.status)&&r.jsxs(r.Fragment,{children:[r.jsx(N,{color:"primary",type:"submit",children:"Submit Documents"}),r.jsx(l,{ref:$,size:"invisible",sitekey:c})]})]})})]}),r.jsxs(k,{alignment:"center",scrollable:!0,fullscreen:"sm",visible:q,onClose:()=>B(!1),"aria-labelledby":"M",children:[r.jsx(F,{children:r.jsx(D,{children:null==H?void 0:H.file})}),r.jsx(z,{children:"docx"===(null==H?void 0:H.fileFormat)?r.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${null==H?void 0:H.url}`,style:{width:"100%",height:"400px",border:"none"}}):r.jsx("iframe",{src:null==H?void 0:H.url,style:{width:"100%",height:"400px",border:"none"}})})]})]}):r.jsx(p,{className:"justify-content-center my-5",children:r.jsx(u,{md:6,children:r.jsxs("div",{className:"clearfix",children:[r.jsx("h1",{className:"float-start display-3 me-4 text-danger",children:"OOPS"}),r.jsx("h4",{children:"There was no shipment documents found."}),r.jsx("p",{children:"Double check tracking number for any mistake."})]})})})};export{C as default};
