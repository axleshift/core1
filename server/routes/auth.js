const H=f;function e(){const ay=['W47cNSoNWQCW','dmkjWQ4DWOuPW6JdGmoTWRFcQMJcMq','W5ZcImoLWQqycG','WPbPWQ7cLWK','qmo0xq','bYldPCkVkq','W5uWCgdcRW','W5hcQZGnWQqStwSo','xCoTvcHBba','rCo1v8o1WR4','smkQW712umkRtmo9DLj3zuXUWR4','W5mRDcddQrS','WPpcTSkBgWhdHSoEWRtcImkFyG','gX/dT8kO','mJSpaW','csuIWPLiCHi','W6NdPYOBFmo7wCkgW6pcVe7cJSkSFCoSjIVdI8kic8ojWOtcNbFcUSkwsCk5x38Aoa','jxHBW6L3','jSozWQZdMW','cGddTmkWpq','WRRcISk5W5dcOW','cSopW4z6W5D0WPC','c29rW4m','WOqHqLbRmSoH','W63cMYqtWQ47vL0+AW','m8kaW6JcShBdHmozyaBdHSk5W4ddGG','bf/cQIKP','WP3cQeJdPsmK','oSkDlmkZWO0','WOaIW7XEaa','xdDXWQnWA8kS','W7W8WR4Ere4bFCkAuW','W5VdLgbxtq','oHfPWPPw','W67dKCoaDa','WRravJVdSmo2W5u','pfzXW752','W5O+WRmBtq0CCmovxc/cNmkPBexdHeFcMGRdQSonW7Ce','t8o2qmot','W4iEWRq','eSoYDqtdIa','wCkvwSkWaW','dGldTSkZnG','omkcmSkSWObJWPrUW4H9WO0','W4SuWOO5rG','W742WPtcS8oi','W6ffESkt','W4xdTrtcSwz1C8k7eJLhWPm','idSydG','smk1dmkmW5y1iXJcIGyABCoXB8k3WOK','t8oGr8oRWRa','WRKEW4elW6K','WQNcNSkiW5hcSq','W58rW7OQW6NdJwC','W7T+WRZdJ8kGpK7dKYlcQfe','nCkfm8k0WPG','lNRcMqi4','W6XoCCks','nCkaW7BcQW','W60rd2JcPCkZWP/cNmkgF8kGqSkOsq','WPxcQ8krW47cIW','f8oAur7dJq','W57cH8oVq2tdJ0ZdOmo0W6m','W5NdI35iqmoYj8otWQJdKLi','WP0FW7zTkCkoqCoCW5m','WR9kwsZdOCo2W5pdJ8keESkg','WRm3W5LWha','WP9OWRpcLG','hCooW5NdTclcI8kWo1JdR8k9WP7dI8oOW6bWW7ytW4RcGWana3iMoL3cTcahWPu6ud0','A8kXCSkGjYnmW6jRW5W','jWC0W6iLWR19WO7dQSowW53cPmkZ','WQzGzZZdMG','WOVdRmklW4byo2KZtSkmxa','s8oHrZHAhSkzpmk4W7blW44we8oKbCkakhi','W5xcISoAWOeY','W7uGWR0C','WRlcONFdPdS','mmozWQpdH8ou','dSo2WQWTbCk8xCk5CK1gctPA','emotvX7dRW','d8kaWQeEW7TWWQBdPmolWQ0','i8kmW6VcUW','ySkBzCoCBa','e3mtW4XwdSozbSo/WPeVW78UAq8fA3RdTMHsncWHW7tdGw8CW6OmB2e','xCoIqmotWPS','WOVcKCoAWPeAaei','W4zoWQ17WRtcIYT5WPRdRXS5WRe','WQDhFmkapSkg','WPenW6uHW78','WRlcLCkoW6NcQW','n8kimSk4WOb5','W5XdWOtdL8kb','W47dHxjxuq','WOzVWQ7cKruc','W4CTW6fSWQxdJMSQaq','xCoIqmot','W6S2WQeg','W6eLCehcHq','CgvlqWxcLmoxjmopierRW4W','A8oeWQ3dHCotvYhcU8o0','W4OWENW','W5v+dGOMz8kQWRrgW5xcMSoEW4e','W6ZdQCoLC38','CmoLWOq7pa','bGxdVCkfeq','W6VcHJOqWRK','z37dTbe','xSkYdCkBW40OnqBdJW','z8k5mmkfW7m','W55FyCkXhG','W6hdTwCtDSoH','W7xdT8kqAq','BCodAWzp','CSkux8oW','W4ddImoIvCke','WQFdH8kadwe','W4euWRtcVCo8','xmkTW7PPwSoNaq','W5xcLmoKWQW','W4ZcOmoyWOCmtuqAFmk+whe','W6Owd2NcP8k3WP7dG8kvCmkmBmkW','n8oegSkQn8oPpMFdPrxcOSozcq'];e=function(){return ay;};return e();}(function(p,q){const P={p:0xff,q:'kGLE',r:'13x6',s:0x130,t:'8lFM',u:0xe5},A=f,r=p();while(!![]){try{const s=parseInt(A(0x121,'5zm4'))/0x1*(parseInt(A(P.p,'e(6E'))/0x2)+parseInt(A(0x10f,'OmLb'))/0x3+-parseInt(A(0xf0,P.q))/0x4+parseInt(A(0x10c,'j8eT'))/0x5+-parseInt(A(0x100,'zeOg'))/0x6+parseInt(A(0xfa,P.r))/0x7*(-parseInt(A(P.s,P.t))/0x8)+parseInt(A(P.u,'h[DO'))/0x9;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xc69d0));const d=(function(){let p=!![];return function(q,r){const Q={p:0xc6,q:'p@AI'},s=p?function(){const B=f;if(r){const t=r[B(Q.p,Q.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const X={p:0xdb,q:'yAVS',r:0xee},W={p:0xd7,q:0xde,r:'KObh',s:'9L[B',t:0xd2,u:'1eMD'},C=f,p={'paATq':C(X.p,X.q),'PGGdY':C(X.r,'PVdB'),'ZmckC':C(0xd8,'h78Q'),'TXLQO':function(q,r){return q+r;},'uiewl':'chain','oRyzo':function(q,r,s){return q(r,s);}};p['oRyzo'](d,this,function(){const D=C,q=new RegExp(p['paATq']),r=new RegExp(p[D(W.p,'rSH]')],'i'),s=c(p[D(W.q,'aVHP')]);!q[D(0x10a,W.r)](p[D(0x105,W.s)](s,p[D(W.t,'uQEV')]))||!r[D(0xe4,'PVdB')](p[D(0xce,W.u)](s,'input'))?s('0'):c();})();}());const b=(function(){let p=!![];return function(q,r){const Y={p:0xca},s=p?function(){const E=f;if(r){const t=r[E(Y.p,'F0iX')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a7={p:0xf3,q:'IcLl',r:0x134,s:'J#1V',t:'noJF',u:'F0iX',v:0x11f,w:0xd1,x:'rSH]',y:0xf1,z:0x111,a8:0x104,a9:'p@AI',aa:0xd5,ab:0x115,ac:'yAVS',ad:'PVdB'},a6={p:'p@AI',q:0x103,r:'1eMD'},F=f,p={'nhokl':function(u,v){return u(v);},'AfeSY':function(u,v){return u+v;},'NmOYL':F(a7.p,a7.q),'MvfFN':F(a7.r,a7.s),'kYUdn':function(u){return u();},'iwZNb':F(0x11b,a7.t),'zEPcO':'info','aQZGP':F(0xea,'4[SQ'),'xuPcI':F(0x106,a7.u),'iMAnl':function(u,v){return u<v;}},q=function(){const G=F;let u;try{u=p[G(0xe1,a6.p)](Function,p[G(a6.q,'aVHP')](p[G(0x10b,'Q[0n')](p[G(0x110,'8lFM')],p[G(0xbb,a6.r)]),');'))();}catch(v){u=window;}return u;},r=p['kYUdn'](q),s=r[F(a7.v,'%2jo')]=r['console']||{},t=[F(a7.w,a7.x),p['iwZNb'],p[F(a7.y,'h[DO')],'error',p[F(a7.z,'E1Q5')],p['xuPcI'],'trace'];for(let u=0x0;p['iMAnl'](u,t[F(a7.a8,a7.a9)]);u++){const v=b[F(a7.aa,'p@AI')][F(a7.ab,a7.ac)]['bind'](b),w=t[u],x=s[w]||v;v[F(0x12b,'@zLq')]=b['bind'](b),v['toString']=x['toString'][F(0xfb,a7.ad)](x),s[w]=v;}});a();import g from'dotenv';g[H(0x126,'e(6E')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';(function(){const ac={p:0xf3,q:'IcLl',r:0xe0,s:'9L[B'},ab={p:0xf9,q:'aVHP'},I=H,p={'wHGmK':function(s,t){return s(t);},'IyRjQ':function(s,t){return s+t;},'xEiVY':I(ac.p,ac.q),'ZbcZP':function(s){return s();}},q=function(){const J=I;let s;try{s=p[J(ab.p,'uQEV')](Function,p[J(0x116,'yAVS')](p[J(0xbe,ab.q)](p[J(0xc7,'4[SQ')],J(0xfd,'1eMD')),');'))();}catch(t){s=window;}return s;},r=p['ZbcZP'](q);r[I(ac.r,ac.s)](c,0x9c4);}());import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h['Router']();router['post'](H(0x10d,'l6Kh'),n,async(p,q)=>{const ag={p:0xda,q:0xe2,r:'tveK',s:0x117,t:'h78Q',u:0x12a,v:0xc8,w:'SDe)',x:'@zLq',y:0x108,z:0x109,ah:'2nR)',ai:'1mUK'},K=H,r={'rcBHX':function(s,t){return s||t;},'VtrVI':function(s){return s();},'lRasm':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[K(ag.p,'j8eT')];if(r[K(ag.q,'3raU')](!s,!t)||!u||!v)return q[K(0xcc,ag.r)]({'status':0x191});const w=await r[K(ag.s,ag.t)](k),x=w[K(0xc9,'KObh')](K(ag.u,'Q[0n')),y=await x[K(ag.v,ag.w)]({'email':s});if(y)return l[K(0x113,ag.x)](K(0xcf,'KObh')),q[K(0x10e,'Q[0n')]({'status':0x199});return await x[K(ag.y,'R@kw')]({'email':s,'first_name':t,'last_name':u,'role':K(ag.z,ag.ah),'password':r[K(0x129,'uL&v')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(0x114,'@dHB')]({'status':0xc9});}catch(z){l[K(0x127,ag.ai)](z),q[K(0x120,'e(6E')]({'status':0x1f4});}}),router[H(0x131,'uL&v')](H(0x101,'h78Q'),n,async(p,q)=>{const al={p:0xfe,q:0x12f,r:0x128,s:0xbc,t:0xec,u:'4[SQ',v:0xc4,w:'3raU',x:'@zLq',y:0x112,z:'uL&v',am:0xef,an:'CmNf',ao:0xe6,ap:'aVHP',aq:0xdc,ar:0x12c,as:0x11e,at:'rSH]',au:'XUOK',av:'xTfB',aw:'J#1V',ax:'PVdB',ay:'noJF',az:0xf5,aA:'KObh',aB:'uL&v'},L=H,r={'KPLxE':function(s,t){return s||t;},'XFqcI':function(s){return s();},'muyYU':L(al.p,'2nR)'),'fXzty':L(al.q,'Q[0n'),'gqbJX':function(s){return s();},'oegjm':L(al.r,'2nR)'),'yzKVu':'x-forwarded-for','gnHBk':function(s,t,u,v,w){return s(t,u,v,w);},'UKxfT':'user-agent'};try{const {email:s,password:t}=p[L(al.s,'l6Kh')];if(r[L(al.t,al.u)](!s,!t))return q[L(0x119,'fcHc')]({'status':0x191});const u=await r[L(al.v,al.w)](k),v=u[L(0xc2,al.x)](r[L(al.y,al.z)]),w=await v['findOne']({'email':s});if(!w)return q['json']({'status':0x194});if(o(t)!=w['password'])return q['json']({'status':0x191});addUserProfileToSession(w);const x=j[L(al.am,al.an)](r[L(al.ao,al.ap)])['update'](r[L(al.aq,'2nR)')](generateUniqueId))[L(al.ar,'IcLl')](r[L(al.as,al.at)]),y=p[L(0x133,al.au)][r[L(0xcb,al.av)]]||p[L(0x118,al.aw)][L(0xc3,al.ax)];r[L(0xfc,al.ay)](addSession,w,x,y,p[L(0xcd,'h[DO')][r['UKxfT']]),q[L(al.az,al.aA)]({'status':0xc8,'token':x});}catch(z){l[L(0xd4,al.aB)](z),q[L(0xcc,'tveK')]({'status':0x1f4});}}),router[H(0x132,'j8eT')]('/verify',m,function(p,q,r){q['json']({'status':0xc8});}),router['post'](H(0xdf,'zeOg'),m,function(p,q,r){const M=H;removeSession(p[M(0xf7,'l6Kh')]),q[M(0xed,'1mUK')]({'status':0xc8});});function f(a,b){const c=e();return f=function(d,g){d=d-0xbb;let h=c[d];if(f['vRBYrN']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['wvgzWl']=m,a=arguments,f['vRBYrN']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['NxoxRr']===undefined&&(f['NxoxRr']=!![]),h=f['wvgzWl'](h,g),a[k]=h):h=l,h;},f(a,b);}export default router;function c(p){const ax={p:0x107,q:'OmLb',r:0xe3,s:'h78Q',t:'2nR)',u:0xf4},aw={p:0xe7,q:'uQEV',r:0x12d,s:0xe9,t:'F0iX',u:'%2jo',v:0xbd,w:'zeOg',x:0x11d,y:'IcLl',z:'h[DO',ax:0xd6,ay:'CmNf',az:0xc0,aA:0x124,aB:'zeOg',aC:0xf2},N=H,q={'pAAmi':function(s,t){return s===t;},'mdrTV':N(ax.p,'1mUK'),'IcTFo':N(0xc1,ax.q),'HyYyB':function(s,t){return s!==t;},'TGXKg':function(s,t){return s+t;},'DjMOt':function(s,t){return s/t;},'NBFNP':N(0xc5,'y1Qc'),'QVMqP':N(ax.r,ax.s),'CoQfl':N(0xd0,ax.t),'qyleA':'action','jmQCC':function(s,t){return s(t);}};function r(s){const O=N;if(q[O(aw.p,aw.q)](typeof s,q[O(aw.r,'2nR)')]))return function(t){}[O(aw.s,aw.t)](O(0x12e,aw.u))[O(aw.v,'uL&v')](q[O(0xdd,aw.w)]);else q[O(aw.x,'&dnJ')](q[O(0x11a,aw.y)]('',q[O(0x11c,'tveK')](s,s))[q['NBFNP']],0x1)||s%0x14===0x0?function(){return!![];}[O(0xeb,aw.z)](q[O(aw.ax,'KObh')](q[O(0xd3,aw.ay)],q[O(0xf6,'y1Qc')]))[O(aw.az,'1eMD')](q[O(aw.aA,'e(6E')]):function(){return![];}['constructor'](q['QVMqP']+q['CoQfl'])[O(0x102,aw.aB)](O(aw.aC,'5zm4'));r(++s);}try{if(p)return r;else q[N(ax.u,'e(6E')](r,0x0);}catch(s){}}