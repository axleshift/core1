import{r as n,R as E,j as e}from"./D3kDgYDB.js";import{F as w,G as A}from"./CUO9jjoX.js";import{R as N}from"./D0iU1EWp.js";import{u as S}from"./CQ-yZ3vu.js";import{b as u,a as P,V as h}from"./DhjcMB1C.js";import{E as R}from"./URk2IvX2.js";import{d as _}from"./o5tV6Bm-.js";import{c as b,C as I,K as k,L as T,S as B,T as $,U as L,l as O,n as z,R as D}from"./BRioXSKG.js";import"./CNSOrHVr.js";import"./WyM-ksIe.js";import"./dB90dn3U.js";import"./Dw8pycEM.js";import"./8JwjhRSi.js";import"./BmHAl9XU.js";import"./CWoBZRFf.js";import"./tpRZQFqq.js";import"./CzFDRTuY.js";import"./B6-gGlhp.js";import"./DzfTGk6K.js";import"./hKczlkOd.js";import"./CXnULsF_.js";import"./CCb-kr4I.js";import"./Cz0CWeBA.js";import"./Cp7XljvA.js";import"./BQBsAJpH.js";import"./DRFurTTo.js";import"./BZxJdD1U.js";const ue=()=>{const[f,m]=n.useState(!1),[l,p]=n.useState({error:!1,message:""}),[i,g]=n.useState(["","","","","",""]),c=cookies.get(u),o=_(),d=E.useRef();S();const x=async()=>{if(c===void 0)return o("/login");await axios.post(`${h}/api/v1/auth/verify`,{},{headers:{Authorization:`Bearer ${c}`}}).then(a=>{if(a.data.is_email_verified)return o("/")}).catch(a=>{if(!a.response)return console.error(a);cookies.remove(u),o("/login")})};n.useEffect(()=>{x()},[o]);const y=(a,t)=>{const r=a.target.value.replace(/[^0-9]/g,"");if(r.length<=1){const s=[...i];s[t]=r,r&&t<5&&document.getElementById(`otp-input-${t+1}`).focus(),g(s)}},j=(a,t)=>{a.key==="Backspace"&&!i[t]&&t>0&&document.getElementById(`otp-input-${t-1}`).focus()},v=async a=>{a.preventDefault(),m(!0);const t=await d.current.executeAsync();await axios.post(`${h}/api/v1/auth/verify/otp`,{otp:i,recaptcha_ref:t},{headers:{Authorization:`Bearer ${c}`}}).then(r=>{if(r.data.error)return p({error:!0,message:r.data.error});const s=new URLSearchParams(window.location.search),C=s.get("n")?s.get("n"):"/";o(C)}).catch(r=>{console.error(r);const s=R[r.status]||"Internal Application Error";p({error:!0,message:s})}).finally(()=>m(!1))};return e.jsxs("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"auth-bg"}),e.jsxs(b,{children:[f&&e.jsx("div",{className:"loading-overlay",children:e.jsx(I,{color:"primary",variant:"grow"})}),e.jsx(k,{className:"justify-content-center",children:e.jsx(T,{md:8,lg:6,xl:5,children:e.jsx(B,{className:"p-1 p-md-4 shadow",children:e.jsxs($,{children:[l.error&&e.jsxs(L,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(w,{className:"flex-shrink-0 me-2",icon:A,size:"xl"}),e.jsx("div",{children:l.message})]}),e.jsxs(O,{onSubmit:v,children:[e.jsx("h1",{children:"OTP"}),e.jsx("p",{className:"text-body-secondary",children:"Enter the 6digit code that was sent to your email address."}),e.jsx(N,{ref:d,size:"invisible",sitekey:P}),e.jsx("div",{className:"d-flex justify-content-center gap-2 mb-3",children:i.map((a,t)=>e.jsx(z,{type:"text",id:`otp-input-${t}`,value:a,onChange:r=>y(r,t),onKeyDown:r=>j(r,t),className:"otp-input",maxLength:"1"},t))}),e.jsx(D,{type:"submit",color:"primary",className:"me-2 rounded",children:"Submit"})]})]})})})})]})]})};export{ue as default};
