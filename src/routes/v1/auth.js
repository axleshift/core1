const J=f;(function(p,q){const R={p:0x15f,q:0x163,r:'E(Ql',s:0x17f,t:'4Re2',u:0x108,v:'tlAi',w:0x120,x:0x143,y:'Wd!!',z:'*]Q^'},B=f,r=p();while(!![]){try{const s=parseInt(B(0x10d,'Wd!!'))/0x1*(-parseInt(B(R.p,'jnvJ'))/0x2)+parseInt(B(R.q,R.r))/0x3*(-parseInt(B(R.s,R.t))/0x4)+parseInt(B(R.u,'D(U7'))/0x5+-parseInt(B(0x166,R.v))/0x6+parseInt(B(R.w,'DZ3)'))/0x7*(parseInt(B(R.x,'(&oD'))/0x8)+-parseInt(B(0x146,R.y))/0x9+parseInt(B(0x193,R.z))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xdb615));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Y={p:0x135,q:'[qPx',r:'V@gF',s:'%8oX'},D=f,p={'vNxHq':function(s,t){return s(t);},'DyAKn':function(s,t){return s+t;},'PUKeK':'{}.constructor(\x22return\x20this\x22)(\x20)'},q=function(){const C=f;let s;try{s=p['vNxHq'](Function,p[C(0x137,'veZq')](p[C(Y.p,Y.q)](C(0x113,Y.r),p[C(0x131,Y.s)]),');'))();}catch(t){s=window;}return s;},r=q();r[D(0x117,'XHlY')](c,0x9c4);}()),(function(){const a5={p:0x11c,q:0x182,r:'1AH9'},a4={p:'7VUw',q:0x1a1,r:'V@gF',s:0x14a,t:'%8oX',u:0x128,v:'5iuO'},E=f,p={'Ysbej':E(a5.p,'E]3O'),'ePRTT':function(q,r){return q(r);},'GPPtR':E(a5.q,'Xyzx'),'PCTvx':'chain','TBKQo':E(0x123,a5.r),'MpTYX':function(q,r){return q(r);},'PhXhQ':function(q){return q();},'kDWkN':function(q,r,s){return q(r,s);}};p['kDWkN'](d,this,function(){const F=E,q=new RegExp(F(0x19b,a4.p)),r=new RegExp(p[F(a4.q,'Xyzx')],'i'),s=p['ePRTT'](c,p[F(0x118,a4.r)]);!q[F(a4.s,'AUM6')](s+p[F(0x115,a4.t)])||!r['test'](s+p[F(0x160,'1AH9')])?p[F(0x16c,')cxa')](s,'0'):p[F(a4.u,a4.v)](c);})();}());const b=(function(){const a6={p:0x138,q:'7VUw'};let p=!![];return function(q,r){const s=p?function(){const G=f;if(r){const t=r[G(a6.p,a6.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const af={p:'XHlY',q:0x161,r:'^rf8',s:0x17a,t:'veZq',u:0x150,v:'AUM6',w:0x153,x:'7VUw',y:'Qznr',z:0x17c,A:0x14d,ag:0x17e,ah:0x18f,ai:0x149,aj:'sZSY',ak:0x152,al:'l&(m'},ae={p:'tlAi',q:'VGai',r:0x18b,s:'esX9',t:0x121},H=f,p={'bpYXW':function(u,v){return u(v);},'evtBg':function(u,v){return u+v;},'GuvAc':function(u,v){return u+v;},'ceAZX':H(0x197,af.p),'bzRjS':H(0x1a3,'mp[A'),'tlbgO':H(af.q,'mp[A'),'QjObg':H(0x164,af.r),'PcoOK':'info','UyDIk':H(af.s,'*]Q^'),'UJPnL':H(0x145,af.t),'ZLhEE':function(u,v){return u<v;}},q=function(){const I=H;let u;try{u=p[I(0x162,ae.p)](Function,p['evtBg'](p[I(0x196,ae.q)](p[I(ae.r,ae.s)],p[I(ae.t,'9)wN')]),');'))();}catch(v){u=window;}return u;},r=q(),s=r['console']=r[H(af.u,af.v)]||{},t=[p['tlbgO'],p['QjObg'],p[H(af.w,af.x)],p[H(0x165,af.y)],H(0x178,'mp[A'),'table',p[H(af.z,'aVGl')]];for(let u=0x0;p['ZLhEE'](u,t[H(af.A,'F2XT')]);u++){const v=b['constructor']['prototype'][H(af.ag,'5iuO')](b),w=t[u],x=s[w]||v;v['__proto__']=b[H(af.ah,'aVGl')](b),v[H(af.ai,af.aj)]=x[H(af.ak,af.al)][H(0x157,'jnvJ')](x),s[w]=v;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';const router=h[J(0x1a4,'YWQy')]();function f(a,b){const c=e();return f=function(d,g){d=d-0x108;let h=c[d];if(f['NxQShA']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['JUXpPg']=m,a=arguments,f['NxQShA']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['lJPqSS']===undefined&&(f['lJPqSS']=!![]),h=f['JUXpPg'](h,g),a[k]=h):h=l,h;},f(a,b);}router[J(0x11a,'*]Q^')](J(0x19f,'MJgg'),async(p,q)=>{const ak={p:0x13d,q:'z&8m',r:'5iuO',s:'1AH9',t:'^rf8',u:'V@gF',v:'9)wN',w:0x195,x:0x151,y:0x158,z:0x185,A:'[qPx',al:0x10e,am:'^rf8',an:'GT&m',ao:0x148,ap:0x190,aq:0x199,ar:0x159,as:'g8A(',at:'MJgg',au:0x15e,av:'l&(m',aw:0x10c,ax:'^rf8',ay:'T2k%'},K=J,r={'eYXTo':function(s,t){return s||t;},'uXGhL':K(ak.p,ak.q),'HGGcA':function(s,t){return s<t;},'AgrWD':K(0x140,ak.r),'zvGpR':K(0x134,'*]Q^'),'yJakd':function(s){return s();},'PqAbC':K(0x116,'0U&r'),'kKArV':K(0x132,'DZ3)'),'uygNb':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(r[K(0x144,ak.s)](!s,!t)||!u||!v||!w)return q[K(0x176,ak.t)](0x190)['send']();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(0x168,ak.u)](s))return q[K(0x18c,ak.v)](0xc8)[K(ak.w,'e2n8')]({'error':r[K(ak.x,'$RX*')]});if(r[K(0x13a,'AUM6')](v[K(ak.y,'FE#4')],0x8))return q['status'](0xc8)[K(ak.z,ak.A)]({'error':r['AgrWD']});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[K(0x171,'&L!]')](v))return q[K(0x10a,'V@gF')](0xc8)['json']({'error':r[K(ak.al,'$RX*')]});if(v!=w)return q[K(0x176,ak.am)](0xc8)[K(0x17d,'$RX*')]({'error':K(0x130,'*]Q^')});const x=await r[K(0x124,ak.an)](k),y=x[K(ak.ao,'veZq')](r['PqAbC']),z=await y['findOne']({'email':s});if(z)return l[K(ak.ap,'tlAi')](r[K(ak.aq,'1AH9')]),q[K(ak.ar,ak.as)](0x199)[K(0x19e,'*]Q^')]();return await y[K(0x16b,ak.at)]({'email':s,'first_name':t,'last_name':u,'role':K(0x1a0,')cxa'),'password':r[K(ak.au,ak.av)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(ak.aw,'&L!]')](0xc9)[K(0x129,ak.ax)]();}catch(A){l[K(0x11e,ak.ay)](A);}return q['status'](0x1f4)['send']();}),router[J(0x18a,'sZSY')](J(0x14f,'g8A('),n,async(p,q)=>{const ar={p:0x174,q:0x167,r:0x12a,s:0x179,t:'MJgg',u:0x170,v:0x198,w:'T2k%',x:0x173,y:0x16e,z:0x183,A:'tlAi',as:0x141,at:'4Re2',au:0x194,av:0x13b,aw:'g8A(',ax:0x191,ay:'GT&m',az:'E(Ql',aA:0x12c,aB:')cxa',aC:0x14c,aD:'XHlY',aE:'e2n8',aF:'l&(m',aG:0x15b,aH:'zHLk',aI:0x13c},L=J,r={'NeTYI':function(s,t){return s||t;},'ziAlt':function(s){return s();},'avwoQ':function(s,t){return s!=t;},'SNURi':function(s,t){return s(t);},'VdhWZ':L(ar.p,'*]Q^'),'sqycP':function(s){return s();},'mNIae':L(0x10b,'T2k%'),'NTLID':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[L(ar.q,'V@gF')];if(r[L(ar.r,'YWQy')](!s,!t))return q[L(0x126,'1AH9')](0x190)[L(ar.s,ar.t)]();const u=await r['ziAlt'](k),v=await u[L(0x122,'JgCY')](L(ar.u,'9)wN'))[L(ar.v,'jnvJ')]({'email':s});if(!v)return q[L(0x16a,ar.w)](0x194)[L(0x136,'FE#4')]();if(r[L(ar.x,'tlAi')](r[L(0x155,'9)wN')](o,t),v[L(ar.y,'Je)O')]))return q[L(ar.z,ar.A)](0x191)[L(ar.as,ar.at)]();const w=j['createHash'](r[L(ar.au,'[qPx')])[L(ar.av,ar.aw)](r[L(ar.ax,ar.ay)](generateUniqueId))[L(0x13f,'z&8m')](L(0x119,'AUM6')),x=p['headers'][r['mNIae']]||p[L(0x133,ar.az)]['remoteAddress'];return r[L(ar.aA,ar.aB)](addSession,v,w,x,p['headers'][L(ar.aC,ar.aD)]),q[L(0x114,ar.aE)](0xc8)[L(0x110,ar.aF)]({'token':w});}catch(y){l[L(ar.aG,ar.aH)](y);}return q[L(ar.aI,'v7&c')](0x1f4)[L(0x19d,'tlAi')]();}),router[J(0x192,'jnvJ')](J(0x181,'MJgg'),m,function(p,q,r){const as={p:'E(Ql',q:0x14b,r:0x12b,s:'iq5P'},M=J;return q[M(0x18e,as.p)](0xc8)['json']({'email':p[M(as.q,'1AH9')],'role':p[M(as.r,as.s)]});}),router[J(0x12d,'[qPx')](J(0x156,'jnvJ'),m,async function(p,q,r){const au={p:0x15a,q:'E]3O',r:0x12f,s:'AUM6',t:'m69H',u:0x14b,v:0x172,w:'E(Ql',x:0x13e,y:'esX9',z:'7VUw'},N=J,s={'tlzCP':function(t,u){return t(u);}};try{const t=await s[N(au.p,au.q)](getUser,p[N(au.r,'Xyzx')]);return q[N(0x180,au.s)](0xc8)[N(0x187,au.t)]({'user':{'email':t[N(au.u,'1AH9')],'first_name':t[N(au.v,au.w)],'last_name':t['last_name']}});}catch(u){l['error'](u);}return q[N(au.x,au.y)](0x1f4)[N(0x109,au.z)]();}),router[J(0x127,'$RX*')](J(0x139,'tlAi'),m,function(p,q,r){const av={p:0x125,q:'VGai',r:'v7&c'},O=J;return removeSession(p['token']),q[O(av.p,av.q)](0xc8)[O(0x111,av.r)]();});export default router;function c(p){const aG={p:'VGai',q:0x189,r:'XHlY',s:'Xyzx',t:'sZSY'},aF={p:0x19c,q:'YWQy',r:'JgCY',s:0x184,t:0x154,u:'0U&r',v:'[qPx',w:0x15d,x:0x11b,y:'Qznr',z:0x169,A:0x17b,aG:0x177},P=J,q={'QLIoZ':function(s,t){return s===t;},'tSmHd':'string','SDEOb':P(0x16d,aG.p),'Rwykw':function(s,t){return s+t;},'kERcE':function(s,t){return s/t;},'wMluC':'length','QUMUd':function(s,t){return s%t;},'appuJ':function(s,t){return s+t;},'qEZfH':P(aG.q,aG.r),'GIzUy':P(0x16f,aG.s),'GvTEg':P(0x12e,aG.t),'afEnf':function(s,t){return s(t);}};function r(s){const Q=P;if(q['QLIoZ'](typeof s,q[Q(aF.p,aF.q)]))return function(t){}[Q(0x19a,'Wd!!')](q[Q(0x142,'Xyzx')])[Q(0x10f,aF.r)]('counter');else q[Q(0x1a5,'Je)O')]('',q['kERcE'](s,s))[q[Q(aF.s,'9)wN')]]!==0x1||q['QLIoZ'](q['QUMUd'](s,0x14),0x0)?function(){return!![];}[Q(aF.t,aF.u)](q['appuJ'](Q(0x112,aF.v),q['qEZfH']))[Q(0x1a2,'*]Q^')](Q(0x175,'^rf8')):function(){return![];}[Q(aF.w,aF.r)](q[Q(aF.x,aF.y)](q[Q(aF.z,'F2XT')],q['qEZfH']))[Q(aF.A,'E(Ql')](q[Q(aF.aG,'jnvJ')]);r(++s);}try{if(p)return r;else q['afEnf'](r,0x0);}catch(s){}}function e(){const aH=['zLTPWOxdHaK','WQSxlv4iDCkEtGddRtfmW40GW71XDmonWOPova','AaFdJ8k+xq8','WOyqpfOxAa','wCkbwwiCW6qbWOuvW5tcHslcOSo3WODiW4yxW7JcJNldNXDUbfRcH8oFsY7cRSoMpGnEq8kn','W7Tomxa','WQqYWOBdOYG','WQNdPCkYW5uVFNHhgWqCW5W','xSkrnKGl','DCkNq0vm','vfWjW7HdF2m4W7ZdRmkizSoNAa','beddK8kGWQbWW57dNq7cQseaw8oM','ySk6tKPmW43dKSk2m8oC','WPlcJmk7rSoRuGxcOq','CrFdHxe','xSkLd3ui','WORdI8kTWP5iv0pcVmkQW4C','W7zmWQhdOw7cRq','auhdKmkGWQfXWPBcGcRcLW40','DMS4y2vc','zH3dMhBdTGBdRG','WR7cMSk1W4fQ','WORcVCkvsmo+W4pdQu8','aSoAW4zzEq','WOn0bcFcTK1NmbKeW58','zJVcTSodW7e','oCkKmCoAW48','Dmk4lmoB','W5RdU8kNW43dIYO','kNm2ChLF','WPRdSNxdN0e','WQldSCoygK4','W7dcKfVcKSk8pCo0','WPBdOmoMh8k5W5RdMfXHhCkQ','WOVcQ8kHCSoU','iSkfjmouW6RcJG0','B8kkju0l','omozza','qSotW4LMW7i','W50wgXa8k343W4hdHHNcNq','xmoIWOJdSq','iCo/W70ggq','fmkxWQmpWPWbv3n5W5pcTSo7','CCkpW67dVW','z8kfW7NdSG','W51GWRxdK2m','WRunnSkWWRjK','WRlcPrvIW6RdSCkHWQ3dHG','k1pdNmoyda','mx/dHmoPWRZcO8kjWOZdKSokWQxdUCkrWP12','WQpcMmouWRBcOH5UWQC','WPmtWQhdMq','qaBcHSoJW6S','WRdcOu7cJq','WOPixvr+qxG5W63dPG','qCovW6DrW7q','hSkReCo2dmol','sSoGWO7dTSoCkq','wmo3WPVdQ8ogna','uCkNfSo6W5O','mCooymkOWQ14WOJcTxW','WQJcRGHJ','cmkXaSkRsW','WO1rx0TZ','hmk7eCklWQ8','WQhcSCkDW4C','A8kjrhu','WROBpLxdU8oglwa','DGBdL3hdRbK','W7tcVqn1W7hdO8kx','WP4yWQRdMa','u8oxW7fkW5be','qJJcJ8oKW5S','WR3dPSoVWQ8','W5eSxMpdTaP6pcWUW6Cf','WObJW6vk','eSkvWQqmWPeeD1b5W7JcNmow','WPJdN8kTWP4','WPBcJmkBrG','EbBdR8kqCa','rGhcGSoLW600','WRddVmkcWRTUWPLOkq','WP9vtLn/Bq','k8kyl8kb','rCorW6jrW5C','W4ZcSmojWO09','zSk+mCol','xmo2r8oZcmojW5H5WPddOJ5PW47cRa','WOhdSCoOWPy/','W6JcV8kmWPq','awldM8oeWRO','WO3dNCk8WPKxwatdSCkIW4zlW5hdPCo3WRGUaXBdHa','Cmk4lmoBW7lcKZK','umkdl24Y','bGzxWROpoIDVW7NdMCkB','nmomW4D1rSkBWRDlpSouW4NdRCoZDeldGa','W4pdSCkxWPxdIW','u8ogW75A','hSkMhSkG','W7tcUqnGW7hdTSkAWQBdKq','e1ddRCoZ','WQ4fWQhdIsa','dSkIhmkO','l8ollCkUWRjIWPlcRMazo8k6fMpdMSktW7SquSoEWQNcGxDkW7HLFCoTWQztx8kn','W6xdJCkpWQNdIKO','WOhcJSoEWQ7cOG','WRZcIsRdMSkPD2pdTrBcUmkLWRldIq','iCoCW4DY','ymkuW6VdSKzJ','WR5umCkRWRvGevTFWRnYtSoUWQJdRG','WRFcSfZcJCkEpq','v18nW7TpEWTgW5JdUCknFW','WRhcTmk1W5L0','WPtdV8o4amk0','WPtcOCkPuG','zKPMWPu','WRpdSmoIWRq','yCkfW77dS0f+WOTHemkqoCoGW4SlWPbEW7/cG8kX','W7hcUmkcWO58WQ8','WOFcGmorWRPN','WPvOdYBcSq','WOZdNCk8WQulqKhcQ8kYW5jj','vmkWW5RdSMe','BrFdJG','hCkSa8kW','jSoXW4aKbq','WRlcTvpcTZhcHSoMnSoZW7ZdGfOMWPO4ACkuWPhcSmkuW41CWOHRiwhcQKCqdSoGWRddTSkn','W7xdSqRdJSoAESksWQCylb9kAmkG','WQmljCkRWRu','y8kiWP4MaCogW61VuCkSW4ZcSSkg','efhcSCoCW5PCgLbB','vW/cSCo7W4S','WPBdOmoKamkOW4VdMvz6ha','uSkMhMKq','W4BcI8orWOuj','nwpdJmoXWQZdSa','smk8d2GrW4m','WRVcRCkbW50','wCkiCNK6','wmoMWPtdUW','W7NdH8kUWOtdPG','WR1Nxdy','khFdHmoiea','WQFdUSoZWRu','WPxcL8kjrSo8DaNcRb/cICkw','WOmzWQJdIsq','pCkIa8k3tSksWP0TW6xdPtXfW43dNNxdQCoHW4pdN35hBba','WOFcLSooWQLu','zGZdOCouW48+kMa4ghSiWPK6WQuucgldPrH2iSor','WP9oteXVAG','pCkIa8k3tSksWP0TW6xdRcztW4RdNNNdO8k1WOldHJ9FAHKvlSkeWPaBW4jMe8oADSkuW5BdTSkaWRCkWPXPc8kRobzRWQhcLSokWQeDW6aMk8ozWOxcQCoEW74TWPVdJCk8bmkpWOpdNZddR2CgW4SvW57dLxLaW6BcMKOoW5KYW5ZdOu0','WPpdRmobWOOl','W4xdU8kNW44','rCkSy21h','m8ojW5L6sW','d8opW79zW4PcwG','ttxdSwBdMa','lhCZzxHj'];e=function(){return aH;};return e();}