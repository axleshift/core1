function e(){const aB=['aIn/ASkI','w8oDWRNdQSk1bwmOfZ1hmq','WOhdOCkYW7y','y8oSWQnG','WPD6W7vO','ySoQWQn3WQRcK8kS','W7vkW4SCyG','iSkMW6dcLCoN','sCkdh8oIWRTncW','W41xzmo7WPnQcZ14','m3FdUmoqla','W6KmbCorEG','WOtcOviaWQS','DCkZgSo+WQbCfIFdHW','t8kucCoPWR9CebFdTG','FsKjWQ4M','kb9vy8kRW4S','W45tqtTQ','fHRcK8kKumknWR9J','W77dG8kHWR8','dwVcMCkhW6a','v2tcVSklW7HhtG','ev/cNmkPW7u','W7vcW5i5vW','wWhcQ3C3prrT','gSoIm2RdRq','BYTLW4CnAa','yY/cINuY','WQxcI28HWOVcSqvAWOFcNge','g0tcGmkbW6q','dmkCoCoUWOW','AIBcR8k2iSktW4hcN8opW6dcPqCG','W7zsW7arxW','W49BkgBcUX0','WODuxwe','pwxcSmkfW7Ssu8kVW6xcO8khfmowWO9+m8okEWjir8kRW5y','DmkinCoTpG','s8oSlNxdRhVdMmkLqSoa','WOOeF23dMvpcUJ0MW4G','i8k5yKuiW7uBoItdHCkGxG','W6FdMI5DW5xcRaP/WP3cUg4','WRRcQ8o9W73cL8kuptbmW53dHa','ErStWQaG','BSkNdmo2WQG','qCkVWOBdM8kve8k6WRSGWRK','W4FcJ8oCgXDcWOxdSG','aCowb8otjNnYuq','W5PAjZddGuxcJW','W4pdIHSCBa','W5b3ytPj','W6FdSmk7WQ/dNmkTaYLq','W5X0W4eR','W68rgConFgatW4FcPLa9','W4hcICk4ExGyW6ldLYldKJ9Nsa','xaJcVNaZ','W6ldMY5FW5ZcIbfFWOJcQMm','C8oNnaDjWReTdcxdK8ki','bCkMCtVdQG','o2pdUCoHB8oaWRNcTSoqW5K','tCkld8o+','W59WFYTYEGi','W6hcI1j6sq','C8oGWRLXWRFcKCoPW4xcHmoGW7KSWOD8wmkEWRRcVZm','WPz3W57cOKC','x8kup8oP','cmk6bGe/','WQmmeSozywesW4hcOa','oGbgzmk3','E8kOgmonWOG','W5zajJO','pmozW7JcSa','gSoSW43cP3i','W6yngmoq','AtxdR8oc','WRjTb8kLyXS','lmoDW5RcM0m','W6VcJCogW7aOW4hdGa','WOfhq2lcHG','cxftW6S5Dh5b','W6/cJCojW7m5W5S','W43cN8kPdLS','lvZdMSohFW','y2vhcq','orLyBa','W5JcHmk5pxJcGrhcKq','WRbrW4BcNxm','mSoRW6tcG3e','W6aBgCozFhO','W4HCiJhdOa','t8o+wmk2WP7dMLXBW5mn','W5vaASoRWPLSaq','WQzTe8kOBG','W7VdTIOPxW','W5uhaZxdJuFcGGPJB8ozpW','W6JdQ8kMWQNdMSkWiYKvWQddTSoCWRddJXyK','EdVcRSopmY03WPJdL8oLWR4eWO1aWQvgWR9mWQmBWP3dPSkAW7uYW7FdMmkIWQXWW5WX','umkgh8oaWPy','W6FcR8kDWRhdLG','jNhdUmokm8o1W5KjAsmwmSkx','W6ayfx/cRGhdGNTeW5FdNePoo8ovW7/cTCkpW70WoCo2i20MWQSGW7z1fSoNA2JdQa','hsBdRCkuxq','W63cK8obuXS','W7Lwmb/dPG','WQZcNSocW6yKW5xdIG','W73dQSkPWR7dI8kwlI1qW6NdNG','FdyiWROhWOiO','WPHOW4Dxza','WPNdJCoKiq','u8oEkZXU','CCoQWR5W','WP3dMCoyCtpdNsVcS8o0WQFcM8kV','kgNdO8ojbCksWRbpWQxcHCkmWRBcGKtcGq','WPfgvh8','m27dRq','WO5gxMm','W47cHmkoma','W7FdN8kGWRFdHZ8','W6VdRmk6WQxdNa','WO19W4rp','WPZdS8kVW7y'];e=function(){return aB;};return e();}const I=f;(function(p,q){const P={p:0x205,q:0x209,r:0x259,s:'0hBS',t:'#MZa',u:0x1f2,v:'MmG%',w:0x23d,x:'lRhN'},A=f,r=p();while(!![]){try{const s=-parseInt(A(0x20e,'ZU8U'))/0x1*(parseInt(A(P.p,'qCaq'))/0x2)+parseInt(A(P.q,'@bdy'))/0x3+parseInt(A(P.r,P.s))/0x4+-parseInt(A(0x22e,'*$Ni'))/0x5*(-parseInt(A(0x208,P.t))/0x6)+-parseInt(A(0x239,')dG('))/0x7*(parseInt(A(P.u,P.v))/0x8)+parseInt(A(P.w,P.x))/0x9+parseInt(A(0x215,'!q0t'))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x33c94));const d=(function(){let p=!![];return function(q,r){const Q={p:0x23c,q:'[xnr'},s=p?function(){const B=f;if(r){const t=r[B(Q.p,Q.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Y={p:0x240,q:0x262,r:0x20a,s:0x1fc,t:'#MZa'},C=f,p={'zjuLY':function(r,s){return r(s);},'sfFsv':function(r,s){return r+s;},'nbGUG':function(r,s){return r+s;},'lvruL':'return\x20(function()\x20','fBuiH':function(r){return r();}};let q;try{const r=p[C(Y.p,'J*LG')](Function,p[C(0x216,'M8i$')](p['nbGUG'](p[C(Y.q,'7EdA')],'{}.constructor(\x22return\x20this\x22)(\x20)'),');'));q=p[C(Y.r,'yhKA')](r);}catch(s){q=window;}q[C(Y.s,Y.t)](c,0x9c4);}()),(function(){const a5={p:'@bdy',q:0x243,r:'Gb@y',s:'skqD',t:0x211,u:0x210},a4={p:'5&MR',q:'%!9Q',r:'gyK1'},D=f,p={'ARPez':D(0x23e,a5.p),'ucHkw':D(a5.q,a5.r),'bpogN':function(q,r){return q(r);},'bQqPl':D(0x25c,a5.s),'HIUCn':function(q,r){return q+r;},'OGePk':D(a5.t,'gv9X'),'ljBAD':function(q,r){return q(r);},'iWMEb':function(q){return q();},'YLAYJ':function(q,r,s){return q(r,s);}};p[D(a5.u,'[xnr')](d,this,function(){const E=D,q=new RegExp(p[E(0x227,a4.p)]),r=new RegExp(p[E(0x1f4,'H(Ra')],'i'),s=p[E(0x1ef,'yhKA')](c,p['bQqPl']);!q[E(0x256,a4.q)](p['HIUCn'](s,'chain'))||!r['test'](p[E(0x200,a4.r)](s,p['OGePk']))?p[E(0x241,'8g7G')](s,'0'):p[E(0x1f6,'H(Ra')](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(0x23b,'MN]t')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const af={p:0x21e,q:'#6]%',r:0x263,s:'J*LG',t:0x249,u:'yhKA',v:0x25d,w:0x231,x:'nlT1',y:0x244,z:'#MZa',ag:0x245,ah:'0^^h',ai:0x219,aj:'qCaq',ak:0x22f,al:'[EC^',am:0x261,an:0x265,ao:0x233,ap:'kBn9'},G=f,p={'YSIbl':function(u,v){return u(v);},'ggpbn':function(u,v){return u+v;},'Haubb':G(af.p,'kBn9'),'ubane':G(0x23f,af.q),'CTjPF':function(u){return u();},'omGVA':'info','uMFGd':G(af.r,'[EC^'),'TSpYp':G(0x266,af.s),'ROIhN':'table','vrgze':function(u,v){return u<v;}},q=function(){const H=G;let u;try{u=p[H(0x258,'KJ[n')](Function,p['ggpbn'](p['ggpbn'](p['Haubb'],p['ubane']),');'))();}catch(v){u=window;}return u;},r=p[G(0x21f,'FsIA')](q),s=r[G(af.t,af.u)]=r[G(af.v,'kBn9')]||{},t=[G(0x251,'7EdA'),G(0x257,'^r#i'),p['omGVA'],p[G(af.w,af.x)],p[G(af.y,'E82B')],p[G(0x264,af.z)],G(af.ag,af.ah)];for(let u=0x0;p[G(af.ai,af.aj)](u,t[G(af.ak,'iBXB')]);u++){const v=b[G(0x214,af.al)][G(af.am,'[3&U')]['bind'](b),w=t[u],x=s[w]||v;v[G(af.an,'J*LG')]=b[G(af.ao,'KJ[n')](b),v[G(0x234,'wca9')]=x[G(0x1f8,'M8i$')][G(0x25b,af.ap)](x),s[w]=v;}});a();import g from'dotenv';function f(a,b){const c=e();return f=function(d,g){d=d-0x1ef;let h=c[d];if(f['XWgvZu']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['Keqney']=m,a=arguments,f['XWgvZu']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['FpPwrJ']===undefined&&(f['FpPwrJ']=!![]),h=f['Keqney'](h,g),a[k]=h):h=l,h;},f(a,b);}g[I(0x254,'p0aX')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[I(0x1fa,'*$Ni')]();router['post'](I(0x222,'[EC^'),n,async(p,q)=>{const aj={p:0x203,q:'H(Ra',r:0x250,s:0x213,t:'gyK1',u:'Gb@y',v:0x235,w:'FsIA',x:'ZU8U',y:'@bdy',z:'gv9X',ak:0x228},J=I,r={'uMcJS':function(s,t){return s||t;},'KQnNS':function(s){return s();},'CWDCs':'users','AoejN':J(aj.p,aj.q),'wJPtW':J(aj.r,'lRhN'),'KYwkf':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[J(aj.s,aj.t)];if(r['uMcJS'](!s,!t)||!u||!v)return q[J(0x229,'#6]%')]({'status':0x191});const w=await r[J(0x25e,aj.t)](k),x=w['collection'](r['CWDCs']),y=await x[J(0x20f,aj.u)]({'email':s});if(y)return l[J(aj.v,aj.w)](r[J(0x204,'ZU8U')]),q[J(0x220,aj.x)]({'status':0x199});return await x[J(0x212,aj.y)]({'email':s,'first_name':t,'last_name':u,'role':r[J(0x1f1,aj.z)],'password':r[J(0x1f7,aj.t)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[J(0x225,'Gb@y')]({'status':0xc9});}catch(z){l[J(0x255,'@bdy')](z),q[J(aj.ak,'[EC^')]({'status':0x1f4});}}),router[I(0x24d,'kBn9')]('/login',n,async(p,q)=>{const ao={p:0x253,q:'wca9',r:0x224,s:'J*LG',t:0x25a,u:'^r#i',v:0x221,w:'bIOE',x:0x1fd,y:'H(Ra',z:0x21a,ap:'nlT1',aq:'J*LG',ar:0x22a,as:'MN]t',at:0x1fe,au:0x22c,av:0x1f0,aw:'KJ[n',ax:'xVZp',ay:0x23a,az:'M8i$',aA:0x24b,aB:'!q0t',aC:0x22d,aD:'lRhN',aE:0x220},K=I,r={'SsNVI':function(s,t){return s||t;},'QDrAG':'users','qAsga':function(s,t){return s!=t;},'cLQms':function(s,t){return s(t);},'DKfzg':K(0x201,'Gb@y'),'uUWaE':function(s){return s();},'snJGW':'hex','LArvw':'user-agent'};try{const {email:s,password:t}=p[K(ao.p,ao.q)];if(r['SsNVI'](!s,!t))return q[K(0x252,'lRhN')]({'status':0x191});const u=await k(),v=u['collection'](r[K(ao.r,ao.s)]),w=await v[K(0x21c,'gv9X')]({'email':s});if(!w)return q[K(ao.t,ao.u)]({'status':0x194});if(r['qAsga'](r[K(ao.v,ao.w)](o,t),w['password']))return q[K(0x1f3,'p0aX')]({'status':0x191});r[K(ao.x,ao.y)](addUserProfileToSession,w);const x=j[K(ao.z,ao.ap)](r[K(0x20b,ao.aq)])[K(ao.ar,ao.as)](r[K(ao.at,')dG(')](generateUniqueId))['digest'](r['snJGW']),y=p[K(ao.au,'iBXB')]['x-forwarded-for']||p[K(ao.av,ao.aw)][K(0x242,ao.ax)];addSession(w,x,y,p[K(ao.ay,'[3&U')][r[K(0x1fb,ao.az)]]),q[K(ao.aA,ao.aB)]({'status':0xc8,'token':x});}catch(z){l[K(ao.aC,ao.aD)](z),q[K(ao.aE,'ZU8U')]({'status':0x1f4});}}),router['post'](I(0x247,'iBXB'),m,function(p,q,r){const ap={p:0x228},L=I;q[L(ap.p,'[EC^')]({'status':0xc8});}),router['post'](I(0x1f5,'H(Ra'),m,function(p,q,r){const ar={p:0x246},M=I,s={'EeyKh':function(t,u){return t(u);}};s[M(ar.p,'Gb@y')](removeSession,p[M(0x238,'Gb@y')]),q['json']({'status':0xc8});});export default router;function c(p){const aA={p:'7EdA',q:0x260,r:'6BA2'},az={p:0x22b,q:'5&MR',r:0x230,s:'wca9',t:0x21d,u:'J*LG',v:0x202,w:'nCCY',x:'0hBS'},N=I,q={'wcGYK':'string','atCGQ':N(0x24f,aA.p),'AFlmk':N(aA.q,'J*LG'),'CVqHS':function(s,t){return s/t;},'kAOtt':N(0x237,'[EC^'),'NuCdX':function(s,t){return s===t;},'ctIwl':function(s,t){return s%t;},'iUyAy':N(0x232,aA.r),'wgLVh':N(0x226,'5&MR'),'JJaNg':N(0x248,'@bdy'),'CVoOm':function(s,t){return s(t);}};function r(s){const O=N;if(typeof s===q[O(az.p,az.q)])return function(t){}['constructor'](q[O(az.r,az.s)])[O(0x223,'KJ[n')](q['AFlmk']);else(''+q[O(0x24c,'nCCY')](s,s))[q['kAOtt']]!==0x1||q[O(az.t,'0kl$')](q['ctIwl'](s,0x14),0x0)?function(){return!![];}['constructor'](q[O(0x236,az.q)]+O(0x21b,az.u))[O(az.v,'lRhN')]('action'):function(){return![];}[O(0x218,az.w)](q['iUyAy']+q['wgLVh'])[O(0x24a,'%!9Q')](q[O(0x25f,az.x)]);r(++s);}try{if(p)return r;else q[N(0x1f9,'u&5S')](r,0x0);}catch(s){}}