const I=f;(function(p,q){const T={p:0xea,q:0x145,r:'pflN',s:0x101,t:'EWrC',u:0x126,v:0x193,w:'h^32',x:'Evp#',y:'4fSs'},B=f,r=p();while(!![]){try{const s=-parseInt(B(T.p,'4fSs'))/0x1*(-parseInt(B(0x19d,'kren'))/0x2)+parseInt(B(T.q,T.r))/0x3*(-parseInt(B(0xdf,']#[a'))/0x4)+parseInt(B(T.s,'j4KX'))/0x5*(parseInt(B(0x1a0,T.t))/0x6)+-parseInt(B(0x155,T.r))/0x7*(-parseInt(B(T.u,'YDbf'))/0x8)+parseInt(B(T.v,'Evp#'))/0x9*(-parseInt(B(0xee,T.w))/0xa)+-parseInt(B(0x19f,'6m3j'))/0xb*(parseInt(B(0xd1,T.x))/0xc)+-parseInt(B(0x123,T.y))/0xd;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x37951));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x142,'SFkk')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:0xda,q:'RkeM',r:'Laak',s:0x170,t:'RkeM',u:0x10b},D=f,p={'ItMiq':function(r,s){return r(s);},'AxboN':function(r,s){return r+s;},'iCCPD':D(a1.p,'VYL1'),'uiXiv':function(r){return r();}};let q;try{const r=p[D(0x148,a1.q)](Function,p[D(0x102,a1.r)]('return\x20(function()\x20'+p[D(a1.s,a1.t)],');'));q=p[D(a1.u,'j@UZ')](r);}catch(s){q=window;}q[D(0x164,'F[*2')](c,0x9c4);}()),(function(){const a7={p:0xf4,q:0x15e,r:'SFkk'},a6={p:0x182,q:'pflN',r:'4]fl',s:'7obO',t:'j4KX',u:'[kOS',v:0xf9,w:'RkeM',x:0x110},E=f,p={'bnLxe':E(a7.p,'r(]i'),'gJbFP':function(q,r){return q(r);},'GHgkK':E(a7.q,'7obO'),'fTOrf':function(q,r){return q+r;},'WIMeX':E(0x13c,a7.r),'AjCDu':function(q,r){return q+r;},'dlsMk':E(0x10a,'7obO'),'urXRI':function(q){return q();}};d(this,function(){const F=E,q=new RegExp(F(a6.p,a6.q)),r=new RegExp(p[F(0x125,a6.r)],'i'),s=p[F(0xcf,a6.s)](c,p['GHgkK']);!q[F(0xfa,a6.t)](p['fTOrf'](s,p[F(0x186,a6.u)]))||!r[F(a6.v,'Laak')](p[F(0x18b,'Laak')](s,p[F(0x104,a6.w)]))?p[F(a6.x,'iaLt')](s,'0'):p['urXRI'](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const G=f;if(r){const t=r[G(0x180,'4fSs')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ae={p:0xf7,q:'j4KX',r:'r3XM',s:0x121,t:0x1a5,u:'V&]b',v:'2As1',w:0x1ae,x:0x141,y:'tfM@',z:'F[*2',A:0xf1,af:0x116,ag:0x117,ah:'6m3j',ai:0x16e,aj:0x188},H=f,p={'SSMZj':function(t,u){return t(u);},'YmuZX':function(t,u){return t+u;},'IKBuH':H(ae.p,ae.q),'IqOSz':H(0x19a,ae.r),'UgEdq':H(ae.s,'t04u'),'Iwemg':H(ae.t,'VYL1'),'wkpPe':H(0x1af,ae.u),'YImmP':'table','AfMJW':'trace'};let q;try{const t=p[H(0xeb,'SvvG')](Function,p[H(0x176,'SFkk')](p['YmuZX'](p['IKBuH'],p[H(0xe7,'[kOS')]),');'));q=t();}catch(u){q=window;}const r=q['console']=q['console']||{},s=[H(0x152,ae.v),p[H(ae.w,'SvvG')],p[H(ae.x,ae.y)],'error',p[H(0x159,ae.z)],p[H(ae.A,'[kOS')],p[H(ae.af,'KTjV')]];for(let v=0x0;v<s[H(ae.ag,ae.ah)];v++){const w=b['constructor'][H(0x14e,'8P(p')]['bind'](b),x=s[v],y=r[x]||w;w['__proto__']=b[H(0x177,'8P(p')](b),w[H(0xcb,'twx]')]=y[H(ae.ai,'X78W')][H(ae.aj,'xMy9')](y),r[x]=w;}});a();import g from'dotenv';g[I(0xe8,'5kos')]();import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';function e(){const aX=['W5ZcGmkBW6TU','W4/dVclcOgC','W5X+ESk6WRu','oCogv18ZrhG','W6L4W4bQAmk9ECoTlmkCWRG','kv7cHmk0','WQhdVHCt','W4xcG8kbW65c','W697D8k/WQS','m1lcRmkejW','BSkCaaKnAeHpWPeG','W5FcIdJcTxPQW7tcQCoftCoUbSolW68hn8o8eCk7bSkoW7nQW59DW7tcP8kEouFcI20','WPJcNKikWPJdJW','CSkLWP/dSq','WQ/cPmowWO7dOSoKW5W','zctcISkxyCkd','WObIodOXWQb1W6CdvW','sM1zW7bnWPVdG8oa','WPldKCkzBW','xclcNCkyCW','cSotjvWc','W5H/tSkO','WOJdShVcNa','W5DZt8kLASkR','WR3cKcSYCq','W5/dOc3cQ1e','WQ5BW50ThCoQ','As3cIa','WOmcWQNdT8oEW63dVKNcQCo2WR5Olmo+ihldRq3cHSo3nc3cKG','WO7cMayitW','iSkpW7VcTmoyW7Cw','zvDyv0e','DSkCW53dTheruI/cIa','v8k4WPxcV3JcIH/cPmoOyNGVemoyB8oecKepWOtdNmkrmG','cG8qyG','EeT+o8kUWRdcSJG','WQhdUX7cQq','cSoGkL0l','W4eMANSWWRy','bZyDsHK','W7/dUc3cMMy','W6P8W4HTkSkBrSo8lCkL','sSkKtx8IeIvcoG','W47dNWJcRwG','ccXPW4D8','gc1+W5P9','W6WPWRFdKa','ndxdSrW','z0OgWRxcJbH9W7itWR7cNa','jXBdS8k8WPy','WPRdOZpcKmoMxCoDWQlcVvCeWQOpW7VcKaz1W4/cLZxcRIFdV8oOfCo9W7hcOY7cNmojW6S','WRldPbWfWRtcPCkr','WPKWWQxcS8kltmk7AtK','W60/WQhdLG','W5NdTIBcVq','W6JdKeLhibBdN05HWRy3WOq','W4BcHNNcUa','lZxdPW','cc9OW5r7WPNdOCoDWQy','aWxdICk8WOW','tmknW5O','W605l8kO','iSoZWRbw','W612yCkczq','WRZdQIOdxCoX','n1ddLCkV','WQPPW6BcK8oeW6BcRSkDFciTsG','y2nqAvO','WRFdVXCaWO/cRSk8sXvL','W5/dVGlcThC','ACkKW655Dq3cLJSQ','W6lcTCku','q0r8r0xcVq','W71oq8k8tW','vfL6vKpcUG','F1/cKxm','W7BcUbtdSGldHCosW5/dNvSKBehdK0HLW5PbW5JcNtZdP8kAW5fAWPGIE3ylFmkFWONdSG','x3BcHqDbWOFdNCkxsN4','EuNcMMu','ySkEW4VcHCojW75YW50ahu/cKCoqWQ0Wbc8paq','W6ZdUI/cQuq','mZxdRaW','zmkEW4ZcHa','kSoHW6nXWOlcISk3wIpcQu/cTLlcM2/cPSorWOXmxJjQqSkUewuzWPiQW68exCkjo8kYW6tdOmo1W47cJ2nGW7hdMmosr8opWQ/dGSouWRRcJmkaW6pcRCk1WQ/cQaRcQJBcJ8kzes8EmSkTtCoPW6XtW5r8WRmic1ZdKX1dyCkstJlcPa','W4/dVINcSe4','W604W6Kjjq','W4RcNhJcSLPQW6i','vwFcKCkPBvBcLa','WOpdTgddQ1m','jSoiWO3dG8klW5m/WQW+hwS','bIJdVrFdHa','EgK8hG','hN3cH8kwBW','D8kIWOa','jmoLWRTa','WQyqWR/dTG','WQn/WRJdGSoN','W5rOxCkL','cripEt0','WQhdPcOiWO0','W4NdVcBcQLBcNCkpWOpcK283','WPVdJCkABCkAW7RcUmkWASkO','W4pdPXBcM3C','lIpdGb3dPWBdHgP5W73cIwNdT8oXg8krW5W','W4VcKNJdIvq','y0CnpZK','WQLaW5C8bG','W5NcHNpcPdHLW6dcUmozta','WQVdSrVcTmopWQ3dJa','W5/cGxFcOMb3','W6FdSYNcVLi','W543zwGXWQ0','DaLlimkUWQ7cVs3cQmoJvSkiW67cVIi','pSomtvitra','W5mIE2m8','WODnWR3dQ8o4ASkoxLRdKCkzW5rD','pmkrW43dThm','cCoHWPb7tW','WO3cReK3WQS','W5tdH8kuxCks','WQVcJWKc','W5X7uSkI','WQH9WPbRD8oKWRbAsvJcOW8','WQ1QW6xcKCoeW6FdS8kbrayDD3S','W7KHW4aJ','WPpdLXJdJr8','W5/dH18ktSouwmoeBq','dJPIW5e','W7JcTCkiW61I','kSoMW4pcQLJcHGBcQSkRFa','pvZcJ8kI','jcy5cZ40WRZcOuD5tMaZw8oXdLvPj0FdT8oDELXZqtxcKa','WR7dOtpdVq0','cXzyW5z2','cNFcUCkxAW','dXvfW5PM','WQZdSsurqCoL','W6JcTISexMRdKW','ECkZWQhdJea','WQpdTdRdTZi','u01j','tWOAFIaxW45Ij8k5WOTxWRHiW5m','WRuGWOy','WOm7WRJcSG','DmoMWQyxFq','neVdH8kVWQzf','sLvOk8k9','A8kIWPhdQ1NcKa','jfFdH8kYWR0','zZxcLa','smk3WQe3W4BcGCkVsKhcP1q','qf0sWQu','iSo+WR8al2G','W7NdICkjySkF','jK/dLSk3WQO','WPRdLmkBsCkl','WRxdVqinWOi','vshdQSkHWRtcQsm','WQ0FWP4WlW','WO3dNXOQWOi','m2xcUCkYDq','uILPW4DMWPRdL8kCWQZdMSkf','W77cV8ktW6rTt3C','W5tdM8koEG','aCoIhea4mG','h2pcHSk0DG','WOJdKmkzDCkqW63cTCkPya','eWGEEdWc','WPnbWQldT8o4umkHw1pdHG','WQtdUt3cHmoz','zgKO','f17dLCkOWQrzCCoaWPyFpSk+rCktW5tcJMS8W5xcJazlomozW7/dObPLW7mLW6uiiCoNxK3cGG','iK3dLmk0WQe','vuFcJ8oIW4VcUYRcRWLsaW','WRqeWR/dTG','W4JdUHm','WRGGWPu6','W6K3mCkCrW','iXZdJYZdVa','W7aZnG','W77cSCo+WQy','W4y9ygOR','criwEa','W4BcQ3xdOq','WROnWQNdOCoBW7BdG0pdRa','itBdVmk4WQ8','W7NcUCkiW4DK','WQNdPXxcVG','W605nCkftmoRW6ZdUCkshJ8','WQ7dLZalxq','W5FdJSkzzSkqW6ZcUa','WP/dHsxdPYe8W4dcSSopv8oafG','tLCyWRVcIHu','WQG7WPaRlSkQ','WPVdJCkyCSklW6VcUCk6CCkPWQ8','W6NcV8o5WQ/dRW','W4qMkSk9vq','WRldRhhdJxe','rCoOWRaNy8k3uCkD','tMxcJGjAWO8','e1lcT8klqa','W5/dISkC','WPJcNLexWOpdMW','nftcNq','W5BdUHFcGa','WP4XWQe','hLldK8kbWOS','WPRdI8kyzq','WRKqWRxdQG','EmogWPKCsa','seezWRi','u19Xx1xcRCkwW5zFWR0','W47dSNlcLmoGxq','pb/dHJjRW5G1W5uGWOyd','WRZdQbmfWP7cUCkh','WR3dOHKrWOi','W7GQWQldJSke','WPldTMRdP1e','aaldLCkWWORcHaFcL1m2mZO/ACkXW4C','W6G6W4uUk8ktWR1/E3dcLq','WPddGtNdGWi','BM8HdH0ZWR0','W7noy8k0rW','x2VcJHvbWPddJmkRx2xdVq','AexcMMu','cCo0W7f2WOdcLG','WP/dQc7cVJhcLLtcUXVdLCkr','bJRdNdZdVW','F1bmo8kPWQO','datdLmk9','W4pdGJlcM3C'];e=function(){return aX;};return e();}import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';function f(a,b){const c=e();return f=function(d,g){d=d-0xcb;let h=c[d];if(f['iXtEQr']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['CuEAzh']=m,a=arguments,f['iXtEQr']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['qgrMzj']===undefined&&(f['qgrMzj']=!![]),h=f['CuEAzh'](h,g),a[k]=h):h=l,h;},f(a,b);}import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';const router=h['Router']();router[I(0x103,'2As1')]('/register',async(p,q)=>{const ai={p:0xfb,q:0x1ab,r:'1KCE',s:0x13f,t:0xf6,u:'xMy9',v:0x19b,w:'MLAI',x:0x19b,y:0xe0,z:'r3XM',A:0x14f,aj:'7obO',ak:0x1a2,al:0x15f,am:0xfd,an:0x185,ao:'2As1',ap:'RkeM',aq:0xed,ar:0x194,as:0x18e,at:'KTjV',au:0x189,av:0xd5,aw:0xe5,ax:'F[*2'},J=I,r={'OoZwo':'Invalid\x20email\x20address','izJai':J(0x153,'SFkk'),'xvWiF':J(ai.p,'l)IO'),'Tcyhf':function(s,t){return s!=t;},'vvMSk':J(ai.q,ai.r),'YEHFe':function(s){return s();},'umJmU':'Email\x20id\x20already\x20exists','gmGTs':'user','eWVor':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(ai.s,'[F3v')];if(!s||!t||!u||!v||!w)return q['status'](0x190)[J(ai.t,ai.u)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/['test'](s))return q[J(ai.v,'bI1%')](0xc8)[J(0x18d,'pflN')]({'error':r['OoZwo']});if(v[J(0x19e,ai.w)]<0x8)return q[J(ai.x,'bI1%')](0xc8)[J(ai.y,ai.z)]({'error':r['izJai']});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[J(0xdd,'4fSs')](v))return q[J(ai.A,ai.aj)](0xc8)['json']({'error':r[J(0xcd,'pmAN')]});if(r[J(ai.ak,'MLAI')](v,w))return q['status'](0xc8)[J(ai.al,'iaLt')]({'error':r[J(ai.am,'rl2U')]});const x=await r['YEHFe'](k),y=x['collection']('users'),z=await y[J(ai.an,ai.ao)]({'email':s});if(z)return l[J(0x14d,ai.ap)](r[J(ai.aq,'r(]i')]),q['status'](0x199)[J(ai.ar,'INUW')]();return await y[J(0xdc,'lNnT')]({'email':s,'first_name':t,'last_name':u,'role':r[J(0x151,'j70Y')],'password':r[J(ai.as,ai.at)](o,v),'email_verify_at':'','created_at':Date['now'](),'update_at':Date['now']()}),q[J(ai.au,'l)IO')](0xc9)[J(0xde,'r(]i')]();}catch(A){l[J(ai.av,'EWrC')](A);}return q['status'](0x1f4)[J(ai.aw,ai.ax)]();}),router[I(0x120,']#[a')](I(0x17c,'VYL1'),n,async(p,q)=>{const am={p:'r(]i',q:'h^32',r:0xe1,s:0x118,t:'twx]',u:0xcc,v:'6m3j',w:0x18f,x:'LXJa',y:0xfe,z:0x115,A:'r3XM',an:0xe6,ao:0x15a,ap:'Evp#',aq:0x132,ar:'&Yy$',as:0xf2,at:0x17e,au:'j@UZ',av:0x196,aw:0x11b,ax:0x114,ay:0x16d,az:'24q&',aA:0x19b,aB:'bI1%',aC:0x163,aD:0x154,aE:0x1a9,aF:'EWrC'},K=I,r={'aeQSl':function(s){return s();},'PZxcb':K(0x1a8,am.p),'dLPTv':function(s,t){return s!=t;},'vPoot':K(0x140,am.q),'OEcUH':K(am.r,'Laak'),'IYbfN':K(am.s,am.t),'pfzSL':function(s,t,u,v,w){return s(t,u,v,w);},'EwzCL':K(0x113,'r3XM')};try{const {email:s,password:t}=p[K(am.u,'j70Y')];if(!s||!t)return q[K(0xce,am.v)](0x190)['send']();const u=await r['aeQSl'](k),v=await u['collection'](r[K(am.w,am.x)])[K(am.y,'r3XM')]({'email':s});if(!v)return q[K(am.z,am.A)](0x194)[K(am.an,'h^32')]();if(r[K(am.ao,'Laak')](o(t),v['password']))return q['status'](0x191)[K(am.an,'h^32')]();const w=j[K(0xec,'j@UZ')](r[K(0x146,am.ap)])['update'](r[K(am.aq,am.ar)](generateUniqueId))[K(am.as,'SvvG')](r['OEcUH']),x=p[K(am.at,am.au)][r[K(am.av,am.x)]]||p['socket'][K(am.aw,'InHg')];return r['pfzSL'](addSession,v,w,x,p[K(am.ax,'j70Y')][r[K(am.ay,am.az)]]),q[K(am.aA,am.aB)](0xc8)[K(am.aC,'j70Y')]({'token':w});}catch(y){l[K(am.aD,'SFkk')](y);}return q[K(am.aE,')O(i')](0x1f4)[K(0x127,am.aF)]();}),router[I(0x174,'KTjV')](I(0xff,'RkeM'),m,async function(p,q,r){const as={p:0x171,q:'tfM@',r:'4fSs',s:0x10f,t:0xd0,u:'KTjV',v:0x139,w:'[F3v',x:0x191,y:'t04u',z:'EWrC',A:0x13a,at:0x1a1,au:'SvvG',av:0x178,aw:'1KCE'},L=I,s={'YmInc':function(z,A){return z!==A;},'VWhFk':function(z){return z();},'wdZvt':L(as.p,as.q),'rJIoi':function(z,A){return z*A;},'IFApR':function(z,A){return z*A;},'FqEda':function(z,A){return z-A;}},{_id:t,email_verify_at:u,...v}=p[L(0xd6,as.r)];v[L(as.s,'Laak')]=s[L(as.t,as.u)](u,'');if(p[L(0x195,'j@UZ')]['email_verify_at']!=='')return q[L(as.v,'SFkk')](0xc8)[L(0x17a,as.w)](v);const w=await s[L(0x108,'InHg')](k),x=await w[L(0x17b,'SvvG')](s[L(as.x,as.y)]),y=await x[L(0xdb,'j@UZ')]({'token':p['token'],'verified':![]});if(y){const z=new Date(y['created_at']),A=s[L(0x12f,as.z)](s['IFApR'](0xa,0x3c),0x3e8);if(!(s[L(as.A,'twx]')](Date['now'](),z)>A))return q['status'](0xc8)[L(as.at,'8P(p')]({'otp':!![]});}return sendOTPEmail(p,x),q[L(0xf0,as.au)](0xc8)[L(as.av,as.aw)]({'otp':!![]});});const sendOTPEmail=(p,q)=>{const aw={p:'&Yy$',q:'7Z%3',r:0x1aa,s:'MLAI',t:0x160,u:'1KCE',v:'INUW',w:0x107,x:0xfc,y:'r(]i',z:'X78W',A:0xf3,ax:'xMy9'},M=I,r={'XwNIU':function(t,u){return t+u;},'zFvLx':function(t,u){return t*u;},'Figpf':function(t,u,v){return t(u,v);},'IAzOY':M(0x1b0,aw.p)},s=Math[M(0x1ac,'YDbf')](r[M(0x11d,'h^32')](0x186a0,r['zFvLx'](Math[M(0x16f,aw.q)](),0xdbba0)));Promise[M(aw.r,aw.s)]([q[M(aw.t,aw.u)]({'user_id':p['user']['_id'],'token':p[M(0x16b,'kren')],'code':s,'verified':![],'expired':![],'created_at':Date[M(0x173,aw.v)](),'updated_at':Date['now']()}),r[M(0xf8,'r(]i')](send,{'to':p[M(aw.w,'1KCE')][M(aw.x,aw.y)],'subject':r[M(0x179,aw.z)],'text':'Your\x20otp\x20is\x20'+s+M(0x12b,'2As1')},p[M(aw.A,aw.ax)][M(0x150,'InHg')])]);};router[I(0x109,'[kOS')](I(0x11c,'V&]b'),m,async function(p,q,r){const ay={p:'RkeM',q:0x15d,r:0x14c,s:'pmAN',t:0x19c,u:'24q&',v:'KTjV'},N=I,s={'pfMLo':function(t,u){return t(u);}};try{const t=await s[N(0x12e,ay.p)](getUser,p[N(ay.q,'6m3j')]);return q[N(ay.r,ay.s)](0xc8)[N(ay.t,'&Yy$')]({'user':{'email':t[N(0x181,ay.u)],'first_name':t['first_name'],'last_name':t['last_name']}});}catch(u){l[N(0x10e,ay.v)](u);}return q['status'](0x1f4)[N(0xde,'r(]i')]();}),router[I(0xe9,'SFkk')](I(0x166,'8P(p'),m,function(p,q,r){const aA={p:'X78W',q:'LXJa',r:0x130},O=I,s={'EaEDl':function(t,u){return t(u);}};return s[O(0x138,aA.p)](removeSession,p[O(0x128,aA.q)]),q[O(aA.r,'5kos')](0xc8)[O(0x1a4,'t04u')]();}),router['post'](I(0x135,'7obO'),[m,n],async function(p,q,r){const aG={p:'4]fl',q:'5kos',r:0x112,s:')O(i',t:0xf5,u:0x111,v:0xe4,w:0x175,x:'lNnT'},P=I,s={'RMnBH':function(t){return t();},'qRtni':P(0x13d,'MLAI'),'zgaqL':function(t,u){return t*u;},'kABUk':function(t,u){return t*u;},'JUoRB':function(t,u){return t>u;},'BCmjr':function(t,u,v){return t(u,v);}};try{const t=await s[P(0x133,aG.p)](k),u=await t['collection'](s[P(0x165,aG.q)]),v=await u['findOne']({'token':p[P(aG.r,aG.s)],'verified':![],'expired':![]});if(v){const w=new Date(v[P(aG.t,'7Z%3')]),x=s['zgaqL'](s[P(aG.u,'2As1')](0xa,0x3c),0x3e8);s['JUoRB'](Date['now']()-w,x)&&(await u['updateOne']({'_id':new ObjectId(v[P(aG.v,'V&]b')])},{'$set':{'verified':![],'expired':!![],'updated_at':Date[P(aG.w,aG.x)]()}}),s['BCmjr'](sendOTPEmail,p,u));}}catch(y){l['error'](y);}return q[P(0xce,'6m3j')](0x1f4)['send']();}),router[I(0x103,'2As1')](I(0x149,'EWrC'),[m,n],async function(p,q,r){const aL={p:'[F3v',q:0xd4,r:'EWrC',s:0x124,t:'rl2U',u:0x105,v:0x18c,w:'twx]',x:'Laak',y:0x147,z:'j@UZ',A:0x100,aM:'EWrC',aN:0x11e,aO:'KTjV',aP:'Evp#',aQ:0x1a3,aR:0x158,aS:'Evp#',aT:0x13b,aU:0x1b1,aV:'7obO',aW:'EWrC',aX:0x15b,aY:'F[*2',aZ:'SvvG',b0:0x17f,b1:'j@UZ',b2:'EWrC',b3:0x106,b4:'h^32',b5:0x134,b6:'twx]',b7:0xef,b8:'LXJa',b9:0x1a6,ba:'[kOS',bb:0x137},Q=I,s={'IORkR':function(t){return t();},'YRhKy':'otp','vITcy':function(t,u){return t*u;},'fFjIF':function(t,u){return t-u;},'tplpi':Q(0xd8,aL.p),'xEXhO':function(t,u){return t!==u;},'Zzkqw':'Invalid\x20OTP','iokpy':Q(aL.q,aL.r)};try{const t=p[Q(aL.s,aL.t)][Q(aL.u,'&Yy$')];if(!t)return q[Q(aL.v,aL.w)](0x190)[Q(0xd7,aL.x)]();const u=await s['IORkR'](k),v=await u[Q(0x10d,'8P(p')](s[Q(aL.y,aL.z)]),w=await v[Q(0x192,'A8pN')]({'token':p[Q(aL.A,'24q&')],'verified':![],'expired':![]});if(w){const x=new Date(w['created_at']),y=s[Q(0x12d,aL.aM)](0xa,0x3c)*0x3e8;if(s[Q(aL.aN,'bI1%')](Date[Q(0x157,aL.aO)](),x)>y)return q[Q(0x169,aL.aP)](0xc8)['json']({'error':s['tplpi']});}if(s[Q(aL.aQ,'pmAN')](w[Q(aL.aR,aL.aS)],parseInt(t[Q(0x14a,'LXJa')](/[^0-9]/g,''))))return q[Q(aL.aT,'&Yy$')](0xc8)[Q(aL.aU,aL.aV)]({'error':s[Q(0x16c,'F[*2')]});return await Promise['all']([v[Q(0xe2,aL.aW)]({'_id':new ObjectId(w['_id'])},{'$set':{'verified':!![],'updated_at':Date[Q(aL.aX,aL.aY)]()}}),u[Q(0x17b,aL.aZ)](s[Q(aL.b0,aL.b1)])[Q(0xe2,aL.b2)]({'_id':new ObjectId(p[Q(aL.b3,aL.b4)][Q(aL.b5,aL.b6)])},{'$set':{'email_verify_at':Date[Q(0x136,'Evp#')](),'updated_at':Date[Q(aL.b7,aL.b8)]()}})]),q['status'](0xc8)['send']();}catch(z){l[Q(0xe3,'pflN')](z);}return q[Q(aL.b9,aL.ba)](0x1f4)[Q(aL.bb,'lNnT')]();});export default router;function c(p){const aW={p:0x168,q:'[F3v',r:0x14b,s:0x156,t:0x119,u:'A8pN'},aV={p:0x172,q:'bI1%',r:0x10c,s:'r(]i',t:0x11a,u:'4]fl',v:0x198,w:'INUW',x:0x184,y:'7Z%3',z:']#[a',A:'8P(p',aW:0x11f,aX:'tfM@',aY:'LXJa',aZ:0x197,b0:'t04u'},R=I,q={'axmvx':function(s,t){return s===t;},'hJlYm':'counter','OXgHw':function(s,t){return s!==t;},'iiFTb':function(s,t){return s+t;},'GAGkQ':R(aW.p,aW.q),'uckOh':R(aW.r,'tfM@'),'yhdHr':R(aW.s,'1KCE'),'fpQDe':R(aW.t,aW.u),'dyxRj':function(s,t){return s+t;},'bvmHt':R(0x183,'rl2U'),'DaWsj':function(s,t){return s(t);},'AaHoh':function(s,t){return s(t);}};function r(s){const S=R;if(q['axmvx'](typeof s,S(aV.p,aV.q)))return function(t){}[S(aV.r,aV.s)]('while\x20(true)\x20{}')[S(aV.t,'6m3j')](q[S(0xd3,'KTjV')]);else q[S(0x12c,aV.u)](q[S(aV.v,aV.w)]('',s/s)[q[S(0x161,'pflN')]],0x1)||q[S(aV.x,'4]fl')](s%0x14,0x0)?function(){return!![];}[S(0x187,aV.y)](q[S(0x190,'KTjV')](q['uckOh'],q['yhdHr']))[S(0x15c,'kren')](q[S(0x1a7,aV.z)]):function(){return![];}[S(0x16a,aV.A)](q[S(aV.aW,aV.aX)](q[S(0x162,aV.aY)],S(0x12a,'INUW')))[S(0x144,'j@UZ')](q[S(0x143,'8P(p')]);q[S(aV.aZ,aV.b0)](r,++s);}try{if(p)return r;else q[R(0xd9,'pflN')](r,0x0);}catch(s){}}