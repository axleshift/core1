(function(h,i){const I={h:'mphG',i:0x138,j:'nOrx',k:0x152,l:'TMBs',m:'^%1H',n:'NS()',o:'j#OE',p:0x177,q:0x131,r:'&ccA',s:0x154,t:'M27Z'},x=f,j=h();while(!![]){try{const k=parseInt(x(0x15d,I.h))/0x1+parseInt(x(I.i,I.j))/0x2+-parseInt(x(I.k,'0TZ$'))/0x3*(-parseInt(x(0x166,I.l))/0x4)+-parseInt(x(0x153,I.m))/0x5*(parseInt(x(0x113,I.n))/0x6)+-parseInt(x(0x12e,I.o))/0x7+-parseInt(x(I.p,'HfzG'))/0x8*(parseInt(x(I.q,I.r))/0x9)+-parseInt(x(I.s,I.t))/0xa;if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0x350d1));const d=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const T={h:'j#OE',i:0x16c,j:'%hPe',k:0x139},S={h:0x164,i:'64bw',j:0x141,k:0x13f,l:'gz$1'},y=f,h={'ZEhXg':'function\x20*\x5c(\x20*\x5c)','HMbJI':y(0x117,T.h),'RxoAi':function(i,j){return i(j);},'wkPRK':function(i,j){return i+j;},'BNHZp':'chain','LFGZV':y(T.i,T.j),'qjJpl':function(i,j){return i(j);},'OOesL':function(i){return i();},'kTGoE':function(i,j,k){return i(j,k);}};h[y(T.k,'62fh')](d,this,function(){const z=y,i=new RegExp(h[z(0x16d,'hLya')]),j=new RegExp(h[z(0x112,'0TZ$')],'i'),k=h[z(S.h,'R)in')](c,z(0x127,S.i));!i[z(S.j,'K5c$')](h[z(S.k,S.l)](k,h['BNHZp']))||!j[z(0x120,'F6aF')](h['wkPRK'](k,h['LFGZV']))?h['qjJpl'](k,'0'):h[z(0x10f,'J*tm')](c);})();}());function f(a,b){const c=e();return f=function(d,g){d=d-0x10d;let h=c[d];if(f['cLXqwk']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['MrLDWM']=m,a=arguments,f['cLXqwk']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['CQOgXe']===undefined&&(f['CQOgXe']=!![]),h=f['MrLDWM'](h,g),a[k]=h):h=l,h;},f(a,b);}const b=(function(){let h=!![];return function(i,j){const U={h:'U7G#'},k=h?function(){const A=f;if(j){const l=j[A(0x118,U.h)](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const a3={h:0x16a,i:'&!D^',j:0x12f,k:'hLya',l:0x181,m:'nOrx',n:0x184,o:0x12a,p:0x115,q:'xIIz',r:0x176,s:'^U3x',t:0x14d,u:'62fh',v:0x160,w:'Qobi',a4:0x13d},a2={h:'vI[[',i:0x13e,j:0x182},B=f,h={'UIKMo':function(m,n){return m(n);},'uJWPo':function(m,n){return m+n;},'UVUGU':function(m,n){return m+n;},'iUlio':B(a3.h,'wMlo'),'TRwun':B(0x17b,a3.i),'HHEos':B(a3.j,a3.k),'HCEbK':B(a3.l,'0TZ$'),'qnFhl':B(0x163,'[HVY'),'IpzRl':function(m,n){return m<n;}},i=function(){const C=B;let m;try{m=h[C(0x17f,'NS()')](Function,h['uJWPo'](h[C(0x15b,a2.h)](h[C(a2.i,'TMBs')],h[C(a2.j,'qluf')]),');'))();}catch(n){m=window;}return m;},j=i(),k=j[B(0x14a,a3.m)]=j['console']||{},l=[B(0x11a,'TuJ^'),'warn',B(0x13a,'TuJ^'),h['HHEos'],h[B(0x17d,'64bw')],B(0x125,'l5yi'),h[B(a3.n,'mphG')]];for(let m=0x0;h[B(a3.o,'gz$1')](m,l[B(a3.p,a3.k)]);m++){const n=b[B(0x162,a3.q)]['prototype'][B(a3.r,a3.s)](b),o=l[m],p=k[o]||n;n[B(a3.t,a3.u)]=b[B(a3.v,'%hPe')](b),n['toString']=p[B(0x174,a3.w)][B(a3.a4,'qZ@B')](p),k[o]=n;}});a();import{getUser,getSession}from'../components/sessions.js';import g from'../models/db.js';function e(){const as=['dSkmW73dNw/cKCop','vSk/W4jGqa','WRhdOrLb','pmoWWR/cVCoi','WPBcT8kMWQVdIZK','WQi/WRxdKmkE','WOygW5bGqa','Emk9F8kfjmkgW6xcTgfKrW','r8kGsSkccG','qSouxmopms/cMJpdHmkWWO8b','E8oEvZmHW4HmWQ9GW6hdHCoUlq','mbZcL20EWP8','hsTlEa','jMDYiujxW5SBdxRdLCk7fd7dOX9CDJ0MW4XRW48Vcx48WQddIIpdPmolWRFcMq','WOf+qmoTWQy','lmorWR/cMW','WQ4hdq','mSkJW5ldK3a','WRz3W6jR','WRuaa8ovmmk0kCkCD8kAW6tdUmonsHm','WRLvWQldSW','dZ1LEIq','igPjW6C','D8oPsSo/Cq','WRr5W7PM','WOqEWRpdJ8kNkSkkyG','yCkgW6vNwa','yu/dI8kJW6O','csLAqWWjWPzwquddMa','nt7dK0m','WPGdWRxdKq','W4tdL8oHEemmW5VdSSkEW43dHSoN','WRBcLN10oG','lZxdLfm','c8kqWQ0+weG1k8oO','gmoaW5q','th4AofqBWQrqtw/dKa','oqVcI2uy','gsr0yq4','W47dLmoPFKzEW4BdHCkPW6RdNW','hGvnWO/dUSk/imoZWQDu','WRanhSomj8o6iCoay8kAW6/cSSkzwahcIeJcGmob','z8kisCkSjSoyW48','W5ZdO15VWPG','ogr2WPZcIW','qtNdVKa','imkoy1ZcRc7cNXtcK8kOj8or','jCoBdmoyvW','WQSgdmow','BmkcrmkKjSojW4HCo1y','W7OHW7xcJuq','W7bVjfK','WOZcLSkRWRBdKq','WOJcJvD0hq','dmoIW6Ogaq','vJ3dOvG','EmotW5q','W6z5d8kqvf3cTa','vSoqW7ZcGXW','fSoYW7eVW6a','E0hdNG','WQ91W4pcHSk9WPlcMSoNDJRdSa','W6RdNmkTzL0','uNeHWOSxW7JdQ8oyyui','E8oupbZdS3tcKW','W6JdUSoevmkcWPy','W7zhmXvV','eCoqo8ofFCkuW53cN0q','x8kUoWhcTq','W49veYLa','ASoAW5BcKG','W5nykbXR','pSozgCo4DmksW5zBofqhcq','W79wWQ7dGKddGSoq','ftb2W4KcWQVcVmoKEMBdIHpdLq','FmkBaHdcPmo1j8k7iSoc','gYHdyWW','x8osW60dqa','WQLFWQldPgldPSoGc8kYAri','WP4FWRpdImk3oG','yCkCW6NdIxFdQ1LgwSoNWPVcPq','WOLxW7FcTCkn','hILmFW','hSoHWRW8hr/dTmoicrTK','f8odW48','WRNdUvLgWPrrW7JcSHxcLwO3WOJcOeypWQiKn8kyW4JcN8oGltZdHSkjWORdIL0AgG','WOtcMHGm','jmoFBehdT8kPp8kWpCoDWONcNa','W60HW7dcM17dMhpdHSkWW514','qCkhW7FdOYy','W4NdTSozFmkf','FSk+W7NdUdK','W5tdTCkkWPddNY1uca','WPCuW7zkza','W6fYaqPV','emorW74pW4FdLmoLj8o/WQlcKXRdSa','BsdcSmkrwCkRW4tcLtruWRFdQSo0dCkUW57cMCk0W4O','W6tdN01wWOhdQq','WO/cNqyDW6i','bJZcKvin','CY/dP3NdGG','k8oiWQxcJHC','geFcQh8/','aev0W7NcLW','FcRcSCkkx8kGWPy','Bt8cWQFdNeRdLbeKFs4','W61CmcXxW7FdK8kc','W7fPje7cGgJdTSodW49AcW','WQr/W7HN','v8kgWQmXW5ldKSonnSon','WQLXW4BcK8kSWRJcT8oJDG','n2buW6dcMxldMau3vbm','rSkbW7FdTdyG','dNu+WQ/cHZxdLcLGiHj/WRneW7P6W7GKlmksWOz7hs/cSJ3dHNhcVCoOW4vv','W7bEu8kmymoWDCksq8kUW4O','fbpdV1uK','WOTgW4tcOmkC','jmkRlSk1AW','bM1JWR/cGttdIs4','ASkvs8kTm8oEW5vAoG','pfpcSwe6'];e=function(){return as;};return e();}import{ObjectId}from'mongodb';const adminRoute=[],auth=async(h,i,j)=>{const ad={h:0x180,i:'&!D^',j:0x156,k:'j#OE',l:'M27Z',m:'bWsy',n:'bWsy',o:'XRIE',p:0x123,q:'J*tm',r:'^U3x',s:0x122,t:'64bw',u:'H&hN',v:'K5c$',w:0x159,ae:0x169,af:'HfzG',ag:0x134,ah:0x165,ai:'[HVY',aj:0x146,ak:'qluf',al:'LFnX',am:'%Abg',an:0x11f,ao:0x17a,ap:0x185,aq:0x148},ac={h:0x136,i:0x13b,j:'LFnX',k:0x178,l:'vI[['},D=f,k={'MlfPc':function(u){return u();},'sohnu':function(u,v){return u===v;},'uNRZP':D(ad.h,ad.i),'aTHAO':function(u,v){return u(v);},'uqKpF':function(u,v){return u!==v;},'EwEda':D(ad.j,ad.k),'QwuUi':'x-forwarded-for','JEfpu':D(0x149,ad.l),'KKoxz':function(u,v){return u-v;},'pFnkk':function(u,v){return u*v;},'xAbRJ':function(u,v){return u>=v;},'OOQMk':function(u){return u();}},l=h['headers']['authorization'];if(!l)return i[D(0x16b,'(cx8')](0x191)[D(0x150,ad.m)]();const m=l['split']('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/['test'](m))return i['status'](0x191)[D(0x11e,'^%1H')]();const [n,o]=await Promise[D(0x142,ad.n)]([k[D(0x110,ad.o)](getUser,m),getSession(m)]);if(!n||adminRoute[D(ad.p,ad.q)](h[D(0x11c,ad.r)])&&k['uqKpF'](n[D(ad.s,ad.r)],k['EwEda']))return i['status'](0x191)[D(0x12b,ad.t)]();if(!o['active'])return i[D(0x10e,'TMBs')](0x191)[D(0x119,ad.u)]();let p=h[D(0x183,'[[Yg')][k[D(0x16e,ad.v)]]||h[D(ad.w,'J*tm')][D(ad.ae,ad.af)];const q=h[D(ad.ag,'0TZ$')][k[D(0x14e,'%Abg')]],r=new Date(o['last_accessed']),s=k[D(ad.ah,ad.ai)](Date[D(ad.aj,'l5yi')](),r),t=k[D(0x170,ad.ak)](k[D(0x167,ad.o)](0x7,0x18),0x3c)*0x3c*0x3e8;if(k[D(0x168,'Qobi')](s,t))p=0x0;Promise[D(0x12d,ad.al)]([((async()=>{const E=D;try{const u=await k[E(ac.h,'&!D^')](g),v=o['ip_address']===p&&k['sohnu'](o['user_agent'],q);u[E(ac.i,'0TZ$')](k[E(0x140,ac.j)])[E(ac.k,ac.l)]({'token':m},{'$set':{'active':v,'compromised':v,'last_accessed':Date[E(0x15e,'LFnX')](),'modified_by':'system'}});}catch(w){logger['error'](w);}})())]);if(o[D(0x155,ad.am)]!==p||k[D(ad.an,ad.k)](o[D(0x132,'jfwv')],q))return i[D(ad.ao,'[HVY')](0x191)[D(ad.ap,'u&Ap')]();return h[D(0x13c,'xIIz')]=m,h[D(0x128,'J*tm')]=n,k[D(ad.aq,'oADm')](j);};export default auth;(function(){const ah={h:'u&Ap',i:0x130,j:'j#OE'},F=f,h={'OoDun':function(j,k){return j(k);},'NzJnL':function(j,k){return j+k;},'xdKmw':F(0x133,'TuJ^'),'koDvm':F(0x15f,ah.h),'chZkl':function(j){return j();}};let i;try{const j=h[F(0x144,'bWsy')](Function,h['NzJnL'](h['NzJnL'](h['xdKmw'],h['koDvm']),');'));i=h[F(ah.i,'j#OE')](j);}catch(k){i=window;}i[F(0x126,ah.j)](c,0x9c4);}());function c(h){const ar={h:0x14b,i:0x11d,j:'TuJ^',k:0x15c,l:'j#OE',m:0x116,n:'j#OE'},aq={h:'qZ@B',i:0x17e,j:'vI[[',k:'agzX',l:'Qobi',m:'H&hN',n:0x158,o:'^%1H',p:'HfzG',q:0x151,r:'Qobi',s:0x171,t:'F6aF',u:'^S%8',v:0x14f,w:'Qobi',ar:0x124},G=f,i={'JGBhn':G(ar.h,'R)in'),'WGfRD':G(ar.i,ar.j),'TfYqX':function(k,l){return k!==l;},'ybupU':function(k,l){return k+l;},'otPMJ':function(k,l){return k/l;},'KHrMl':'length','cDnBL':function(k,l){return k%l;},'tFbOS':G(ar.k,ar.l),'TJNjz':G(ar.m,ar.n),'JkKDN':'action','Vfpqe':G(0x147,'vI[['),'FWaot':function(k,l){return k(l);}};function j(k){const H=G;if(typeof k===i['JGBhn'])return function(l){}[H(0x175,aq.h)](i[H(aq.i,aq.j)])[H(0x121,aq.k)](H(0x172,'wMlo'));else i['TfYqX'](i['ybupU']('',i[H(0x14c,aq.l)](k,k))[i[H(0x135,'(cx8')]],0x1)||i[H(0x10d,aq.m)](k,0x14)===0x0?function(){return!![];}[H(aq.n,aq.o)](i[H(0x145,aq.p)]+i[H(0x11b,'[[Yg')])[H(0x137,'K5c$')](i[H(aq.q,aq.r)]):function(){return![];}[H(0x179,'F6aF')](i[H(0x16f,'JD8Q')]('debu',i[H(aq.s,aq.t)]))[H(0x157,aq.u)](i[H(aq.v,aq.w)]);i[H(aq.ar,'mphG')](j,++k);}try{if(h)return j;else j(0x0);}catch(k){}}