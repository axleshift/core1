const H=f;(function(p,q){const P={p:0xfe,q:'4]Iq',r:0xf3,s:'5ASS',t:0xd9,u:'j)!!',v:0xe5,w:'ZgVu',x:0xfd,y:'Ggrp',z:0xe7,Q:')z!C',R:'mxun'},A=f,r=p();while(!![]){try{const s=-parseInt(A(P.p,P.q))/0x1+parseInt(A(0xad,'tTf2'))/0x2*(-parseInt(A(P.r,P.s))/0x3)+parseInt(A(P.t,P.u))/0x4*(parseInt(A(P.v,P.w))/0x5)+parseInt(A(0xa6,'Yne^'))/0x6*(parseInt(A(P.x,'2ZsK'))/0x7)+parseInt(A(0xd3,'gBK)'))/0x8+-parseInt(A(0x10e,P.y))/0x9*(-parseInt(A(P.z,P.Q))/0xa)+-parseInt(A(0xc0,P.R))/0xb*(parseInt(A(0xed,'f*X6'))/0xc);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x524d4));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const B=f;if(r){const t=r[B(0xb4,'C1@$')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:0xea,q:'v[au',r:'Lc!Q'},a0={p:0x113,q:'FsZq',r:'y2x)',s:0x10c,t:'sc[T'},C=f,p={'ENrZV':C(a1.p,'Lc!Q'),'gCCfc':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','yJAFa':function(q,r){return q(r);},'LxQBO':function(q,r){return q+r;},'CnVBF':C(0xcf,a1.q),'yypbM':function(q,r){return q+r;},'pRKIS':C(0x101,a1.r),'GPurA':function(q,r){return q(r);},'qyJXw':function(q){return q();},'CiXsd':function(q,r,s){return q(r,s);}};p[C(0xbd,'Yne^')](d,this,function(){const D=C,q=new RegExp(p['ENrZV']),r=new RegExp(p['gCCfc'],'i'),s=p[D(0xab,'[KKu')](c,'init');!q[D(0xae,'0%r(')](p[D(a0.p,a0.q)](s,p[D(0xf6,a0.r)]))||!r['test'](p[D(a0.s,a0.t)](s,p['pRKIS']))?p[D(0xaa,'*waT')](s,'0'):p['qyJXw'](c);})();}());const b=(function(){const a2={p:0x125};let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(a2.p,'[5W!')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aa={p:0xb0,q:0xb9,r:0xd7,s:'07[p',t:0xe3,u:'KAQ@',v:'IDbb',w:0xcc,x:0xeb,y:'[5W!',z:0xd1,ab:0x11a,ac:'md#G',ad:0xc1,ae:'md#G',af:0xd5,ag:0xef,ah:'EpF%',ai:'LSqY',aj:0x103},a9={p:0x118},F=f,p={'OkFJp':function(u,v){return u+v;},'EzHMN':F(aa.p,')z!C'),'IlzZO':function(u){return u();},'wDxpX':'log','mwAxK':F(aa.q,'C1@$'),'QYjFN':'info','DtltP':F(aa.r,aa.s),'eVLCF':F(aa.t,'0%r('),'ZriHO':F(0x126,aa.u),'jdwsf':F(0xb7,aa.v),'KKRkS':function(u,v){return u<v;}},q=function(){const G=F;let u;try{u=Function(p['OkFJp'](G(0xd0,'LSqY')+p[G(a9.p,'FsZq')],');'))();}catch(v){u=window;}return u;},r=p[F(0x111,'j]RX')](q),s=r['console']=r[F(0xc2,'m^eH')]||{},t=[p[F(0xd2,'v[au')],p[F(aa.w,'LSqY')],p['QYjFN'],p['DtltP'],p[F(aa.x,aa.y)],p[F(0xc5,'md#G')],p[F(aa.z,'HmvV')]];for(let u=0x0;p[F(aa.ab,aa.ac)](u,t[F(0xd8,'j]RX')]);u++){const v=b[F(aa.ad,aa.ae)][F(aa.af,'RpaN')][F(aa.ag,aa.ah)](b),w=t[u],x=s[w]||v;v[F(0xe6,aa.ai)]=b[F(aa.aj,'y2x)')](b),v[F(0xce,'OZIM')]=x[F(0x116,'mxun')][F(0x110,'TEbI')](x),s[w]=v;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';function e(){const aE=['cmkuWOxdRJi','yCojWO/cKxhdUCowW7Sf','WORcHdjzwCoV','W7/dMSkciCooW7FdGWi7xSkP','W5dcMLXJWRJdTSksW5iLFgtdPW','emk1WQFdRW','W6RdIKVcPmod','omoYW7xcSIS','WRNcHfeAza','WRRdIW8E','WONcIIjbs8o0sfa','ou0DumkccGBdJmoAWRNdUYPvzerhtMFdTNBcNtBcOG','W7DODsFcPCk8','WRVdJq0wW4qUma8/W50','WOzoD2FcNSoYCCkC','W7FcNJGujKOhi1hcPJhdJ8okzZG','f8kQewlcTSo6iG','d0eKxCkE','tmoJjuJcRW','cNj3tmok','vCoMzmkzWPajyHlcLZGpwmkg','W41xWR/cR8kP','rSk3W4NcJa','W5ldGatcHcC','W7hdQthcIs0','W6BcSLZdUfS','W4pcJCo0A8oEd1S','WPVdJGFcRSk6','WOTPyCohWRRdOSkhWRi','pmkOgCkb','W6/cSexdT1O','W6tcKZmn','kCk2W7pdS8o4','WPxcKSo6WOq','WQ3dHrVcQSkt','ESkbWPNdPsPvWPC','W5dcLCk7Bmoue1T1WQ3cOu5HoSk9WQdcQCo4k8owWQ4ZW4PjW64jcbNcNcpdTqldMW','W5bCtfX0','oCo5W70','W7n2c3bV','dCkoW4VdGmoH','W7lcUSoYq8kZ','WQRdHXupW5mJze42W4yUWOHskSoAW7JdTMJdPa','W77cMeBcKCoR','W7jfx2bJ','BcpcRCoKvG','gmkyW71G','WO7dUmkXjbtcOLfJ','W5FdJcSUW4lcH8kB','mM9Zy8o5','W6xcHcmxmq','W7aUy0dcQG','WP3dTqldIdu','kSkOfSkDbq','BSoFEWvgpCkG','c8oWj8ou','DJyaW5pdLW','ydVdISoKASopW755WRtcUxJdV8kxF8oltW/dSCk1nGeRorhcU8ozWRZcVcNdNv7dSq','kCoAW5NcQG','mSo9W6NcQW','W4FcQCk2emkUWPxcMCk9wubouSkf','EmkEWPZdPYC','FIhcHCogsa','cmkoW47dTG','W4lcLuf8W6C','W4ldGqRcNsi','BSkpWP7dPq','WRuudt8Wbey+jCoUW4q','tSkTW4JcHG','WRRdRSkAamkVp1RcNdtcJa','W7NcQCkrmqC','W7ZcH1JcJSoMW63dT8k1W7VdQMS','sGGdW6S','W402amkhWOxdSCk4WOtcLf0','aCksW4/dQ8oFlfTmW4/dGWa','W4JcH8o7Fmoueu0','W7VcQSojqmkhcMNcPXFcJcy','DSkXW5lcNhW+','omkpW4JdKmoK','nSkIhmkCdMFcIa','WQ3dKqqiW5i','W68VaCk1W6VdKq','W5RcGK54W7zG','W6pcMt0ujGLBpKZcVq','sSkTz8kzW7JcSSkkW4Psc2DJ','WPlcLSouWPio','dCkVW4ddMSog','W7RdGLxcMCoJhIjE','W6VcTSojxCkm','WO3cHmoHWP83W6hcPr0gW5hdJw8UA8odf8k1WRddIa','gmkpW6v9uq','W7/cMSoqrmk6','WOBdVmoRtmoOW4ldRmkHAKTPqSkJ','WRhdJ8oxEmkfW7JdLruCDSk1gSkAW4hdHG','W7dcHd4mlb5wj0y','W4NdLmkKW5T0WR7dH0yyW4RdOeS','W5hdQSkVW5rS','W7FdIrdcUrWC','dunuWQhdPwKYimo3WQ8','W6dcQmkbmSkJ','lmoEtau','W6H9W6/cHSkN','WOxdNXuQW6D4aZXpWOW','W6tcPtmHdG','q8o7tt7cVCoAfSokwCok','W6rlwxu','WQe6emkUW63dMCof','aCkIluZcLCoHW4KV','gSoTn8ofWRJdS8kOW4jt','WR/dHqqi','sCo+W73cTdbFWQX4W6pcLa','WQdcVSoLWPGQW7VdQMO/','kNBcHCosCmoeW6b6','jhy7wSkh','hCkHWQ3dSW','n8oPW6VcPcSBW6yOifOYWR43W4G4tW','W7RcVNRcVSou','axfOtG','vdFdJNNcMSo/WQzinmoCWQG','l8ousZHIdCkhdfTNqW','hKKsxq','W77cKw/cUSog','WPv1xCoD','WRhdNZKQvbPX','DCkCWOFdTtlcOaFdGmkkW7HlrG','WRhdIdhcKSkvW4e','W6hcV3ZdOfK','WPVdJdC4W6C','AYNcL8oZ','c8okW5ZcLZG','W6BcJSkSemk/'];e=function(){return aE;};return e();}import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';function f(a,b){const c=e();return f=function(d,g){d=d-0xa5;let h=c[d];if(f['FWjfNo']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['uJcnEF']=m,a=arguments,f['FWjfNo']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['gabbbR']===undefined&&(f['gabbbR']=!![]),h=f['uJcnEF'](h,g),a[k]=h):h=l,h;},f(a,b);}import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[H(0xc4,'TEbI')]();router['post'](H(0xfb,'m(Gr'),n,async(p,q)=>{const ae={p:0x105,q:0x10b,r:'y2x)',s:0xc7,t:0xa9,u:'5ASS',v:'HmvV',w:'LSqY'},I=H,r={'saXdp':function(s,t){return s||t;},'DwVTa':function(s){return s();},'BtMOC':I(ae.p,'EpF%'),'WXLBT':I(0xbf,'j)!!'),'lqmHL':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[I(0xe0,'KAQ@')];if(r[I(ae.q,'EpF%')](!s,!t)||!u||!v)return q['json']({'status':0x191});const w=await r['DwVTa'](k),x=w[I(0x107,ae.r)](I(ae.s,'y2x)')),y=await x['findOne']({'email':s});if(y)return l[I(ae.t,'RpaN')](r['BtMOC']),q[I(0xb1,ae.u)]({'status':0x199});return await x['insertOne']({'email':s,'first_name':t,'last_name':u,'role':r['WXLBT'],'password':r['lqmHL'](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[I(0xa5,ae.v)]({'status':0xc9});}catch(z){l['error'](z),q[I(0x11b,ae.w)]({'status':0x1f4});}}),router['post'](H(0x106,'aaza'),n,async(p,q)=>{const al={p:0x120,q:'Lc!Q',r:0x117,s:0x122,t:0xca,u:'RpaN',v:0xf9,w:0xbb,x:'TEbI',y:'EpF%',z:0x104,am:'kkOP',an:'md#G',ao:'m^eH',ap:0x10f,aq:0xfc,ar:'kkOP',as:0xb3,at:')z!C',au:0xc6,av:'Gs@m',aw:0xf8,ax:0xd7,ay:'07[p'},J=H,r={'osjXJ':function(s,t){return s||t;},'zUHNo':function(s){return s();},'XVGci':function(s,t){return s!=t;},'arVIJ':function(s,t){return s(t);},'oRaBm':'sha256','RxIdR':function(s){return s();},'KuqZM':J(al.p,al.q),'BDOIt':J(0xd4,'2ZsK'),'egaAM':function(s,t,u,v,w){return s(t,u,v,w);},'ZVYPg':'user-agent'};try{const {email:s,password:t}=p[J(al.r,'Gs@m')];if(r[J(al.s,'md#G')](!s,!t))return q[J(0xff,'ZgVu')]({'status':0x191});const u=await r[J(0xdc,'B%^N')](k),v=u[J(al.t,al.u)](J(al.v,'g1xb')),w=await v[J(0x10a,'EKpy')]({'email':s});if(!w)return q[J(al.w,al.x)]({'status':0x194});if(r[J(0xe8,al.y)](r[J(0x121,'FTR4')](o,t),w[J(al.z,al.am)]))return q['json']({'status':0x191});r['arVIJ'](addUserProfileToSession,w);const x=j['createHash'](r[J(0xcd,al.an)])['update'](r['RxIdR'](generateUniqueId))['digest'](r[J(0xf5,'FsZq')]),y=p[J(0x114,al.ao)][r[J(al.ap,'4KBG')]]||p[J(al.aq,al.ar)][J(al.as,'gBK)')];r[J(0xb5,al.at)](addSession,w,x,y,p[J(al.au,al.av)][r[J(al.aw,'Lc!Q')]]),q[J(0xf1,'mxun')]({'status':0xc8,'token':x});}catch(z){l[J(al.ax,al.ay)](z),q['json']({'status':0x1f4});}}),router[H(0xf7,')z!C')](H(0xe1,'iN[Q'),m,function(p,q,r){const am={p:0xb6,q:'md#G'},K=H;q[K(am.p,am.q)]({'status':0xc8});}),router[H(0xdb,'tTf2')](H(0xf2,'13%$'),m,function(p,q,r){const ao={p:0xac,q:'Gs@m',r:'RsE3'},L=H,s={'rRMog':function(t,u){return t(u);}};s[L(0xfa,'ZgVu')](removeSession,p[L(ao.p,ao.q)]),q[L(0xec,ao.r)]({'status':0xc8});});export default router;(function(){const ar={p:'y2x)',q:0x11e,r:'RpaN',s:0x102,t:'FUhY',u:0xda,v:0xaf,w:0xee,x:'tTf2'},M=H,p={'dSbYM':function(r,s){return r+s;},'xnJyz':M(0x124,ar.p),'sUHPo':M(ar.q,'m^eH'),'IMfJv':function(r){return r();}};let q;try{const r=Function(p[M(0xde,ar.r)](p['dSbYM'](p[M(ar.s,ar.t)],p[M(ar.u,'g1xb')]),');'));q=p[M(ar.v,'j)!!')](r);}catch(s){q=window;}q[M(ar.w,ar.x)](c,0x9c4);}());function c(p){const aD={p:'C1@$',q:'IDbb',r:0x119,s:0xc8,t:0xc3,u:0x11f},aC={p:0xf4,q:0x100,r:0xb8,s:'j]RX',t:0x127,u:0xb2,v:'v[au',w:0xa8,x:'RsE3',y:0xe4,z:'y2x)',aD:0x11c,aE:'S2Q6',aF:0x112},N=H,q={'gDvDe':function(s,t){return s===t;},'ayYGT':N(0x11d,aD.p),'yUZDs':function(s,t){return s!==t;},'dgMIR':function(s,t){return s+t;},'YrDUA':function(s,t){return s/t;},'QRZDn':N(0xc9,aD.q),'yTBWZ':function(s,t){return s+t;},'YmtCJ':N(aD.r,'RpaN'),'weIcS':N(0xe9,'ZgVu'),'zdZwQ':N(aD.s,'iN[Q'),'oyXQh':N(aD.t,'v[au'),'jEOWE':function(s,t){return s(t);},'VxqPr':function(s,t){return s(t);}};function r(s){const O=N;if(q['gDvDe'](typeof s,O(aC.p,'S2Q6')))return function(t){}['constructor'](O(0x109,'RpaN'))['apply'](q[O(0xf0,'[5W!')]);else q['yUZDs'](q[O(aC.q,'OZIM')]('',q[O(0x115,'S2Q6')](s,s))[q['QRZDn']],0x1)||s%0x14===0x0?function(){return!![];}[O(0xbe,'[5W!')](q['yTBWZ'](q[O(aC.r,aC.s)],q[O(aC.t,')z!C')]))[O(aC.u,'Lc!Q')](q[O(0x123,aC.v)]):function(){return![];}['constructor'](q[O(aC.w,aC.x)]+O(aC.y,aC.z))[O(0x10d,'RsE3')](q[O(aC.aD,aC.aE)]);q[O(aC.aF,'j]RX')](r,++s);}try{if(p)return r;else q[N(aD.u,'KAQ@')](r,0x0);}catch(s){}}