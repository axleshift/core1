const J=f;(function(p,q){const R={p:'t7rh',q:'^mt2',r:'8%nM',s:0xdc,t:'W^p[',u:0x103,v:'uJqR',w:'q9ky',x:0x10b},B=f,r=p();while(!![]){try{const s=parseInt(B(0x122,'YTO^'))/0x1*(-parseInt(B(0xed,R.p))/0x2)+parseInt(B(0xdf,'WYGL'))/0x3*(-parseInt(B(0xce,'d6^7'))/0x4)+parseInt(B(0xc6,'2IJ2'))/0x5*(-parseInt(B(0x125,R.q))/0x6)+parseInt(B(0xe1,'cXP['))/0x7*(-parseInt(B(0x9e,R.r))/0x8)+-parseInt(B(R.s,R.t))/0x9*(parseInt(B(R.u,R.v))/0xa)+-parseInt(B(0x9c,R.w))/0xb+parseInt(B(R.x,'IJ55'))/0xc*(parseInt(B(0xf0,'2IJ2'))/0xd);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xea879));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x115,'wpVy')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0xf8,q:'457f'},Z={p:0xc2,q:0x12a,r:'C5Le',s:'I%X$',t:0xc3,u:'QSlU',v:'xt)G'},D=f,p={'kjqUQ':function(q,r){return q(r);},'zfJGK':D(a0.p,a0.q),'lRNrV':function(q,r){return q+r;},'ZsYYi':'chain','bsLCE':function(q){return q();}};d(this,function(){const E=D,q=new RegExp('function\x20*\x5c(\x20*\x5c)'),r=new RegExp(E(Z.p,'t7rh'),'i'),s=p[E(Z.q,'WO0*')](c,p[E(0x129,'WO0*')]);!q[E(0xfc,'uRNL')](p[E(0xa2,Z.r)](s,p['ZsYYi']))||!r[E(0x11e,Z.s)](s+E(Z.t,Z.u))?p['kjqUQ'](s,'0'):p[E(0x127,Z.v)](c);})();}());function f(a,b){const c=e();return f=function(d,g){d=d-0x98;let h=c[d];if(f['FoNRtb']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['uAPUHA']=m,a=arguments,f['FoNRtb']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['VUnJDZ']===undefined&&(f['VUnJDZ']=!![]),h=f['uAPUHA'](h,g),a[k]=h):h=l,h;},f(a,b);}const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a9={p:'uJqR',q:0xa9,r:'xswl',s:0xf9,t:'A9K!',u:'0zaq',v:0xac,w:0xc4,x:'WO0*',y:'O*gs',z:0xe5,A:0x10a,aa:'^OU]',ab:0x105,ac:'jKjZ'},a8={p:0xbf,q:'qEUm',r:'je^k'},F=f,p={'YsykT':function(u,v){return u(v);},'oGYuA':F(0xb3,'7*iI'),'Gyaoj':'{}.constructor(\x22return\x20this\x22)(\x20)','ybpyW':function(u){return u();},'EnKFw':F(0xe8,a9.p),'YNjdT':F(a9.q,'I%X$'),'yHRYM':F(0x11f,a9.r),'vyPHi':F(0x9a,'e)45'),'bPCGd':'table','IEwgv':F(a9.s,a9.t),'Dmobo':function(u,v){return u<v;}},q=function(){const G=F;let u;try{u=p[G(a8.p,a8.q)](Function,p[G(0xeb,a8.r)]+p[G(0x116,'u)Rr')]+');')();}catch(v){u=window;}return u;},r=p['ybpyW'](q),s=r[F(0xbb,a9.u)]=r[F(a9.v,'QSlU')]||{},t=[F(0xcc,'u)Rr'),p[F(0xdb,'cpOd')],p['YNjdT'],p[F(0xa0,'iBr)')],p[F(0xf6,'WO0*')],p[F(a9.w,a9.x)],p['IEwgv']];for(let u=0x0;p['Dmobo'](u,t[F(0x11b,a9.y)]);u++){const v=b[F(a9.z,'d6^7')][F(0xad,'uRNL')]['bind'](b),w=t[u],x=s[w]||v;v[F(a9.A,a9.aa)]=b[F(0xe9,'eCDH')](b),v['toString']=x['toString'][F(a9.ab,a9.ac)](x),s[w]=v;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';(function(){const ae={p:0xe3,q:0xd2,r:'z4g7'},ad={p:0xf1,q:0xb8,r:'z4g7',s:0x112,t:'xswl'},H=f,p={'yQOTQ':function(s,t){return s(t);},'PEYmM':function(s,t){return s+t;},'AOnbk':H(ae.p,'N&^%'),'vnHtF':function(s){return s();}},q=function(){const I=H;let s;try{s=p['yQOTQ'](Function,p[I(ad.p,'MnKg')](p[I(0xde,'A9K!')](I(ad.q,ad.r),p[I(ad.s,ad.t)]),');'))();}catch(t){s=window;}return s;},r=p[H(ae.q,'W^p[')](q);r[H(0xb9,ae.r)](c,0x9c4);}());import m from'../../middleware/auth.js';function e(){const aF=['WR7dOmonWQZcGCotW5q1y2OUD8k1','CSovutb3WR0h','BtuTgG','dmokwSkwra','E0CQWOK','W4byWPDMamku','FGHOEmkppuJcVLfCW40YWR4ish/dGc3dT8kxFdCzsJCmjCoetb7dV8k4W7Gb','yCkiWQ3cULm','hmoyDSo4fW','hmkBdYlcVW','dSkoWQDXzmoqfhhcHa','bmoFWOO0','dcVcL8kp','W4f4WRrYWOa','fcj7WR3cMCopW6FcIxJdKeO','W7VcV8kFWQNcGSoC','nahdNa','mmoluCksyG','W7yzWOVdIWu3q1JdQ1JcHmonoq','W7ldRCkUqSoMWQBdOCozW5FdRW','aG1ScG','W7FcJSoRi08','W7nYWQz2WRu','W5rwWPXkeG','jN84WOlcMG','W7NcTsWelq','hbddMmkXACkzzW','jImGW5yE','W6ldTSkJwSo2WRy','k2j2s1JdMwDliaddPq','oHXOqrBcQKZcVSoMWOG','W5pdJuvTW6O','WRXwWPPrWORdPmko','WOVdRCk8xJ4iFSoxFYm1imoW','rmo5zJL1','WObAWRLWlmkDza','Ee03WPK','WP1oDXnKD8kHW4NcQmocWOW','WQ5FW5xcLa','edhdNmkEWPFdGJtcOJfBWOhdLhZcKKf2fmkaW6BcISokWPyUd2/cKqhcI8kcaCkLeG','EZ0IfWi','WQDdW5tcIun3bLddK0pcUW','y8ocBsm','CfL3omoz','W4TDhs8','fsr7WQO','ox8YWP4','zg8aWOJcJG','EmozutnmWRS','fXfnfCo+xWhdJq','mmoYB8ojia','eSoXu8kkyW','dCkjWQyhmSkOrLJcH8oydLhdRq','iIDge8k3','BciUW5GBnq','W7NdLfLdW78','WPJcJr7dPNu','WONdOhtcTCoQW4hdJdBdSmoZ','cmoXzCo3gG','yKyQWPJcVs0kWQv2','i8oxd8kv','ymooxJDD','emo+W45adIaMq2Dw','W6xdHMbp','j2KUWOq','WODNW6zs','CWu/WPlcVs4KWRL3W6eyuSoOWOXm','tXiEWRThW44','fSoTvmoBfKVcHW','aYHMWRO','z8oitt1wWRq','WOOlxhBdSmo0kCofACk7WQznW64','shFcVmooeCkV','WRdcImomW4i','W7uyWONdIhTKouhdNwu','b8kZWR7cGmk9','FfxcKCo4pa','jmoyW5RdRCkd','emkamIpcNKldNYPP','WR7dR8okW5ZdUmkEWPq6Da','lmkod2z7WRSYWO/cTNi','BCkuWQ/cOfu','s3pdSSkxW6a','W53cKseE','W77dUv98W4G','t2ZcTSoFcG','EKZcS8oydW','gYXMWRRcSSotW7pcH2K','kSkEqSkX','W6f6W7KhWQ0','hXFdMSoCW5W','E8ksWRZcU1jy','ySoczYKrWP0VW5TTW6Tr','WPtdTMK','fSkwWR3cHSk0','g8oFWOO3WQ5s','W5tcJsiCcCkEgCoerqK','W6TzW4NcN0u','WPxcHGpdIW','xNhcR8ovfG','AuC9WOq','BCk3gvNcGa','WOldRSk4webWbSovuqu','rKPtnSoCyW','lGtdQCo3W5C','f1tcP8oHC8klEJRdQmkJ','WOlcJr/dVMK','D8kGde3cJG','AeCSWPpcUZW3','bmoUF8o4oa','fCoIrmoQiG','W5jLW7WFWRhcNq','vmoCW7nqzmoJbG','WO1cW4ZcM1TSfXpdGKhcQmonl8kFW6FcSNldRNzoWPy','aSkPWQxcHSkH','bmooWOuKWQ9j','gSo6W4SWjIamAeO','jSonqSkjzCkp','edtdVCoZW6y','nCkmpdSt','EqSEWQzEWP0ydvtcNXxcUmombCkmsSoTWRxcUWXiFei','W7VcSSkqW78','W5VcVSo8bgjF','WOfXW61e','FWFdPmkGr8kmwcFcKSkeW7bltCkCWQKRDGpcUSoBd1XHWOZdUmkofmoyACkEWP8ShNmPW7rp','W5lcMI0vhmkjbmocra','iCkDxCkZWQu','D8ozgmoSW6qFW7dcL8ktWOOaW6K9','WQbVW7FcMxS','gCo5W41hdWaNDhDP','W73cL8ohW5tdQuK2','W6JdISkqD8oo','W5tcJsadgmkpgmooxGJdLG','CGinddG','W7FdK35hW6q','aqDXgG','DSkvnGlcIhVdSG','B1RcJSkaWO7dK8otcCksh1pcVhq','zCk8m3O','iszHWRHaW44','WOJcJrBdKa','BZZdMmkoWOG','WOxcHHldIG','A8kjWRpcVeHhWOu','i34YWOtcHGRcTSk+W7K','W6TFW6OEWQu','b1VcRCoahq','aGdcSCk1WPu','c8kPocyX','EYpdNmkY','ae3cVmohhmkAWQ1NW7tcHqDWW67dS8kzWR/cLMddOa','pCkqgqC/','WPlcLXhdI1zV','W5FdM0tdUgXOyudcHW','pYDyWQPt','bCk8WPNcTSkCW7dcGCkgdeHBW5JcV8kaWO45d8ovpq','bmk8WPNcISkaW6RdHmoChfXz','au3cPSow','ySoczYKkWOm/'];e=function(){return aF;};return e();}import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[J(0x12b,'wpVy')]();router[J(0xd0,'MnKg')]('/register',async(p,q)=>{const aj={p:0x99,q:0xaf,r:'TT1Q',s:0xe6,t:'C5Le',u:'QSlU',v:0x114,w:0x12d,x:'d6^7',y:0xec,z:'A9K!',A:0xa8,ak:'%VaA',al:0xe2,am:'d6^7',an:'%VaA',ao:0xff,ap:'z4g7',aq:0xbd,ar:0x126,as:0x98,at:'*0Tq',au:'je^k',av:'xt)G',aw:0xb5,ax:'u#He'},K=J,r={'RzCkv':function(s,t){return s<t;},'muXff':K(aj.p,'^mt2'),'ZIJSk':function(s,t){return s!=t;},'NzZvS':'Password\x20does\x20not\x20match','vEJrZ':function(s){return s();},'upHEO':K(aj.q,'7*iI'),'cnoAJ':K(0x134,aj.r),'dCMcL':K(0xfd,'*0Tq'),'xdYWK':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[K(aj.s,'0zaq')];if(!s||!t||!u||!v||!w)return q['status'](0x190)[K(0xbe,aj.t)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(0x101,'eCDH')](s))return q[K(0x117,aj.u)](0xc8)[K(aj.v,'q9ky')]({'error':K(aj.w,aj.x)});if(r[K(0xe7,'t7rh')](v[K(aj.y,aj.z)],0x8))return q[K(aj.A,aj.ak)](0xc8)[K(aj.al,aj.am)]({'error':r[K(0xb7,aj.an)]});if(r['ZIJSk'](v,w))return q[K(aj.ao,'TT1Q')](0xc8)['json']({'error':r[K(0xee,'WO0*')]});const x=await r[K(0x10e,']$uv')](k),y=x[K(0xcf,'iBr)')](r[K(0x12e,aj.ap)]),z=await y[K(aj.aq,'A9K!')]({'email':s});if(z)return l['error'](r[K(aj.ar,'I%X$')]),q[K(0xc1,'WYGL')](0x199)[K(aj.as,aj.at)]();return await y[K(0xf7,aj.au)]({'email':s,'first_name':t,'last_name':u,'role':r[K(0x9d,'d6^7')],'password':r[K(0x121,aj.av)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['status'](0xc9)[K(0xfb,'cpOd')]();}catch(A){l[K(0x10d,'QSlU')](A);}return q[K(aj.aw,'I%X$')](0x1f4)[K(0xb2,aj.ax)]();}),router[J(0xa7,'xt)G')](J(0xf2,'2nDd'),n,async(p,q)=>{const ao={p:'IJ55',q:0x119,r:'ldt8',s:0xf5,t:0x120,u:'je^k',v:'O*gs',w:0xf3,x:'cpOd',y:0xc9,z:0xba,A:'7*iI',ap:0xaa,aq:0x104,ar:'xswl',as:0xc7,at:'O*gs',au:0xd3,av:0x123,aw:'t7rh',ax:0x100,ay:'wRaB',az:0x109},L=J,r={'owWhb':function(s){return s();},'DdZps':L(0xd4,'uRNL'),'gzjXg':function(s,t){return s(t);},'AOyMG':L(0xcb,ao.p),'bCmve':function(s){return s();},'iTFPd':L(ao.q,ao.r),'GVLBX':L(0xfe,'je^k'),'aHclH':function(s,t,u,v,w){return s(t,u,v,w);},'mCAtc':L(ao.s,'ldt8')};try{const {email:s,password:t}=p[L(ao.t,ao.u)];if(!s||!t)return q[L(0x12f,'O*gs')](0x190)[L(0xc7,ao.v)]();const u=await r[L(ao.w,ao.x)](k),v=u['collection'](r[L(ao.y,'W^p[')]),w=await v['findOne']({'email':s});if(!w)return q['status'](0x194)[L(ao.z,ao.A)]();if(r[L(ao.ap,'u#He')](o,t)!=w['password'])return q[L(ao.aq,ao.ar)](0x191)[L(ao.as,ao.at)]();r[L(ao.au,'WYGL')](addUserProfileToSession,w);const x=j['createHash'](r['AOyMG'])['update'](r['bCmve'](generateUniqueId))[L(ao.av,ao.aw)](r[L(0x133,'wRaB')]),y=p[L(ao.ax,'WO0*')][r[L(0x108,ao.ar)]]||p['socket']['remoteAddress'];return r[L(0xb4,ao.ay)](addSession,w,x,y,p[L(0x12c,'2IJ2')][r['mCAtc']]),q[L(0x131,'qEUm')](0xc8)[L(0x10f,'e)45')]({'token':x});}catch(z){l[L(ao.az,'(k0o')](z);}return q['status'](0x1f4)[L(0xa4,'MnKg')]();}),router[J(0xc0,'je^k')](J(0x9f,'jKjZ'),m,function(p,q,r){const ap={p:'TT1Q',q:'q9ky'},M=J;return q[M(0xff,ap.p)](0xc8)[M(0x114,ap.q)]({'email':p['email']});}),router['post'](J(0x11d,'d6^7'),m,async function(p,q,r){const ar={p:0x11c,q:'e)45',r:0xef,s:'qEUm',t:0xd7,u:'2nDd',v:0xd8,w:'iBr)',x:0xea,y:0xe4,z:'C5Le',A:0xda,as:'eCDH',at:'je^k'},N=J,s={'kUcuq':function(t){return t();},'GHpws':'users'};try{const t=await s[N(0xae,'wpVy')](k),u=t[N(ar.p,ar.q)](s[N(ar.r,ar.s)]),v=await u['findOne']({'email':p[N(ar.t,ar.u)]});return q[N(ar.v,ar.w)](0xc8)[N(ar.x,'uRNL')]({'user':{'email':v[N(ar.y,ar.z)],'first_name':v[N(ar.A,'ig6r')],'last_name':v[N(0x113,ar.as)]}});}catch(w){l[N(0xcd,ar.s)](w);}return q[N(0x104,'xswl')](0x1f4)[N(0xe0,ar.at)]();}),router['post']('/logout',m,function(p,q,r){const at={p:0x132},O=J,s={'CTEnE':function(t,u){return t(u);}};return s[O(at.p,'m7]U')](removeSession,p[O(0x111,'xswl')]),q['status'](0xc8)[O(0x135,'IJ55')]();});export default router;function c(p){const aE={p:'je^k',q:'YTO^'},aD={p:'N&^%',q:'0zaq',r:'u)Rr',s:0xca,t:0x110,u:'cpOd',v:'YTO^',w:'wRaB',x:0x107,y:0xa1,z:0x9b,A:'z4g7'},P=J,q={'iLCHm':function(s,t){return s===t;},'kHhHf':P(0x102,'A9K!'),'NWbtA':'while\x20(true)\x20{}','XPGth':P(0x128,aE.p),'vjRDa':function(s,t){return s/t;},'ynnYV':'length','SDMsN':function(s,t){return s===t;},'xFHEU':function(s,t){return s%t;},'hZQWU':function(s,t){return s+t;},'MScNB':P(0xab,'I%X$'),'WqBMF':P(0xc8,'N&^%'),'pjSCS':P(0x136,aE.q),'aOPEZ':'stateObject','CTKRw':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(0xb0,aD.p)](typeof s,q['kHhHf']))return function(t){}[Q(0x118,aD.q)](q[Q(0xd5,'e)45')])[Q(0xa3,'cpOd')](q['XPGth']);else(''+q[Q(0x124,aD.r)](s,s))[q[Q(0xf4,'I%X$')]]!==0x1||q[Q(0xc5,'^OU]')](q['xFHEU'](s,0x14),0x0)?function(){return!![];}[Q(aD.s,'eCDH')](q[Q(aD.t,aD.u)](q[Q(0xd1,aD.v)],q[Q(0xb1,aD.w)]))['call'](q[Q(aD.x,'z4g7')]):function(){return![];}[Q(aD.y,'e)45')](q['MScNB']+q['WqBMF'])[Q(aD.z,'q9ky')](q[Q(0x11a,aD.A)]);q['CTKRw'](r,++s);}try{if(p)return r;else r(0x0);}catch(s){}}