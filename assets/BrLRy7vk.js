import{R as e,r as s,j as a}from"./_LxKj9PG.js";import{F as t,l as r,m as o,U as i,M as n,N as l}from"./GO_KNHZp.js";import{R as m}from"./CD8lARB7.js";import{a as c,b as d,e as p,V as u}from"./Bq0diEaH.js";import{d as j,b as h,c as x,Q as f,R as y,T as g,A as b,X as v,U as N,a as _,Y as w}from"./slvTtaAp.js";import"./C_9exQ7i.js";import"./Itq7e1c5.js";import"./BGnBE-TB.js";import"./c7OvE8pj.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BJRa5TG-.js";import"./tRrjmjzN.js";import"./BFk34ZWe.js";import"./lcqsW1nY.js";import"./DIrOWF5t.js";import"./D74OPSAh.js";import"./COFYN2eQ.js";import"./BJtv0x2K.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./ZZM5rHs7.js";import"./Dw1DiDGf.js";import"./YiBEvX-Q.js";import"./rRm29nvs.js";import"./CzGuHLZU.js";import"./B8Let_61.js";import"./CZm-rpfG.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const C=()=>{const{user:C,setUser:z}=c(),k=e.useRef(),S=Intl.supportedValuesOf("timeZone"),{addToast:A}=d(),[U,F]=s.useState({username:C.username,email:C.email,first_name:C.first_name,last_name:C.last_name,timezone:C.timezone}),[R,T]=s.useState(!1),[D,Y]=s.useState(null),E=e=>{const{name:s,value:a}=e.target;return F((e=>({...e,[s]:a})))};return a.jsxs("div",{children:[R&&a.jsx("div",{className:"loading-overlay",children:a.jsx(j,{color:"primary",variant:"grow"})}),a.jsx(m,{ref:k,size:"invisible",sitekey:p}),a.jsxs(h,{xs:{cols:1},sm:{cols:2},children:[a.jsxs(x,{children:[a.jsx("h4",{children:"Account details"}),a.jsx(f,{className:"mb-3",children:a.jsx(y,{children:a.jsxs(g,{onSubmit:e=>(async e=>{if(e.preventDefault(),U.username===C.username&&U.email===C.email&&U.first_name===C.first_name&&U.last_name===C.last_name&&U.timezone===C.timezone)return A("No changes detected.");const s=await k.current.executeAsync();T(!0),axios.post("/auth/user",{...U,recaptcha_ref:s}).then((e=>{if(e.data.error)return A(e.data.error);z(e.data),A("Your changes has been saved.")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);A(t)})).finally((()=>T(!1)))})(e),children:[C.avatar?a.jsx(b,{crossOrigin:"Anonymous",src:`${u}/images/${C.avatar}.png`,className:"rounded-pill p-1 border mb-3",width:"100px",fluid:!0,loading:"lazy"}):a.jsx("div",{className:"rounded-pill bg-primary d-flex align-items-center justify-content-center mb-3 fs-4",style:{width:"70px",height:"70px",color:"white"},children:(I=C.first_name,I?I.charAt(0).toUpperCase():"")}),a.jsxs(v,{className:"mb-3",children:[a.jsx(N,{name:"profile_pic",type:"file",onChange:e=>{Y(e.target.files[0]);const s=document.getElementById("upload-button");e.target.files.length>0?s.style.display="inline-block":s.style.display="none"}}),a.jsx(_,{id:"upload-button",color:"primary",className:"ms-2 rounded",style:{display:"none"},onClick:e=>{D&&(async e=>{e.preventDefault();const s=await k.current.executeAsync();T(!0);const a=new FormData;a.append("profile_pic",D),a.append("recaptcha_ref",s),axios.post("/auth/upload",a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{if(e.data.error)return A(e.data.error);A("Your profile picture has been updated.")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);A(t)})).finally((()=>T(!1)))})(e)},children:"Upload"})]}),a.jsxs(v,{className:"mb-3",children:[a.jsx(w,{children:a.jsx(t,{icon:r})}),a.jsx(N,{type:"text",name:"username",placeholder:"Username",autoComplete:"username",value:U.username,onChange:e=>E(e)})]}),a.jsxs(v,{className:"mb-3",children:[a.jsx(w,{children:a.jsx(t,{icon:o})}),a.jsx(N,{type:"email",name:"email",placeholder:"Email",autoComplete:"email",value:U.email,onChange:e=>E(e)})]}),a.jsxs(h,{children:[a.jsx(x,{md:6,className:"mb-3",children:a.jsxs(v,{children:[a.jsx(w,{children:a.jsx(t,{icon:r})}),a.jsx(N,{name:"first_name",type:"text",placeholder:"First Name",autoComplete:"given-name",value:U.first_name,onChange:e=>E(e)})]})}),a.jsx(x,{md:6,className:"mb-3",children:a.jsxs(v,{children:[a.jsx(w,{children:a.jsx(t,{icon:r})}),a.jsx(N,{name:"last_name",type:"text",placeholder:"Last Name",autoComplete:"family-name",value:U.last_name,onChange:e=>E(e)})]})})]}),a.jsxs(v,{className:"mb-2",children:[a.jsx(w,{children:a.jsx(t,{icon:i})}),a.jsx(N,{type:"text",name:"timezone",placeholder:"Timezone",list:"timezone-options",value:U.timezone,onChange:e=>E(e)}),a.jsx("datalist",{id:"timezone-options",children:S.map((e=>a.jsx("option",{value:e},e)))})]}),"user"===C.role&&a.jsxs("div",{className:"mb-3",children:[a.jsxs(_,{color:"secondary",className:"mb-1 me-2 rounded",size:"sm",disabled:!0,children:[a.jsx(t,{icon:n})," ",C.oauth2&&C.oauth2.google?C.oauth2.google.email:"Connect Google"]}),a.jsxs(_,{color:"secondary",className:"mb-1 me-2 rounded",size:"sm",disabled:!0,children:[a.jsx(t,{icon:l})," ",C.oauth2&&C.oauth2.github?C.oauth2.github.email:"Connect Github"]})]}),a.jsx(_,{type:"submit",color:"primary",className:"d-block me-2 rounded",children:"Save changes"})]})})})]}),a.jsx(x,{})]}),"user"===C.role&&a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"text-danger",children:"Delete account"}),a.jsx(f,{className:"mb-3",children:a.jsxs(y,{children:[a.jsxs("p",{children:["If you wish to delete your account, please note that this action is irreversible and will remove all your data permanently.",a.jsx("br",{}),"To proceed with the deletion of your account, please click the button below:"]}),a.jsx("span",{className:"text-muted",children:"We cannot process your account deletion request, if you have unpaid invoices or inroute shippment"}),a.jsx(_,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:!0,children:"Request account deletion"})]})})]})]});var I};export{C as default};
