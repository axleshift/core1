import{j as e,r as o}from"./D3kDgYDB.js";import{F as q,I as R}from"./BlWyeQQ1.js";import{a as I,b as E}from"./Cl7e3D_B.js";import{P as s}from"./WyM-ksIe.js";import{p as f}from"./C2QnNB4K.js";import{y as N,K as F,L as C,M as S,N as T,_ as j,a9 as w,aa as _,ab as p,ac as i,ad as P,ae as a,c as M,C as H,af as G,ag as Q,ah as b,ai as V,aj as g}from"./CRebGdRz.js";import{U as $}from"./B5pYM8KV.js";import{i as A}from"./zOQeB56e.js";import{d as B}from"./FDBtgKq2.js";import"./CNSOrHVr.js";import"./D3kAHpSt.js";import"./Dw8pycEM.js";import"./8JwjhRSi.js";import"./tpRZQFqq.js";import"./CzFDRTuY.js";import"./CQ-yZ3vu.js";import"./BmHAl9XU.js";import"./t_wxcTun.js";import"./DiDpq0UU.js";import"./CHUBTVDa.js";import"./CXnULsF_.js";import"./CCb-kr4I.js";import"./Cz0CWeBA.js";import"./Cp7XljvA.js";import"./BQBsAJpH.js";import"./CWmxXzlZ.js";import"./BZxJdD1U.js";const K=({query:c,setQuery:n,state:t,setState:d,priority:u,setPriority:m,order:h,setOrder:x,result:l})=>e.jsxs(e.Fragment,{children:[l.scm.length===0&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(N,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})}),l.scm.length!==0&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(C,{className:"mb-3",children:[e.jsx(S,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:c,onChange:r=>n(r.target.value)}),e.jsx(T,{id:"basic-addon",children:e.jsx(q,{icon:R})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:t,onChange:r=>d(r.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:u,onChange:r=>m(r.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:h,onChange:r=>x(r.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(w,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(_,{children:e.jsxs(p,{children:[e.jsx(i,{children:"#"}),e.jsx(i,{children:"State"}),e.jsx(i,{children:"Scope"}),e.jsx(i,{children:"Manifest"}),e.jsx(i,{children:"CVE"}),e.jsx(i,{children:"Summary"}),e.jsx(i,{children:"Severity"}),e.jsx(i,{children:"Last Updated"})]})}),e.jsx(P,{children:l.scm.map(r=>e.jsxs(p,{children:[e.jsx(a,{children:r.number}),e.jsx(a,{children:r.state}),e.jsx(a,{children:r.scope}),e.jsx(a,{children:r.manifest}),e.jsx(a,{children:r.cve}),e.jsx(a,{children:r.summary}),e.jsx(a,{children:r.severity}),e.jsx(a,{children:f(new Date(r.updated_at).getTime())})]},r.number))})]})]})]});K.propTypes={query:s.string.isRequired,setQuery:s.func.isRequired,state:s.string.isRequired,setState:s.func.isRequired,priority:s.string.isRequired,setPriority:s.func.isRequired,order:s.string.isRequired,setOrder:s.func.isRequired,result:s.shape({scm:s.arrayOf(s.shape({number:s.number.isRequired,state:s.string.isRequired,scope:s.string.isRequired,manifest:s.string.isRequired,cve:s.string.isRequired,summary:s.string.isRequired,severity:s.string.isRequired,updated_at:s.string.isRequired})).isRequired}).isRequired};const L=({result:c})=>{const n=t=>{const d=new $;return d.setUA(t),d.getResult(),t};return e.jsx(e.Fragment,{children:e.jsxs(w,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(_,{children:e.jsxs(p,{children:[e.jsx(i,{children:"#"}),A&&e.jsx(i,{children:"User"}),e.jsx(i,{children:"Location"}),e.jsx(i,{children:"Device"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Last Accessed"})]})}),e.jsx(P,{children:c.sessions.map((t,d)=>e.jsxs(p,{children:[e.jsx(a,{children:d+1}),A&&e.jsx(a,{children:t.user_id}),e.jsx(a,{children:t.ip_address}),e.jsx(a,{children:n(t.user_agent)}),e.jsx(a,{children:t.active?"Active":"Inactive"}),e.jsx(a,{children:f(t.last_accessed)})]},d))})]})})};L.propTypes={result:s.shape({browser:s.string,os:s.string,sessions:s.arrayOf(s.shape({_id:s.string.isRequired,user_id:s.string,ip_address:s.string.isRequired,user_agent:s.string.isRequired,active:s.bool.isRequired,last_accessed:s.number.isRequired})).isRequired}).isRequired};const D=({query:c,setQuery:n,state:t,setState:d,priority:u,setPriority:m,order:h,setOrder:x,result:l})=>e.jsxs(e.Fragment,{children:[l.sentry.length===0&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(N,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any issues."}),e.jsx("p",{children:"Should we add one? :)"})]})}),l.sentry.length!==0&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(C,{className:"mb-3",children:[e.jsx(S,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:c,onChange:r=>n(r.target.value)}),e.jsx(T,{id:"basic-addon",children:e.jsx(q,{icon:R})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:t,onChange:r=>d(r.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:u,onChange:r=>m(r.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:h,onChange:r=>x(r.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(w,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(_,{children:e.jsxs(p,{children:[e.jsx(i,{children:"#"}),e.jsx(i,{children:"Title"}),e.jsx(i,{children:"Culprit"}),e.jsx(i,{children:"Level"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Priority"}),e.jsx(i,{children:"Count"}),e.jsx(i,{children:"Last Updated"})]})}),e.jsx(P,{children:l.sentry.map(r=>e.jsxs(p,{children:[e.jsx(a,{children:r.id}),e.jsx(a,{children:r.title}),e.jsx(a,{children:r.culprit}),e.jsx(a,{children:r.level}),e.jsx(a,{children:r.status}),e.jsx(a,{children:r.priority}),e.jsx(a,{children:r.count}),e.jsx(a,{children:f(new Date(r.updated_at).getTime())})]},r.id))})]})]})]});D.propTypes={query:s.string.isRequired,setQuery:s.func.isRequired,state:s.string.isRequired,setState:s.func.isRequired,priority:s.string.isRequired,setPriority:s.func.isRequired,order:s.string.isRequired,setOrder:s.func.isRequired,result:s.shape({sentry:s.arrayOf(s.shape({id:s.string.isRequired,title:s.string.isRequired,culprit:s.string.isRequired,level:s.string.isRequired,status:s.string.isRequired,priority:s.string.isRequired,count:s.string.isRequired,updated_at:s.string.isRequired})).isRequired}).isRequired};const W=()=>e.jsx(e.Fragment,{children:e.jsx(M,{fluid:!0,style:{height:"100vh"},children:e.jsx("iframe",{src:`${I}/status`,className:"rounded",style:{width:"100%",height:"100%",border:"none"}})})}),O=({setLoading:c,result:n})=>(o.useState(""),e.jsxs(e.Fragment,{children:[!n.apiToken&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(N,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"There was no API Token"}),e.jsx("p",{children:"Should we add one? :)"})]})}),n.apiToken&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-center border rounded",children:e.jsx("div",{className:"p-0 p-md-5 my-5 my-md-0",children:e.jsxs(C,{className:"mb-3",children:[e.jsx(S,{"aria-label":"tracking id","aria-describedby":"basic-addon",width:"10px"}),e.jsx(T,{id:"basic-addon",children:e.jsx(q,{icon:R})})]})})})})]}));O.propTypes={setLoading:s.func.isRequired,result:s.shape({apiToken:s.arrayOf(s.any).isRequired}).isRequired};const Re=()=>{const[c,n]=o.useState(!1),[t,d]=o.useState("2"),[u,m]=o.useState("1"),[h,x]=o.useState("1"),[l,r]=o.useState(""),[y,k]=o.useState({scm:[],sessions:[],sentry:[],apiToken:{}});B();const U=async()=>{n(!0),await axios.get(`${I}/api/v1/threat/`,{headers:{Authorization:`Bearer ${cookies.get(E)}`}}).then(v=>{k(v.data)}).catch(v=>{console.error(v)}).finally(()=>{n(!1)})};return o.useEffect(()=>{U()},[]),e.jsxs("div",{children:[c&&e.jsx("div",{className:"loading-overlay",children:e.jsx(H,{color:"primary",variant:"grow"})}),e.jsxs(G,{activeItemKey:0,className:"mb-4",children:[e.jsxs(Q,{variant:"underline-border",children:[e.jsx(b,{"aria-controls":"dashboard-tab-pane",itemKey:0,children:"Dashboard"}),e.jsx(b,{"aria-controls":"sessions-tab-pane",itemKey:1,children:"Sessions"}),e.jsx(b,{"aria-controls":"dependabot-tab-pane",itemKey:2,children:"Dependabot"}),e.jsx(b,{"aria-controls":"sentry-tab-pane",itemKey:3,children:"Sentry"}),e.jsx(b,{"aria-controls":"api-tab-pane",itemKey:4,children:"API Key"})]}),e.jsxs(V,{children:[e.jsx(g,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:e.jsx(W,{})}),e.jsx(g,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:e.jsx(L,{result:y})}),e.jsx(g,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:e.jsx(K,{query:l,setQuery:r,state:t,setState:d,priority:u,setPriority:m,order:h,setOrder:x,result:y})}),e.jsx(g,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:e.jsx(D,{query:l,setQuery:r,state:t,setState:d,priority:u,setPriority:m,order:h,setOrder:x,result:y})}),e.jsx(g,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:4,children:e.jsx(O,{setLoading:n,result:y})})]})]})]})};export{Re as default};
