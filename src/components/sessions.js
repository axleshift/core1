(function(i,j){const G={i:'OHrx',j:'XmIQ',k:'@KId',l:0x236,m:'m8dj',n:'K8uP',o:0x239},r=f,k=i();while(!![]){try{const l=-parseInt(r(0x1eb,'aq&j'))/0x1+parseInt(r(0x243,G.i))/0x2+-parseInt(r(0x201,G.j))/0x3+parseInt(r(0x22e,G.k))/0x4+-parseInt(r(0x1f3,'a3BD'))/0x5+parseInt(r(G.l,G.m))/0x6+parseInt(r(0x23a,G.n))/0x7*(-parseInt(r(G.o,'A6zW'))/0x8);if(l===j)break;else k['push'](k['shift']());}catch(m){k['push'](k['shift']());}}}(e,0x6a9a2));const d=(function(){const H={i:0x228};let i=!![];return function(j,k){const l=i?function(){const s=f;if(k){const m=k[s(H.i,'UYvj')](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}());function e(){const ap=['xImno2a','uGBcVenUuSomWR0AWQm','q8ogtwlcLa','a0a6vLtdIG','gSotW7BcR8oy','jg8fEdS','yuFdOSkCcGa','WRiRsNpdKa','s8oKE3JcOCkrySoyW43dHa','WRJdOSo5W7DVmwyaWOW','W7tcKmkyW63cMYBdVIXyW6e','eNNdIJvb','W4bDkCodhW','WQzyE8kiW7xcGw8Uyv9aW7hcRG','W7ZdTd1qW6e','gamYW5rq','AaxdJIlcN8kaW7PpCCkyW40','W7y2cmkKrq','W4xdMSkAW4q','WQFcICk5zCoYimovWOXq','W4hdLd0','WOhcHsPqWRuzW5lcM8osW7rKWQ0','A8kszCoLD8oAW5W','W7hdQh5JlGjdkW','bmkAdNFdQG','W4FdHNmkW6a','WQ7cMSk4FSoF','jc86','mmkiWQ/dPSkjw8ob','nqKKWQS3pXlcI2FcTJb1WRO','vmkQrJldMG','W7a8lYe','W6BdQef7oqHzjCk0W4K','ENnVWOedpCkhbmkwW5bBC8kp','WPtcS0OvWOy','fuWRwKRdMxhcOri','w8oUzgFcRCkDEmoc','f1xdHmkwFcVdTW','W5JdQcf6W7y','ve7dVmknia','W5ZdNJLXW7T2WQb0','agZdIsPrw8kbWQO','ogJdRJ9X','bv7dOrC6cmoFWPurWQT0FW','Dx0KW4fb','W53dQKtdGq','WPJdOr1gW4bSWOq','WO/cTg0','W47dIZPUW6S','WQ7dSaqgW6fuW6ODW5JcSci','W4FdQe/dG8kx','CvhdV8kBgX/cK8ktktv9','WQmXm8oiW4xcMfCZWQ9/','WP7dVYOyW58','F8klCu/dTCoCWRddJSknW5ldNYxdQ8k8k8kTgrOR','ESktySoTxCkuWPhcQCozW6HhWRWWWOpcNq','WQxcRw0HWOhdHrqNWOy','FdhcM0bf','tmkyAW7dKW','sqGybLu','W5hdNxWn','v8k0ESoSW7JdImoZWR7dKCo5','aSkmWRddU8k8','ae7dSHv0','kY8ZW4fgESokjmkmW7zA','l2iyrG','ahirshK','lwGCxta','kudcL2/dISo+W7TltCkpW7pcIq','W7yWiZa','WRtcSXOIAL4FbCk4W6Sgjmov','W6DefCoa','W6tdSYzHW5q','W41yW4i','W6zocSowjtjlsG','hmobuSoKWPRcI8kgta','W6ZdQuT4','ArtdMYpcImkHWRGnCSkoW5FcHmoIDSkhW4BcISkdW6W','WRTmEuddRa','WQuLrMZdGxldOCkeWRddTa4','xSk8W48RDHbjW55xd8oDxW','W4ddKCkDW5FdPx0','W73cJ8kBWOa4','W59Jn8omaa','WQ8TB3FdPq','W7NcKmkd','WQJcH8kKySozpmobWOjbduu','BbddNtG','fSkgW5vexx3cICokWR7dGdHdWQy','yKLUW7n0','EJzibM7cLSkCs8omsbz1Cq','WR/cPKe+','W6FcGSofWO8UB8kgxhRdG8kfW6eUW4TjWO/cNc4bjuraW4FdNmkDW7ddOmoTW4LeWP7cNG','hSk/WORdUSkO','j8kcWRldOq','g8oAwCoIWQS','W7NdSab5W6PqW4RdS8kMcdbsEW','FLVdV8kpgWu','WRldKh4OpSkCba','iZPIWPWfkMRcGf7cM8kJsqC','h8orqfdcLSkhxa','C13dPCkbaam','W70emmoAWRBdHHazAW','f1xdNCkuBs3dSCkqW5/dQW','W7RcMSkEWQ0Y','Dhb0W61c','bCoiy8ovWPW','tbutjfVdOmkXvW','z0rbymkb','W6KqlXZcThNcMwNdKmo/g8khmq','cConDCo5WP7cHW','oSkthfldOq'];e=function(){return ap;};return e();}(function(){const P={i:0x224},O={i:0x23e,j:0x1e8,k:0x231,l:'m8dj',m:'a3BD',n:0x234,o:0x229},t=f,i={'jObfB':'function\x20*\x5c(\x20*\x5c)','feuAs':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','sKhqD':t(P.i,'OHrx'),'JHNiL':'input','WSgHx':function(j,k){return j(k);},'BWRfZ':function(j){return j();},'QZwfC':function(j,k,l){return j(k,l);}};i['QZwfC'](d,this,function(){const u=t,j=new RegExp(i['jObfB']),k=new RegExp(i[u(O.i,'UYvj')],'i'),l=c(u(O.j,'gzM^'));!j[u(O.k,O.l)](l+i[u(0x23f,O.m)])||!k[u(O.n,'5*ZP')](l+i[u(O.o,'JRSW')])?i['WSgHx'](l,'0'):i['BWRfZ'](c);})();}());const b=(function(){const Q={i:0x206,j:'D8)e'};let i=!![];return function(j,k){const l=i?function(){const v=f;if(k){const m=k[v(Q.i,Q.j)](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),a=b(this,function(){const Z={i:0x232,j:'UYvj',k:')wvX',l:'r#oc',m:'gZiO',n:0x1f9,o:'TwFr',p:'E%X[',q:0x238,a0:'h(f]',a1:'5*ZP',a2:0x22d,a3:'oFMr',a4:0x235,a5:0x1ee,a6:0x1fd,a7:0x1f4,a8:'EB6g',a9:0x203,aa:0x221,ab:0x1f5},Y={i:0x211,j:'yJE#',k:'oFMr'},w=f,i={'vxxQg':function(n,o){return n(o);},'asZzD':function(n,o){return n+o;},'SOwRs':w(Z.i,Z.j),'ScBhB':function(n){return n();},'ZgFVQ':w(0x1f1,Z.k),'stXrC':w(0x222,Z.l),'UaeMj':w(0x1f0,Z.m),'FpmeO':w(Z.n,Z.o),'SIysu':w(0x1dd,Z.p),'UHLNa':w(0x1ef,'aq&j'),'pFYwC':function(n,o){return n<o;}},j=function(){const x=w;let n;try{n=i[x(Y.i,Y.j)](Function,i['asZzD'](x(0x223,Y.k)+i[x(0x1e4,'D8)e')],');'))();}catch(o){n=window;}return n;},k=i['ScBhB'](j),l=k[w(Z.q,Z.a0)]=k[w(0x1f2,Z.a1)]||{},m=[i['ZgFVQ'],w(Z.a2,Z.a3),i[w(Z.a4,'TWL#')],i[w(Z.a5,'!hB$')],i[w(Z.a6,'EB6g')],i['SIysu'],i[w(Z.a7,'nR6m')]];for(let n=0x0;i[w(0x218,'TwFr')](n,m[w(0x237,Z.a8)]);n++){const o=b[w(0x225,'E%X[')]['prototype'][w(0x212,'aq&j')](b),p=m[n],q=l[p]||o;o['__proto__']=b[w(Z.a9,'Ugqp')](b),o[w(0x1ed,'r#oc')]=q[w(Z.aa,'TWL#')][w(Z.ab,'dR!3')](q),l[p]=o;}});a();import{ObjectId}from'mongodb';import g from'../models/db.js';(function(){const a5={i:0x20c,j:'9P!s',k:0x1e7,l:'TP]!'},a4={i:0x1da,j:'#0TS',k:'#0TS',l:0x20b},y=f,i={'RdjmL':function(l,m){return l(m);},'KaTfI':function(l,m){return l+m;},'sGHLL':function(l,m){return l+m;},'CjZWP':y(a5.i,a5.j),'KwtzF':function(l){return l();}},j=function(){const z=y;let l;try{l=i[z(a4.i,'[S&q')](Function,i[z(0x200,a4.j)](i[z(0x215,a4.k)](i[z(a4.l,'o%)n')],'{}.constructor(\x22return\x20this\x22)(\x20)'),');'))();}catch(m){l=window;}return l;},k=i[y(a5.k,a5.l)](j);k[y(0x207,'o%)n')](c,0x9c4);}());import h from'./logger.js';export const addSession=async(i,j,k,l)=>{const a7={i:'#0TS',j:'D8)e',k:0x23c,l:'d]KS',m:'o^KO',n:0x22f,o:'a3BD'},A=f,m={'wSkxd':function(n){return n();},'khwha':A(0x1ff,a7.i)};try{const n=await m[A(0x1fc,a7.j)](g);n[A(0x1d7,'XmIQ')](m[A(0x1d5,'!hB$')])[A(a7.k,'m8JR')]({'user_id':i[A(0x21f,a7.l)],'token':j,'active':!![],'ip_address':k,'user_agent':l,'compromised':![],'last_accessed':Date[A(0x22b,a7.m)]()});}catch(o){h[A(a7.n,a7.o)](o);}};export const getUser=async i=>{const a8={i:0x1fa,j:'nR6m',k:0x1de,l:'K8uP',m:0x1db,n:'LkLc',o:'JR!o',p:0x1e9,q:'gZiO',a9:'JRSW'},B=f,j={'Mzarh':B(a8.i,'K8uP'),'ljxLg':'users'};try{const k=await g(),l=await k[B(0x1e0,'o^KO')](j[B(0x210,a8.j)])['findOne']({'token':i});if(!l)return null;const m=await k[B(a8.k,a8.l)](j[B(a8.m,'#H2]')])[B(0x1ec,a8.n)]({'_id':l['user_id']});return{'_id':m[B(0x205,'3[8C')],'email':m[B(0x219,'#H2]')],'first_name':m[B(0x20a,a8.o)],'last_name':m[B(a8.p,a8.q)],'role':m[B(0x21d,a8.a9)],'email_verify_at':m['email_verify_at']};}catch(n){h['error'](n);}return null;};function f(a,b){const c=e();return f=function(d,g){d=d-0x1d5;let h=c[d];if(f['wktdBn']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['nvhiEW']=m,a=arguments,f['wktdBn']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['pAvcvF']===undefined&&(f['pAvcvF']=!![]),h=f['nvhiEW'](h,g),a[k]=h):h=l,h;},f(a,b);}export const removeSession=async i=>{const aa={i:0x22a,j:0x23d,k:0x1d6,l:'yJE#',m:0x1df,n:'lL#J',o:0x1dc},C=f,j={'igGhP':function(k){return k();},'aSmlR':C(0x241,'yJE#')};try{const k=await j[C(aa.i,'E%X[')](g);await k[C(aa.j,'2%(b')](j[C(aa.k,aa.l)])[C(aa.m,aa.n)]({'token':i},{'$set':{'active':![],'last_accessed':Date['now'](),'modified_by':C(aa.o,'EB6g')}});}catch(l){h['error'](l);}};export const getSession=async i=>{const ac={i:'JRSW',j:0x213,k:'JRSW',l:'3[8C',m:'D8)e',n:0x202},D=f,j={'kMZvP':function(k){return k();},'UvPfS':D(0x220,ac.i)};try{const k=await j[D(0x1d8,'K8uP')](g),l=await k[D(0x1f6,'r#oc')](D(0x1fe,'D8)e'))['findOne']({'token':i});if(l[D(0x244,'TWL#')])k[D(ac.j,'9)JD')](j[D(0x1e2,ac.k)])[D(0x20e,ac.l)]({'token':i},{'$set':{'last_accessed':Date[D(0x1ea,ac.m)]()}});return l;}catch(m){h[D(ac.n,'A6zW')](m);}return null;};function c(i){const ao={i:'dR!3',j:0x217,k:0x23b,l:'EB6g',m:'oFMr'},an={i:0x242,j:0x20d,k:0x216,l:0x20f,m:'XmIQ',n:0x209,o:'EB6g',p:0x1f8,q:'3[8C',ao:0x233,ap:'5*ZP',aq:0x240},E=f,j={'vREZR':function(l,m){return l===m;},'tdYnU':E(0x1d9,'TwFr'),'GwFUc':function(l,m){return l+m;},'xkefe':function(l,m){return l/m;},'BcqKs':E(0x227,'gzM^'),'ChCFV':function(l,m){return l%m;},'MXKoN':E(0x21b,ao.i),'QkqnZ':E(ao.j,'#H2]'),'nssWE':E(ao.k,ao.l),'DnCUs':function(l,m){return l+m;},'PCofb':E(0x1e6,ao.m),'mfbEt':function(l,m){return l(m);},'KHlcF':function(l,m){return l(m);}};function k(l){const F=E;if(j[F(an.i,'11pA')](typeof l,j['tdYnU']))return function(m){}[F(0x22c,'gZiO')](F(an.j,'LkLc'))[F(0x1e1,'#0TS')](F(0x1fb,'2%(b'));else j['GwFUc']('',j[F(0x208,'Ugqp')](l,l))[j['BcqKs']]!==0x1||j['vREZR'](j['ChCFV'](l,0x14),0x0)?function(){return!![];}[F(an.k,')wvX')](j['GwFUc'](j[F(an.l,an.m)],j['QkqnZ']))['call'](j['nssWE']):function(){return![];}[F(an.n,an.o)](j[F(an.p,an.q)](j[F(an.ao,'5*ZP')],j[F(0x214,an.ap)]))['apply'](j[F(0x1e5,')wvX')]);j[F(an.aq,'TWL#')](k,++l);}try{if(i)return k;else j[E(0x21e,'D8)e')](k,0x0);}catch(l){}}