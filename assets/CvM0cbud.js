import{j as e,r as s}from"./kqbr3HuW.js";import{Y as a,Z as r,n as l,a2 as t,e as i,f as n,a3 as d,J as c,K as o,C as h,t as j,o as m,p as x,q as u,r as p,a9 as v,ad as y,ae as b,af as g,ag as f,ah as N,ai as w,aj as S,ak as _,al as A,am as C,an as K}from"./BFR-PdVD.js";import{a as q,V as k,c as T}from"./BZ9cedpL.js";import{E as D}from"./URk2IvX2.js";import{P as F}from"./CgN-7aKy.js";import{F as L,d as R}from"./BNSBxhWN.js";import{p as P}from"./B51y9YVM.js";import{i as $}from"./B8H-rvok.js";import"./BgRKNlhe.js";import"./DoV6T4jL.js";import"./oXqQd4Ap.js";import"./CQYGjB7w.js";import"./CJ2-25UQ.js";import"./BqHrj3jM.js";import"./DFarnK1O.js";import"./uhX4GmSj.js";import"./BJ13bZ6b.js";import"./c0eKk1Db.js";import"./DbzcfNKS.js";import"./BGKE3O6B.js";import"./DJeUPDeV.js";import"./B0UoamS-.js";import"./HSznFPq-.js";import"./omosduih.js";import"./D3yCfJ5s.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";const U=()=>e.jsx(e.Fragment,{children:"This will list down all user & admin activities"}),E=()=>e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Deactivate all apikeys"}),e.jsx(a,{className:"mb-3",children:e.jsxs(r,{children:[e.jsx("p",{children:"Clearing all active apikeys will deny future incoming requests."}),e.jsx(l,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:!0,children:"Deactivate all apikeys"})]})}),"This will list down all api auth token created by user, there last accessed and its allowed ip addresses."]}),O=({color:s,title:a,value:r,data:l})=>e.jsx(t,{color:s,value:r,title:a,action:e.jsx(i,{alignment:"end",children:e.jsx(n,{color:"transparent",caret:!1,className:"text-white p-0"})}),chart:e.jsx(d,{className:"mt-3",style:{height:"70px"},data:{labels:Array(10).fill(""),datasets:[{label:"Data",backgroundColor:"rgba(255,255,255,.2)",borderColor:"rgba(255,255,255,.55)",data:l,fill:!0}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!1}},elements:{line:{borderWidth:2,tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4}},animation:{duration:0}}})});O.propTypes={color:F.string.isRequired,title:F.string.isRequired,value:F.any.isRequired,data:F.any.isRequired};const I=()=>{const[a,r]=s.useState(null),[l,t]=s.useState(!0),{addToast:i}=q(),[n,d]=s.useState(Array(10).fill(0)),[h,j]=s.useState(0),[m,x]=s.useState(Array(10).fill(0)),[u,p]=s.useState(0),v=(e,s,a,r)=>{const l=4*(Date.now()-r),t=parseFloat((a/l*100).toString().match(/^(\d+\.\d)/));x((e=>{const s=[...e,t];return s.length>10&&s.shift(),s}));const i=m.reduce(((e,s)=>e+s),0);p(i.toString().match(/^(\d+\.\d)/))},y=async()=>{await axios.get(`${k}/metrics/v1/prometheus`,{headers:{Authorization:`Bearer ${cookies.get(T)}`}}).then((e=>{const s=e.data;r(s),((e,s,a,r)=>{v(e,s,a,r);const l=Date.now()-r,t=parseFloat((s/l).toString().match(/^(\d+\.\d)/));d((e=>{const s=[...e,t];return s.length>10&&s.shift(),s}));const i=n.reduce(((e,s)=>e+s),0);j(i.toString().match(/^(\d+\.\d)/))})(s.process_cpu_user_seconds_total[0].value,s.process_cpu_system_seconds_total[0].value,s.process_cpu_seconds_total[0].value,s.process_start_time_seconds[0].value)})).catch((e=>{if(401==e.status)return window.location.reload();console.error(e);const s=D[e.status]||"Server is offline or restarting please wait";i(s,"Submit failed!")})).finally((()=>t(!1)))};return s.useEffect((()=>{y();const e=setInterval((()=>{y()}),1500);return()=>clearInterval(e)}),[]),e.jsx("div",{children:a&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{xs:{gutter:4},children:[e.jsx(o,{sm:6,xl:4,xxl:3,children:e.jsx(O,{color:"primary",title:"Average Load Time",value:h,data:n})}),e.jsx(o,{sm:6,xl:4,xxl:3,children:e.jsx(O,{color:"danger",title:"CPU Usage",value:`${u}%`,data:m})})]}),JSON.stringify(a,null,4)]})})},z=()=>{const{addToast:a}=q(),[r,l]=s.useState(!0),[t,i]=s.useState([]);return s.useEffect((()=>{(async()=>{await axios.get(`${k}/api/v1/sec/management/dependabot`,{headers:{Authorization:`Bearer ${cookies.get(T)}`}}).then((e=>{e.data.error||i(e.data)})).catch((e=>{console.error(e);const s=D[e.status]||"Server is offline or restarting please wait";a(s)})).finally((()=>l(!1)))})()}),[]),e.jsxs("div",{children:[r&&e.jsx("div",{className:"loading-overlay",children:e.jsx(h,{color:"primary",variant:"grow"})}),0===t.length&&!r&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(j,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})}),0!==t.length&&e.jsxs(e.Fragment,{children:[e.jsxs(m,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(x,{className:"mb-3",children:[e.jsx(u,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:query,onChange:e=>setQuery(e.target.value)}),e.jsx(p,{id:"basic-addon",children:e.jsx(L,{icon:R})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:state,onChange:e=>setState(e.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:priority,onChange:e=>setPriority(e.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:order,onChange:e=>setOrder(e.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(y,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(b,{children:e.jsxs(g,{children:[e.jsx(f,{children:"#"}),e.jsx(f,{children:"State"}),e.jsx(f,{children:"Scope"}),e.jsx(f,{children:"Manifest"}),e.jsx(f,{children:"CVE"}),e.jsx(f,{children:"Summary"}),e.jsx(f,{children:"Severity"}),e.jsx(f,{children:"Last Updated"})]})}),e.jsx(N,{children:t.map((s=>e.jsxs(g,{children:[e.jsx(w,{children:s.number}),e.jsx(w,{children:s.state}),e.jsx(w,{children:s.scope}),e.jsx(w,{children:s.manifest}),e.jsx(w,{children:s.cve}),e.jsx(w,{children:s.summary}),e.jsx(w,{children:s.severity}),e.jsx(w,{children:P(new Date(s.updated_at).getTime())})]},s.number)))})]})]})]})},B=()=>e.jsx(e.Fragment,{children:"This will setup maintenance status to the system denying user access temporarily."}),M=()=>{const{addToast:a}=q(),[r,l]=s.useState(!0),[t,i]=s.useState([]);return s.useEffect((()=>{(async()=>{await axios.get(`${k}/api/v1/sec/management/sentry`,{headers:{Authorization:`Bearer ${cookies.get(T)}`}}).then((e=>{e.data.error||i(e.data)})).catch((e=>{console.error(e);const s=D[e.status]||"Server is offline or restarting please wait";a(s)})).finally((()=>l(!1)))})()}),[]),e.jsxs("div",{children:[r&&e.jsx("div",{className:"loading-overlay",children:e.jsx(h,{color:"primary",variant:"grow"})}),0===t.length&&!r&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(j,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any issues."}),e.jsx("p",{children:"Should we add one? :)"})]})}),0!==t.length&&e.jsxs(e.Fragment,{children:[e.jsxs(m,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(x,{className:"mb-3",children:[e.jsx(u,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:query,onChange:e=>setQuery(e.target.value)}),e.jsx(p,{id:"basic-addon",children:e.jsx(L,{icon:R})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:state,onChange:e=>setState(e.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:priority,onChange:e=>setPriority(e.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:order,onChange:e=>setOrder(e.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(y,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(b,{children:e.jsxs(g,{children:[e.jsx(f,{children:"#"}),e.jsx(f,{children:"Title"}),e.jsx(f,{children:"Culprit"}),e.jsx(f,{children:"Level"}),e.jsx(f,{children:"Status"}),e.jsx(f,{children:"Priority"}),e.jsx(f,{children:"Count"}),e.jsx(f,{children:"Last Updated"})]})}),e.jsx(N,{children:t.map((s=>e.jsxs(g,{children:[e.jsx(w,{children:s.id}),e.jsx(w,{children:s.title}),e.jsx(w,{children:s.culprit}),e.jsx(w,{children:s.level}),e.jsx(w,{children:s.status}),e.jsx(w,{children:s.priority}),e.jsx(w,{children:s.count}),e.jsx(w,{children:P(new Date(s.updated_at).getTime())})]},s.id)))})]})]})]})},H=()=>{const{addToast:t}=q(),[i,n]=s.useState(!0),[d,c]=s.useState([]);return s.useEffect((()=>{(async()=>{await axios.get(`${k}/api/v1/sec/management/sessions`,{headers:{Authorization:`Bearer ${cookies.get(T)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{console.error(e);const s=D[e.status]||"Server is offline or restarting please wait";t(s)})).finally((()=>n(!1)))})()}),[]),e.jsxs("div",{children:[i&&e.jsx("div",{className:"loading-overlay",children:e.jsx(h,{color:"primary",variant:"grow"})}),d&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Logout all sessions"}),e.jsx(a,{className:"mb-3",children:e.jsxs(r,{children:[e.jsx("p",{children:"Clearing all active sessions will log everyone out."}),e.jsx(l,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:!0,children:"Logout all sessions"})]})}),e.jsxs(y,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(b,{children:e.jsxs(g,{children:[e.jsx(f,{children:"#"}),$&&e.jsx(f,{children:"User"}),e.jsx(f,{children:"Location"}),e.jsx(f,{children:"Device"}),e.jsx(f,{children:"Status"}),e.jsx(f,{children:"Last Accessed"})]})}),e.jsx(N,{children:d.map(((s,a)=>e.jsxs(g,{children:[e.jsx(w,{children:a+1}),$&&e.jsx(w,{children:s.user_id}),e.jsx(w,{children:s.ip_address}),e.jsx(w,{children:s.user_agent}),e.jsx(w,{children:s.active?"Active":"Inactive"}),e.jsx(w,{children:P(s.last_accessed)})]},a)))})]})]})]})},J=()=>e.jsx("div",{children:e.jsxs(S,{activeItemKey:0,className:"mb-4",children:[e.jsxs(_,{variant:"underline-border",children:[e.jsx(A,{"aria-controls":"dashboard-tab-pane",itemKey:0,children:"Dashboard"}),e.jsx(A,{"aria-controls":"sessions-tab-pane",itemKey:1,children:"Sessions"}),e.jsx(A,{"aria-controls":"dependabot-tab-pane",itemKey:2,children:"Dependabot"}),e.jsx(A,{"aria-controls":"sentry-tab-pane",itemKey:3,children:"Sentry"}),e.jsx(A,{"aria-controls":"api-tab-pane",itemKey:4,children:"API Key"}),e.jsx(A,{"aria-controls":"activity-tab-pane",itemKey:5,children:"Activity"}),e.jsx(A,{"aria-controls":"maintenance-tab-pane",itemKey:6,children:"Maintenance"})]}),e.jsxs(C,{children:[e.jsx(K,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:e.jsx(I,{})}),e.jsx(K,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:e.jsx(H,{})}),e.jsx(K,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:e.jsx(z,{})}),e.jsx(K,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:e.jsx(M,{})}),e.jsx(K,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:4,children:e.jsx(E,{})}),e.jsx(K,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:5,children:e.jsx(U,{})}),e.jsx(K,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:6,children:e.jsx(B,{})})]})]})});export{J as default};
