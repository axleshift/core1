const I=f;(function(p,q){const T={p:0x190,q:'A^wE',r:0x1a8,s:'0h&A',t:0x17d,u:'Sy#9',v:0x206,w:'c$ok',x:'TY2m',y:0x203,z:0x209,A:'ctl['},C=f,r=p();while(!![]){try{const s=parseInt(C(T.p,T.q))/0x1*(-parseInt(C(0x1ff,'xw@t'))/0x2)+parseInt(C(T.r,'jeSL'))/0x3*(parseInt(C(0x210,T.s))/0x4)+-parseInt(C(T.t,T.u))/0x5*(parseInt(C(T.v,T.w))/0x6)+parseInt(C(0x1c2,T.x))/0x7+-parseInt(C(T.y,'cC7t'))/0x8+-parseInt(C(0x14d,'xw@t'))/0x9+parseInt(C(T.z,T.A))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x4916f));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a2={p:0x172,q:0x19d,r:'oHn%'},a1={p:'0qW5',q:0x159,r:0x1dd,s:0x185,t:0x205,u:'A^wE',v:0x16a,w:'0h&A',x:0x221,y:'ctl['},D=f,p={'rIJVM':D(0x1c9,')YC!'),'FUWjJ':function(q,r){return q(r);},'KJxBF':'init','WiPTD':function(q,r){return q+r;},'hPHMC':D(a2.p,'fAwx'),'nfHJZ':D(a2.q,a2.r),'nmAjO':function(q){return q();}};d(this,function(){const E=D,q=new RegExp(E(0x157,a1.p)),r=new RegExp(p['rIJVM'],'i'),s=p[E(a1.q,'vWiT')](c,p[E(0x1e6,'hkyn')]);!q[E(a1.r,'ppd%')](p[E(a1.s,'g[P0')](s,p[E(0x1c4,'js@0')]))||!r[E(0x199,'OyCk')](p[E(a1.t,a1.u)](s,p[E(0x15e,'ctl[')]))?p[E(a1.v,a1.w)](s,'0'):p[E(a1.x,a1.y)](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ab={p:0x212,q:'A*MQ',r:0x202,s:'^xTs',t:'yZRZ',u:0x1f5,v:0x1da,w:'E6Xd',x:')YC!',y:0x1c7,z:0x225,A:'NN)6',B:0x151,ac:0x1de,ad:'6Sx6',ae:0x180,af:'kABV',ag:0x166,ah:'cC7t',ai:'ppd%'},aa={p:0x217,q:'NN)6',r:'uG[Z',s:'xw@t'},F=f,p={'VdPya':function(u,v){return u(v);},'OzJXL':function(u,v){return u+v;},'eqUhj':function(u,v){return u+v;},'NlHdm':'return\x20(function()\x20','hgIrP':'{}.constructor(\x22return\x20this\x22)(\x20)','OiGNH':F(ab.p,'CLbc'),'XLUjA':F(0x17a,'G)Z6'),'SBigg':F(0x1c0,ab.q),'AdoAH':F(ab.r,'@[QD')},q=function(){const G=F;let u;try{u=p[G(aa.p,aa.q)](Function,p['OzJXL'](p[G(0x1e0,aa.r)](p[G(0x179,'c$ok')],p[G(0x182,aa.s)]),');'))();}catch(v){u=window;}return u;},r=q(),s=r[F(0x227,ab.s)]=r[F(0x1fd,'Z$T8')]||{},t=[F(0x170,ab.t),p['OiGNH'],'info',p[F(ab.u,'!8Ry')],p[F(ab.v,ab.w)],'table',p[F(0x1a3,ab.x)]];for(let u=0x0;u<t[F(ab.y,'OyCk')];u++){const v=b[F(ab.z,'Sy#9')][F(0x1b8,ab.A)][F(ab.B,'M#n)')](b),w=t[u],x=s[w]||v;v[F(ab.ac,ab.ad)]=b[F(ab.ae,ab.af)](b),v[F(ab.ag,ab.ah)]=x[F(0x1cb,ab.ai)]['bind'](x),s[w]=v;}});a();import g from'dotenv';g['config']();import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x144;let h=c[d];if(f['trMpCr']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['LZKoCo']=m,a=arguments,f['trMpCr']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['cBFwPt']===undefined&&(f['cBFwPt']=!![]),h=f['LZKoCo'](h,g),a[k]=h):h=l,h;},f(a,b);}import{send}from'../../components/mail.js';function e(){const b0=['khZdI0u','uc1qwG','W7bhomkBW4a','iK3dJ0Xnaa','W4FcJrGgD2W','rmocA8k1WPG','A1zzWPv0W5pdTJbzWOa','eeBdNW','EsxcOrPlW4VdQrZcGNa','gmopW7C','WPuWW4ddNa','b1/dJmk3W5i','WQXAWO0PDq','omkdC2WZW7DA','WPVdNmkTWQ5p','DuOLW4bp','W4zGmJRdUa7cNXZdIWyt','W5lcKbCwtxhcPq','ugekW7P3WRy1','seLPWQ7dTc7cQ3NcVmkkW41O','c1RdJCk0W7G','WOm6W5FdKq','tY5BvtFcGG','FZ42umoSWQHjWQjcWRm','W7NdN8kCwMe','WPutbXBdSa','WR7dPh7dHa','mxVdHv9HsG','jIOZqYxcQG','W5vmc8kjW4qD','jCoxW7DR','W65SbSkxW7a','WOmkbWVdQvq','w8olW4jyWQm2WPm9W5JcMW','CMb5WO/cPa','xaOHEwVcTGWtacCtW4HY','mSoCW5P1sG','q2exW70','W5iDWOKEfG','W5BcKbCw','v8k6WR4GdCkgzSkTtW','tCkGWQWXcSkb','WPJdKSkbWPFcNG','W5XgntpdPG','WOKeaZ3dMW','W6ZdVSkXCMhdHIBcI8ovWRfQk0RcKXBdJa','WQBdQSk/WQ0','yezndfS','xmoGFq','W7ZdLKz6gq','W7xdNKL0aCoR','bfZdQmotW7W','WQXrWOqjya','WQiujWVdVG','eK7dPhnW','yCofdeG','BYj7n8kooq','WRldPmkQWRTnW6W','WO9Rqve','qCo7A8kpWOiK','WOmWW7FdKrVcPmk4W58','WPmNlWRdTG','WRinraO','WP86W5W','WORdJmkhWQNcVq','W4VcQmoBW5zgna','WPNdNmkCWQhcNG','WQBdO8kpWPvj','FSkhuvK','W4PQs1JcGCoOW7DVWR8','Dmo1qG','WRdcQCoFWQRdLg0','WRFdV3ddG8ol','wSk9WQOGdmkg','i2ZdKej7vW','WQC+W5FdLH7cOSkKW5XnCCo3WRfYWRVdRYSSWO7cHuJdSSkBBCoIECkZWQLyk2OxW6pdGCkSke5j','WOq6W4RdGq','WOqRW4xdKrZcVG','zYSNpCkpmmkmCfhdRSobW5i2dmo1W51BWQr4ptz2y8oLymkCWPRdLmoAWQSSWP4','WPhdRmkAvCoW','WObQxfdcMG','uCoogvpcQqaWW6X3A8kS','lxVdLa','WPq9Ah/cUrBcGaxdRH8B','uJXrg8kxEW','Dmo/sY3dS8kS','WQmbraO','bCoOW5T3WQCoW4GVz8kDmW','af9Boai','WQSBrqa','cwpdNCobW4i','WPBdUCkBWPT8','W6RcS8opW5zwnq','rxX2cNrtedpdUCot','W4tcLGOg','sXL6g8kK','WRVdG8kiWONcVG','jCogW7H7tSoR','C8oyW7Sg','x8onW5rs','A8oZW7HlW5KVfSoxW4rawSk/W7xcL0e','Fmo6W7yYWOW','DJJcLXWSd1OvW55Qm8op','ASo/ut/dTCkQkszTWRKEWRBdGCkUWRZcRXNdSSoA','WRGXW4hcHt3cPmk7W51ntmoJWRf1W6ZdOJXOW4NdN2ldH8k/iq','WRddOSk9xCov','Amo1vJ4','W6ufWQGWma','s8oFdq','W4tcLqm9Bq','ufGYW4r3','WQpcLIO5','BmosW5e','vxz0aG','k3RdG8kTW4i','WRr0W4BdRmoe','W5FcIXWtDNRcPmoaWQn4','rxj2cG','E01uWO1KW4m','W6NdLfrN','W63cQmokW7DW','ycXFlSkQ','huH2kYBdOhaAaG','W7NdO8k+iYdcMq','WQ5UW5FdRCofWRq','jvBdHv1w','tXNcNmoXWRRdRCoilSk1WPVcTSoqyG','W6r9WPi2WOhcLwziyb3cOXZdHa','w8oBW50GWOO','WOLwg8khW5m','EZRcVrPx','hCoJzCkCWPGIW6C','za18dCkL','WQPsWQ0Nx8kqrW','rSoGyCkEWPK','huT3oce','WRVdO2e','c2ldQ8o0W4e','fuJdIebE','vSoQAmko','FIm3sa','W4CcWPixaq','W5zrb8kwW44DaSoQW4K','tK94','F8krr18','WRhcNZyIra','oN9JW4LP','dvvZiZ7dMKKrftCZW6fmlCkR','jJS8uW','rcSHq8oD','c2JdUSo+W4pdM8ktDcC','W5vgbSkg','l3HHaSkOW785WOvZWO1RWPOC','A8oUrd7dSSk3','WRGFW6LiW7S','CCoyW4JcQW','WQxdTvZdNmog','WRVcLJCQqMi','WRFcSSovWRVdJW','FwnSrmociSosWQW/cGPYz8oJjmouW7dcHN5zWPJcSCkBaCkmreZcRSodawVdINhdVG','WQ7dN8kpWR1n','iwf0W79QWOP3WRW','BdybvmoG','mJK3rq','WR3dUwldJ8oxdmodCmoq','n8oSqdJdRSkICa','qmowW6WqWOHACwzlW50HWOZdIbtdRHVcUG3dS8oLWOrHW44','WQFdNZ3dI8kj','xCkHBv8a','chNdT8o/W7ZdGCkF','dSoiW6xdRLaAWPtdHsGbWOC','W7VdU37dJComfG','WOafW4bgW4a','W5rggmkoW4akhG','W7BcS8oE','o0RdGvy','WRldMrxdPCk5','xYXnwZe','tYDh','iwTuW78','WQ8HfG3dS1muW59M','WQtcHZG5q3K','z8omW7pcPWq','WQFdSN/dJG','fCoIW4fnWR0iW5G+zCktlq','c2WlaNBcJCkTs8k8gqy','cmoOW4i','W7NdICkwz3m','ECofCSk5WRe','k2y9BSosASopvfBdK8o6W7Wy','lCovW7ZdOq','lColW4pcVqFcLSkoW7SAWPlcP8o8umkCW6G','CmkXW7jiW447a8omW49l','BSk1WR42cmkDw8kNcSoEW47dHtaLCSoSWOxcHrFdHmomEmkhW6DgWRLqWPxcUSkYWRdcUYlcQSknW7JdOSkgW5PpW78WWPhcL8ktWOmwA8kTWPhdMmkafIeEw8oEW5VdTSogjMvnW6lcGMSvnWpdHrb6W4z1WO5SasitW5mxW6VcMCk9x8of','W5rQdXZdQW','hh7dV8kuW4e','WRlcGsSIra','b8oRW5K','W6RcOSoaW4y','AIxcVGi','xCouW4i','BZNcQaq','dmosW6vLWQi','swPjWRBcLq','WOvXWQavFa','WRHOW4tdTSoc','y8kXW61q','F8ksrKWxW7P2W4LV','WQ97W5JdVCoFWQO','EIu9vCoxWQnK','xhLygqVdReu','bCoOW5T3WRWqW5G','p1PadIu','wLLdcWldRvW','W5hcVHeFCa','zCoeW7Or','FSkqq04g','W49QWPBcLvddU8k6W74eDSo0WPm','W6FdOSkOA14','fwBdTh9q','W6VcTSoGyCo8WRXWA8oO','Et4HxSoQ','WR/dRCkXWRFcGSkq','W7uhW7HZcmowbmonWRpcTa4oWQq','F0LR','b196mIO','WRKSW4JdQrO','BslcPbPlWOJcTqhcN2TlsY9cWPK','WRiCsXRcIrO','W41Qps3dQq7cMq','W7JdMmkAWPdcRSkkW6C','W7pcTmobW4W','z8owW60n','CSkYW7i','W6n7WPm2WOJcLg1PrtlcOX3dQq'];e=function(){return b0;};return e();}(function(){const ae={p:'yZRZ',q:0x178,r:'0h&A',s:0x204,t:'0qW5',u:0x1a2,v:'*i!S',w:0x1e2},H=f,p={'wZXJI':function(r,s){return r(s);},'miwzK':function(r,s){return r+s;},'sBIvf':H(0x191,ae.p),'todUS':H(ae.q,'7M^C')};let q;try{const r=p[H(0x18a,ae.r)](Function,p[H(ae.s,ae.t)](p['miwzK'](p[H(0x1e5,ae.t)],p[H(ae.u,ae.v)]),');'));q=r();}catch(s){q=window;}q[H(ae.w,'Z$T8')](c,0x9c4);}());const router=h[I(0x16b,'*i!S')]();router[I(0x1f1,'Q^dH')](I(0x16f,'G)Z6'),async(p,q)=>{const aj={p:'nqvl',q:0x1d0,r:'CLbc',s:0x1b1,t:0x1ba,u:'@[QD',v:'cC7t',w:'*i!S',x:'uG[Z',y:')%SN',z:0x171,A:'Grg0',B:0x20b,ak:'xw@t',al:0x17e,am:0x215,an:'A^wE',ao:'0qW5',ap:0x1d2,aq:0x1c3,ar:'MEzm',as:0x1fe,at:'jTIf',au:0x226,av:'TY2m',aw:'g[P0',ax:'*i!S',ay:'vWiT',az:0x1be,aA:0x1b3,aB:'A*MQ',aC:0x218,aD:0x1f0},J=I,r={'oedve':function(s,t){return s||t;},'bWWRJ':function(s,t){return s<t;},'oghxx':J(0x175,'cC7t'),'sTCKt':J(0x1eb,aj.p),'WCOrc':function(s,t){return s!=t;},'ZLfaw':J(aj.q,aj.r),'WbRDw':function(s){return s();},'USkkI':J(aj.s,'xw@t'),'oODru':'Email\x20id\x20already\x20exists','oqDBq':J(aj.t,aj.u)};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(0x21f,aj.v)];if(r['oedve'](!s,!t)||!u||!v||!w)return q[J(0x186,aj.w)](0x190)[J(0x1c5,aj.x)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(0x16e,'@[QD')](s))return q[J(0x146,aj.y)](0xc8)[J(0x158,'0h&A')]({'error':'Invalid\x20email\x20address'});if(r[J(0x1ed,'jeSL')](v[J(0x15c,'5nv#')],0x8))return q[J(aj.z,aj.A)](0xc8)[J(0x183,'kABV')]({'error':r[J(aj.B,aj.ak)]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[J(0x22a,'cC7t')](v))return q[J(aj.al,')YC!')](0xc8)[J(aj.am,aj.an)]({'error':r[J(0x22d,aj.ao)]});if(r[J(aj.ap,aj.u)](v,w))return q[J(aj.aq,'yZRZ')](0xc8)[J(0x216,aj.ar)]({'error':r[J(0x223,'g[P0')]});const x=await r[J(aj.as,aj.ak)](k),y=x[J(0x1ea,aj.at)](r[J(0x19c,'jeSL')]),z=await y[J(aj.au,'M#n)')]({'email':s});if(z)return l[J(0x207,aj.av)](r[J(0x1ca,aj.aw)]),q[J(0x186,aj.ax)](0x199)[J(0x19b,aj.ay)]();return await y[J(0x152,aj.p)]({'email':s,'first_name':t,'last_name':u,'role':r[J(0x1bc,'ppd%')],'password':o(v),'email_verify_at':'','created_at':Date[J(0x19a,'uG[Z')](),'update_at':Date['now']()}),q['status'](0xc9)[J(aj.az,aj.y)]();}catch(A){l[J(aj.aA,aj.aB)](A);}return q[J(aj.aC,'TN(p')](0x1f4)[J(aj.aD,aj.ax)]();}),router['post'](I(0x1d5,'fAwx'),n,async(p,q)=>{const ao={p:'eUQu',q:0x14e,r:']BEG',s:0x21d,t:'Q^dH',u:0x14a,v:0x1be,w:'TY2m',x:0x22b,y:'MEzm',z:0x173,A:0x169,B:0x1af,ap:'ctl[',aq:0x18e,ar:'NN)6',as:0x1df,at:0x216,au:0x208,av:'0h&A'},K=I,r={'dnCzq':function(s,t){return s||t;},'hoxoo':function(s){return s();},'cYIuj':function(s,t){return s!=t;},'NslLs':K(0x1a5,'0qW5'),'HOnuQ':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[K(0x18d,ao.p)];if(r[K(ao.q,ao.r)](!s,!t))return q[K(0x171,'Grg0')](0x190)['send']();const u=await r['hoxoo'](k),v=await u[K(ao.s,ao.t)]('users')['findOne']({'email':s});if(!v)return q[K(ao.u,'6Sx6')](0x194)['send']();if(r[K(0x167,'6Sx6')](o(t),v['password']))return q['status'](0x191)[K(ao.v,')%SN')]();const w=j[K(0x22c,ao.w)](r[K(0x20c,'cC7t')])[K(ao.x,ao.y)](generateUniqueId())[K(ao.z,'nqvl')](K(ao.A,'cC7t')),x=p[K(ao.B,ao.ap)][K(ao.aq,'jTIf')]||p[K(0x147,ao.ar)]['remoteAddress'];return r[K(0x149,'NN)6')](addSession,v,w,x,p[K(0x20f,'Sy#9')]['user-agent']),q[K(ao.as,'OyCk')](0xc8)[K(ao.at,ao.y)]({'token':w});}catch(y){l['error'](y);}return q[K(ao.au,ao.av)](0x1f4)[K(0x176,'cC7t')]();}),router[I(0x194,'yZRZ')](I(0x1cf,'yZRZ'),m,async function(p,q,r){const au={p:'xw@t',q:'cC7t',r:0x1d9,s:'TN(p',t:0x187,u:'vWiT',v:'A*MQ',w:'Grg0',x:0x19e,y:'A*MQ',z:0x21a,A:'Z$T8',B:'kABV',av:'DXN7',aw:0x200},L=I,s={'HSKTJ':function(z,A){return z!==A;},'qQMlH':'otp','jLqHO':function(z,A){return z*A;},'Giqkb':function(z,A){return z>A;},'vMaNo':function(z,A){return z-A;},'eGhmr':function(z,A,B){return z(A,B);}},{_id:t,email_verify_at:u,...v}=p['user'];v['is_email_verified']=s['HSKTJ'](u,'');if(s['HSKTJ'](p[L(0x201,'CLbc')][L(0x1bd,au.p)],''))return q[L(0x177,au.q)](0xc8)[L(au.r,au.s)](v);const w=await k(),x=await w[L(au.t,au.u)](s['qQMlH']),y=await x[L(0x1d3,au.v)]({'token':p[L(0x1c8,au.w)],'verified':![]});if(y){const z=new Date(y[L(au.x,'M#n)')]),A=s['jLqHO'](s[L(0x15d,au.y)](0xa,0x3c),0x3e8);if(!s['Giqkb'](s[L(au.z,'hkyn')](Date[L(0x1e4,au.A)](),z),A))return q[L(0x20e,au.B)](0xc8)[L(0x1e8,au.av)]({'otp':!![]});}return s[L(au.aw,'M#n)')](sendOTPEmail,p,x),q[L(0x18b,']BEG')](0xc8)['json']({'otp':!![]});});const sendOTPEmail=(p,q)=>{const ax={p:0x1bb,q:'OyCk',r:0x1fa,s:'fAwx',t:0x161,u:0x196,v:'0dbB',w:'!8Ry',x:0x21c,y:'jeSL',z:0x22e,A:0x1b4,B:'TN(p',ay:0x201,az:'CLbc'},M=I,r={'ibOnJ':function(t,u){return t+u;},'PAEJu':function(t,u,v){return t(u,v);},'Dqfxf':M(0x192,'cC7t')},s=Math[M(ax.p,ax.q)](r['ibOnJ'](0x186a0,Math[M(ax.r,'oHn%')]()*0xdbba0));Promise[M(0x1ef,'Z$T8')]([q[M(0x1ce,ax.s)]({'user_id':p[M(ax.t,'0dbB')][M(ax.u,ax.v)],'token':p['token'],'code':s,'verified':![],'expired':![],'created_at':Date[M(0x20a,ax.w)](),'updated_at':Date[M(ax.x,ax.y)]()}),r['PAEJu'](send,{'to':p[M(0x1f3,'Q^dH')][M(ax.z,'6Sx6')],'subject':r[M(ax.A,ax.B)],'text':M(0x228,'!8Ry')+s+',\x20valid\x20for\x2010\x20minutes\x20only.'},p[M(ax.ay,ax.az)][M(0x14b,'eUQu')])]);};router[I(0x188,'M#n)')](I(0x1ab,'NN)6'),m,async function(p,q,r){const az={p:0x145,q:'A^wE',r:'G)Z6',s:0x1f7,t:'oHn%'},N=I,s={'qbMvc':function(t,u){return t(u);}};try{const t=await s[N(0x1c6,'fAwx')](getUser,p['token']);return q[N(az.p,az.q)](0xc8)[N(0x164,az.r)]({'user':{'email':t[N(0x15b,'5nv#')],'first_name':t['first_name'],'last_name':t['last_name']}});}catch(u){l[N(az.s,az.t)](u);}return q[N(0x219,'M#n)')](0x1f4)[N(0x1f0,'*i!S')]();}),router[I(0x1f8,'jTIf')](I(0x1ad,'hkyn'),m,function(p,q,r){const aA={p:'hkyn'},O=I;return removeSession(p[O(0x1b0,aA.p)]),q[O(0x1a0,')j@]')](0xc8)['send']();}),router[I(0x14f,'^xTs')](I(0x1e9,'uG[Z'),[m,n],async function(p,q,r){const aG={p:'*i!S',q:0x1fb,r:0x1a7,s:0x14c,t:'!8Ry',u:0x16c,v:'@[QD',w:0x1b9,x:0x15a,y:'hkyn',z:0x1ee,A:0x1c1},P=I,s={'TKQTi':function(t){return t();},'cFeSp':function(t,u){return t*u;},'UELbi':function(t,u){return t*u;},'zEnVu':function(t,u){return t>u;},'RjAtb':function(t,u,v){return t(u,v);}};try{const t=await s[P(0x154,'0h&A')](k),u=await t['collection'](P(0x1d8,aG.p)),v=await u[P(aG.q,'TY2m')]({'token':p[P(aG.r,'TN(p')],'verified':![],'expired':![]});if(v){const w=new Date(v['created_at']),x=s[P(aG.s,aG.t)](s[P(aG.u,'0h&A')](0xa,0x3c),0x3e8);s['zEnVu'](Date['now']()-w,x)&&(await u[P(0x1f9,aG.v)]({'_id':new ObjectId(v[P(aG.w,aG.t)])},{'$set':{'verified':![],'expired':!![],'updated_at':Date[P(aG.x,aG.y)]()}}),s[P(0x15f,'6Sx6')](sendOTPEmail,p,u));}}catch(y){l[P(aG.z,'OyCk')](y);}return q[P(0x153,'nqvl')](0x1f4)[P(aG.A,'NN)6')]();}),router[I(0x1a1,'5nv#')]('/verify/otp',[m,n],async function(p,q,r){const aN={p:0x17b,q:'0dbB',r:'DXN7',s:'jeSL',t:0x1b2,u:'fAwx',v:0x1e1,w:0x1bf,x:0x17c,y:0x150,z:0x1f6,A:'ctl[',B:'Sy#9',aO:0x21c,aP:0x144,aQ:'^xTs',aR:'CLbc',aS:0x1d7,aT:0x1a6,aU:0x213,aV:'jTIf',aW:'xw@t',aX:'uG[Z',aY:0x21b,aZ:'js@0',b0:0x21e,b1:'A^wE',b2:0x168,b3:'MEzm'},Q=I,s={'XgrrE':function(t){return t();},'GFlVF':function(t,u){return t*u;},'qeSUg':function(t,u){return t>u;},'aIIFU':function(t,u){return t-u;},'jUPaq':Q(aN.p,aN.q),'cVVMo':function(t,u){return t!==u;},'yHAhJ':function(t,u){return t(u);},'plzOo':Q(0x1d4,aN.r),'PJaCx':Q(0x229,aN.s)};try{const t=p[Q(0x1b6,'TY2m')][Q(aN.t,aN.u)];if(!t)return q[Q(0x165,'hkyn')](0x190)[Q(aN.v,'fAwx')]();const u=await s[Q(aN.w,'TY2m')](k),v=await u['collection'](Q(aN.x,'A^wE')),w=await v['findOne']({'token':p[Q(aN.y,'YPv9')],'verified':![],'expired':![]});if(w){const x=new Date(w['created_at']),y=s[Q(aN.z,aN.A)](0xa,0x3c)*0x3e8;if(s[Q(0x1ec,aN.B)](s['aIIFU'](Date[Q(aN.aO,'jeSL')](),x),y))return q[Q(0x163,'g[P0')](0xc8)[Q(aN.aP,'fAwx')]({'error':s[Q(0x1f4,'Z$T8')]});}if(s[Q(0x198,aN.aQ)](w[Q(0x18c,aN.aR)],s['yHAhJ'](parseInt,t[Q(aN.aS,'NN)6')](/[^0-9]/g,''))))return q[Q(aN.aT,'oHn%')](0xc8)[Q(0x211,'*i!S')]({'error':s[Q(0x197,'M#n)')]});return await Promise[Q(aN.aU,aN.aV)]([v[Q(0x1a4,aN.aW)]({'_id':new ObjectId(w[Q(0x1f2,aN.aX)])},{'$set':{'verified':!![],'updated_at':Date[Q(0x1dc,')YC!')]()}}),u[Q(aN.aY,')j@]')](s[Q(0x1d6,aN.aZ)])['updateOne']({'_id':new ObjectId(p['user'][Q(aN.b0,'DXN7')])},{'$set':{'email_verify_at':Date['now'](),'updated_at':Date['now']()}})]),q[Q(0x145,aN.b1)](0xc8)[Q(aN.b2,'kABV')]();}catch(z){l[Q(0x1db,aN.b3)](z);}return q['status'](0x1f4)[Q(0x148,']BEG')]();});export default router;function c(p){const aZ={p:0x162,q:'7M^C',r:0x1b5},aY={p:0x1ae,q:'7M^C',r:0x1b7,s:'YPv9',t:'6Sx6',u:'CLbc',v:'jeSL',w:'E6Xd',x:0x19f,y:'vWiT',z:0x174,A:'TN(p',B:0x224,aZ:'^xTs',b0:0x184,b1:'Q^dH',b2:0x1cc},R=I,q={'EELbG':R(aZ.p,aZ.q),'WOsED':R(0x20d,'Q^dH'),'yzeBG':function(s,t){return s!==t;},'lMiQs':function(s,t){return s+t;},'yvdqY':function(s,t){return s/t;},'yIizj':function(s,t){return s===t;},'KlBCu':function(s,t){return s%t;},'CwJKH':function(s,t){return s+t;},'FDAIW':R(aZ.r,'hkyn'),'gsDZq':R(0x1cd,')%SN'),'obolH':'stateObject','pzRex':function(s,t){return s(t);}};function r(s){const S=R;if(typeof s===q[S(aY.p,')YC!')])return function(t){}['constructor'](q[S(0x189,aY.q)])[S(aY.r,aY.s)]('counter');else q[S(0x156,aY.t)](q[S(0x18f,aY.u)]('',q[S(0x220,aY.v)](s,s))[S(0x17f,'yZRZ')],0x1)||q[S(0x155,'Sy#9')](q[S(0x1aa,aY.u)](s,0x14),0x0)?function(){return!![];}['constructor'](q[S(0x195,'YPv9')](q[S(0x1d1,aY.w)],q[S(0x16d,'g[P0')]))[S(aY.x,aY.y)](S(aY.z,'A^wE')):function(){return![];}[S(0x181,'Z$T8')](q[S(0x160,aY.A)](q[S(aY.B,aY.aZ)],q[S(aY.b0,'A*MQ')]))[S(0x1ac,aY.b1)](q[S(0x193,'c$ok')]);q[S(aY.b2,'TY2m')](r,++s);}try{if(p)return r;else q['pzRex'](r,0x0);}catch(s){}}