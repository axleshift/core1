const I=f;(function(p,q){const R={p:0x15a,q:0xf8,r:'nOJ5',s:0x11a,t:'XM(A',u:'ceUP',v:0x119,w:'0yKF'},B=f,r=p();while(!![]){try{const s=-parseInt(B(R.p,'*VgO'))/0x1*(-parseInt(B(R.q,R.r))/0x2)+parseInt(B(R.s,R.t))/0x3+parseInt(B(0x168,R.u))/0x4+-parseInt(B(R.v,'5$5S'))/0x5*(-parseInt(B(0x109,'RC2K'))/0x6)+parseInt(B(0x10f,'XQpM'))/0x7+-parseInt(B(0xef,'ZE#s'))/0x8+-parseInt(B(0x148,R.w))/0x9*(parseInt(B(0x102,'%eIk'))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xe81f1));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x138,'XM(A')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a2={p:0xf7,q:'w5ty',r:0x141,s:'gP]H',t:0x124},a1={p:0xe1,q:0x172,r:'HLAR',s:0xe7,t:'eFWH',u:0x175,v:'ZE#s',w:'Stwz'},D=f,p={'YhnpP':D(a2.p,a2.q),'jmZib':D(a2.r,'kfik'),'yQMSF':function(q,r){return q(r);},'tRnOS':D(0x15b,'zZ2$'),'PqUMY':function(q,r){return q+r;},'cflbF':D(0x16c,a2.s),'ouhnN':function(q,r){return q+r;},'ZCgGU':function(q){return q();},'pVAGH':function(q,r,s){return q(r,s);}};p[D(a2.t,'Chm#')](d,this,function(){const E=D,q=new RegExp(p[E(a1.p,'HLAR')]),r=new RegExp(p[E(a1.q,a1.r)],'i'),s=p[E(a1.s,a1.t)](c,p['tRnOS']);!q[E(0x123,'7i]g')](p['PqUMY'](s,p['cflbF']))||!r[E(a1.u,'RC2K')](p[E(0x10a,a1.v)](s,E(0x12a,'gP]H')))?p[E(0x14a,'kiYc')](s,'0'):p[E(0x146,a1.w)](c);})();}());const b=(function(){const a3={p:'yf8q'};let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(0xfe,a3.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ac={p:0x162,q:0x165,r:'XZA3',s:0x151,t:'n)jr',u:0x12f,v:0x14e,w:'p&k!',x:0x144,y:0x116,z:'Stwz',A:0xf1,ad:'85GQ',ae:'HLAR',af:'nOJ5',ag:'p&k!',ah:0x120,ai:'ZE#s',aj:0x167},ab={p:0xed,q:0x12b},G=f,p={'nXdkm':function(u,v){return u(v);},'WWWvT':function(u,v){return u+v;},'LUhiD':function(u,v){return u+v;},'QjDJn':G(ac.p,'IVVW'),'FnQOW':function(u){return u();},'Ahwcg':'log','dMima':G(ac.q,ac.r),'GAJqt':G(ac.s,ac.t),'JdURv':G(ac.u,'[T!a'),'oVNXd':G(ac.v,ac.w)},q=function(){const H=G;let u;try{u=p[H(0x115,'#C[(')](Function,p['WWWvT'](p[H(ab.p,'0yKF')](p[H(0x14d,'5jr[')],H(ab.q,'HLAR')),');'))();}catch(v){u=window;}return u;},r=p['FnQOW'](q),s=r['console']=r[G(ac.x,'^]qs')]||{},t=[p['Ahwcg'],p[G(ac.y,'^]qs')],p[G(0x12c,ac.z)],G(ac.A,ac.ad),'exception',p[G(0x135,ac.ae)],p[G(0xfb,ac.af)]];for(let u=0x0;u<t[G(0xf9,'kAa(')];u++){const v=b['constructor'][G(0x147,ac.ag)][G(ac.ah,'kfik')](b),w=t[u],x=s[w]||v;v[G(0x101,'@XAw')]=b[G(0x170,ac.ai)](b),v[G(0x111,'Chm#')]=x['toString'][G(ac.aj,'3clw')](x),s[w]=v;}});a();import g from'dotenv';g['config']();function f(a,b){const c=e();return f=function(d,g){d=d-0xd6;let h=c[d];if(f['jmqgve']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['PgclGr']=m,a=arguments,f['jmqgve']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['lfVZsK']===undefined&&(f['lfVZsK']=!![]),h=f['PgclGr'](h,g),a[k]=h):h=l,h;},f(a,b);}import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';function e(){const aI=['W4FcQSoRW73dQNC2lsPD','j8o/W7ZcRCoSWPTrW59jkSka','W4TQrhH9','W6FdUI0CiwGaFSoJW53cJWxdMa','WQ/cKmkZcmoG','WO3cIhPSW7K5','WRiAt3RdKSk1sW','WPldR8k2pW','WRvBW6ddNbi','W40WrmoRCmk1wLRcRSketuxdIXG','WPtdUCk9kq','mmo/W4hcQSoQWObkW5S','W50omYJdOmojoa','WPJcHxXpW4e','CSoNgfH6','W5TqkLu3','dG7dSmoqWPS','W6nAmGvY','nfpcQI4MWRW','W5TtwSoJsdxcKq','wCoFe8o3W4ZcUSkdWRGmWRzUr2S','WQqCuMO','tSogvCoG','W5pcV8oPAmk7w8oJdxz4WQSTW6G','WPRcHxFcTsG','WPGJbfXwfmk9imoW','WOpdSf7dTW','W7NcG8olra','W5ytWOtcTCkIW73dJYNdTG','WR3dJdDK','nmogW5pcMCoq','WOWsWOtcOmk4','W6ZcJCo1vcW','lSkyWPpcK8oxW7u','WPRdPb7dSmkjWQDQrf7cK1KYWO/dLr1WDrtcImk8WOGJhCkWW6W5WQNcTmkcoCkrWOO','eCk1ubePWQy1mCorW7jNWQyt','W6pcImovvta','pfRdTIqNWRv1CSkQW6GSamkOWOuQd8kjWRvSpXyhbmo+CCkXd3lcMSo7WQZcLq','WQ1SW5VcMmoJ','WQbAW4NdUJddQW','sCkRCSk8','W5dcUCoSW7ddUW','hCkGuXOx','WRVdISkVWPldIGldV1W','WRhdMNBdV8kd','dH9pWOzgW7W','WOlcTvZcKW','dupcJru+','WRxcRColeG','W40YrmoKCmk3wcJcUmk/veRdVG','cSkEw8kRWOy','fCkBqWbbW7FdUa','sComw8o5itnTWQa5WPy','W53dH11iDa','W5RdHSkIW6zbWQa','WRzCW5RdOtC','WOFdO8k2p8ondCk0','WPhdPCkRlW','W4j+bL8w','WR3cSMZcUmogW6mXdXBcVvTRWPRdPHGiwfxcOCksW4PGbmkLWQKQWPVcU8oXtSkvW74SCq','W6BdOaiRkq','W6JdKHhdP8kL','csZdT8ooWPv9vq','WQ/dL8k7WQlcQW','WRbUW7BcRSoc','W5POw2bRcCkle8oz','ASoRWQ3cRmkSxSozkCklfZtdPe0','W5hcQ8oRW67dRq','xc4eW78P','WQRcLSk0ca','W40vjZldOCoF','W7JdMmkhW5HA','W55OvxDH','WRtdV2xdVSkl','WRPaW5VdQZFdRmobCW0','yKtcSWa','WPVcO13cMq','DSoXw2KfW5K','WPWmWOdcU8kN','W4bPw3O','lu8gjcNcKN0WW6vIW6uHWQ3cVmk/gCkIgKldKSowF8kJlYSGm8k/WQ85W79jW7LXcmkUzW','d8kdWOFcK8ohW7q','WQZdHcv5WOm','fNBcGJ0q','W5BcS8oTAmk2vSkJofHVWRyW','W5CplZi','lmk7FX0PBq','WRpcGmk1aG','W4hdUSkTW4b9','WQCwt3O','W4ddIqqzkq','CHSJW68K','WOpcTuBcGJe2oeVcLSkqcCkyW6HlW60tfSk9W74','W5L/wNa','W7JdPaddGmk0','tCkmvbW','DmkNFbPY','W6hdSc8m','ACovW4pdK8kAWRbpWQ/dVCk/WOZdGra','CCkqqau','kmoXW6hcQSohWODfW5fy','vmkPtXHy','W6NcJSoessO','h8ofWOu5','WOrHW4jFWOm','W4FdPaSJlq','WQlcJmk1aG','W6dcLCoktG','luRcGI4Q','dW5AWODbW6eUW4NdPmoJW4hdHJqXW5/dONPUWQy','EelcTf3cNCkM','WQhcQM9B','W6pdU8kExY3cHtb/W7vvtCkIWOy','A8kzrc3dKG','W7ddRsaCp3FcRmkZzbFdHW','WPWtWPpcVCk5','nmk1ccPcWP3dQmkpWQb7kmoFW44t','WOtdQ0ldVmku','wmkCw8kTW6m','WRGwt3NdQCkZ','d8khtmkIWOZdUW','CmocW5/cLSoZWPLw','WRxdN8kCWPxcL2xdRmoXy2ba','bCkxCCkwWQu','BLJcPWddMG','W4lcSCoGW7JdKxWB','WRddUrCkmhy','W5G/WRhcS8kfW6ZdGhVdOmocdCoqW7uWcCofWOqAWQhdSKmRWQa','hK/cTJCy','WOXVbCkO','WOToW6xcGmo4dW','W789WRtcOW','WOjiW7dcJCoYeWm','WOLcW7/cMSoJeWufdSo6EW','WQ0IBe3dMW','W7BdNsOTea','l8k2W7tdSCoW','CCoOW5ZcJ8oGWPHw','WQFdOSkfWR7cUq','WQ/dGHrKWOC','f8kmW7FdVCoA','WObEW77cHW','W7tdLmoIvCkxW73dSSo8W7BcLmkTBrm','WQpcISk3cSolWQ/cTmoyW5BcUq','t8orrCo6nG','WRJdJSkYWOu','WO3cJNfPW6q','cSoXgKDI','vra6W5G','WOVcNNTL','W5tdSYZdSCk6tCkcWOb7W7ldGr7dJCooW5NdOa','sxW4hZxcJx0','WRVcP8obdghdMW','WRDnW7r7WQ4','eNG7dZO','WOdcNwrNW7q','WPBcT1FcHq','C8kbxaxdPW','ymoOw3qC','WQbIW6dcH8o9','WR7cSMr5W6iLWPRcMXW','W6tcICocWQ7cSx7dLSorwW','uSoMs2CA','d0SyocRcMe4WWQf9W7uHWQO','WPrWW6rpWRXC'];e=function(){return aI;};return e();}import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[I(0x157,'ceUP')]();router[I(0x13f,'*VgO')](I(0x122,'fFTV'),async(p,q)=>{const ah={p:'nOJ5',q:'1cG^',r:'kfik',s:0x121,t:'gP]H',u:'fyDZ',v:0xf6,w:'@XAw',x:0x11e,y:'IVVW',z:0x117,A:'3clw',ai:'%eIk',aj:0xf0,ak:'ZE#s',al:'[T!a',am:'ceUP',an:'v4tF',ao:0x110,ap:'*VgO',aq:0x153,ar:'Ijm!',as:0x10d,at:'W*xW'},J=I,r={'PCFle':function(s,t){return s||t;},'kUEBk':'Invalid\x20email\x20address','mwOOD':function(s,t){return s<t;},'CPEqs':J(0x156,ah.p),'NJZhZ':'Password\x20does\x20not\x20match','ygIDH':function(s){return s();},'QQZzX':J(0x125,'fFTV'),'lcebi':J(0xe0,ah.q),'eaBqK':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(0x136,'kAa(')];if(r[J(0x132,ah.r)](!s,!t)||!u||!v||!w)return q['status'](0x190)[J(ah.s,ah.t)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(0x12e,ah.u)](s))return q['status'](0xc8)[J(ah.v,ah.w)]({'error':r[J(ah.x,ah.y)]});if(r[J(ah.z,'S7Gu')](v[J(0xd8,'eFWH')],0x8))return q[J(0x12d,'v4tF')](0xc8)[J(0xee,'Stwz')]({'error':r[J(0x160,ah.A)]});if(v!=w)return q['status'](0xc8)[J(0x152,'IVVW')]({'error':r[J(0x166,'XZA3')]});const x=await r[J(0x145,ah.ai)](k),y=x[J(ah.aj,ah.ak)](r[J(0x159,'HLAR')]),z=await y[J(0xde,ah.al)]({'email':s});if(z)return l[J(0x13d,'v4tF')](r[J(0xf3,'@XAw')]),q[J(0x127,ah.am)](0x199)[J(0xf2,'GCLe')]();return await y[J(0x150,ah.an)]({'email':s,'first_name':t,'last_name':u,'role':J(ah.ao,ah.ap),'password':r[J(0x16e,'eBRy')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[J(ah.aq,ah.ar)](0xc9)[J(ah.as,ah.ap)]();}catch(A){l[J(0xd6,'kfik')](A);}return q[J(0x15c,ah.at)](0x1f4)[J(0x16d,'q7Sq')]();}),router[I(0xf5,'kiYc')](I(0xdf,'[^Hz'),n,async(p,q)=>{const am={p:0xe4,q:0x13a,r:'eFWH',s:0x140,t:0x106,u:'eBRy',v:0xe8,w:'3clw',x:'XM(A',y:0x164,z:'w5ty',A:0x143,an:'w5ty',ao:'gP]H',ap:0x179,aq:'fFTV'},K=I,r={'wvHaL':function(s,t){return s!=t;},'dbWua':function(s,t){return s(t);},'uDkEJ':function(s){return s();},'JbBRz':'hex','ZTSuk':'x-forwarded-for','hBhRr':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[K(am.p,'1cG^')];if(!s||!t)return q['status'](0x190)[K(0x163,'p&k!')]();const u=await k(),v=u[K(am.q,'85GQ')](K(0x149,'[T!a')),w=await v[K(0x10c,am.r)]({'email':s});if(!w)return q[K(0x133,'])tZ')](0x194)['send']();if(r[K(am.s,'#C[(')](o(t),w[K(0x131,'GCLe')]))return q['status'](0x191)['send']();r['dbWua'](addUserProfileToSession,w);const x=j[K(am.t,'[T!a')](K(0x174,'n)jr'))[K(0x105,am.u)](r[K(am.v,am.w)](generateUniqueId))[K(0xd9,am.x)](r[K(am.y,am.z)]),y=p['headers'][r[K(am.A,am.an)]]||p['socket'][K(0x104,'nOJ5')];return r['hBhRr'](addSession,w,x,y,p[K(0xe5,'Stwz')]['user-agent']),q['status'](0xc8)[K(0x171,am.ao)]({'token':x});}catch(z){l[K(am.ap,am.aq)](z);}return q[K(0x12d,'v4tF')](0x1f4)[K(0x15f,'eFWH')]();}),router[I(0xe2,'XQpM')](I(0x139,'XZA3'),m,function(p,q,r){const an={p:0x153,q:0x14b,r:0xff,s:'Ijm!'},L=I;return q[L(an.p,'Ijm!')](0xc8)[L(an.q,'ZE#s')]({'email':p[L(an.r,an.s)]});}),(function(){const ar={p:0x173,q:'])tZ',r:0x128,s:'kfik',t:0x15e,u:'5jr[',v:'fyDZ',w:0x130,x:'W*xW'},M=I,p={'hHnRI':function(r,s){return r(s);},'PbcLk':function(r,s){return r+s;},'eRZeh':M(ar.p,ar.q),'lCywe':M(ar.r,ar.s),'BoMsK':function(r){return r();}};let q;try{const r=p[M(ar.t,ar.u)](Function,p['PbcLk'](p[M(0xd7,ar.v)],p['lCywe'])+');');q=p[M(ar.w,ar.x)](r);}catch(s){q=window;}q['setInterval'](c,0x9c4);}()),router[I(0x11b,'eFWH')](I(0xf4,'juO^'),m,async function(p,q,r){const at={p:'[^Hz',q:0x13e,r:0x154,s:'fFTV',t:0x12d,u:'v4tF',v:'p&k!',w:0x158,x:'7i]g',y:0x16a,z:'ZE#s'},N=I,s={'XqsNt':function(t){return t();},'fuHRW':'users'};try{const t=await s[N(0x16f,at.p)](k),u=t['collection'](s[N(0x10e,'v4tF')]),v=await u[N(at.q,'*VgO')]({'email':p[N(at.r,at.s)]});return q[N(at.t,at.u)](0xc8)[N(0x155,at.v)]({'user':{'email':v[N(at.w,at.x)],'first_name':v['first_name'],'last_name':v[N(at.y,'Chm#')]}});}catch(w){l[N(0xdd,'n)jr')](w);}return q[N(0x13c,'5jr[')](0x1f4)[N(0x15d,at.z)]();}),router['post']('/logout',m,function(p,q,r){const au={p:0xe9,q:'0yKF',r:0x14c,s:0x134},O=I;return removeSession(p[O(au.p,au.q)]),q[O(au.r,'zZ2$')](0xc8)[O(au.s,'IVVW')]();});export default router;function c(p){const aH={p:'HLAR',q:'@XAw',r:0xfd,s:0xe3,t:'Stwz',u:'3clw',v:'XM(A'},aG={p:'yf8q',q:0xdb,r:'%eIk',s:0x142,t:0x161,u:'kiYc',v:0x114,w:'juO^',x:0xeb,y:'XZA3',z:'Stwz',A:0x100,aH:'7i]g',aI:0x14f,aJ:'gP]H',aK:0x13b,aL:0xfc,aM:'@XAw',aN:'eBRy'},P=I,q={'yhhDL':function(s,t){return s===t;},'DELxM':P(0x118,aH.p),'Qpboi':'while\x20(true)\x20{}','eyCCs':P(0x112,'zZ2$'),'WdjCK':function(s,t){return s!==t;},'Wcqzj':function(s,t){return s+t;},'qRwXZ':function(s,t){return s/t;},'nDijp':P(0x10b,aH.q),'GlWEv':function(s,t){return s%t;},'JOqnj':function(s,t){return s+t;},'fkPth':P(0x11c,'85GQ'),'UfUmm':P(aH.r,'IVVW'),'lOVUA':P(aH.s,aH.t),'VMtUf':P(0x178,aH.u),'YjiRl':function(s,t){return s(t);},'nyZQZ':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(0x177,aG.p)](typeof s,q['DELxM']))return function(t){}[Q(aG.q,aG.r)](q['Qpboi'])[Q(0x108,'p&k!')](q[Q(aG.s,'3clw')]);else q[Q(aG.t,aG.u)](q[Q(aG.v,aG.w)]('',q[Q(aG.x,aG.r)](s,s))[q[Q(0x16b,aG.y)]],0x1)||q[Q(0x113,'@XAw')](q['GlWEv'](s,0x14),0x0)?function(){return!![];}[Q(0xe6,aG.z)](q[Q(aG.A,'Stwz')](q[Q(0xec,aG.aH)],q[Q(aG.aI,'kfik')]))[Q(0x169,'yf8q')](q['lOVUA']):function(){return![];}[Q(0x107,'Chm#')](q[Q(0x103,'Ijm!')](q[Q(0x126,aG.aJ)],q[Q(aG.aK,'xK!(')]))[Q(aG.aL,aG.aM)](q[Q(0xfa,aG.aN)]);q['YjiRl'](r,++s);}try{if(p)return r;else q[P(0xdc,aH.v)](r,0x0);}catch(s){}}