import{r as e,R as s,j as t}from"./B29SdWEC.js";import{H as a}from"./CIAn0bGm.js";import{R as r}from"./Cri8ushB.js";import{b as l,d as i}from"./Ch0NCz77.js";import{k as n}from"./BFKNndIN.js";import{c as o,a as c,b as p,T as d,Q as m,R as u,ak as j,al as x,am as h,an as f,ao as g,ap as b,U as w,i as y,d as v}from"./CMmVygpm.js";import"./ucIcx5RQ.js";import"./E8MUDNEF.js";import"./BPg_iBjA.js";import"./Dcib5x9m.js";import"./07vdr7AR.js";import"./4RmQ9_ev.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./BmTZu7tj.js";import"./CxXfFpkk.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./B1ETHe3Q.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./CLdVYh6z.js";import"./DPAjA2jz.js";import"./6cdfdvti.js";import"./OBe_9qlD.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const N=()=>{const{id:N}=n(),[S,k]=e.useState(!0),{addToast:D}=l(),C=s.useRef(),[O,R]=e.useState(null),[T,U]=e.useState(null),[F,$]=e.useState(null),[z,A]=e.useState(!1);return e.useEffect((()=>{(async()=>{axios.get(`/documents/${N}`).then((e=>R(e.data.documents))).finally((()=>k(!1)))})()}),[]),S?t.jsx("div",{className:"loading-overlay",children:t.jsx(o,{color:"primary",variant:"grow"})}):O?t.jsxs(t.Fragment,{children:[t.jsx(a,{children:t.jsxs("title",{children:[N," - Documents | Axleshift"]})}),t.jsxs(d,{onSubmit:async e=>{e.preventDefault();const s=await C.current.executeAsync();k(!0);const t=new FormData;t.append("exportLicense",T),t.append("certificateOfOrigin",F),t.append("recaptcha_ref",s),axios.post(`/documents/${N}/upload`,t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{D("Documents uploaded successfully!","success")})).catch((e=>{var s,t;const a=(null==(t=null==(s=e.response)?void 0:s.data)?void 0:t.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);D(a,"danger")})).finally((()=>k(!1)))},children:[t.jsx("h2",{children:"Upload Documents"}),t.jsx("span",{className:"text-muted",children:N}),t.jsx(m,{className:"mt-2 mb-3",children:t.jsxs(u,{children:[t.jsxs(j,{stripedColumns:!0,hover:!0,responsive:!0,className:"table-even-width",children:[t.jsx(x,{children:t.jsxs(h,{children:[t.jsx(f,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Document Name"}),t.jsx(f,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Type"}),t.jsx(f,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),t.jsx(f,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Upload"}),t.jsx(f,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap"})]})}),t.jsx(g,{children:O.map(((e,s)=>t.jsxs(h,{children:[t.jsx(b,{children:e.name}),t.jsx(b,{children:e.type}),t.jsx(b,{className:"text-capitalize",children:t.jsx("span",{className:"badge bg-"+("approved"===e.status?"success":"rejected"===e.status?"danger":"warning"),children:e.status})}),t.jsx(b,{children:e.file.file&&"rejected"!==e.status?e.file.file:t.jsxs(t.Fragment,{children:[t.jsx(w,{type:"file",onChange:e=>((e,s)=>{const t=e.target.files[0];if(t){const e=[...O];e[s]={...e[s],status:"Under Review"},R(e),0===s&&U(t),1===s&&$(t)}})(e,s)}),t.jsx("span",{className:"text-danger text-decoration-line-through",children:e.file.file})]})}),e.file.file&&t.jsx(f,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:t.jsx(y,{className:"btn btn-primary",onClick:s=>{return t=N,a=e.file.file,alert(JSON.stringify(a)),void axios.post(`/documents/file/${t}`,{file:a}).then((e=>{if(e.data.error)return D(e.data.error);const s=e.data.url;alert(s)})).catch((e=>{var s,t;const a=(null==(t=null==(s=e.response)?void 0:s.data)?void 0:t.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);D(a)}));var t,a},children:"View"})})]},s)))})]}),t.jsx("span",{className:"d-block mb-2 small",children:"Please ensure that the documents you upload are authentic and not counterfeit. Uploading fraudulent documents may result in legal consequences."}),t.jsx(y,{color:"primary",type:"submit",children:"Submit Documents"}),t.jsx(r,{ref:C,size:"invisible",sitekey:i})]})})]}),t.jsx(v,{alignment:"center",scrollable:!0,visible:z,onClose:()=>A(!1),"aria-labelledby":"M"})]}):t.jsx(c,{className:"justify-content-center my-5",children:t.jsx(p,{md:6,children:t.jsxs("div",{className:"clearfix",children:[t.jsx("h1",{className:"float-start display-3 me-4 text-danger",children:"OOPS"}),t.jsx("h4",{children:"There was no shipment documents found."}),t.jsx("p",{children:"Double check tracking number for any mistake."})]})})})};export{N as default};
