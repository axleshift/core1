(function(j,k){const F={j:0x148,k:0xe0,l:'4Rt8',m:'hJ[2',n:0x14e,o:'$OdV',p:0x12a,q:0x11f,r:'VP16',G:0xf4,H:0x129,I:'n$]P'},s=f,l=j();while(!![]){try{const m=-parseInt(s(0x147,'s&@w'))/0x1+-parseInt(s(F.j,'s&@w'))/0x2*(parseInt(s(F.k,F.l))/0x3)+parseInt(s(0xfb,F.m))/0x4*(-parseInt(s(F.n,'Y60%'))/0x5)+-parseInt(s(0x14f,F.o))/0x6*(parseInt(s(0x10a,'[Zov'))/0x7)+-parseInt(s(F.p,'t0!g'))/0x8*(-parseInt(s(F.q,F.r))/0x9)+-parseInt(s(F.G,'sRfL'))/0xa*(-parseInt(s(F.H,'FJa8'))/0xb)+parseInt(s(0x108,F.I))/0xc;if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0xc2cd0));const d=(function(){let j=!![];return function(k,l){const m=j?function(){if(l){const n=l['apply'](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const P={j:0x143,k:'kBwP',l:0xff,m:'PSxv',n:0x11b,o:'3pEs',p:'UV#G',q:0x109,r:'t0!g',Q:0x138},O={j:0x117,k:'hJ[2',l:0x131,m:0xe5,n:'$OdV',o:0x146,p:0xec},t=f,j={'EAKdY':t(P.j,P.k),'Ntkjo':t(P.l,P.m),'kiCzn':function(k,l){return k(l);},'FaQKw':t(P.n,P.o),'hZRxp':function(k,l){return k+l;},'cybfZ':t(0x139,P.p),'lHOBb':t(P.q,P.r),'sRRUB':function(k){return k();},'rFLpu':function(k,l,m){return k(l,m);}};j[t(P.Q,P.p)](d,this,function(){const u=t,k=new RegExp(j[u(0xe1,'YXao')]),l=new RegExp(j[u(O.j,O.k)],'i'),m=j[u(O.l,'s&@w')](c,j[u(O.m,O.n)]);!k['test'](j[u(0xf3,'cK&D')](m,j[u(O.o,'(4Tx')]))||!l['test'](j[u(O.p,'HSc2')](m,j['lHOBb']))?j[u(0x150,'3pEs')](m,'0'):j['sRRUB'](c);})();}());const b=(function(){let j=!![];return function(k,l){const m=j?function(){const v=f;if(l){const n=l[v(0x124,'Hpx8')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const Y={j:'q9&u',k:0x11e,l:'$OdV',m:0x112,n:'(4Tx',o:0xea,p:'(Z*z',q:'gWXH',r:'Y60%',Z:0x10e,a0:0x101,a1:0x11d,a2:'YtqN',a3:0x114,a4:0x141,a5:0x119,a6:'35UD',a7:'t0!g',a8:0xef,a9:'(KFf',aa:0x10b,ab:'^hY0'},X={j:0xdf,k:'hJ[2',l:0x12f},w=f,j={'NxmFv':function(o,p){return o+p;},'GripD':w(0x144,'3pEs'),'CAnfR':function(o){return o();},'ShMAj':w(0xf8,Y.j),'ViHhK':w(Y.k,Y.l),'ddmzP':w(Y.m,Y.n),'hZjiN':w(Y.o,Y.p),'WjnmQ':w(0x145,Y.q),'jieCA':function(o,p){return o<p;}},k=function(){const x=w;let o;try{o=Function(j[x(X.j,X.k)](j[x(0x12e,'F6hf')],x(X.l,'UV#G'))+');')();}catch(p){o=window;}return o;},l=j[w(0xeb,Y.r)](k),m=l[w(Y.Z,'[rF3')]=l['console']||{},n=[j[w(Y.a0,'FJa8')],j[w(Y.a1,'kBwP')],j[w(0xf6,Y.a2)],j[w(Y.a3,'sRfL')],w(0xee,'^hY0'),w(Y.a4,'gWXH'),j[w(Y.a5,Y.a6)]];for(let o=0x0;j[w(0xde,Y.a7)](o,n[w(Y.a8,Y.a9)]);o++){const p=b['constructor'][w(0x130,'hJ[2')]['bind'](b),q=n[o],r=m[q]||p;p[w(0x103,Y.q)]=b[w(Y.aa,'t0!g')](b),p[w(0x115,Y.ab)]=r[w(0xfe,'XJ2e')]['bind'](r),m[q]=p;}});a();import g from'fs';import{ObjectId}from'mongodb';import h from'../models/db.js';import i from'../src/logger.js';export const addSession=async(j,k,l,m)=>{const a0={j:0xfd,k:'gWXH',l:0xfa,m:'YXao',n:0xf1,o:'VP16'},y=f,n={'qjjqQ':function(o){return o();},'bFtqB':y(0x136,'gWXH')};try{const o=await n[y(a0.j,a0.k)](h),p=o['collection'](n[y(a0.l,a0.m)]);await p[y(0x111,'DkAw')]({'user_id':j[y(a0.n,a0.o)],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date['now']()});}catch(q){i['error'](q);}};export const getUser=async j=>{const a2={j:'ZZJ^',k:'$OdV',l:'kBwP',m:'YMDe',n:0xfc,o:'PSxv'},z=f,k={'arVWF':function(l){return l();}};try{const l=await k[z(0x128,a2.j)](h),m=l[z(0x118,a2.k)](z(0x149,a2.l)),n=await m['findOne']({'token':j});if(!n)return null;const o=l['collection']('users'),p=await o['findOne']({'_id':n[z(0xf2,a2.m)]});return{'_id':p[z(a2.n,a2.o)],'email':p['email'],'first_name':p['first_name'],'last_name':p[z(0xf7,'VB#)')],'role':p['role']};}catch(q){i['error'](q);}return null;};export const removeSession=async j=>{const a4={j:0x11c,k:'RP*s',l:'VB#)'},A=f,k={'fwmCL':function(l){return l();},'cUnVB':A(a4.j,'Hpx8')};try{const l=await k[A(0x123,a4.k)](h),m=l[A(0x118,'$OdV')](k[A(0x13f,a4.l)]);await m[A(0xe6,'HSc2')]({'token':j},{'$set':{'active':![],'last_accessed':Date[A(0x13c,'kBwP')]()}});}catch(n){i['error'](n);}};export const isActiveToken=async j=>{const a6={j:0x134,k:0x116,l:0x10f,m:'hJ[2',n:'sRfL',o:0x13e,p:0x106,q:'kBwP'},B=f,k={'EmLsU':function(l){return l();},'JoNuh':B(a6.j,'UV#G')};try{const l=await k[B(a6.k,'s&@w')](h),m=l[B(a6.l,a6.m)](k[B(0x14d,'VB#)')]),n=await m[B(0xe2,a6.n)]({'token':j});return n[B(a6.o,'4Rt8')];}catch(o){i[B(a6.p,a6.q)](o);}return![];};function e(){const an=['psaCW5CT','cmoPFmoGb8kIywZcHCkU','lWJdKSoeWRK','sfhdUg3dOvNcS8oQoCoaWRRcQ34','WQ7dUfxdQq','rCkZWP7dLSkxttRcKa','dSo8ESowAa','hmoNySoI','r3xcOmkKgmowW7iwW77cP8oD','w3hcOmkQW6SuvwtcOYy','WQBdTuJdThzI','W5ejW4BcGdS','W7O0W7WAWRa','v8kMWP3dICkh','WQG3pmk9','FCkSW7mGsNyV','eduBW5e','W63cLY86ua','W7BcVxNcPajJuCkiW57cUgNdLG','ESoKWO99ywK9zKNcPG','x2nkWPpcGW','oCoLqSoswG','q8k6ySo2W5G','WOemW7HTCa','W6qyWOlcQX8qoCoTfWhdSItdMCoyWOCMC8kbnCooWRJdRc7dOSo8uLNcRt3cI8kGDa','aYyyW4KTWRScWPFcPq','AJ9JWR7cIG','W5fgihRcLq','chSBoCoV','W6WaW5/cUXKrjmoQ','cGFdImoCWPRdINldKq7dHdC4id1IW43dVYFdLG','lCobECkCW43cKMFdPq','jCoTWQJcIfuyhfSBA2i','W60JW6dcUau','W7WnW43cOr4','W5lcQmohvsDjWOSgW4SOsa','W4/dOmkIW5O','nSo6rq','lSo+W5ddUH5IgCkvW7a','WRXFW59TWPRdNG','kWPeWQb6','W4a4W51bkSocj8o0kapcMq','kSofAmkdW4e','FSkcrCo6W7W','pSoGxmoDv8o8WQjCWOz/CvzJWOZdJZe','WRxdS0JdQgTIAYreWOSnquvgW67cNmk2WOfJ','kSowA8kmW4e','k2O7WPHP','mgyuW7tdLN9ChqldVW7cGmol','m2muWQZcSHy+aZC','k8oWqConsSo6WQnb','actcIblcUa','qwfdW5uuWP4HWQRcGq','WQldOstdTKi6','aJbKWOnq','W5VcO8o6A8k7aSoR','xCo+vmoPkmkuCa','WQZdV3/dP3C','W5RcSmkDFYztWP0aW488r1jUh2HArSoVumkQdaxcOmo9W4xdNHhdU8kqCvOg','W6VcGHWF','W6xcHGWvrW','iCk9W5igqq','psWAW7S0','W64jWP0ZW5RdVxpdHCkmW73dHa','oZRcR8k9W7u','WQKpBv3cOSobWQm','W5VcOmoNsc8','lWNdMSonya','lCoNqCohfq','eYiKWRPTqwiIgG','WPtcT8oxDIjLWPK','W61/cfTO','WRewW7HXuCoDc1e6pSodsCkFymoK','WRFcUdKjWQO','WQ3cMmoWz8kc','dGGsWQnP','W5ZdRmkSmmoOA8kVWOq9W7dcVmkrWPG','o8kzW5T1o0P2v8kO','WQm1n8kOa8oA','o2CRWPDDoW','ksVdSa','W5tcVSowBHzuWOO','W6CdW7ZdGuq','W75vm07cICoaWQrhW4K','W5lcUCosAcXYWOWEW5GQua','FSkoEmojW44','jd5zWOjNtmkgW5bc','WQCSWQi','AWKpySkf','hd3cKmkOW64','qwraWO56W79dWPxcI8kzW7tdJCkH','qmkKWOq','l8ooymkEW7u','nKKGsCkMxhlcNq','q8oMWRZcPLONu8oaWQVcNfFdRs7dH8obfhFcTxNcOmk2WOPkuLKAWPBdLZVcPCkivIldQW','qmkPW4JdJZK','WP3dRaFdKfW','b8oOx8oA','aCo7ESkDW4VcIwBdICk4','WPxcOXOJWOW','WP/cOHWmWPC','pCoNqmoruq','W6tcVwxcTSkaowJcIvusWP0','WRBdJmk1WQpcTCkCW5pdS8k6CHddT8k/W70','iSk6W4CWDa','WRxdPZNdTmomEI7cH047WONdLmot','kCk9W5KH','ndZcNrKZfXJdImk/WQddJSoV','amoIu8oCkq40d8k5WR/dRq','W5DKnvHvWQrU','edSBW5eNWQWpWO7cR8kB','W5vKpufo','qwZcGvLcWPpcTSk3WRK','ix0/WPe','W7GCW5ZcHHG','WQC8AvdcOW','kSkoW6TKovDXxW','rdTSWRFcSq'];e=function(){return an;};return e();}function f(a,b){const c=e();return f=function(d,g){d=d-0xdd;let h=c[d];if(f['MdvpXE']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['dNMAMb']=m,a=arguments,f['MdvpXE']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['EJIMrA']===undefined&&(f['EJIMrA']=!![]),h=f['dNMAMb'](h,g),a[k]=h):h=l,h;},f(a,b);}function c(j){const aj={j:0xf0,k:'(4Tx',l:0xe9,m:0x14c,n:0x152,o:'ZZJ^',p:0x121,q:'3pEs',r:0xf5,ak:'YMDe'},ai={j:0xe8,k:'[rF3',l:0xf9,m:0x140,n:0x104,o:'(Z*z',p:0x105,q:'VP16',r:'[rF3',aj:0x102,ak:'O^CN',al:'hJ[2',am:0x100,an:'LpMc',ao:'9Q]B',ap:'YtqN',aq:0x125,ar:0x133,as:'6ozw'},C=f,k={'YtSpR':function(m,n){return m===n;},'ONGYC':C(aj.j,aj.k),'GiQET':C(aj.l,'F6hf'),'MhWjO':function(m,n){return m!==n;},'zmTTf':function(m,n){return m+n;},'SuYZI':function(m,n){return m/n;},'YKNQO':C(aj.m,'FJa8'),'aofjt':function(m,n){return m===n;},'quXxZ':function(m,n){return m%n;},'NljHK':function(m,n){return m+n;},'kXhSS':C(aj.n,aj.o),'VqVpZ':C(aj.p,aj.q),'YPwEF':C(0x13b,')k(q'),'dhPIb':C(aj.r,aj.ak),'icuxQ':function(m,n){return m(n);}};function l(m){const D=C;if(k[D(ai.j,ai.k)](typeof m,k[D(ai.l,'kGRo')]))return function(n){}[D(ai.m,'rX%$')](k[D(ai.n,ai.o)])[D(0x12c,'kBwP')]('counter');else k[D(ai.p,'(Z*z')](k[D(0xe3,'YMDe')]('',k['SuYZI'](m,m))[k[D(0xe4,ai.q)]],0x1)||k[D(0x110,ai.r)](k['quXxZ'](m,0x14),0x0)?function(){return!![];}[D(0x107,'[Zov')](k[D(0x122,'UV#G')](D(ai.aj,'LpMc'),k[D(0x132,ai.ak)]))[D(0x127,ai.al)](k[D(ai.am,'(au*')]):function(){return![];}[D(0x10d,ai.an)](k[D(0x12b,ai.ao)](k[D(0x12d,ai.ap)],D(ai.aq,'(KFf')))[D(ai.ar,ai.as)](k[D(0x142,'YtqN')]);k[D(0xdd,'ZZJ^')](l,++m);}try{if(j)return l;else l(0x0);}catch(m){}}(function(){const am={j:0x135,k:0x113,l:0x14a,m:'h[0)',n:0x151,o:0x13a,p:'YMDe'},E=f,j={'gypNh':function(l,m){return l+m;},'zEGLa':E(am.j,'35UD'),'xjFSR':function(l){return l();}};let k;try{const l=Function(j[E(am.k,'UV#G')](j['gypNh'](j[E(am.l,am.m)],E(am.n,'YMDe')),');'));k=j['xjFSR'](l);}catch(m){k=window;}k[E(am.o,am.p)](c,0x9c4);}());