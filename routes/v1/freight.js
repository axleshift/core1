const G=f;(function(m,n){const O={m:0x1f2,n:'7pXe',o:'Mp3l',p:0x1d8,q:'ZawO',r:'b3qp',s:'D)N#',t:0x1fd,u:0x1e4,v:'@MSy'},z=f,o=m();while(!![]){try{const p=parseInt(z(O.m,O.n))/0x1*(-parseInt(z(0x1c4,O.o))/0x2)+-parseInt(z(O.p,'2L@s'))/0x3*(parseInt(z(0x1db,O.q))/0x4)+parseInt(z(0x236,O.r))/0x5*(-parseInt(z(0x1b6,O.s))/0x6)+-parseInt(z(O.t,'PbRc'))/0x7+parseInt(z(O.u,'(zkS'))/0x8+parseInt(z(0x246,O.v))/0x9+parseInt(z(0x258,'qhGV'))/0xa;if(p===n)break;else o['push'](o['shift']());}catch(q){o['push'](o['shift']());}}}(e,0xe124a));function f(a,b){const c=e();return f=function(d,g){d=d-0x1aa;let h=c[d];if(f['kXLGmB']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['JetdDD']=m,a=arguments,f['kXLGmB']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['RgHfeX']===undefined&&(f['RgHfeX']=!![]),h=f['JetdDD'](h,g),a[k]=h):h=l,h;},f(a,b);}const d=(function(){let m=!![];return function(n,o){const P={m:0x1ea},p=m?function(){const A=f;if(o){const q=o[A(P.m,'r)Zi')](n,arguments);return o=null,q;}}:function(){};return m=![],p;};}());(function(){const X={m:0x1e6,n:'HdGf'},W={m:'ZawO',n:0x1fa,o:'b3qp',p:0x242,q:0x1e0,r:'xCHO',s:'@MSy',t:0x233,u:'VBdB'},B=f,m={'ewgVQ':B(X.m,'1@nY'),'nbxzQ':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','Fazch':function(n,o){return n(o);},'Bmdxw':'init','batif':function(n,o){return n+o;},'vtoss':B(0x1f7,X.n),'BKYRC':function(n,o,p){return n(o,p);}};m[B(0x22d,'xCHO')](d,this,function(){const C=B,n=new RegExp(m[C(0x253,W.m)]),o=new RegExp(m[C(W.n,W.o)],'i'),p=m[C(W.p,'W5Pv')](c,m[C(0x1ca,'yu4M')]);!n[C(W.q,W.r)](p+'chain')||!o[C(0x1f5,W.s)](m['batif'](p,m[C(W.t,W.u)]))?m['Fazch'](p,'0'):c();})();}());const b=(function(){let m=!![];return function(n,o){const p=m?function(){if(o){const q=o['apply'](n,arguments);return o=null,q;}}:function(){};return m=![],p;};}());(function(){const a7={m:0x1aa,n:'xsLQ',o:'$^[(',p:0x1b3},a6={m:0x25c,n:'ie@U',o:0x1ee,p:'6IE%'},D=f,m={'PyxZS':function(p,q){return p(q);},'zLfDM':function(p,q){return p+q;},'DgOfD':function(p,q){return p+q;},'KdSkz':D(0x211,'Wfyt'),'nhcXO':D(a7.m,a7.n),'vQiwt':function(p){return p();}},n=function(){const E=D;let p;try{p=m[E(a6.m,a6.n)](Function,m[E(0x1ae,'HdGf')](m[E(0x208,'ie@U')](m[E(a6.o,a6.p)],m['nhcXO']),');'))();}catch(q){p=window;}return p;},o=m[D(0x22c,a7.o)](n);o[D(a7.p,'YDGW')](c,0x9c4);}());function e(){const aF=['DSkFW7TSpG','W7qljSo2f8oE','cSkdWQbcyfW','hq9G','WO1VWOxcL8kg','xmkZW4D1','WRvAyCkKtmkyW5BcLa7dMdFcLx7cNW','WRekWRXBWOi','fXfCgSoK','W53cImooWONdGa','uCk2W71I','FhrKWQ9SDmoAW5ldSCodWRi','q8o0xI/dVG','WP3cUNb4','W7PDa8o8W63cTCkCWOdcMZRcVa','WOFcR3fVjW','WRNcIxhdNmkZ','vCoWDJtdR8kdWR8ifda','vqOCg8kCB3ZdH8kTkWdcJW','W7vFFYxcH8oa','WQGacCoeW5pcV8kRWQa','W7ZdPmkGW6G','WQ1LWOasyCkeot/cVLJdSey','gcVcRSkRaa','A8kGW51F','WPvHWOdcLG','whzGWOL0','W7bIEcJcMq','W73cTqVdG3NdOqXgva','c1TjAmoe','gY1ZwaK','e8kexCoU','WRmvW4BdKWu','WOaQWOPz','W65tW7/cPCkaqmkOsSooWQSKW7lcQa','WRdcHX3dNCkM','W4eNWRFcLq','WPtcO315jebFtSkS','WROnWRpdV8oepmoWqSoCWO8VW4xcSmoO','vCkiW7Wm','c8ofn8kKrG','aSkowa','hmkhBSkiha','W4fAWOFcThi0WQlcVCkWAa','ydH+uG','jmosmCkoWOa','gLavWRVcSHy','u8oOFq7dMW','W5BdNmoQwW','W5aJW4r9aa','WQ7cHg5Uo0bzFSkD','kdbVbCot','W4S3W5ZdISoBDgqsvHtcLCo5wqa','W5D4W5afW5BdLeL+WRrZWP4AEq','W49KDSkVW47cQa','DmkSW55ska','WPSAW7xdNYW','WPi9WOTkWRRdKCoez8kD','ks1RvWq','WRzXar/dTG','W4nwWP/cSxG5','i0xcLN5uirGZWQW','W4DToCk4W5tcTsxcKXH6ualdL8odpLpdMmkjWQL9WR7cKbpdT2FcJd/cMZtdHSkfnG','W6VcUSoNWR4','WR46WOzJWQBcOCo6WRLAWRzOna','jJvel8k0','ou5hzSoQ','WRvXfHNdOXbp','lILNxW','W7/cOHddGMtdU1uEv24uWPj9WPRcM8k4WQH6bG','W7VdRSkLW6NcMG','W7CpimoEfmozWOVdLbxdLY4','taldK8kFhbT1jWXQ','hSkmASkwha','W6iXfZVdJGb5W6i','W4FdNSoTtW','WRhcTWZcPmoKW4r4','cL14ECo8','amkYFmo2bW','Be9VWQH5','kxfota','WPdcQ25Wlq','yI1Pt8oQ','kCoZW4nlpGm/WQe','acLh','ESkSW51F','hMz9BNqp','W55lvdvEzCk3W4BcOSo3xG','WPj8W6pdLmoMjCo4pbdcMvmh','gCoKoCkKra','wCk1W4v9W6FdVmoGsCodrq','oetcIx4','WO0Hj8oTWONdOMddLXL5uc/dSCol','WOHEkW9EW4/dTq','mW1JimkB','W69YsdpcGa','W6jnxG','W5ldHcLhdmk5','W5aTWR3cIa','ctBcJ8kWadVcPW8','dHvqn8oM','W6veCclcNCoFWPi','ASkBW6jcW5O','WRZcTf/dLCkQ','WO/cKGJdRmkf','outcL28','WRhcUq7cUW','adbfaCoP','W50vF18nWPddImovW6dcHrOs','W6n5CW','lSkcxq','b8kPAIJdQmkXWRKN','fdFcV8kObZBcRbS','C35KWRTSBG','W6G+W5TpnW','W7v7W5yNW6VdOG','W6VcPSoKWQ8','c8ofhCkZwSkwW4a','WPxcVtxcR8ot','ov/cHg9tjG','WRC+WODLWQZcQmkdW6HKWQnjod3cUq','W7pdTSokFI4','k8oqnCkjWRT7WRe9W5VcH8kLf8ooavbP','W6RcUSkBE8kcbq','W5v+WQDHWORdTSoiCW','WPCOWPTF','WOy9WP9hWRC','W4FdLYLjeW','uSkYW6fNiSoO','lu9rASon','ACk3W4bTnq','W63cOCk7FCkff8oW','qIH1FG','W7voCdu','WQSbjCofW53cHCkQWPK','pSoroSkEWRPH','ou7cI38','WQ0hWRxdPq','lqpcV8kriW','kMXrv8ot','W5a8WRlcMmkRza','wCoYDMO','a11vuCo1','Bh5KWRG','l8omnCko','nM8Ue8kUEComW4K3ld1xh8kv','rCo6DdW','W5r0W54sW7RcG8ocw8k7W4TsaG','r8kSW5C','WR7cPf7dGq','WOHfiai','WRGgW6pdOq','WP5dpri','WRGgWQVdUmoE','xWldJmkh','WQ0kW6pdOq','WO8eW4ldOZS','bfflra','WOP0WO/cHSkDma','xaJdKCkx','xCkZW4nRmG','W6TmFHjb','rSkcW6yu','WOLHWPZcK8kfma','eJrugCoLW7C','W640W4rFk8oyCvpcV2JdVgrlWQeer8kZx8kA','u8k0W4P9W7FdU8oXuW','W7zHzSosWPz9','W4HYCCkuW78','WQddO8oHWRBcGfBdVJ0','W7CEnCoJh8oIWOZdJaBdLty','hNDYFG','BmkQW6bplJSJWOa','fCoOn8kNCa','WQOhWQJdTq','cmkkECkngZW','DcT6vmoTpW','cKSAWQNcRGi','WR3cTSo8WRtdHXJcVMJcGYVcRCotzqu','WOjamGRdJW','wX/dJSkciW','W7VcOCkEDG','vCoWDcVdVSksWR4cdZhcTa','WOrFiqG'];e=function(){return aF;};return e();}const a=b(this,function(){const aa={m:'K9hO',n:0x227,o:'b3qp',p:0x1be,q:'PbRc',r:')]M9',s:0x20d,t:'tzOS',u:0x1b8,v:'BBPu',w:0x1d1,x:'MRxi',y:'xCnV',ab:0x24e,ac:'OP4]',ad:0x249,ae:'VBdB',af:0x224,ag:0x1b9,ah:'2(D2',ai:'VBdB',aj:0x1fc,ak:'1@nY',al:'Chfl'},F=f,m={'nwyRO':function(q,r){return q(r);},'VhDTk':F(0x1b1,aa.m),'VAIUO':'{}.constructor(\x22return\x20this\x22)(\x20)','zQeOg':F(aa.n,'yu4M'),'gyvqr':F(0x209,aa.o),'oUeZv':F(aa.p,aa.q),'TLhjq':F(0x25e,'W5Pv'),'xvKVz':F(0x247,aa.r),'gbURX':function(q,r){return q<r;}};let n;try{const q=m['nwyRO'](Function,m[F(aa.s,aa.t)]+m[F(0x1e5,'Chfl')]+');');n=q();}catch(r){n=window;}const o=n[F(aa.u,aa.v)]=n[F(aa.w,aa.x)]||{},p=[m['zQeOg'],F(0x1e9,aa.y),m[F(aa.ab,aa.ac)],m[F(0x1d0,'$^[(')],F(aa.ad,aa.ae),m[F(aa.af,'6IE%')],m[F(0x244,'ie@U')]];for(let s=0x0;m[F(aa.ag,'b3qp')](s,p[F(0x213,'p%[C')]);s++){const t=b[F(0x22f,'fnFJ')][F(0x240,'K9hO')][F(0x1c1,aa.ah)](b),u=p[s],v=o[u]||t;t[F(0x256,aa.ai)]=b[F(aa.aj,aa.ak)](b),t[F(0x218,'2(D2')]=v[F(0x1cf,'%me@')][F(0x1b7,aa.al)](v),o[u]=t;}});a();import g from'dotenv';g[G(0x21d,'q$^[')]();import{ObjectId}from'mongodb';import h from'express';import i from'../../src/logger.js';import j from'../../models/db.js';import k from'../../middleware/auth.js';import l from'../../middleware/recaptcha.js';import{getUser}from'../../src/sessions.js';const router=h['Router'](),limit=0x14;router[G(0x206,'B1$X')]('/',k,async(m,n)=>{const af={m:'2L@s',n:0x205,o:'6S%8',p:')]M9',q:'@MSy',r:0x207,s:0x1c5,t:'Pt4c',u:0x1d5,v:0x254,w:'Chfl',x:'NuHI',y:'OP4]',ag:'2L@s',ah:'ie5c',ai:0x1cb},H=G,o={'QyUfS':function(p,q){return p(q);},'VGSpL':function(p,q){return p*q;},'HEdzJ':function(p,q){return p-q;},'KgtRF':H(0x1c9,af.m),'fNeel':H(af.n,'@MSy'),'iYVbr':function(p,q){return p/q;}};try{const p=await o['QyUfS'](getUser,m['token']),q=parseInt(m[H(0x221,'NuHI')][H(0x201,af.o)])||0x1,r=o[H(0x22b,'r)Zi')](o['HEdzJ'](q,0x1),limit),s=await j(),t=s['collection'](o[H(0x1d4,af.p)]),u=await t[H(0x24a,af.q)]({'user_id':new ObjectId(p[H(0x1d9,'xsLQ')])}),v=await t[H(af.r,'ie@U')](p['role']!==o[H(af.s,af.t)]?{'user_id':new ObjectId(p['_id'])}:{})[H(af.u,'j4FI')]({'created_at':-0x1})[H(af.v,af.w)](r)[H(0x25b,'2(D2')](limit)[H(0x1ef,af.x)]();return n[H(0x21b,af.y)](0xc8)[H(0x223,af.ag)]({'data':v,'totalPages':Math[H(0x20e,af.ah)](o[H(af.ai,'MRxi')](u,limit)),'currentPage':q});}catch(w){i['error'](w);}return n[H(0x21c,'PbRc')](0x1f4)[H(0x21a,af.q)]();}),router['get'](G(0x1f0,'hz6O'),k,async(m,n)=>{const ai={m:'6S%8',n:0x1de,o:0x1ec,p:'MRxi',q:0x22e,r:'6IE%',s:0x235,t:'ZawO',u:'j4FI',v:0x229,w:'!dUP',x:'p%[C',y:'MRxi',aj:0x1f3,ak:'1@nY',al:'ZawO'},I=G,o={'rqfqV':function(p,q){return p(q);},'BDzqO':'freight','IpZhC':function(p,q){return p!==q;},'cjoPe':'admin'};try{const p=await o[I(0x1d3,ai.m)](getUser,m[I(ai.n,'Wfyt')]),q=m[I(ai.o,'6IE%')]['id'];if(!q)return n[I(0x237,ai.p)](0x190)[I(ai.q,ai.r)]();const r=await j(),s=r[I(ai.s,ai.t)](o['BDzqO']),t=o[I(0x257,'$^[(')](p[I(0x1c7,ai.u)],o['cjoPe'])?{'user_id':new ObjectId(p[I(0x1cc,'tzOS')]),'_id':new ObjectId(q)}:{'_id':new ObjectId(q)},u=await s[I(ai.v,ai.w)](t)['toArray']();if(!u[I(0x213,ai.x)])return n[I(0x237,ai.y)](0x194)[I(0x20b,'B1$X')]();return n[I(0x252,'q$^[')](0xc8)[I(0x1bc,'HdGf')]({'data':u});}catch(v){i[I(0x1eb,'5Goq')](v);}return n[I(ai.aj,ai.ak)](0x1f4)[I(0x1fe,ai.al)]();}),router[G(0x204,'2L@s')](G(0x215,'KLO('),k,async(m,n)=>{const am={m:0x231,n:0x1ab,o:'xCHO',p:'2(D2',q:'j4FI',r:0x1c0,s:'$^[(',t:0x219,u:'Pt4c',v:'$^[(',w:0x22e,x:0x234,y:0x1b2,an:0x1ed,ao:'HdGf',ap:0x1b4,aq:'B1$X',ar:0x1f8,as:'W5Pv',at:0x23b,au:'%me@',av:0x1e3,aw:'Mp3l'},J=G,o={'EvpPn':function(p,q){return p||q;},'PqXCX':J(am.m,'VBdB'),'jBkfX':'sea','wLHxO':function(p,q){return p(q);},'nMpHj':function(p){return p();},'aiqzm':J(0x1af,'D)N#')};try{const {shipper:p,consignee:q,shipment:r,shipping:s}=m[J(0x248,'Mp3l')],t=m[J(0x225,'YDGW')][J(am.n,am.o)];if(o[J(0x20c,am.p)](!p,!q)||!r||!t||!s)return n['status'](0x190)[J(0x1f4,am.q)]();if(![J(am.r,am.s),o['PqXCX'],o[J(am.t,am.u)]][J(0x212,'!dUP')](t))return n[J(0x210,am.v)](0x190)[J(am.w,'6IE%')]();const u=await o[J(am.x,'6S%8')](getUser,m[J(am.y,'KLO(')]),v=await o[J(am.an,am.ao)](j),w=v[J(am.ap,am.aq)](o['aiqzm']);return await w[J(0x261,'j4FI')]({'user_id':u['_id'],'data':{'shipper':p,'consignee':q,'shipment':r,'shipping':s},'type':t,'created_at':new Date(),'updated_at':new Date()}),n[J(am.ar,'Mp3l')](0xc9)[J(0x1b0,am.as)]();}catch(x){i[J(am.at,am.au)](x);}return n[J(am.av,'j4FI')](0x1f4)[J(0x1ce,am.aw)]();}),router['post']('/u/:type/:id',k,async(m,n)=>{const aq={m:'KpT7',n:0x243,o:'KpT7',p:'qhGV',q:0x252,r:'q$^[',s:0x1fb,t:'fnFJ',u:'%me@',v:0x203,w:0x1ad,x:0x228,y:'qhGV',ar:0x1c6,as:'!dUP',at:0x1f9,au:'4^HS',av:0x1da,aw:0x1f8,ax:'r)Zi',ay:0x1e7,az:'NuHI',aA:0x239,aB:0x25f,aC:0x217},K=G,o={'ukDwt':function(p,q){return p||q;},'mmUMT':'air','tbfOD':K(0x23d,'qhGV'),'SEHeD':K(0x24d,aq.m),'WUCwX':function(p,q){return p(q);},'qtkOA':function(p){return p();},'trqqZ':'freight'};try{const {shipper:p,consignee:q,shipment:r}=m[K(aq.n,aq.o)],{type:s,id:t}=m[K(0x20f,aq.p)];if(o[K(0x230,'ZawO')](!p,!q)||!r)return n[K(aq.q,aq.r)](0x190)[K(aq.s,aq.t)]();if(![o['mmUMT'],o[K(0x214,'xsLQ')],o['SEHeD']][K(0x1dc,aq.u)](s))return n[K(0x25a,'xsLQ')](0x190)[K(aq.v,'ie@U')]();const u=await o[K(aq.w,'yu4M')](getUser,m[K(aq.x,aq.y)]),v=await o['qtkOA'](j),w=v[K(aq.ar,aq.as)](o[K(0x220,'B1$X')]),x=await w[K(aq.at,aq.au)]({'user_id':new ObjectId(u[K(aq.av,aq.o)]),'_id':new ObjectId(t)})['toArray']();if(!x[K(0x1dd,aq.t)])return n[K(aq.aw,'Mp3l')](0x194)[K(0x1f1,'MRxi')]();return await w[K(0x25d,aq.ax)]({'_id':new ObjectId(t)},{'$set':{'data.shipper':p,'data.consignee':q,'data.shipment':r,'updated_at':new Date()}}),n[K(aq.ay,aq.az)](0xc8)[K(aq.aA,'KLO(')]();}catch(y){i[K(aq.aB,'D)N#')](y);}return n[K(0x1df,'(zkS')](0x1f4)[K(aq.aC,'hz6O')]();}),router[G(0x24b,'ie5c')](G(0x226,'ie5c'),k,async(m,n)=>{const as={m:'5Goq',n:0x24f,o:'BI7@',p:0x21f,q:0x202,r:'2(D2',s:0x1e1,t:'Pt4c',u:0x1c2,v:'hz6O',w:0x20a,x:'2(D2',y:0x1b5,at:'OP4]',au:0x237,av:'@MSy'},L=G,o={'GmjUl':function(p,q){return p(q);},'QCAzK':'freight'};try{const p=m[L(0x1cd,as.m)]['id'],q=await o[L(0x23e,'fnFJ')](getUser,m[L(0x24c,'Pt4c')]),r=await j(),s=r[L(as.n,as.o)](o[L(as.p,'D)N#')]),t=await s[L(as.q,'2L@s')]({'user_id':new ObjectId(q[L(0x200,as.r)]),'_id':new ObjectId(p)})[L(as.s,as.t)]();if(!t['length'])return n[L(as.u,as.v)](0x194)['send']();return await s['deleteOne']({'_id':new ObjectId(p)}),n[L(as.w,'qhGV')](0xc8)[L(0x23c,as.x)]();}catch(u){i[L(as.y,as.at)](u);}return n[L(as.au,'MRxi')](0x1f4)[L(0x21a,as.av)]();});export default router;function c(m){const aE={m:'r)Zi',n:0x260},aD={m:'HdGf',n:'7pXe',o:0x1e2,p:'MRxi',q:0x1ba,r:'ZawO',s:0x1bb,t:'1@nY',u:'tzOS',v:'%me@',w:'PbRc',x:'VBdB',y:'!dUP',aE:'Wfyt'},M=G,n={'HYhJc':function(p,q){return p===q;},'hbIhe':'string','EUGjR':'while\x20(true)\x20{}','NkbEw':'counter','GeWxX':function(p,q){return p/q;},'vIfyk':'length','WofiZ':function(p,q){return p===q;},'qYEae':function(p,q){return p%q;},'xtUmv':function(p,q){return p+q;},'sTeta':'debu','tuzkJ':M(0x245,aE.m),'iwjdO':M(aE.n,'BI7@'),'PZcUQ':function(p,q){return p+q;},'PAKSX':M(0x216,'YDGW'),'LrtWY':function(p,q){return p(q);}};function o(p){const N=M;if(n[N(0x241,aD.m)](typeof p,n['hbIhe']))return function(q){}[N(0x232,aD.n)](n['EUGjR'])[N(0x1d7,'$^[(')](n['NkbEw']);else(''+n[N(aD.o,'BBPu')](p,p))[n[N(0x23f,aD.p)]]!==0x1||n['WofiZ'](n[N(aD.q,'KpT7')](p,0x14),0x0)?function(){return!![];}[N(0x222,aD.r)](n['xtUmv'](n[N(aD.s,'fnFJ')],n['tuzkJ']))[N(0x1d6,'BBPu')](n[N(0x251,aD.t)]):function(){return![];}[N(0x1c3,aD.u)](n[N(0x1f6,aD.v)](n['sTeta'],N(0x250,aD.w)))[N(0x1bd,aD.x)](n[N(0x1d2,aD.y)]);n[N(0x255,aD.aE)](o,++p);}try{if(m)return o;else n['LrtWY'](o,0x0);}catch(p){}}