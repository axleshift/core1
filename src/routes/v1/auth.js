const J=f;(function(p,q){const W={p:'mZpm',q:0x1cb,r:0x1b2,s:'j7HK',t:0x201,u:'NAdP',v:0x1be,w:'slW6',x:0x1bd,y:'ohe0'},E=f,r=p();while(!![]){try{const s=-parseInt(E(0x297,W.p))/0x1*(-parseInt(E(W.q,'c^N7'))/0x2)+-parseInt(E(W.r,W.s))/0x3+parseInt(E(W.t,W.u))/0x4+-parseInt(E(W.v,'1sSU'))/0x5+-parseInt(E(0x1cc,'ou*E'))/0x6+-parseInt(E(0x299,W.w))/0x7+parseInt(E(W.x,W.y))/0x8;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x68e9e));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a5={p:0x28b,q:'ZfF)',r:0x264,s:'AYTM',t:0x22b,u:'%za*',v:'1sSU',w:0x29f,x:'h#ka',y:0x1d0,z:'gVPz'},F=f,p={'vxUNZ':F(0x28a,'dUS)'),'zMuOL':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ClgBk':function(q,r){return q(r);},'aLvJs':F(0x261,'pp#F'),'MKPey':function(q,r){return q+r;},'BytSi':F(0x285,'r5!8'),'oZGbl':function(q){return q();},'fEjpG':function(q,r,s){return q(r,s);}};p[F(0x1f3,'tM8i')](d,this,function(){const G=F,q=new RegExp(p[G(a5.p,a5.q)]),r=new RegExp(p['zMuOL'],'i'),s=p['ClgBk'](c,p[G(a5.r,'j7HK')]);!q[G(0x28d,a5.s)](p[G(a5.t,a5.u)](s,G(0x1df,a5.v)))||!r['test'](s+p[G(a5.w,a5.x)])?s('0'):p[G(a5.y,a5.z)](c);})();}());function f(a,b){const c=e();return f=function(d,g){d=d-0x1b1;let h=c[d];if(f['vPrfLO']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['SEyCkx']=m,a=arguments,f['vPrfLO']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['HDGmrJ']===undefined&&(f['HDGmrJ']=!![]),h=f['SEyCkx'](h,g),a[k]=h):h=l,h;},f(a,b);}const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ag={p:0x226,q:'AYTM',r:'AYTM',s:'P!HJ',t:0x29d,u:'%za*',v:0x232,w:0x1c0,x:'slW6',y:0x1b4,z:'j7HK',A:0x1bc,B:'ZWIb',C:0x20c,D:'t1tP',ah:0x2a0,ai:'r5!8',aj:0x258,ak:0x262,al:'tSZh',am:0x295,an:'7y4X',ao:'tM8i',ap:0x22a,aq:'jYdr',ar:0x23a,as:'%za*'},af={p:'P!HJ',q:'NAdP'},H=f,p={'IbSVo':function(u,v){return u+v;},'uDTjB':function(u,v){return u+v;},'FNXXJ':'return\x20(function()\x20','LQvhb':H(ag.p,ag.q),'cOhQE':function(u){return u();},'RDaoh':H(0x23f,'BIMQ'),'gWRlX':H(0x210,ag.r),'bBklg':H(0x28f,ag.s),'PMYgT':H(ag.t,ag.u),'LSHcg':H(ag.v,'P!HJ'),'qghkp':function(u,v){return u<v;}},q=function(){const I=H;let u;try{u=Function(p['IbSVo'](p[I(0x1c7,af.p)](p[I(0x237,'c^N7')],p[I(0x1ea,af.q)]),');'))();}catch(v){u=window;}return u;},r=p[H(ag.w,ag.x)](q),s=r['console']=r[H(ag.y,ag.z)]||{},t=[p[H(ag.A,ag.B)],H(0x1cd,'c^N7'),p[H(ag.C,ag.D)],p[H(ag.ah,ag.ai)],p['PMYgT'],p[H(ag.aj,'Yz6c')],H(ag.ak,'pp#F')];for(let u=0x0;p[H(0x23e,ag.al)](u,t[H(ag.am,ag.an)]);u++){const v=b[H(0x1c1,ag.ao)][H(ag.ap,ag.aq)][H(0x241,'BIMQ')](b),w=t[u],x=s[w]||v;v[H(0x1ff,'x[Xj')]=b[H(ag.ar,ag.as)](b),v[H(0x1ce,ag.ao)]=x['toString'][H(0x241,'BIMQ')](x),s[w]=v;}});a();import g from'dotenv';function e(){const b3=['df/cG8owb8oufCovW5ZcVSk4','ymkiW6BcGJ94rCo0m8kvlL9Bp8o/hdVdMSkn','e8o/W6ixfSkfA2bpWRxdUSo3nSo6cmohiSkVkM7dO0rxCa0CWOz0WRr9W4ldIq','WOZdGmoknfhdKmkVbbBcPG','vLldKCoqW5u','WQWguwddHKLL','suBdQSo9W57dG8oBWQuK','xc3dNwnQ','fSoQBSkVbW','pZJdOgHIia','BLlcPfTayMyjgh7cQ8oswmkska','imkLxSk9WQxcL1GNuG','xCk/W5ygW74','W43cMfXRWRRcPwtdS8ozrN1+W7i','CSk4umklpq','W4K6W5pdHq','dCoQA8k1m8kz','ASkEx8kFfq','WQ9RWPHsid4','ECobWOGTWQG','cmoxtSk4ha','W49gW6hcJmobha7dPmouoZCy','CW/dO2i','W4KRW5ZdLCktW7u','m2BdNx/dMW','re7cG8ow','sZFdVWDV','zCkIW74','WP/cPfZcOa','A8kKW7Cu','WOZdNCodouddLSk/mHJcVa','pmk4smkQWQq','wLVdQCoLW5tdLmowWRWUga','WPZdISosevRdH8k+hW/cQCop','pZLxhmkX','vHBdMSo/WQhdMhddKbddL8oPWOv2','DmkvCG','WRFdN8oc','E35mgM4','sSo8WRuh','WRONvKmi','WOVdHHOO','zsFdQN0Ml8kiWOlcPrS','yHldRhjMkW','W4aPWRqmca','rf3dUa/cKNrZ','y2lcJSoEya','W7X/WONdMhO7FCkGaSk+WOS','WRzSWPzi','WRGuWOtdS8kN','xv7dNJ7cQwf9WPpcVW','zCkTWRHPnmoVWPKhBCoLW5FdO3TZrCoJW63dL8otW5e8WQn2aSk6WP7dQ8oo','khtcP8kVW7m','W64GWQOGeG','v3xcP1lcQW','WPZcRKhcSa','dCoOWP8ZfG','pCkBW7FcHsrWha','yGpdO2i','WPOothFdVKHYW51UBXVcNCkCW57cNmkkDSoRddakjv0GldRcGaJcMmkaWPJdVSkpW6z2vmkB','WPz2iGpcNaddOCkHW4rZ','WPRcQbCg','WOFcTb8rWQy','W6ZdISompYpcOSk6W4m1BIO','WQ/cJSk6ArW','WPNcTreC','uJxdTGH6W67dMq','WRnAW4ddRXe','W6CSDSoh','WRGhW7JdRuJcTci','svVcVKrsltWzsMBcU8kidmojn09pW6dcIGRdUfmhW6hcUG1sbchdOCkAWP8mFSkcimolW5ldKtjkBZSgwtdcTZZcSL0ZW5e8WRddOqLhBSo6WQvuD8o8WPiKAmkIBKdcPsZdSgxcRCkGW5lcTatcOIpdV8kEW47cV8oQW64','evtcISk+','A8kHW7dcPr0','W6DUWONdIhOgBa','o3xdLZ3cTq','ydVdVhS','zCk2xmkbmCkb','CaRdOq','W74dWPe9','W53cICoCmt3cVmk/WPeExX5ZrCklW5O','W5qWW4O','zqNdPMn9','WOxdSmoNqCox','WO3cPeVcRq','obiOWRBcN03dKhfoWPfQrmo6W497lHr8W4OhW5C','WRBcO8ohWP8','W6SpWPe9pSo3cW','WPOjF2iTlmk1','WP9Qiqe','W5u4BmoqWOu','kN3dNx4','WPJdIauW','AeZcM1pcQmkIW6xcTJ9YW4VdQ8o9WOyTz14BW55vW7FdUCk5','ztSEWRhcUSoFW6pdTqhdTSkKW5ZcGa','WPtcLCklANNdU8kPWO41Cdie','WQVcR8kTsGm','W5BdKmoBkJRcUa','pMrEW7hdVG','i2vfW6hdPa','WR7cQsvWW4pcK0RdRWu','ASk8xmkalmko','WPJdHGuWW6ZdSsBdSSosya','WP0eWR/dNmkattFdJmkWrqXiW4rNAdu','AelcLSkCWRW','vfTqpa','hmoNWR8a','WRNcOSoAWP4o','y8kRqmkikG','hCoYWQGvdCkov3Py','j8kKwG','t8oUWQmgWPupW7VdRG','W4BdI8oEoW','dCoNECk1i8kh','W6e6D8ooWPvR','WPZdM8ohlehdGa','jIxdJfLzkmkv','iCkUvq','fq8lA8oNW4PwWPBcVCoTWRhcUKC','WOxcUedcUG','WPxcLavXW4i','AmkPW5VcVJ0','Db7dRMnJlf/cLu8','Ac7dGwTP','qfBcT1JdIG','nuHfW6JdRq','W5tdH8oTfIO','eeJcHmkPW7O','j2vDW7a','E8kOW7qFW7JcKgpdULTRWOzqDW','y1/cS2FdMG','WOGszgm','W7RdTCo8efPlW7pdTmoBxSkgW58','WRZdVCo/iwi','WQ3cRCkIuaaFW4a','W7C7W4tdG8kR','W6PMWONdHxm','WO8uChixmq','W7P4WO3dNG','WOHIW6hdJWm','AK7cRenqmq','WORdMCocvq','t2jbp0q','aXFdJ8kcjctcJey8W5HMW6ddLG','erZdKmkvvSkkwCkQW5xcG8k8W7XA','emoXFq','rhfwcCkx','EmkoBc5gW4ZdTMddHxNdMG','wf/cQ2Dk','CuRcRw8','oh5E','WOzTlXVcJba','gmo3zmkLcCkeW5S','C8kDzSkngG','aGG/WQpcHLC','WORdNCoun0y','W6mWBG','dSk+W6fbW5rqW77dPWJdT8otra','WRRcSLxcIfKsW4mBWQrvW6RcMSka','smoUWQiB','B8kousLaW5FdRwq','wSoFWP4WWPy','W7GXW5ddQeS','WPVdK8oisa','W6DyWR3dMe0','bmk4rSkXWP8','yv3cPMRdLYpcLcOXW58','qmk8W6RcOIm','WO/dHGi5W6C','pCkyW6hcKJ8','w0NcJq','hK3dIc3cN3XOWPVcQa','hXmP','DLtcKwlcSa','tmo7WQiCWOWh','jh/dUwhdQG','W4pdJCouoGdcPCk7','qehcH8onaa','WRVcSCkPurW','WQqyWRu','WRfCW4hdRZy','dNBdH1FdMW','W6fUWP/dN3mrA8k+aSkV','j8ohWQDWeW','WQreW6ddIta','WPuEWQy','xaftdSkA','WOGfWRddI8kbvW','mSopFmkPja','WRtcQdP5W5tcHhhdQa9b','zCkzW4hcMXW','r0pcKhRdKG','WQfhW6hdLtz8WPNdQmkxCvS','j8oIWRK','peD0W5BdSa','WPRcUeRcPKK','yZhdOwS','FCkKAc11','WRlcV8oF','WOKqDwCwj8kFgMK','tYpdSH4','aKpdIc0','ov7dONJdHq','v2RcJ39j','WRKnCg8oySk5ecXTW7pcS2mnWOiIW4/cG8kvvKDHW6i','WRvXWOPdjZKNfmo5','FSktCdja','Fmk+W7Wc','W5tdNWWUW6ddTcVcTmosEM8WW7C1za','WRdcLf/cPLvOW5Gnvq','pxLbW6O','tmkVoSo0DSoAWO7cLZxcTIbzgq','W6GWW4JdLCkdW7q','rffqk8kMWOeAWRlcS8otWRe','W6CvWPa3','WOJdHGO3W6ZdPG','WQ3cM0FcLvm','W6TIWO/dIwWa','WRNcQce','ECkIW6Oe','D1/cP2RdLYm','A0RcP8kZWPiTCfj9','x3RcUKZcHW','yZ/dOH4/W7pdNSoAWQW/WOyz','FSkmyZrEW6hdTwBdG3/dJSkUAe/cJa','cZGxWP7cGW','aCoSWQOB','WPZcLmkKBbu','kmkMBmkFWO0','WPbRpadcIW','mgZdSgpdSq','vePFlmkNWOa','g8oNWQiq','m3RdK2tdHCor','W4HaWOldLLu','uxZcRSoWtW','aSkbD8k6WPK','t2VcSeVcTW','pCoIWQvTnG','W4tdImow','WRKjs8o8W4LwlwtcKmo6W53cLJu','oSkUq8k8','W4GcW7m','jZnshSkRWQ4','gSoHWOGFpq','ESkmqXPO'];e=function(){return b3;};return e();}g[J(0x270,'P!HJ')]();import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';(function(){const al={p:'zs&w'},ak={p:'r5!8',q:'P!HJ'},K=J,p={'kMZRz':function(s,t){return s(t);},'lGmxM':function(s,t){return s+t;},'jzBbW':K(0x225,'7nE!'),'ElSqq':function(s){return s();}},q=function(){const L=K;let s;try{s=p[L(0x1f0,ak.p)](Function,p[L(0x235,ak.q)](p['jzBbW']+'{}.constructor(\x22return\x20this\x22)(\x20)',');'))();}catch(t){s=window;}return s;},r=p[K(0x1ed,'h#ka')](q);r[K(0x245,al.p)](c,0x9c4);}());import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';const router=h[J(0x202,'bjuJ')]();router['post'](J(0x256,'fBf&'),async(p,q)=>{const ap={p:'rp0v',q:0x25f,r:'mSAr',s:0x280,t:'h&KD',u:'h#ka',v:0x1d2,w:']TEQ',x:0x288,y:0x204,z:'Dmi#',A:0x259,B:'Dmi#',C:0x228,D:'oV8k',aq:0x265,ar:'pp#F',as:0x27d,at:'7y4X',au:'slW6',av:'bjuJ',aw:'t1tP',ax:0x1bf,ay:']TEQ',az:0x211,aA:'j7HK',aB:'dUS)',aC:'7y4X',aD:0x1e9,aE:'Dmi#'},M=J,r={'hSUtR':M(0x278,ap.p),'pbBsA':function(s,t){return s<t;},'cFUyc':M(ap.q,ap.r),'dZTEX':M(0x26a,'nCmR'),'ofTYd':function(s,t){return s!=t;},'BxJuR':M(ap.s,'t1tP'),'Xguyd':M(0x1f1,'x[Xj'),'shook':M(0x1fa,'h&KD'),'NyyBo':'user','NxuGk':function(s,t){return s===t;},'RVhOz':M(0x1b1,ap.t),'COnUr':M(0x1e4,'V2Ip')};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w,newsletter:x}=p[M(0x277,'x[Xj')];if(!s||!t||!u||!v||!w||!x)return q['status'](0x190)[M(0x1c3,ap.u)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/['test'](s))return q['status'](0xc8)[M(0x27c,'CQUn')]({'error':r[M(ap.v,'V2Ip')]});if(r[M(0x214,ap.w)](v[M(ap.x,'P!HJ')],0x8))return q['status'](0xc8)[M(ap.y,ap.z)]({'error':r[M(ap.A,ap.B)]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/['test'](v))return q['status'](0xc8)[M(0x200,'r5!8')]({'error':r[M(0x219,'ohe0')]});if(r[M(ap.C,'jYdr')](v,w))return q[M(0x236,ap.D)](0xc8)[M(ap.aq,ap.ar)]({'error':r['BxJuR']});const y=await k(),z=await y['collection'](r[M(ap.as,ap.at)]),A=await collection[M(0x27b,ap.t)]({'email':s});if(A)return l[M(0x1c9,'zs&w')](r[M(0x23c,']TEQ')]),q[M(0x215,ap.au)](0x199)[M(0x233,ap.av)]();await z[M(0x287,'cIK[')]({'email':s,'first_name':t,'last_name':u,'role':r[M(0x1db,ap.aw)],'password':o(v),'email_verify_at':'','created_at':Date[M(ap.ax,'NAdP')](),'update_at':Date[M(0x274,ap.av)]()});if(r[M(0x1e3,ap.ay)](x,r[M(ap.az,ap.aA)])){const B=await y[M(0x289,'fD&H')](r['COnUr']),C=await x[M(0x229,'mSAr')]({'email':s});!C&&B[M(0x22f,'Aw%2')]({'email':s,'created_at':Date[M(0x1e7,ap.aB)](),'update_at':Date[M(0x1ca,ap.aC)]()});}return q['status'](0xc9)['send']();}catch(D){l['error'](D);}return q[M(ap.aD,'dUS)')](0x1f4)[M(0x272,ap.aE)]();}),router[J(0x26f,'mZpm')](J(0x22d,'mZpm'),n,async(p,q)=>{const av={p:0x298,q:'mZpm',r:0x29b,s:'cIK[',t:0x234,u:'jCsY',v:'zs&w',w:0x21b,x:0x1de,y:'2$&h',z:'7nE!',A:'Dmi#',B:0x292,C:'c^N7',D:0x23b,aw:'h#ka',ax:'h&KD',ay:0x26d,az:'V2Ip',aA:'fD&H',aB:0x2a4,aC:0x26e,aD:'fBf&',aE:0x266,aF:0x25a,aG:0x1fc},N=J,r={'BSSds':function(s,t){return s||t;},'mFAmA':function(s){return s();},'wFXkh':N(0x1e0,'j7HK'),'yLbRP':function(s,t){return s!=t;},'MOKUy':function(s,t){return s(t);},'FGGEj':N(av.p,'Aw%2'),'Zhjrk':N(0x273,'2$&h'),'IYldu':function(s,t,u,v,w){return s(t,u,v,w);},'oXOrt':N(0x24e,av.q)};try{const {email:s,password:t}=p[N(0x1bb,'jCsY')];if(r[N(av.r,av.s)](!s,!t))return q[N(av.t,'NAdP')](0x190)['send']();const u=await r[N(0x276,av.u)](k),v=await u[N(0x227,av.v)](r[N(av.w,'t1tP')])[N(av.x,av.y)]({'email':s});if(!v)return q['status'](0x194)['send']();if(r[N(0x26c,av.z)](r[N(0x250,av.A)](o,t),v[N(av.B,av.C)]))return q[N(av.D,'bjuJ')](0x191)[N(0x25e,'%za*')]();const w=j['createHash']('sha256')[N(0x20a,av.aw)](r['mFAmA'](generateUniqueId))[N(0x207,'V2Ip')](r[N(0x24c,av.ax)]),x=p[N(av.ay,av.az)][r['Zhjrk']]||p[N(0x205,av.aA)][N(av.aB,'BIMQ')];return r[N(av.aC,av.aD)](addSession,v,w,x,p[N(av.aE,'tSZh')][r[N(av.aF,'t1tP')]]),q['status'](0xc8)[N(0x29a,'x[Xj')]({'token':w});}catch(y){l[N(av.aG,'tM8i')](y);}return q['status'](0x1f4)['send']();}),router[J(0x1f7,'fBf&')](J(0x25d,'7nE!'),m,async function(p,q,r){const aB={p:0x248,q:'Aw%2',r:0x1b8,s:'V2Ip',t:0x20e,u:'tM8i',v:0x217,w:']TEQ',x:0x267,y:'Y]Wi',z:0x238,A:0x1c2,B:0x1c8,C:'SJGT',D:'Cuvy',aC:0x268},O=J,s={'MskiH':function(z,A){return z!==A;},'GKjzJ':function(z){return z();},'qrOIS':O(aB.p,'tM8i'),'vIDyZ':function(z,A){return z*A;},'AefPo':function(z,A){return z*A;},'nJixK':function(z,A,B){return z(A,B);}},{_id:t,email_verify_at:u,...v}=p[O(0x26b,'Yz6c')];v['is_email_verified']=s['MskiH'](u,'');if(s[O(0x1d3,aB.q)](p[O(aB.r,aB.s)][O(aB.t,aB.u)],''))return q[O(aB.v,aB.w)](0xc8)['json'](v);const w=await s[O(0x218,'V2Ip')](k),x=await w['collection'](s[O(aB.x,aB.y)]),y=await x[O(0x27a,'Dmi#')]({'token':p[O(0x21c,'Cuvy')],'verified':![]});if(y){const z=new Date(y['created_at']),A=s[O(aB.z,'NAdP')](s[O(aB.A,'nCmR')](0xa,0x3c),0x3e8);if(!(Date['now']()-z>A))return q[O(aB.B,'rp0v')](0xc8)[O(0x279,aB.C)]({'otp':!![]});}return s[O(0x1e5,aB.D)](sendOTPEmail,p,x),q[O(0x1b7,'h&KD')](0xc8)[O(aB.aC,'7y4X')]({'otp':!![]});});const sendOTPEmail=(p,q)=>{const aE={p:'Y]Wi',q:0x271,r:'%za*',s:0x2a2,t:0x1f4,u:'SJGT',v:'tSZh',w:0x24a,x:'ZWIb',y:0x257,z:'Cuvy',A:0x24b,B:'c^N7'},P=J,r={'bIFvT':function(t,u){return t*u;},'BPhAi':function(t,u,v){return t(u,v);},'fXlJB':'One\x20Time\x20Password\x20(OTP)'},s=Math[P(0x1e6,aE.p)](0x186a0+r['bIFvT'](Math['random'](),0xdbba0));Promise[P(aE.q,aE.r)]([q[P(0x1fb,'oV8k')]({'user_id':p['user']['_id'],'token':p[P(aE.s,'Yz6c')],'code':s,'verified':![],'expired':![],'created_at':Date[P(0x208,'cIK[')](),'updated_at':Date[P(aE.t,aE.u)]()}),r[P(0x206,'x[Xj')](send,{'to':p[P(0x1f6,aE.v)][P(0x1b6,'V2Ip')],'subject':r[P(aE.w,aE.x)],'text':P(0x20d,'tSZh')+s+P(aE.y,aE.z)},p[P(aE.A,aE.B)]['first_name'])]);};router[J(0x24d,'fD&H')](J(0x1d7,'7nE!'),m,async function(p,q,r){const aG={p:0x1d6,q:'fD&H',r:0x1c5,s:'CQUn',t:0x27e,u:']TEQ',v:0x283,w:'j7HK',x:0x1d9,y:0x213,z:'2$&h'},Q=J,s={'AQHVM':function(t,u){return t(u);}};try{const t=await s['AQHVM'](getUser,p[Q(aG.p,aG.q)]);return q[Q(aG.r,aG.s)](0xc8)[Q(aG.t,aG.u)]({'user':{'email':t[Q(aG.v,aG.w)],'first_name':t['first_name'],'last_name':t[Q(aG.x,'fBf&')]}});}catch(u){l[Q(aG.y,aG.s)](u);}return q[Q(0x284,aG.z)](0x1f4)[Q(0x1f2,'mZpm')]();}),router[J(0x240,'x[Xj')](J(0x269,'gVPz'),m,function(p,q,r){const aH={p:'%za*',q:0x1ba,r:0x216},R=J;return removeSession(p[R(0x275,aH.p)]),q[R(aH.q,'nCmR')](0xc8)[R(aH.r,'AYTM')]();}),router[J(0x209,'BIMQ')](J(0x1fe,'fD&H'),[m,n],async function(p,q,r){const aM={p:'Y]Wi',q:0x1e2,r:0x246,s:'F1VD',t:0x1b5,u:0x230,v:0x291,w:'AYTM',x:0x1f9,y:0x1d5,z:'7nE!'},S=J,s={'JJniA':function(t){return t();},'stNIt':'otp','MdybM':function(t,u){return t*u;},'TrOvr':function(t,u){return t-u;},'NPBHl':'system','RQxUn':function(t,u,v){return t(u,v);}};try{const t=await s[S(0x1b9,aM.p)](k),u=await t[S(0x260,'CQUn')](s[S(aM.q,'Y]Wi')]),v=await u['findOne']({'token':p[S(aM.r,aM.s)],'verified':![],'expired':![]});if(v){const w=new Date(v[S(0x1d4,'h#ka')]),x=s[S(aM.t,'bjuJ')](0xa*0x3c,0x3e8);s[S(aM.u,'BIMQ')](Date[S(aM.v,'Aw%2')](),w)>x&&(await u[S(0x290,aM.w)]({'_id':new ObjectId(v[S(0x220,'gVPz')])},{'$set':{'verified':![],'expired':!![],'updated_at':Date['now'](),'modified_by':s[S(aM.x,'nCmR')]}}),s[S(aM.y,aM.z)](sendOTPEmail,p,u));}}catch(y){l['error'](y);}return q['status'](0x1f4)[S(0x21f,'Aw%2')]();}),router[J(0x2a3,'r5!8')](J(0x224,'1sSU'),[m,n],async function(p,q,r){const aS={p:0x1c4,q:'r5!8',r:0x263,s:'2$&h',t:'NAdP',u:0x248,v:'tM8i',w:0x284,x:'x[Xj',y:0x286,z:'r5!8',A:0x242,B:0x29e,C:'%za*',D:0x1b3,aT:'zs&w',aU:0x2a1,aV:0x222,aW:'AYTM',aX:0x24f,aY:0x254,aZ:'2$&h',b0:0x1f5,b1:0x249,b2:'Cuvy',b3:'7nE!',b4:0x244,b5:'ZfF)',b6:0x1e1,b7:'dUS)',b8:'rp0v',b9:0x28e,ba:'SJGT',bb:0x28c},T=J,s={'PbntS':T(aS.p,aS.q),'ePNEt':function(t,u){return t*u;},'yHLmz':function(t,u){return t>u;},'htdnA':function(t,u){return t-u;},'SRYyV':'Expired\x20OTP','qcWHe':function(t,u){return t!==u;},'rcDkD':function(t,u){return t(u);},'VDtkw':T(aS.r,aS.s),'wtSlQ':T(0x294,aS.t)};try{const t=p['body'][T(aS.u,aS.v)];if(!t)return q[T(aS.w,aS.s)](0x190)[T(0x25b,aS.x)]();const u=await k(),v=await u[T(0x1eb,'cIK[')](s['PbntS']),w=await v[T(0x1c6,'NAdP')]({'token':p[T(aS.y,aS.z)],'verified':![],'expired':![]});if(w){const x=new Date(w[T(aS.A,'zs&w')]),y=s[T(0x1cf,'c^N7')](0xa*0x3c,0x3e8);if(s[T(aS.B,aS.C)](s[T(0x22c,'NAdP')](Date['now'](),x),y))return q[T(0x296,'zs&w')](0xc8)['json']({'error':s[T(aS.D,aS.aT)]});}if(s[T(aS.aU,aS.s)](w[T(0x293,aS.s)],s[T(aS.aV,aS.aW)](parseInt,t['replace'](/[^0-9]/g,''))))return q[T(aS.aX,'%za*')](0xc8)[T(aS.aY,'oV8k')]({'error':s[T(0x252,'ohe0')]});return await Promise[T(0x21d,aS.aZ)]([v[T(aS.b0,'h&KD')]({'_id':new ObjectId(w[T(aS.b1,'jCsY')])},{'$set':{'verified':!![],'updated_at':Date[T(0x1ef,aS.b2)](),'modified_by':s[T(0x1ec,aS.b3)]}}),u[T(aS.b4,'jYdr')](T(0x243,'Aw%2'))[T(0x20b,aS.b5)]({'_id':new ObjectId(p[T(0x1fd,'BIMQ')][T(aS.b6,aS.b7)])},{'$set':{'email_verify_at':Date[T(0x1da,aS.b8)](),'updated_at':Date[T(0x1d8,'ohe0')]()}})]),q['status'](0xc8)[T(0x1d1,'jCsY')]();}catch(z){l[T(aS.b9,aS.ba)](z);}return q['status'](0x1f4)[T(aS.bb,'slW6')]();});export default router;function c(p){const b2={p:0x221,q:'F1VD',r:'V2Ip',s:'Aw%2'},b1={p:0x21a,q:'Aw%2',r:0x1dc,s:0x203,t:'nCmR',u:0x1dd,v:']TEQ',w:0x255,x:'7nE!',y:0x27f,z:'fD&H',A:0x1ee,B:'Y]Wi',C:0x2a5,D:'h#ka',b2:'tM8i'},U=J,q={'KJZbN':function(s,t){return s===t;},'HmnAu':'counter','dqKqZ':function(s,t){return s!==t;},'ejSGo':function(s,t){return s+t;},'CeULS':function(s,t){return s/t;},'yPPhu':U(b2.p,b2.q),'zDIIp':U(0x23d,'1sSU'),'zDpbg':'debu','UJdxM':U(0x253,b2.r),'amAGZ':function(s,t){return s(t);}};function r(s){const V=U;if(q[V(b1.p,b1.q)](typeof s,V(b1.r,'c^N7')))return function(t){}[V(b1.s,'slW6')](V(0x22e,b1.t))['apply'](q['HmnAu']);else q[V(b1.u,b1.v)](q[V(0x1e8,'H!O!')]('',q[V(b1.w,'dUS)')](s,s))[q[V(0x1f8,']TEQ')]],0x1)||q['KJZbN'](s%0x14,0x0)?function(){return!![];}['constructor'](q[V(0x25c,'AYTM')]('debu',q[V(0x29c,b1.x)]))[V(b1.y,b1.z)]('action'):function(){return![];}[V(b1.A,b1.B)](q['zDpbg']+q[V(0x20f,'rp0v')])[V(b1.C,b1.D)](q['UJdxM']);q[V(0x223,b1.b2)](r,++s);}try{if(p)return r;else q[U(0x212,b2.s)](r,0x0);}catch(s){}}