import{r as e,j as t}from"./_LxKj9PG.js";import{u as s}from"./zzZDfg70.js";import{j as a}from"./DJ7kxq5B.js";import{F as i,a3 as r,a5 as o}from"./CUCxJel0.js";import{b as n}from"./C_hIR-2K.js";import{d}from"./BJRa5TG-.js";import{d as c,b as l,c as m,A as h,T as j,X as p,U as g,Y as u,Q as x,Z as v,a as b,e as f,f as N,g as w,h as k}from"./BRvZdRVW.js";import"./C_9exQ7i.js";import"./Itq7e1c5.js";import"./D1Sfz1v5.js";import"./CR-CXyre.js";import"./IaOX6k4U.js";import"./BIw_sdFo.js";import"./c7OvE8pj.js";import"./yJGO6Amu.js";import"./tRrjmjzN.js";import"./BFk34ZWe.js";import"./lcqsW1nY.js";import"./DIrOWF5t.js";import"./D74OPSAh.js";import"./COFYN2eQ.js";import"./DcHTRIdl.js";import"./BXbwj-H9.js";import"./K-dupnmX.js";import"./ZZM5rHs7.js";import"./Dw1DiDGf.js";import"./YiBEvX-Q.js";import"./rRm29nvs.js";import"./CzGuHLZU.js";import"./B8Let_61.js";import"./CZm-rpfG.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const y=()=>{const{addToast:y}=n(),[X,I]=e.useState(""),[R,C]=e.useState(null),[D,Q]=e.useState(!1),[S,A]=e.useState(!1),E=d(),{getRootProps:T,getInputProps:P}=s({onDrop:e=>{const t=e[0];if(t){const e=new FileReader;e.onloadend=()=>{C(e.result),q(e.result)},e.readAsDataURL(t)}}}),U=e=>(e.preventDefault(),X&&0!==X.trim().length?/^[A-Z]{2}-\d+$/.test(X)?E(`/track/${X}`):void y("Invalid Tracking ID Number."):null),$=e=>{A(!1),I(e),Q(!0),setTimeout((()=>(Q(!1),e&&0!==e.trim().length?/^[A-Z]{2}-\d+$/.test(e)?E(`/track/${e}`):void y("Invalid Tracking ID Number."):null)),1e3)},q=e=>{if(!e)return;const t=document.createElement("img");t.src=e,t.onload=()=>{const e=document.createElement("canvas"),s=e.getContext("2d");e.width=t.width,e.height=t.height,s.drawImage(t,0,0);const i=s.getImageData(0,0,e.width,e.height),r=a(i.data,e.width,e.height);if(!r)return y("No QR code found.");$(r.data)}};return t.jsxs("div",{children:[D&&t.jsx("div",{className:"loading-overlay",children:t.jsx(c,{color:"primary",variant:"grow"})}),t.jsxs(l,{className:"mb-3",children:[t.jsx(m,{xs:4,className:"image-container d-none d-md-flex",children:t.jsx(h,{fluid:!0,rounded:!0,src:"/images/freight-track.jpg",className:"custom-image",loading:"lazy"})}),t.jsxs(m,{md:7,className:"mb-4",children:[t.jsx("h1",{children:"Tracking Number"}),t.jsx(j,{className:"mb-3",onSubmit:U,children:t.jsxs(p,{children:[t.jsx(g,{"aria-label":"Track shipment","aria-describedby":"basic-addon",value:X,onChange:e=>I(e.target.value),placeholder:"AX-17XXXXXXXXXX"}),t.jsx(u,{id:"basic-addon",onClick:U,children:t.jsx(i,{icon:r})})]})}),t.jsx("div",{children:t.jsxs(x,{className:"d-inline-block text-center border border-2",...T(),children:[t.jsx(g,{...P(),accept:".png,.jpg"}),!R&&t.jsxs("div",{className:"p-5",children:[t.jsx(v,{children:"Drag & Drop QRCode"}),t.jsx("p",{children:"or click to select an image"})]}),R&&t.jsx(h,{src:R,alt:"QRCode",className:"img-fluid",loading:"lazy"})]})}),t.jsx("div",{className:"mt-3",children:t.jsxs(b,{color:"primary",onClick:()=>(()=>{A(!0);const e=document.createElement("video"),t=document.createElement("canvas"),s=t.getContext("2d");navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then((i=>{e.srcObject=i,e.setAttribute("style","position: absolute; top: 0; left: 0; width: 100%; height: auto; z-index: 50000;"),document.getElementById("video").appendChild(e),e.addEventListener("loadedmetadata",(()=>{e.play();const r=()=>{t.width=e.videoWidth,t.height=e.videoHeight,s.drawImage(e,0,0,t.width,t.height);const o=s.getImageData(0,0,t.width,t.height),n=a(o.data,t.width,t.height);n?(i.getTracks().forEach((e=>e.stop())),e.remove(),$(n.data)):requestAnimationFrame(r)};r()}))})).catch((e=>{y("Unable to access camera.")}))})(),children:[t.jsx(i,{icon:o,className:"me-2"})," Open Camera"]})})]})]}),S&&t.jsxs(f,{alignment:"center",fullscreen:"sm",scrollable:!0,backdrop:"static",keyboard:!1,visible:S,onClose:()=>(()=>{A(!1);const e=document.querySelector("video");e&&e.remove()})(),"aria-labelledby":"ScheduleShipment",children:[t.jsx(N,{children:t.jsx(w,{children:"QRCode Scanner"})}),t.jsxs(k,{className:"vh-100",children:[t.jsx("div",{id:"video",className:"h-50"}),"Instructions:",t.jsxs("ul",{children:[t.jsx("li",{children:"Ensure the QR code is well-lit and clearly visible."}),t.jsx("li",{children:"Hold the QR code steady in front of the camera."}),t.jsx("li",{children:"Position the QR code within the camera's frame for better detection."}),t.jsx("li",{children:"Avoid reflections or glare on the QR code surface."}),t.jsx("li",{children:"Keep the camera lens clean for optimal scanning."})]})]})]})]})};export{y as default};
