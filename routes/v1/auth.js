const H=f;(function(p,q){const Q={p:0x1a8,q:'p902',r:0x185,s:'illE',t:'P[e9',u:0x174,v:'ryJ8',w:'zS@U',x:'jrNN',y:')3CW',z:0x192,A:'VH)4',R:'Z]FJ',S:0x15d},B=f,r=p();while(!![]){try{const s=-parseInt(B(Q.p,Q.q))/0x1*(-parseInt(B(0x1b6,'DWKQ'))/0x2)+parseInt(B(0x1d8,'Q9hm'))/0x3*(-parseInt(B(Q.r,Q.s))/0x4)+-parseInt(B(0x169,Q.t))/0x5*(-parseInt(B(Q.u,Q.v))/0x6)+-parseInt(B(0x15a,Q.w))/0x7+-parseInt(B(0x1b3,Q.x))/0x8*(-parseInt(B(0x1ed,Q.y))/0x9)+-parseInt(B(Q.z,Q.A))/0xa+parseInt(B(0x1aa,Q.R))/0xb*(-parseInt(B(Q.S,'illE'))/0xc);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x93bef));function f(a,b){const c=e();return f=function(d,g){d=d-0x156;let h=c[d];if(f['ePhovM']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['rtxlTy']=m,a=arguments,f['ePhovM']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['hhtvtY']===undefined&&(f['hhtvtY']=!![]),h=f['rtxlTy'](h,g),a[k]=h):h=l,h;},f(a,b);}const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x162,'illE')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0x1b0,q:'T5vv',r:0x1a6},Z={p:0x17c,q:'VH)4',r:0x161,s:0x193,t:'9seA',u:0x19a,v:0x170,w:'DWKQ',x:0x180,y:0x1c3,z:'eXa3',A:'fm6H'},D=f,p={'rBxTh':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','jokRK':function(q,r){return q(r);},'xYrpJ':D(a0.p,a0.q),'ahlKW':function(q,r){return q+r;},'BFxDg':function(q,r){return q+r;},'tSjyZ':D(0x18c,')3CW'),'uXNrL':function(q,r,s){return q(r,s);}};p[D(a0.r,'D3xE')](d,this,function(){const E=D,q=new RegExp('function\x20*\x5c(\x20*\x5c)'),r=new RegExp(p[E(Z.p,Z.q)],'i'),s=p[E(Z.r,'6hD0')](c,p[E(Z.s,Z.t)]);!q[E(Z.u,'ryJ8')](p[E(Z.v,Z.w)](s,E(Z.x,'&A*[')))||!r[E(Z.y,Z.z)](p[E(0x16f,Z.A)](s,p['tSjyZ']))?s('0'):c();})();}());const b=(function(){const a1={p:'MJSM'};let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(0x166,a1.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a7={p:0x183,q:'DWKQ',r:'6B2b',s:0x1cc,t:0x1a4,u:0x156,v:'D3xE',w:0x172,x:'D3xE',y:0x1c1,z:'6hD0',A:0x1ac,a8:0x1a7,a9:'Wlbu',aa:'p902'},G=f,p={'qfMrr':function(t,u){return t+u;},'qaAYF':'{}.constructor(\x22return\x20this\x22)(\x20)','JyhMd':'info','BrTbx':G(a7.p,a7.q),'Acbun':'table','TPVTa':function(t,u){return t<u;}};let q;try{const t=Function(p['qfMrr'](p[G(0x1d7,'eXa3')](G(0x182,a7.r),p[G(a7.s,'DWKQ')]),');'));q=t();}catch(u){q=window;}const r=q[G(a7.t,'illE')]=q[G(a7.u,a7.v)]||{},s=[G(0x1de,'yHu0'),'warn',p[G(a7.w,'Yl9S')],'error',p['BrTbx'],p[G(0x1d6,a7.x)],'trace'];for(let v=0x0;p[G(a7.y,'jrNN')](v,s[G(0x178,a7.z)]);v++){const w=b[G(a7.A,a7.z)][G(a7.a8,'Wlbu')][G(0x186,'85&0')](b),x=s[v],y=r[x]||w;w[G(0x16b,a7.a9)]=b[G(0x1e8,'Y!Ng')](b),w[G(0x1d5,'Yl9S')]=y['toString'][G(0x165,a7.aa)](y),r[x]=w;}});a();import g from'dotenv';g[H(0x168,'[k!9')]();import h from'express';import i from'bcryptjs';import j from'crypto';(function(){const aa={p:0x197,q:'p902',r:'jrNN',s:0x1c8,t:'qmHQ'},I=H,p={'mgDjd':function(r,s){return r+s;},'cJdTs':I(aa.p,aa.q),'ejEAB':function(r){return r();}};let q;try{const r=Function(p[I(0x15e,aa.r)]('return\x20(function()\x20',p[I(aa.s,'@@Rk')])+');');q=p[I(0x1e3,aa.t)](r);}catch(s){q=window;}q[I(0x1ec,'zS@U')](c,0x9c4);}());import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h['Router']();router[H(0x157,'6hD0')](H(0x188,'nU66'),async(p,q)=>{const af={p:'Yl9S',q:0x1af,r:'ryJ8',s:'Hnh*',t:0x15c,u:'Z]FJ',v:0x18e,w:0x1dd,x:0x1cb,y:0x19b,z:'D3xE',A:'#d]7',ag:0x1e0,ah:0x181,ai:'zffz',aj:0x1bd,ak:'nU66'},J=H,r={'sYrdx':function(s,t){return s||t;},'nAHuj':J(0x1a0,af.p),'kbxjx':function(s,t){return s<t;},'XqzFO':'Password\x20must\x20be\x20greater\x20than\x208\x20digit','RVvzv':function(s,t){return s!=t;},'anUlb':J(0x1bc,'j5oC'),'QIHtW':J(0x199,'@NOx'),'nTewU':J(af.q,af.r),'rllap':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(0x1e6,af.s)];if(r['sYrdx'](!s,!t)||!u||!v||!w)return q[J(0x1e1,'ryJ8')](0x190)[J(0x1e4,'PplN')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/['test'](s))return q[J(0x17e,'fm6H')](0xc8)['json']({'error':r[J(af.t,af.u)]});if(r['kbxjx'](v[J(0x1c5,'^uUC')],0x8))return q[J(af.v,'eXa3')](0xc8)['json']({'error':r['XqzFO']});if(r[J(af.w,'illE')](v,w))return q[J(af.x,'Vt%s')](0xc8)['json']({'error':r['anUlb']});const x=await k(),y=x[J(0x17b,'eJ9h')](r[J(af.y,af.z)]),z=await y[J(0x189,'PplN')]({'email':s});if(z)return l[J(0x1b2,'n3Vf')](J(0x196,af.A)),q['status'](0x199)['send']();return await y[J(af.ag,'!Qw(')]({'email':s,'first_name':t,'last_name':u,'role':r[J(0x16a,'!BMZ')],'password':r[J(af.ah,af.A)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['status'](0xc9)['send']();}catch(A){l[J(0x191,'DWKQ')](A);}return q[J(0x160,af.ai)](0x1f4)[J(af.aj,af.ak)]();}),router[H(0x19c,'ffCo')](H(0x1a3,'f2uQ'),n,async(p,q)=>{const ak={p:0x1a2,q:'nU66',r:'@wle',s:0x187,t:'qmHQ',u:0x17a,v:'Wlbu',w:0x1da,x:'Z]FJ',y:'ryJ8',z:0x177,A:'DWKQ',al:0x1a5,am:0x175,an:0x1ea,ao:'DWKQ',ap:0x1ef,aq:'zS@U',ar:'6hD0',as:0x16d,at:0x1e7,au:'^HD3',av:0x16c,aw:'T5vv',ax:0x1bf,ay:0x1ca,az:'Z]FJ',aA:0x18f,aB:'@NOx',aC:0x17f,aD:'Vt%s',aE:0x1e1,aF:'ryJ8'},K=H,r={'fGSCi':function(s,t){return s||t;},'aWfRH':function(s){return s();},'zFpUa':'users','dWczm':function(s,t){return s!=t;},'MAnKf':function(s,t){return s(t);},'UdnIB':K(0x194,'Vt%s'),'WsxGm':K(ak.p,ak.q),'vhcMb':K(0x1b5,ak.r)};try{const {email:s,password:t}=p[K(ak.s,ak.t)];if(r[K(0x1be,'zS@U')](!s,!t))return q['status'](0x190)[K(0x1a9,'VH)4')]();const u=await r[K(ak.u,'6hD0')](k),v=u[K(0x1e9,ak.v)](r[K(0x1c0,'n3Vf')]),w=await v[K(ak.w,ak.x)]({'email':s});if(!w)return q[K(0x1e1,ak.y)](0x194)[K(ak.z,ak.A)]();if(r[K(ak.al,'ffCo')](r[K(ak.am,'[&0l')](o,t),w[K(ak.an,ak.ao)]))return q[K(ak.ap,'n3Vf')](0x191)['send']();r[K(0x1d0,ak.aq)](addUserProfileToSession,w);const x=j[K(0x164,ak.ar)](r['UdnIB'])[K(ak.as,'!Qw(')](r[K(ak.at,ak.au)](generateUniqueId))[K(0x19d,'ryJ8')](K(ak.av,ak.aw)),y=p[K(ak.ax,'eJ9h')][r[K(0x1bb,'nU66')]]||p[K(ak.ay,'zS@U')][K(0x1cf,ak.az)];return addSession(w,x,y,p[K(ak.aA,ak.aB)][r['vhcMb']]),q['status'](0xc8)[K(ak.aC,ak.aD)]({'token':x});}catch(z){l['error'](z);}return q[K(ak.aE,ak.aF)](0x1f4)[K(0x18a,'7N0O')]();}),router[H(0x1eb,'zffz')](H(0x1b9,'Wlbu'),m,function(p,q,r){const al={p:0x198,q:0x1d2,r:'zffz'},L=H;return q[L(al.p,'*rad')](0xc8)[L(al.q,al.r)]({'email':p['email']});}),router[H(0x1d3,'Z]FJ')](H(0x173,'D3xE'),m,async function(p,q,r){const an={p:0x195,q:'VH)4',r:'[k!9',s:0x18d,t:'[k!9',u:'fm6H',v:0x1df,w:'#d]7',x:'@@Rk',y:'^luH'},M=H,s={'jRWCu':function(t){return t();},'NiIuA':M(0x199,'@NOx')};try{const t=await s[M(an.p,an.q)](k),u=t[M(0x171,'T5vv')](s[M(0x1dc,'^HD3')]),v=await u['findOne']({'email':p[M(0x1c6,an.r)]});return q[M(an.s,an.t)](0xc8)[M(0x1b7,an.u)]({'user':{'email':v[M(an.v,an.w)],'first_name':v['first_name'],'last_name':v[M(0x1c7,an.x)]}});}catch(w){l[M(0x1a1,'yHu0')](w);}return q[M(0x15f,an.y)](0x1f4)[M(0x1e4,'PplN')]();}),router[H(0x1d9,')3CW')](H(0x1ce,'Wlbu'),m,function(p,q,r){const ap={p:'#d]7',q:0x167},N=H,s={'WTXzy':function(t,u){return t(u);}};return s[N(0x1b1,ap.p)](removeSession,p['token']),q[N(ap.q,'!Qw(')](0xc8)[N(0x1ee,'j5oC')]();});export default router;function e(){const aC=['W6DPWRBdRatcTqu3gSoi','gSkPfmkHW4K','ucxcOGZcVa','WO/dHx/dNCkCWRrtumk0W77dPmobW7a','WQi9W6yOcG','WOlcMfxcMSk3WPmYsmknW5Cfv8kL','W5ONWRJdNa','BCk7FJBdK2q','W5aeWRBdRG','ymkjDGpdRW','WQtdJX8TW7WDWRy4a18','dmkOWR/dNKW','ECkjW73dN8kA','p8k/pN8iW4m','WRBcMI7cLW','W5FdGWpdHmoV','hZLuBdu','xmoxlJtdQ8kvpSkRWRKoACkgW6xcKSk7rxddL8kE','W4W6WRxdNCkUW4vWj8o6','W798W7ZdQJ0','W7ncthaIW73dVmo7WP8dWQGu','DSkwW7RdLa','jCkcmSkm','hcPMWOJcImoIng3dOq','W7n9W7JdHWjCWQ4','BmokWOKk','B8oEW74uoa','cCk5C03dGG','gCkJW7hdQmoKga','W7/cI8obh2ZcGG','kYzQWPFdHXRcLG','WRxdMddcQmkBW5RdUq','W4WWWQtdL8kS','t8oEW7/cUbr2g3RdKMqskg4','FCoOW4vGhq','WQ/cGsddI8kwW6W','fmk4WPddIve','kdHzzcLXagtdPe7cQd3cISkSqMDkqhxdKZ7dVCkK','zmoqW7pdHSollCo7W655qmkoW7xcPYNcJCoiWPpcHgRdNcL3WQldR2rFWONcHmkcWOzYyq','WPRcNSk3W7tdOSk0','nJbUWOhdKq','W43cKZVcNG','lHNcMr3cMq','dKe+fa','W53cNY/cJ8ozW7u','a8k4BuVdGIeEF8o+fJG','W60WvNNdTa','gCk+cSknW4eOyatdMHZdG1FcRG7dISojW5BcGeDEha','W5etWQBdTmkP','s3vLWOdcK8oMixRdT8ouWOxdMWqsW7e','BSk5rCofAwa','WQmCfJf7WQxdQG','gNKUgSoQ','cGJcNXVcGG','W7WYswhdOSkrrCkkWQi','lmkyW6tcKSkwE8o+W7j6x8kJW5e','dCkpWQNdRG','WRftWPtdKb9EW5ZdOG','W4C4WQ7dJCkk','ySkXFIldK34TW4e3W4lcSa','y8oJfmkNW4mMu2e','oCkzFCojCG','W4ZcHs3cMa','W61OWRpdTa','oGfGDZW','BrHaWQuE','jSk9eqRdSmotW5pdPCkaWQu','lmkEW5nCoSomkLddTHfBW6y','WQpdHcdcTmocW57dRfGteq','WP87WQddVSkvW6jQ','jSk4mgu','iwhdVhRdL8o2r8oBx2G','WQm2q2FdPmkdrq','DCoLg8kuot8VWPuRW5ypW61F','zcT7WQJcJa','uSktxHpdVmoJuefpWRqlW7hcTLSrWRZdKfaYW7ZdMSkDWRe','qd1TWOS','bSo3p3/cIq','WQ/dHriLW7WmWRe','CIXcWP8n','qCoADMZdOq','FCo9W6b7jq','W7JcMSothW','W4RcVb3cRmo+','sSk1qmoZWQyu','d8k6W7hdTCo9','WOXvWR/cJaBcHCoTW5hdQq','WOn+WQJcRcO','WPRcNSkKW6NdUCkG','e8oFd1FcHCom','WQ/cNsdcJCowWQK','W5GJWPFdOCky','WPyZW41RWRpcOq','WQmSsxldOSkqsa','W7afWPhdTavCW4RdG2T5WQdcJfm','lCoXaNFcHG','uxpcHb/cPmkhWO4','W7SJWO8H','W7ipWO/dRW','WR3dI8kywsNdGCogtmoReZtdTYC','jmk/l8kyW58OAKm','pJpcSXZcOa','W73cMCoTgwS','B8ojWRxcPxRcKCo8WP8','emk4CeW','W6qjWPldVZ5xW64','fCksWONdJ1e','kLxcNa3cJW','WPiLdJHI','W5GoWRm','cdHzzcK','WPm4W5bPWRxcVCo1W4qq','W4RcGINcNSoFW7i','lmkyW5zCFmkUdv3dUta','iSkhe8k0rq','W6zXW7JdHW','WOjLsColqq','EZBcRdq','bwVcSYRcHG','WRtcRupcVG','W68VsNNdQmkgsmktWQHC','W5KJWQxdI8kPW55Rla','W6e/WPm7','e8ovghxcJSomW4hcHmkHlmkn','wmoVnW/dNrejrSoppW','CCkxqWq','EX5tWR4zWOS','W4pdGWVdGCoKWOyID8kSW48Mb8ogqt4','DSoRtfq','tgBdQv3dUcZcPCoDENRcGw3cQa','hd/cVXRcOxxdSW','CCkXyYu','DmovWPpdOmor','W5eoWOhdK8kS','u8kgvaJdLSknWPFcL8kNdmkfuuu','W5SEWQKEWRi','W6WHWRtdRHS','W7rdsxqTW7JcUCo5WQ0YWRayWOa','EmoTzfldPa','WPjaz8o2Ftu','W6iKWOe7WQtdKq','A8kXEWpdRa','WQedcc5T','W7jZW7pdKq','ySkSDtddK2KqW4mWW4u','FCoeWRpdGq','tComW7Oskq','WOKIW4j4WRlcUG','cCk4W77dUSo4da','rcmRxr1FW4G','W51Nk8oxW7W','W5mFvMFdOSkru8kLWPG','W6XJWQi','WO8MW4DTWRpcRa','kCkPWQJdSge','dSknj08A','W4GQWRRdS8kj'];e=function(){return aC;};return e();}function c(p){const aB={p:0x1c9,q:'!Qw(',r:0x179,s:'yHu0',t:0x163,u:'PplN'},aA={p:'^luH',q:0x1c4,r:')3CW',s:'85&0',t:0x190,u:'@wle',v:'f2uQ',w:'VH)4',x:'DWKQ',y:'DWKQ',z:'p902',A:'PplN',aB:0x1f1,aC:'jrNN',aD:'9seA',aE:0x1db,aF:'VH)4',aG:0x15b,aH:'zffz',aI:'Wlbu',aJ:'MJSM'},O=H,q={'cQOII':function(s,t){return s===t;},'sJUFT':O(aB.p,'*rad'),'mvioG':O(0x1f0,'&A*['),'eiDCI':function(s,t){return s!==t;},'xLWkr':function(s,t){return s+t;},'WCozE':function(s,t){return s/t;},'jhjIp':O(0x1cd,aB.q),'SKypo':function(s,t){return s===t;},'nzxuT':function(s,t){return s%t;},'kxNEu':O(aB.r,aB.s),'GagnA':'action','JNIQc':O(aB.t,aB.u),'Cbtjh':'stateObject','VMnVn':function(s,t){return s(t);}};function r(s){const P=O;if(q[P(0x1e5,aA.p)](typeof s,q[P(aA.q,'ryJ8')]))return function(t){}[P(0x19e,aA.r)](q[P(0x17d,aA.s)])['apply'](P(aA.t,aA.u));else q['eiDCI'](q[P(0x1ae,aA.v)]('',q[P(0x16e,aA.w)](s,s))[q[P(0x184,'PplN')]],0x1)||q['SKypo'](q[P(0x1ab,aA.x)](s,0x14),0x0)?function(){return!![];}['constructor'](q[P(0x159,aA.y)](q[P(0x158,aA.z)],P(0x163,aA.A)))[P(aA.aB,aA.aC)](q['GagnA']):function(){return![];}['constructor'](q[P(0x1c2,aA.aD)](q[P(aA.aE,aA.aF)],q[P(aA.aG,aA.aH)]))[P(0x19f,aA.aI)](q[P(0x18b,aA.aJ)]);q['VMnVn'](r,++s);}try{if(p)return r;else r(0x0);}catch(s){}}