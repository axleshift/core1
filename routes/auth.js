const F=f;(function(p,q){const O={p:0x1ae,q:'W4dv',r:0x13e,s:0x1b3,t:'!3qn',u:0x19d,v:0x1a7,w:0x169,x:0x13a},A=f,r=p();while(!![]){try{const s=parseInt(A(O.p,O.q))/0x1+-parseInt(A(0x19a,'qr0Q'))/0x2+-parseInt(A(O.r,'XCNu'))/0x3+parseInt(A(O.s,O.t))/0x4+-parseInt(A(O.u,'])2y'))/0x5+-parseInt(A(O.v,'nRWL'))/0x6*(-parseInt(A(0x1b4,'NXkw'))/0x7)+parseInt(A(O.w,'vWI]'))/0x8*(parseInt(A(O.x,'H$UQ'))/0x9);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xbc571));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Y={p:0x172,q:0x178,r:'0]2g'},X={p:0x14a,q:'kK[t',r:0x159,s:0x16f},B=f,p={'MGbDv':B(Y.p,'XCNu'),'eLKHe':function(q,r){return q+r;},'GkqVA':function(q,r){return q+r;},'sBRXR':function(q,r){return q(r);},'HLORZ':function(q,r,s){return q(r,s);}};p[B(Y.q,Y.r)](d,this,function(){const C=B,q=new RegExp(p['MGbDv']),r=new RegExp(C(0x17b,'VU(m'),'i'),s=c(C(X.p,X.q));!q['test'](p['eLKHe'](s,C(0x16b,'H)8n')))||!r[C(0x1a5,'Iqp!')](p['GkqVA'](s,C(X.r,'W1UE')))?p[C(X.s,'F7p7')](s,'0'):c();})();}());const b=(function(){const Z={p:'*TY^'};let p=!![];return function(q,r){const s=p?function(){const D=f;if(r){const t=r[D(0x160,Z.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a5={p:'NXZl',q:0x15f,r:0x174,s:'H$UQ',t:0x157,u:'clx%',v:0x143,w:0x140,x:0x14b,y:0x183,z:'jp1o',a6:0x18f,a7:0x167,a8:'nRWL',a9:'ZUCG',aa:0x196,ab:0x1b2,ac:0x1ba,ad:'NXkw',ae:'$Ufi',af:'vWI]',ag:'Gywf',ah:'TL3U',ai:0x13f,aj:'Iqp!'},E=f,p={'gzfTp':function(t,u){return t(u);},'vnvQV':function(t,u){return t+u;},'ahXGw':E(0x19f,a5.p),'hReQD':E(a5.q,'h)l9'),'kQoLA':E(a5.r,'H5o]'),'olQcb':E(0x148,a5.s),'ddcYd':E(a5.t,a5.u),'Mtojm':'exception','ecULK':E(a5.v,'H)8n')};let q;try{const t=p[E(a5.w,'W1UE')](Function,p[E(a5.x,'!3qn')](p['vnvQV'](p[E(a5.y,'$Ufi')],p[E(0x19b,a5.z)]),');'));q=t();}catch(u){q=window;}const r=q[E(a5.a6,'TL3U')]=q[E(0x13b,'H)8n')]||{},s=[E(a5.a7,a5.a8),p[E(0x1ad,a5.a9)],p['olQcb'],p[E(a5.aa,'VU(m')],p['Mtojm'],p[E(a5.ab,a5.z)],E(a5.ac,a5.ad)];for(let v=0x0;v<s['length'];v++){const w=b[E(0x173,a5.ae)][E(0x1a6,a5.af)]['bind'](b),x=s[v],y=r[x]||w;w['__proto__']=b[E(0x193,a5.ag)](b),w[E(0x151,a5.ah)]=y[E(0x181,'o02J')][E(a5.ai,a5.aj)](y),r[x]=w;}});a();import g from'dotenv';function f(a,b){const c=e();return f=function(d,g){d=d-0x13a;let h=c[d];if(f['IDTLaO']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['VMmchH']=m,a=arguments,f['IDTLaO']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['wetHfB']===undefined&&(f['wetHfB']=!![]),h=f['VMmchH'](h,g),a[k]=h):h=l,h;},f(a,b);}g[F(0x195,'3NPI')]();import h from'express';(function(){const a9={p:0x18b,q:'vWI]',r:0x168},G=F,p={'kUTrd':function(r,s){return r(s);},'zzear':function(r,s){return r+s;},'JDcWy':'return\x20(function()\x20','MXuPv':G(0x1bb,'0]2g'),'luBZi':function(r){return r();}};let q;try{const r=p[G(a9.p,'%OW7')](Function,p[G(0x191,a9.q)](p[G(a9.r,'z&eY')],p['MXuPv'])+');');q=p[G(0x171,'%OW7')](r);}catch(s){q=window;}q[G(0x16a,'KB]s')](c,0x9c4);}());import i from'bcryptjs';import j from'crypto';function e(){const az=['wSo5pI7dJ8oeu8kiWR/cHgaaWPG','y8kQW6dcP8on','aCk6rs5hWOtdRmoyiSkp','WRCvhquFw8kdjSoadelcJ8ojday','WQCCp8kpjW','WRCDkmksjG','WRldVeTAaa','r8o0W7JcPua','nmkaW75C','wG55ntK','leaJt8kSrSoYfW','WQGyfq0FcCoy','WQenbaud','lmkQCmoRldFdSbmFWRpdQCo2W4PyrmorW6JcIKvgW4ZcMSopw1pdLmohWPvgWPWZW74','WO8hWOibWO0','CWLDlCoHW7ZdG8oBCbtcOxVcOa','W5SGnSow','W5nHo1NdRJyw','le4Jsa','WRy/WRGimW','dc02W6GLCW','W508pG','W5JdTh3dMCoZ','EtuMW6uSktWKC8kQ','EgXeWOm4DdivWPmPFq','yxzCxmoQ','pa3dS8o8xG','n8o+nmk+eW','WQWaWQ00mW','j8oAe8kulW','ureSWQJdTW','dSkGAXHl','W51Xnf7dVY0kuZLVW64Dx8ozWRuc','zSkrW6xcG8oVySoraSoQqCog','ccavEa','fmo7W7VcRSkg','aJC+W6m','g8omW5/cMa','FdacWPpdGq','WRGCnCkt','WPtdSvDx','iwxdT2pcLCkxy8ouw8oQyCkVnmoEyr/dRvldUSoFWRpdSmkHcb/cJSk0W4ZdGf3cQSoDswK','WQOogWC','W6nyBmofys3dQSk9mHNdVG','A8oGW6BdHSogW4VdTZdcRCkl','D25zvmoWaq','W7BdP3JdPSoh','uuX1WOeMWQiUW4C','eCk9shaxW5e','zmkwW5pcT8oS','BKClBCk/WQVcJW','eMzCWQqSWQmj','jemCCmkK','WOLfaGvaWO9AWQ7dMa','o3v5WP8j','yCk6W7pdSCkD','cJiczmok','cCkaFtbg','i8kRW4PuWQaUF8kAuZq','t8oQW4FcVL0','WPrOnvRdPder','A8oGW6tdMComW4tdPG','pw90WRWhnG','nhPYWRyq','iJZcTgmCzq','DSo3WPuc','CSoYm0q','hmogW5pcI8kLW6K','gsRdIbhdKq','W5nPzY84','jbCVWPT+gq','CmoMW6tdGCoK','BHrMdCoIhmkWgHKQW7lcQCoK','WP7dJfz/ma','W5XcW4rCW43cU8khW7JdS198W7S/','yCoFWQGCFSoutWVdUSoLELPy','nLuFvCkU','wJT3FCk/W7xdVa7cQx53c8orA13dSCo5WRzs','a8oQj8kRoq','qSo/W6BcT0aQ','gcpdIIhdMq','CmkZW7NcHCoY','BCoYovG','BmoKl14','pNj4WQmnnIyZva','WOvJyCkmmZCIW4bkAHpdL1C','WO4FW4FcMN0B','kGrtACkyWQNcI3tdQYFcTmkLW6zLhG','rfnPWPS9','rCoYWPG1WQm','W6fwBSokyM/cHmkodI/dRmoEta','sejfWRNdUW','CabDkSoHW7/dGSo4ActcL3/cLq','W6ldN23dUG','B1r8sSogbCo3wvynnW','W55nWOddHIvhWRZdT8kGWQVdTYFcHq','WPpdVwzIpW','W4LvW7TlDKhdN1RdLWBcPCoNpa','zwXpv8ksWRBcOW','mSoXm8k/csNdQCozec8','ofPAAa','BJhcT2G','AclcQwSh','z3nCxmoO','jLTuzCkp','tWfJWQldTmoEjHWKW4VdOMtcOGxdOCkYWPRdImoSWRnLcmkFhdzCAmkECrmiW54','wxnNWRvJC3S3lCo0dG','yxftrSoRcmor','W78Kg8oGsW','vMbpWOFcL1DSner4','WOG9BGRcVxjrBxiKW7LedG','ESoOmK4','sCoGW67cHeq','gq41WOD7','leGwtCkj','DN9FwCoH','BWjZkWTBW58xWQ7dHCkl','e8oiW47cMCktW6ddISkJWOe','gsGjCSo2WRPT','swbfWPS','asO3W6i','gbddOSo5s387rCkEbCkeW5FdUSkOpezwW5mmaZLxya','f8k0c34','WO4lWRqOfW','lCogW4JcMCkPW7W','uSkDW5pcUSor','W49EaGva','WPr2p1RdOJCrwgS','nLi/uG','FmoGW5NdNSorW4hdRt4'];e=function(){return az;};return e();}import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[F(0x14c,'3NPI')]();router['post'](F(0x14f,'XCNu'),n,async(p,q)=>{const ac={p:0x149,q:'v&%z',r:'Iqp!',s:0x1b6,t:'NXkw',u:'TL3U',v:0x17e,w:0x16e,x:'!3qn',y:0x1b8,z:'eRDu',ad:0x187,ae:0x188,af:'vWI]',ag:'W4dv'},H=F,r={'PfJRY':function(s,t){return s||t;},'xinkG':function(s){return s();},'TeoMr':H(0x18a,'H5o]'),'DzoQj':H(ac.p,ac.q),'uunHk':H(0x1a4,ac.r)};try{const {email:s,first_name:t,last_name:u,password:v}=p[H(0x17a,'jp1o')];if(r['PfJRY'](!s,!t)||!u||!v)return q[H(ac.s,ac.t)]({'status':0x191});const w=await r[H(0x199,ac.u)](k),x=w[H(ac.v,'TL3U')](r[H(ac.w,ac.x)]),y=await x['findOne']({'email':s});if(y)return l[H(ac.y,ac.z)](r['DzoQj']),q[H(0x179,'clx%')]({'status':0x199});return await x[H(ac.ad,'*YBm')]({'email':s,'first_name':t,'last_name':u,'role':r[H(ac.ae,ac.af)],'password':o(v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['json']({'status':0xc9});}catch(z){l[H(0x186,ac.ag)](z),q[H(0x147,'ZUCG')]({'status':0x1f4});}}),router['post'](F(0x192,'eRDu'),n,async(p,q)=>{const aj={p:0x182,q:'%OW7',r:0x165,s:0x16d,t:'F7p7',u:0x154,v:'%OW7',w:0x189,x:'Bx0E',y:0x146,z:'H5o]',ak:'qr0Q',al:0x15c,am:0x180,an:0x17f,ao:'H)8n',ap:'H$UQ',aq:0x1a0,ar:0x15d,as:'nRWL',at:'vWI]',au:0x15b,av:0x163,aw:'Iqp!',ax:'nRWL'},I=F,r={'NZzqr':function(s,t){return s||t;},'cfurn':function(s){return s();},'bTYbd':function(s,t){return s!=t;},'PyXcc':function(s,t){return s(t);},'dWfhM':function(s,t){return s(t);},'rtVGq':I(aj.p,aj.q),'WrfgD':'hex','NwBXO':I(0x1a9,'NXkw'),'VcdmF':function(s,t,u,v,w){return s(t,u,v,w);},'ikBwl':I(0x13d,'ZUCG')};try{const {email:s,password:t}=p['body'];if(r[I(aj.r,'!3qn')](!s,!t))return q['json']({'status':0x191});const u=await r[I(aj.s,aj.t)](k),v=u[I(aj.u,aj.v)](I(aj.w,aj.x)),w=await v[I(aj.y,aj.z)]({'email':s});if(!w)return q[I(0x150,aj.ak)]({'status':0x194});if(r['bTYbd'](r['PyXcc'](o,t),w[I(aj.al,'qr0Q')]))return q['json']({'status':0x191});r[I(aj.am,'z&eY')](addUserProfileToSession,w);const x=j['createHash'](r['rtVGq'])[I(aj.an,aj.ao)](generateUniqueId())[I(0x166,aj.ap)](r[I(aj.aq,'F7p7')]),y=p[I(aj.ar,'dM4Z')][r[I(0x13c,aj.as)]]||p[I(0x190,aj.at)]['remoteAddress'];r[I(aj.au,']GzX')](addSession,w,x,y,p[I(aj.av,'XCNu')][r['ikBwl']]),q[I(0x194,aj.aw)]({'status':0xc8,'token':x});}catch(z){l['error'](z),q[I(0x162,aj.ax)]({'status':0x1f4});}}),router[F(0x1af,'z&eY')](F(0x184,'W4dv'),m,function(p,q,r){const ak={p:0x1b9,q:'H)8n'},J=F;q['json']({'status':0xc8,'email':p[J(ak.p,ak.q)]});}),router[F(0x164,'qr0Q')](F(0x14e,'*YBm'),m,async function(p,q,r){const am={p:0x156,q:0x1a3,r:'$Ufi',s:0x170,t:'VU(m',u:'F7p7',v:0x145,w:'3NPI'},K=F,s={'Ebagy':function(w){return w();},'uMrui':K(am.p,'clx%')},t=await s[K(0x197,'iq#z')](k),u=t['collection'](s[K(am.q,am.r)]),v=await u['findOne']({'email':p[K(am.s,'0]2g')]});q[K(0x176,'H$UQ')]({'status':0xc8,'user':{'email':v[K(0x1a2,am.t)],'first_name':v[K(0x1b5,am.u)],'last_name':v[K(am.v,am.w)]}});}),router['post'](F(0x18e,'XCNu'),m,function(p,q,r){const an={p:0x17c},L=F;removeSession(p['token']),q[L(an.p,'dM4Z')]({'status':0xc8});});export default router;function c(p){const ay={p:0x198,q:'%gUx',r:0x155,s:'W1UE',t:0x15a,u:'n53e',v:0x18d},ax={p:']GzX',q:0x14d,r:'$Ufi',s:0x16c,t:0x142,u:'qr0Q',v:0x1ab,w:0x141,x:0x1b7,y:'jp1o',z:0x153,ay:'qr0Q',az:'o02J'},M=F,q={'jdYXx':function(s,t){return s===t;},'CuFCd':M(ay.p,ay.q),'WcXJJ':M(ay.r,'dM4Z'),'piFqR':'counter','kRFCJ':function(s,t){return s!==t;},'QlcSM':function(s,t){return s/t;},'sPmky':M(0x1a1,ay.s),'FGpzS':function(s,t){return s%t;},'Nmhuk':M(ay.t,'])2y'),'Dbxtt':M(0x1a8,ay.u),'pTGyD':function(s,t){return s+t;},'fTkWV':'debu','jtOiu':M(0x1b0,'isil'),'apOni':function(s,t){return s(t);}};function r(s){const N=M;if(q['jdYXx'](typeof s,q['CuFCd']))return function(t){}[N(0x144,ax.p)](q[N(ax.q,ax.r)])[N(ax.s,'v&%z')](q[N(ax.t,ax.u)]);else q[N(0x175,'3NPI')]((''+q[N(ax.v,'Gywf')](s,s))[q['sPmky']],0x1)||q['jdYXx'](q['FGpzS'](s,0x14),0x0)?function(){return!![];}['constructor'](N(0x177,'3NPI')+q[N(ax.w,'%gUx')])[N(ax.x,'eRDu')](q[N(0x158,ax.y)]):function(){return![];}['constructor'](q['pTGyD'](q[N(ax.z,'$Ufi')],'gger'))[N(0x15e,'dM4Z')](q[N(0x19e,ax.ay)]);q[N(0x1aa,ax.az)](r,++s);}try{if(p)return r;else q[M(ay.v,'W1UE')](r,0x0);}catch(s){}}