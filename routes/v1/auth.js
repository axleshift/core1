const H=f;(function(p,q){const R={p:0x216,q:'pb$2',r:0x224,s:'(l6o',t:0x1c2,u:'95p(',v:0x255,w:'&@Ag',x:0x203,y:0x249,z:'19oJ',A:0x1cd,S:'xS#$'},B=f,r=p();while(!![]){try{const s=-parseInt(B(R.p,R.q))/0x1+-parseInt(B(0x1cc,'!DYQ'))/0x2*(-parseInt(B(R.r,R.s))/0x3)+-parseInt(B(R.t,R.u))/0x4+parseInt(B(R.v,R.w))/0x5+parseInt(B(R.x,'qY3o'))/0x6*(-parseInt(B(R.y,R.z))/0x7)+parseInt(B(R.A,'d)2n'))/0x8*(-parseInt(B(0x1bf,R.S))/0x9)+parseInt(B(0x1ee,'$DY3'))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xe9730));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a2={p:0x215,q:'GPur',r:0x1ff,s:'7tKN'},a1={p:'RKjJ',q:0x1ca,r:0x1b9,s:'qkar',t:0x1e3,u:0x20d,v:'6ltH',w:'7!J4',x:0x20c,y:'c62(',z:0x227,A:'(l6o'},C=f,p={'WGcLS':C(a2.p,a2.q),'jxdzh':C(0x24a,'Oo&E'),'HMSJk':function(q,r){return q(r);},'OaLrY':function(q,r){return q+r;},'tKePn':C(a2.r,a2.s),'lkxkl':function(q,r){return q+r;},'SNGTd':C(0x23a,'z)O6'),'ILJUN':function(q){return q();},'MQvas':function(q,r,s){return q(r,s);}};p['MQvas'](d,this,function(){const D=C,q=new RegExp(p[D(0x1dc,a1.p)]),r=new RegExp(p[D(0x1f9,'Oo&E')],'i'),s=p[D(a1.q,'XfzF')](c,D(a1.r,a1.s));!q[D(a1.t,'N$b9')](p['OaLrY'](s,p[D(a1.u,a1.v)]))||!r[D(0x1c0,a1.w)](p[D(a1.x,a1.y)](s,p['SNGTd']))?p['HMSJk'](s,'0'):p[D(a1.z,a1.A)](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(0x1c1,'eYl)')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ab={p:0x20a,q:'XfzF',r:0x1b7,s:0x23f,t:0x1fc,u:'&2iC',v:0x20e,w:'uxL(',x:0x1db,y:'c3q3',z:0x1f8,A:'19oJ',ac:0x202,ad:0x239,ae:'GPur',af:'7tKN',ag:0x1e4,ah:'yG]r',ai:0x1c9,aj:'pb$2',ak:0x21f,al:'d)2n',am:'Oo&E'},aa={p:0x1fd},F=f,p={'cGxIG':function(u,v){return u(v);},'CcVjx':function(u,v){return u+v;},'HUXQF':'{}.constructor(\x22return\x20this\x22)(\x20)','VTddZ':function(u){return u();},'wMmiS':'log','SnyIw':F(ab.p,ab.q),'SkwXE':'exception','PgBUQ':F(ab.r,'XfzF')},q=function(){const G=F;let u;try{u=p[G(0x205,'yG]r')](Function,p[G(aa.p,'yG]r')](G(0x208,'qkar'),p['HUXQF'])+');')();}catch(v){u=window;}return u;},r=p[F(ab.s,'95p(')](q),s=r[F(ab.t,ab.u)]=r[F(0x1d6,'S&jG')]||{},t=[p[F(ab.v,ab.w)],F(ab.x,ab.y),F(ab.z,'Tnhu'),p[F(0x244,ab.A)],p[F(ab.ac,'K8#%')],'table',p[F(0x226,'E!sz')]];for(let u=0x0;u<t[F(ab.ad,'(l6o')];u++){const v=b[F(0x243,ab.ae)][F(0x1ea,ab.af)][F(ab.ag,ab.ah)](b),w=t[u],x=s[w]||v;v[F(ab.ai,ab.aj)]=b[F(ab.ak,'HDjq')](b),v[F(0x20f,ab.al)]=x['toString'][F(0x229,ab.am)](x),s[w]=v;}});function f(a,b){const c=e();return f=function(d,g){d=d-0x1b7;let h=c[d];if(f['okUfrA']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['lCCxSs']=m,a=arguments,f['okUfrA']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['pXLTNs']===undefined&&(f['pXLTNs']=!![]),h=f['lCCxSs'](h,g),a[k]=h):h=l,h;},f(a,b);}a();import g from'dotenv';g[H(0x223,'&2iC')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';function e(){const aI=['rSo1W7tcRfrt','ghnevG8','WRLfW50f','v8odrmkY','kmoXbmobW71vAa','W5OwhSkeh8oX','W7NdHXZdRCo1W7qKW4SppcVcMfBdLav1t8kLW44','k8odqa','cCkHW4bfeW','rSoSWRNdJNLuC8oMBq','W67dTqhdRmoR','W6qLnSkQAW','WRhcLKJcMa','zmkgW6W+WODqWRKzeKOwwSk+DW','W6CeW4VcJG','ogznza','qNKxW4ba','trpdI8kiWQHU','W7NdHWxdT8oZW79fWOCnoYdcIfe','CCoYW57cKNe','W63dIWBdVmoiW7rH','ihVdIrFcTx4','W6CLWRtcKCks','oMhdJGW','FConW7u7DG','CfqwW4joWP4oWQ3cOCowW4BcJ8o7xSorW4yDW7ZdJ8k9bCkRW7aciJ/cSConaxSWW49UuY3dMJdcLIarW4JcRH7cHh0YWOebthpcRa7cTmoBWPhdRCo8Eu3dNMdcVCoaW7y3WOypu3byW7uismkiWOLuA8kXW51/rt/cICoeA3q','ufOwW4u','W6eEm8ktuYrG','DSojFmk8WOy','FhNdJrhcQwVcIG','vCo2WRFdK3G','sWBdGCkn','W77dKq3dQSo0','WPlcKKZcThu','WRNdR2GDW5PqWRZcNSkJ','vMiDW7TC','vSoTuSkFWRK','wCoGW6BcRh5ou13cOa','AttdISkgWPi','oCoPjmoIySoDWOL+W7LeW5KxgfFdRhXPrSkm','v8oftSkV','kJlcHSkptq','W5JcT2ZdSCo/Da','W6BcS2hdRSo2','vCoxWOexWQu','WRxcVbLIWQK','hmk+W6nDgcHzBq','W5WqmSoG','WR3dRw1mWOP4WPJcRCkxWOtcTW','W4SzymkH','zSo/WQxdIwfpEmoYkez2BCkbWRNcISkfWOxdHsz2WORdGK3dQsK5W4FcVwZcTvZcQCktk8oiwsy','WPNdPrldKwi','WQxcHGORx3b9vKPTcL02W6X6AW','CSobW4/dISkTWOf+DM4ZWPdcPG','WRnlxSoCwaZcGdvjcCoD','WRNcJ37cGW','WRnlxSoCsda','WRNdMNJdMxycmq','WRLpW4uubW','WRdcLGOS','WQrAxCoD','WPxcVsKhxW','wGRdGCkn','W6xdGMxdL3Cq','nutdQtNcMq','jSouWRvT','W6eEm8kgvs8','WO5gjmoScmo5CNisW4nKW5m','WRhcHrv/WO9c','W5aeW6ZcQCof','W7i6wCkaDa','W74gW4L7W6y','DCoCW78L','bCoqW7aGWOC','W6WLWOFcPSkYcW','W7pdM3BdL3u','W6GAW4bLW7dcPhTQl8kF','WR5uW48fhmkg','W4OcCCk5FW','omo4mCoJzCoa','eCk3W4tdHmkGsmoyACo0daChbWm','bmoxj8olW6y','W4tdIW9bW5K','ve1ig8kw','W6xcVJGmW7O','W6tcJmocW7SEW4y','mmojw3hdOdi','oCkmWPRcJSoUW4C','W5CtFCkYtSkM','WQLrt8oDsq','D1f6oCkjWPFdVCoClW','Fmojxmk5WR0','WRJcVKa2WR7dMG','oSk5W4pcTw0Y','W45/W59Xtq','oJpcKCkseSomvrldHsS','CmkNW57cVxy','zSo/WQxdIwfpEmoYke9SE8kgWRNcHSkpW5hcGJLYWP/dLua','WQdcNaO7x2TNwX4Oja','rSk7W5xcM3m','WQxcKfZcIupdPW','awDiCtS5WRFcJ8oOW6zXvZ93hgldRgBdICksWRS','sXFdJSkDWQL4','W7noW457BW','jmoJWPRdOZnVwHvaWQZcOge','s8kEW41QpNNdMSkhjSkMWPZdPSkqWQi9D8ovA8oUWPKylNBdISomsKjIEhqCgIZdQa','W5BdMHPEW6m','awDSyHm','kCkHWRFcN8ov','WPZdIaNdHW','BSo2WQFcVSo6','W5iFuCktbCoSWOLhumorW64YWOFcRmk5W5ZdTIlcK8krW4NcNMhdPspdRcFdPmo7dCkTW54','omoaW6iKBa','W7GqW4jT','omoPpSoZ','umo2zHum','W5xcHY1BW4rgW47cTmk1W4ZdHCkIWPe','pmkiW7jmbG','oZlcLCkdwG','W4ugm8oQ','iSoIoCoJ','iCooW6iGWOe','WPXssmojwmk1WRr4wmoZW6yj','W6ykW5ZcJ8oGjsq3WP44','lmorW54LWOm','W7tcHCopWQu','BSkEug8vichdKq','rSkoW6vB','W74HWPBcVSk+','WQOBWOmNjCkkWOvxDJXOW7dcJW','W4mremkE','xSk0W6dcOgu','W5pdT1KIWRq3WP0','WQRdGaBdIKjeyrJdK0fwe17dQgaGWOy7wSoOWRjAAW','W5dcRXBdIW7cRMas','W7JcT3xdOa','fCkNWOVcImo0W4bzFeG','bW3cP8kQva','WRvaW6ZcPW','WRK2W6HeW5tcGMK','xCoJWOCExcHExSoDWQFcSG','C8kdW4BcVh4','WRddPM5lWOOKWRNcRmk/WQxcLHa','W4VcVHCcW7e','W7mgW4dcMa','sSoZWPZcNq','l0HBwcq','BSkyfaLfzKZdOSoABZNcHmka','vSoUW7NcTerdrLNcQSkE','W7xdMxNdJxyBia','WRXbW6BcQmo4W5tcO8kbWPVcVq','W6NcT3FdTSoUDbxdLuGTW74','jCoqWQH6W4ilW75n','p8oVnSoHW4S','WQ7cVeyX','WOH0W6dcHCoF','W7GbW419W6dcTa','vSofrmkLWOOfWPDfWODjW5C','kSoUaCodW7a','lCoZWPHnW4a'];e=function(){return aI;};return e();}import l from'../../src/logger.js';import{addSession,removeSession,getUser}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[H(0x20b,'c62(')]();router[H(0x212,'(l6o')]('/register',async(p,q)=>{const ah={p:'!ci%',q:'Jczd',r:'aP0n',s:0x209,t:0x21c,u:0x1f1,v:'k9qO',w:0x1d3,x:'l46T',y:'pb$2',z:'pO#)',A:'Sx[n',ai:0x1f6,aj:'Tnhu',ak:0x1cb,al:'7tKN',am:0x234,an:'vqIR',ao:0x22d,ap:'!DYQ',aq:0x24c,ar:0x23b,as:0x22f,at:0x1ba,au:'EiFw'},I=H,r={'DsKJP':function(s,t){return s||t;},'bLrqy':I(0x246,'l46T'),'KaLra':function(s,t){return s<t;},'gAeHs':I(0x213,'7tKN'),'cHyQm':function(s,t){return s!=t;},'JrAGm':function(s){return s();},'InRrD':I(0x201,ah.p),'FGlpt':I(0x1c6,ah.q),'qtblE':I(0x218,ah.r),'nZzRC':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[I(ah.s,'yG]r')];if(r[I(0x1f4,'v[u7')](!s,!t)||!u||!v||!w)return q[I(0x225,'uxL(')](0x190)[I(ah.t,'GPur')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[I(0x1c0,'7!J4')](s))return q['status'](0xc8)['json']({'error':r[I(ah.u,ah.v)]});if(r[I(0x1c4,'19oJ')](v['length'],0x8))return q['status'](0xc8)['json']({'error':r[I(ah.w,ah.x)]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/['test'](v))return q[I(0x238,ah.y)](0xc8)[I(0x1d2,ah.z)]({'error':I(0x1fa,'k9qO')});if(r[I(0x233,ah.A)](v,w))return q[I(ah.ai,ah.aj)](0xc8)[I(ah.ak,'RKjJ')]({'error':I(0x242,ah.al)});const x=await r[I(ah.am,ah.an)](k),y=x[I(ah.ao,ah.ap)](r[I(ah.aq,'l46T')]),z=await y['findOne']({'email':s});if(z)return l['error'](r['FGlpt']),q['status'](0x199)[I(0x200,'HDjq')]();return await y[I(ah.ar,'vqIR')]({'email':s,'first_name':t,'last_name':u,'role':r[I(ah.as,'(l6o')],'password':r[I(ah.at,ah.au)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[I(0x1e1,'v[u7')](0xc9)['send']();}catch(A){l['error'](A);}return q[I(0x1e6,'1B6U')](0x1f4)[I(ah.t,'GPur')]();}),(function(){const am={p:0x248},al={p:0x221,q:'Tnhu',r:0x24b,s:0x1e2,t:'l46T'},J=H,p={'fKAZY':function(s,t){return s(t);},'qYlNW':function(s,t){return s+t;},'PzzFX':J(0x250,'1B6U'),'keunx':function(s){return s();}},q=function(){const K=J;let s;try{s=p[K(al.p,al.q)](Function,p['qYlNW'](p[K(al.r,'Sx[n')](K(0x1e7,'!ci%'),p[K(al.s,al.t)]),');'))();}catch(t){s=window;}return s;},r=p[J(am.p,'95p(')](q);r['setInterval'](c,0x9c4);}()),router[H(0x1ed,'K8#%')](H(0x23e,'19oJ'),n,async(p,q)=>{const as={p:'cOYl',q:0x1bd,r:'EiFw',s:0x22a,t:0x1d5,u:'v[u7',v:'eYl)',w:'!ci%',x:'qkar',y:'1tmD',z:0x230,A:'Jczd',at:'RKjJ',au:'yG]r',av:0x1f2,aw:'19oJ',ax:'qY3o',ay:0x1ec,az:0x240,aA:'XfzF',aB:'z)O6',aC:'1B6U',aD:0x22b},L=H,r={'cEFWA':function(s,t){return s||t;},'JDhRE':function(s){return s();},'xtRCU':L(0x228,'!DYQ'),'OIVdo':function(s,t){return s!=t;},'IcvoC':L(0x236,'IXvD'),'CaMyM':function(s){return s();},'fVjnz':L(0x1e8,as.p),'mabwF':'x-forwarded-for','fTkJW':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p['body'];if(r[L(as.q,as.r)](!s,!t))return q['status'](0x190)[L(0x252,'!DYQ')]();const u=await r[L(as.s,'EiFw')](k),v=await u[L(as.t,as.u)](r[L(0x1f7,as.v)])[L(0x1f5,as.w)]({'email':s});if(!v)return q[L(0x247,'HDjq')](0x194)[L(0x253,as.x)]();if(r[L(0x232,as.y)](o(t),v[L(0x1d9,'$DY3')]))return q[L(as.z,'qkar')](0x191)[L(0x24e,as.A)]();const w=j[L(0x1d7,as.at)](r[L(0x23c,as.au)])[L(as.av,'HDjq')](r[L(0x1d0,'qY3o')](generateUniqueId))[L(0x245,'K8#%')](r[L(0x1ce,as.aw)]),x=p['headers'][r[L(0x235,as.ax)]]||p[L(0x237,as.p)][L(0x1f3,'!ci%')];return r[L(as.ay,'&2iC')](addSession,v,w,x,p['headers'][L(as.az,as.aA)]),q[L(0x219,as.aB)](0xc8)[L(0x1c3,as.aC)]({'token':w});}catch(y){l['error'](y);}return q[L(as.aD,'eYl)')](0x1f4)[L(0x222,'$DY3')]();}),router[H(0x1fb,'k9qO')](H(0x1fe,'Tnhu'),m,function(p,q,r){const at={p:0x1c8,q:'c62('},M=H;return q['status'](0xc8)[M(0x210,'x]bN')]({'email':p['email'],'role':p[M(at.p,at.q)]});}),router[H(0x1f0,'l46T')](H(0x251,'Oo&E'),m,async function(p,q,r){const av={p:'!ci%',q:0x1dd,r:'!DYQ',s:'S&jG',t:'E!sz',u:'19oJ',v:0x22b,w:'E!sz'},N=H,s={'eWitl':function(t,u){return t(u);}};try{const t=await s[N(0x1eb,av.p)](getUser,p['token']);return q[N(av.q,av.r)](0xc8)['json']({'user':{'email':t[N(0x22c,av.s)],'first_name':t[N(0x1bc,av.t)],'last_name':t[N(0x206,'v[u7')]}});}catch(u){l[N(0x241,av.u)](u);}return q[N(av.v,'eYl)')](0x1f4)[N(0x1d1,av.w)]();}),router['post'](H(0x21a,'S&jG'),m,function(p,q,r){const aw={p:0x21b,q:'N$b9',r:0x22e,s:0x1b8},O=H;return removeSession(p[O(aw.p,aw.q)]),q[O(aw.r,'N$b9')](0xc8)[O(aw.s,'x]bN')]();});export default router;function c(p){const aH={p:'S&jG',q:0x1e5,r:'1tmD',s:0x23d,t:'c3q3',u:0x217},aG={p:'$DY3',q:0x1d8,r:'c62(',s:0x1e9,t:'d)2n',u:0x254,v:')z1X',w:0x21e,x:0x214,y:'Jczd',z:0x207,A:'HDjq',aH:0x1ef,aI:0x1df,aJ:'pO#)'},P=H,q={'cYLeN':function(s,t){return s===t;},'xBCDu':P(0x220,aH.p),'vDqBM':P(aH.q,aH.r),'mjYoR':function(s,t){return s!==t;},'tqGNB':function(s,t){return s+t;},'VNMOt':function(s,t){return s/t;},'vHurL':'length','JsMMu':function(s,t){return s%t;},'EEezL':'gger','TYBel':P(aH.s,aH.t),'QWeoN':P(0x21d,'z)O6'),'vWxJe':P(aH.u,'z)O6'),'NvTMh':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(0x24d,'pb$2')](typeof s,q[Q(0x1e0,aG.p)]))return function(t){}[Q(aG.q,aG.r)]('while\x20(true)\x20{}')[Q(aG.s,aG.t)](q['vDqBM']);else q[Q(aG.u,aG.v)](q[Q(0x1da,'1tmD')]('',q[Q(aG.w,'GPur')](s,s))[q[Q(aG.x,aG.y)]],0x1)||q['JsMMu'](s,0x14)===0x0?function(){return!![];}['constructor'](q['tqGNB']('debu',q['EEezL']))[Q(0x1be,'IXvD')](q[Q(0x256,'d)2n')]):function(){return![];}[Q(0x1de,'yG]r')](q['tqGNB'](q[Q(aG.z,aG.A)],Q(aG.aH,'E!sz')))[Q(aG.aI,'1tmD')](q[Q(0x204,'k9qO')]);q[Q(0x24f,aG.aJ)](r,++s);}try{if(p)return r;else r(0x0);}catch(s){}}