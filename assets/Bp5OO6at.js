import{r as e,j as a,R as s}from"./Oq9P1Wj_.js";import{F as l,R as t,N as r,f as i,h as n,I as c,S as o,g as d,T as h,U as m,V as x}from"./CehKozqE.js";import{b as p,e as j}from"./BJf5-03J.js";import{p as u}from"./2aPQtUzY.js";import{A as v}from"./Bzftd6m0.js";import{c as g,P as b,Q as y,aa as f,ab as N,ac as w,ad as S,ae as k,af as C,ag as _,a as P,b as T,i as A,$ as E,o as R,p as K,a0 as L,S as F,W as D,T as I,X as q,ah as U,R as O,a3 as M,a4 as z,a5 as W,a6 as B,a7 as $}from"./B1wsI-8q.js";import{R as V}from"./eGqyD3ZN.js";import{P as G}from"./NdsU5MZw.js";import{d as H}from"./Ce_fjdqS.js";import"./deeEeel3.js";import"./CewSaW8v.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./B0pL_gbQ.js";import"./DhxmCZ7v.js";import"./fHQ1LRrH.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./b9dqFv80.js";import"./VSWDZ_lP.js";import"./B2NO97j6.js";import"./BIq-TSdk.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";import"./BXWkExu4.js";const Q=()=>{const{addToast:s}=p(),[l,t]=e.useState(!0),[r,i]=e.useState([]),[n,c]=e.useState(1),[o,d]=e.useState(0);return e.useEffect((()=>{(async e=>{axios.post("/sec/management/activity",{page:e}).then((e=>{i(e.data.data),d(e.data.totalPages)})).catch((e=>{var a,l;const t=(null==(l=null==(a=e.response)?void 0:a.data)?void 0:l.error)||"Server is offline or restarting please wait";s(t)})).finally((()=>t(!1)))})(n)}),[n]),l?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[a.jsx(b,{className:"mb-4",children:a.jsxs(y,{children:[a.jsx(f,{children:"Activity Logs"}),a.jsxs(N,{hover:!0,responsive:!0,className:"table-even-width",children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"User ID"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Session ID"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Event"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Location"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Device"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Time"})]})}),a.jsx(C,{children:r.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.user_id}),a.jsx(_,{children:e.session_id}),a.jsx(_,{children:e.event}),a.jsx(_,{children:"::1"===e.ip_address||"::ffff:127.0.0.1"===e.ip_address?"localhost":e.ip_address}),a.jsx(_,{children:e.user_agent}),a.jsx(_,{children:u(e.time)})]},s)))})]})]})}),o>1&&a.jsx(v,{currentPage:n,setCurrentPage:c,totalPages:o,setTotalPages:d})]})},X=()=>{const r=s.useRef(),{addToast:i}=p(),[n,c]=e.useState(!0),[o,d]=e.useState({apiToken:[],deny:!0}),[h,m]=e.useState(1),[x,E]=e.useState(0);return e.useEffect((()=>{(async e=>{axios.post("/sec/management/apikeys",{page:e}).then((e=>{d(e.data.data),E(e.data.totalPages)})).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))})(h)}),[h]),n?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):0==o.apiToken.length?a.jsx(P,{className:"justify-content-center my-5",children:a.jsx(T,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no apikeys yet."}),a.jsx("p",{children:"Check it out later"})]})})}):a.jsxs("div",{children:[a.jsx(V,{ref:r,size:"invisible",sitekey:j}),a.jsx("h4",{children:"Deactivate all apikeys"}),a.jsx(b,{className:"mb-3",children:a.jsxs(y,{children:[a.jsx("p",{children:"Clearing all active apikeys will deny future incoming requests."}),a.jsxs(A,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:o.deny,onClick:async()=>{const e=await r.current.executeAsync();c(!0),axios.post("/sec/management/apikeys/deactivate",{recaptcha_ref:e}).then((e=>window.location.reload())).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))},children:[a.jsx(l,{icon:t,className:"me-2"})," Deactivate all apikeys"]})]})}),a.jsx(b,{children:a.jsxs(y,{children:[a.jsx(f,{children:"API keys"}),a.jsxs(N,{hover:!0,responsive:!0,className:"table-even-width",children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"User"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Token"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Whitelist"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Device"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Last Accessed"})]})}),a.jsx(C,{children:o.apiToken.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.user_id}),a.jsx(_,{children:e.active?"Active":"Inactive"}),a.jsx(_,{children:e.token}),a.jsx(_,{children:e.whitelist_ip.map((e=>e.split(",")[0])).join(" ")}),a.jsx(_,{children:e.user_agent}),a.jsx(_,{children:e.last_accessed?u(e.last_accessed):"Never"})]},s)))})]})]})}),x>1&&a.jsx(v,{currentPage:h,setCurrentPage:m,totalPages:x,setTotalPages:E})]})},Y=({color:e,title:s,value:l,data:t})=>a.jsx(E,{color:e,value:l,title:s,action:a.jsx(R,{alignment:"end",children:a.jsx(K,{color:"transparent",caret:!1,className:"text-white p-0"})}),chart:a.jsx(L,{className:"mt-3",style:{height:"70px"},data:{labels:Array(10).fill(""),datasets:[{label:"Data",backgroundColor:"rgba(255,255,255,.2)",borderColor:"rgba(255,255,255,.55)",data:t,fill:!0}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!1}},elements:{line:{borderWidth:2,tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4}},animation:{duration:0}}})});Y.propTypes={color:G.string.isRequired,title:G.string.isRequired,value:G.any.isRequired,data:G.any.isRequired};const Z=()=>{const[s,l]=e.useState(null),[t,r]=e.useState(!0),{addToast:i}=p(),[n,c]=e.useState([]),[o,d]=e.useState([]),h=e=>{const a=e.filter((e=>0!==e)),s=a.reduce(((e,a)=>e+a),0),l=a.length;return 0===l?0:s/l},m=async()=>{axios.get("/metrics/prometheus").then((e=>{const a=e.data;l(a),((e,a,s,l)=>{const t=(e+a)/(Date.now()/1e3-l);d((e=>[...e,parseFloat(t.toFixed(2))]))})(parseFloat(a.process_cpu_user_seconds_total[0].value),parseFloat(a.process_cpu_system_seconds_total[0].value),parseFloat(a.process_cpu_seconds_total[0].value),parseFloat(a.process_start_time_seconds[0].value)),c((e=>[...e,parseFloat(a.process_cpu_seconds_total[0].value.toFixed(2))]))})).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l,"Submit failed!")})).finally((()=>r(!1)))};return e.useEffect((()=>{m();const e=setInterval((()=>{m()}),5e3);return()=>clearInterval(e)}),[]),s?a.jsx("div",{children:a.jsxs(P,{xs:{gutter:4},children:[a.jsx(T,{sm:6,xl:4,xxl:3,children:a.jsx(Y,{color:"primary",title:"Average Load Time",value:`${h(o).toFixed(2)}ms`,data:o})}),a.jsx(T,{sm:6,xl:4,xxl:3,children:a.jsx(Y,{color:"danger",title:"CPU Usage",value:`${h(n).toFixed(2)}%`,data:n})})]})}):""},J=()=>{const{addToast:s}=p(),[t,i]=e.useState(!0),[n,c]=e.useState([]),[o,d]=e.useState(""),[h,m]=e.useState(0),[x,j]=e.useState(0),[v,A]=e.useState(0);return e.useEffect((()=>{(async()=>{axios.get("/sec/management/dependabot").then((e=>c(e.data))).catch((e=>{var a,l;const t=(null==(l=null==(a=e.response)?void 0:a.data)?void 0:l.error)||"Server is offline or restarting please wait";s(t)})).finally((()=>i(!1)))})()}),[]),t?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):0===n.length?a.jsx(P,{className:"justify-content-center my-5",children:a.jsx(T,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no alerts yet."}),a.jsx("p",{children:"Check it out later"})]})})}):a.jsxs("div",{children:[a.jsxs(F,{className:"d-flex justify-content-left my-2 my-lg-0",children:[a.jsxs(D,{className:"mb-3",children:[a.jsx(I,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:o,onChange:e=>d(e.target.value)}),a.jsx(q,{id:"basic-addon",children:a.jsx(l,{icon:r})})]}),a.jsx("div",{className:"mx-2"}),a.jsx(U,{value:v,onChange:e=>A(e.target.value),options:[{label:"All",value:0},{label:"Resolved",value:1},{label:"Unresolved",value:2},{label:"Not Plan",value:3}],required:!0,className:"mb-3"}),a.jsx("div",{className:"mx-2"}),a.jsx(U,{value:x,onChange:e=>j(e.target.value),options:[{label:"All",value:0},{label:"High",value:1},{label:"Medium",value:2},{label:"Low",value:3}],required:!0,className:"mb-3"}),a.jsx("div",{className:"mx-2"}),a.jsx(U,{value:h,onChange:e=>m(e.target.value),options:[{label:"Newer",value:1},{label:"Older",value:2}],required:!0,className:"mb-3"})]}),a.jsx(b,{children:a.jsxs(y,{children:[a.jsx(f,{children:"Vulnerability Alerts"}),a.jsxs(N,{hover:!0,responsive:!0,className:"table-even-width",children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"State"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Scope"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Manifest"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"CVE"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Summary"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Severity"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Last Updated"})]})}),a.jsx(C,{children:n.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.state}),a.jsx(_,{children:e.scope}),a.jsx(_,{children:e.manifest}),a.jsx(_,{children:e.cve}),a.jsx(_,{children:e.summary}),a.jsx(_,{children:e.severity}),a.jsx(_,{children:u(new Date(e.updated_at).getTime())})]},s)))})]})]})})]})},ee=()=>{const r=s.useRef(),{addToast:i}=p(),[n,c]=e.useState(!0),[o,d]=e.useState(!1);return e.useEffect((()=>{(async()=>{axios.get("/sec/management/maintenance").then((e=>d(e.data.maintenance||"a"))).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))})()}),[]),n?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[a.jsx(V,{ref:r,size:"invisible",sitekey:j}),a.jsx("h4",{children:"Enable maintenance"}),a.jsx(b,{children:a.jsxs(y,{children:[a.jsx("p",{children:"When enabled, it prevents users from interacting with the platform until maintenance is complete."}),a.jsxs(A,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:o,children:[a.jsx(l,{icon:t,className:"me-2"})," Enable maintenance"]})]})})]})},ae=()=>{const{addToast:s}=p(),[t,i]=e.useState(!0),[n,c]=e.useState([]),[o,d]=e.useState(""),[h,m]=e.useState(0),[x,j]=e.useState(0),[v,A]=e.useState(0);return e.useEffect((()=>{(async()=>{axios.get("/sec/management/sentry").then((e=>c(e.data))).catch((e=>{var a,l;const t=(null==(l=null==(a=e.response)?void 0:a.data)?void 0:l.error)||"Server is offline or restarting please wait";s(t)})).finally((()=>i(!1)))})()}),[]),t?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):0===n.length?a.jsx(P,{className:"justify-content-center my-5",children:a.jsx(T,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no issues yet."}),a.jsx("p",{children:"Check it out later"})]})})}):a.jsxs("div",{children:[a.jsxs(F,{className:"d-flex justify-content-left my-2 my-lg-0",children:[a.jsxs(D,{className:"mb-3",children:[a.jsx(I,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:o,onChange:e=>d(e.target.value)}),a.jsx(q,{id:"basic-addon",children:a.jsx(l,{icon:r})})]}),a.jsx("div",{className:"mx-2"}),a.jsx(U,{value:v,onChange:e=>A(e.target.value),options:[{label:"All",value:0},{label:"Resolved",value:1},{label:"Unresolved",value:2},{label:"Not Plan",value:3}],required:!0,className:"mb-3"}),a.jsx("div",{className:"mx-2"}),a.jsx(U,{value:x,onChange:e=>j(e.target.value),options:[{label:"All",value:0},{label:"High",value:1},{label:"Medium",value:2},{label:"Low",value:3}],required:!0,className:"mb-3"}),a.jsx("div",{className:"mx-2"}),a.jsx(U,{value:h,onChange:e=>m(e.target.value),options:[{label:"Newer",value:1},{label:"Older",value:2}],required:!0,className:"mb-3"})]}),a.jsx(b,{children:a.jsxs(y,{children:[a.jsx(f,{children:"Error Reports"}),a.jsxs(N,{hover:!0,responsive:!0,className:"table-even-width",children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Title"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Culprit"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Level"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Priority"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Count"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Last Updated"})]})}),a.jsx(C,{children:n.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.title}),a.jsx(_,{children:e.culprit}),a.jsx(_,{children:e.level}),a.jsx(_,{children:e.status}),a.jsx(_,{children:e.priority}),a.jsx(_,{children:e.count}),a.jsx(_,{children:u(new Date(e.updated_at).getTime())})]},s)))})]})]})})]})},se=()=>{const r=s.useRef(),{addToast:i}=p(),[n,c]=e.useState(!0),[o,d]=e.useState([]),[h,m]=e.useState(1),[x,P]=e.useState(0);return e.useEffect((()=>{(async e=>{axios.post("/sec/management/sessions",{page:e}).then((e=>{d(e.data.data),P(e.data.totalPages)})).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))})(h)}),[h]),n?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[a.jsx(V,{ref:r,size:"invisible",sitekey:j}),a.jsx("h4",{children:"Logout all sessions"}),a.jsx(b,{className:"mb-3",children:a.jsxs(y,{children:[a.jsx("p",{children:"Clearing all active sessions will log everyone out."}),a.jsxs(A,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",onClick:async()=>{const e=await r.current.executeAsync();c(!0),axios.post("/sec/management/sessions/logout",{recaptcha_ref:e}).then((e=>window.location.reload)).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))},children:[a.jsx(l,{icon:t,className:"me-2"})," Logout all sessions"]})]})}),a.jsx(b,{className:"mb-4",children:a.jsxs(y,{children:[a.jsx(f,{children:"Sessions"}),a.jsxs(N,{hover:!0,responsive:!0,className:"table-even-width",children:[a.jsx(w,{children:a.jsxs(S,{children:[a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"User ID"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Location"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Device"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),a.jsx(k,{className:"text-muted poppins-regular table-header-cell-no-wrap",children:"Last Accessed"})]})}),a.jsx(C,{children:o.map(((e,s)=>a.jsxs(S,{children:[a.jsx(_,{children:e.user_id}),a.jsx(_,{children:"::1"===e.ip_address||"::ffff:127.0.0.1"===e.ip_address?"localhost":e.ip_address}),a.jsx(_,{children:e.user_agent}),a.jsx(_,{children:e.active?"Active":"Inactive"}),a.jsx(_,{children:u(e.last_accessed)})]},s)))})]})]})}),x>1&&a.jsx(v,{currentPage:h,setCurrentPage:m,totalPages:x,setTotalPages:P})]})},le=()=>{const r=s.useRef(),{addToast:i}=p(),[n,c]=e.useState(!0),[o,d]=e.useState([]);e.useState(""),e.useState(0),e.useState(0);const[h,m]=e.useState(0),[x,u]=e.useState([]);e.useEffect((()=>{(async()=>{axios.get("/sec/management/ip-filtering").then((e=>d(e.data))).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))})()}),[]);return n?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[a.jsx(V,{ref:r,size:"invisible",sitekey:j}),a.jsxs(O,{color:"warning",className:"small",children:[a.jsx(l,{icon:t,className:"me-2"})," Block or allow specific set of address on who can access this platform."]}),a.jsxs(P,{className:"align-items-center mb-2",children:[a.jsx(T,{children:a.jsx("h4",{className:"mb-0",children:"IP Filtering"})}),a.jsxs(T,{className:"text-right d-flex justify-content-end",children:[a.jsx(A,{color:"primary",onClick:()=>{u([...x,{ip:"",checked:!1}])},children:"New"}),a.jsx(A,{color:"danger",onClick:()=>{u(x.filter((e=>!e.checked)))},className:"ms-2",children:"Delete"})]})]}),a.jsx(P,{className:"align-items-center mb-2",children:a.jsxs(T,{className:"d-flex align-items-center",children:[a.jsx("span",{className:"me-3",children:"Filter Mode:"}),a.jsxs(U,{"aria-label":"Select whitelist or blacklist",onChange:e=>m(e.target.value),className:"w-auto",children:[a.jsx("option",{value:"0",children:"Whitelist"}),a.jsx("option",{value:"1",children:"Blacklist"})]})]})}),x.map(((e,s)=>a.jsxs("div",{className:"d-flex mb-2",children:[a.jsx("input",{className:"me-3",type:"checkbox",checked:e.checked,onChange:e=>((e,a)=>{const s=[...x];s[e].checked=a,u(s)})(s,e.target.checked)}),a.jsx(I,{type:"text",value:e.ip,onChange:e=>((e,a)=>{const s=[...x];s[e].ip=a,u(s)})(s,e.target.value),placeholder:"Enter IP address"})]},s))),a.jsx(A,{color:"primary",onClick:async()=>{const e=await r.current.executeAsync();c(!0),axios.post("/sec/management/ip-filtering",{recaptcha_ref:e,ipList:x}).then((e=>i("Changes saved successfully","Success"))).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))},children:"Apply all changes"}),a.jsxs("div",{className:"text-muted",children:["Examples:",a.jsxs("ul",{children:[a.jsx("li",{children:"Single IP: 192.168.100.1"}),a.jsx("li",{children:"Prefix IP: 192.168.100.1/24"}),a.jsx("li",{children:"IP Range: 192.168.100.1-192.168.100.200"})]})]})]})},te=()=>{const r=s.useRef(),{addToast:i}=p(),[n,c]=e.useState(!0),[o,d]=e.useState([]);e.useState(""),e.useState(0),e.useState(0);const[h,m]=e.useState(0),[x,u]=e.useState([]);e.useEffect((()=>{(async()=>{axios.get("/sec/management/ip-filtering").then((e=>d(e.data))).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))})()}),[]);const v=(e,a)=>{const s=[...x];s[e].ip=a,u(s)};return n?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[a.jsx(V,{ref:r,size:"invisible",sitekey:j}),a.jsxs(O,{color:"warning",className:"small",children:[a.jsx(l,{icon:t,className:"me-2"})," Block or allow specific set of geolocation on who can access this platform."]}),a.jsxs(P,{className:"align-items-center mb-2",children:[a.jsx(T,{children:a.jsx("h4",{className:"mb-0",children:"GeoLocation Filtering"})}),a.jsxs(T,{className:"text-right d-flex justify-content-end",children:[a.jsx(A,{color:"primary",onClick:()=>{u([...x,{ip:"",checked:!1}])},children:"New"}),a.jsx(A,{color:"danger",onClick:()=>{u(x.filter((e=>!e.checked)))},className:"ms-2",children:"Delete"})]})]}),a.jsx(P,{className:"align-items-center mb-2",children:a.jsxs(T,{className:"d-flex align-items-center",children:[a.jsx("span",{className:"me-3",children:"Filter Mode:"}),a.jsxs(U,{"aria-label":"Select whitelist or blacklist",onChange:e=>m(e.target.value),className:"w-auto",children:[a.jsx("option",{value:"0",children:"Whitelist"}),a.jsx("option",{value:"1",children:"Blacklist"})]})]})}),x.map(((e,s)=>a.jsxs("div",{className:"d-flex mb-2",children:[a.jsx("input",{className:"me-3",type:"checkbox",checked:e.checked,onChange:e=>((e,a)=>{const s=[...x];s[e].checked=a,u(s)})(s,e.target.checked)}),a.jsx(I,{type:"text",value:e.latitude,onChange:e=>v(s,e.target.value),placeholder:"Enter Latitude",className:"me-2"}),a.jsx(I,{type:"text",value:e.longitude,onChange:e=>v(s,e.target.value),placeholder:"Enter Longitude"})]},s))),a.jsx(A,{color:"primary",onClick:async()=>{const e=await r.current.executeAsync();c(!0),axios.post("/sec/management/ip-filtering",{recaptcha_ref:e,geoLocationList:x}).then((e=>i("Changes saved successfully","Success"))).catch((e=>{var a,s;const l=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.error)||"Server is offline or restarting please wait";i(l)})).finally((()=>c(!1)))},children:"Apply all changes"})]})},re=()=>{const[s,t]=e.useState(0),[r,p]=e.useState(!0),j=H(),u=window.location.hash?window.location.hash.substring(1):"",v=(e,a)=>{j(`#${a}`)};return e.useEffect((()=>{switch(u||0!=u.length||v(0,"dashboard"),u){case"dashboard":t(0);break;case"sessions":t(1);break;case"dependabot":t(2);break;case"sentry":t(3);break;case"access-token":t(4);break;case"activity":t(5);break;case"maintenance":t(6);break;case"ip-filtering":t(7);break;case"geo":t(8)}p(!1)}),[]),r?a.jsx("div",{className:"loading-overlay",children:a.jsx(g,{color:"primary",variant:"grow"})}):a.jsx("div",{children:a.jsxs(M,{activeItemKey:s,className:"mb-4",children:[a.jsxs(z,{variant:"underline-border",children:[a.jsxs(W,{"aria-controls":"dashboard-tab-pane",itemKey:0,onClick:()=>v(0,"dashboard"),children:[a.jsx(l,{icon:i,className:"me-1"})," Dashboard"]}),a.jsxs(W,{"aria-controls":"sessions-tab-pane",itemKey:1,onClick:()=>v(0,"sessions"),children:[a.jsx(l,{icon:n,className:"me-1"})," Sessions"]}),a.jsxs(W,{"aria-controls":"dependabot-tab-pane",itemKey:2,onClick:()=>v(0,"dependabot"),children:[a.jsx(l,{icon:c,className:"me-1"})," Dependabot"]}),a.jsxs(W,{"aria-controls":"sentry-tab-pane",itemKey:3,onClick:()=>v(0,"sentry"),children:[a.jsx(l,{icon:o,className:"me-1"})," Sentry"]}),a.jsxs(W,{"aria-controls":"access-token-tab-pane",itemKey:4,onClick:()=>v(0,"access-token"),children:[a.jsx(l,{icon:d,className:"me-1"})," Access Token"]}),a.jsxs(W,{"aria-controls":"activity-tab-pane",itemKey:5,onClick:()=>v(0,"activity"),children:[a.jsx(l,{icon:h,className:"me-1"})," Activity"]}),a.jsxs(W,{"aria-controls":"maintenance-tab-pane",itemKey:6,onClick:()=>v(0,"maintenance"),children:[a.jsx(l,{icon:m,className:"me-1"})," Maintenance"]}),a.jsxs(W,{"aria-controls":"ip-filtering-tab-pane",itemKey:7,onClick:()=>v(0,"ip-filtering"),children:[a.jsx(l,{icon:x,className:"me-1"})," IP Filtering"]}),a.jsxs(W,{"aria-controls":"geo-tab-pane",itemKey:8,onClick:()=>v(0,"geo"),children:[a.jsx(l,{icon:x,className:"me-1"})," Geo"]})]}),a.jsxs(B,{children:[a.jsx($,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:a.jsx(Z,{})}),a.jsx($,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:a.jsx(se,{})}),a.jsx($,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:a.jsx(J,{})}),a.jsx($,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:a.jsx(ae,{})}),a.jsx($,{className:"py-3","aria-labelledby":"access-token-tab-pane",itemKey:4,children:a.jsx(X,{})}),a.jsx($,{className:"py-3","aria-labelledby":"activity-tab-pane",itemKey:5,children:a.jsx(Q,{})}),a.jsx($,{className:"py-3","aria-labelledby":"maintenance-tab-pane",itemKey:6,children:a.jsx(ee,{})}),a.jsx($,{className:"py-3","aria-labelledby":"ip-filtering-tab-pane",itemKey:7,children:a.jsx(le,{})}),a.jsx($,{className:"py-3","aria-labelledby":"geo-tab-pane",itemKey:8,children:a.jsx(te,{})})]})]})})};export{re as default};
