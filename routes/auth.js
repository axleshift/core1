const J=f;(function(p,q){const R={p:0x20c,q:'[p0m',r:0x208,s:'Ww]t',t:0x1fd,u:'7S&x',v:0x218,w:'Nm%7',x:0x1ed,y:'I%bD',z:'bO*V',A:'v@3d',S:'8QOB',T:'4k9O'},B=f,r=p();while(!![]){try{const s=parseInt(B(R.p,R.q))/0x1*(-parseInt(B(R.r,R.s))/0x2)+parseInt(B(R.t,'P!hE'))/0x3*(-parseInt(B(0x276,'[p0m'))/0x4)+parseInt(B(0x241,R.u))/0x5*(parseInt(B(R.v,R.w))/0x6)+-parseInt(B(R.x,'2vat'))/0x7*(parseInt(B(0x25d,R.y))/0x8)+parseInt(B(0x271,R.z))/0x9*(parseInt(B(0x1fc,R.A))/0xa)+parseInt(B(0x245,R.S))/0xb+parseInt(B(0x224,'MHRn'))/0xc*(parseInt(B(0x21e,R.T))/0xd);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xcefcb));const d=(function(){const S={p:0x277,q:'Nm%7'};let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(S.p,S.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:0x25a},a0={p:'1$n1',q:0x25e,r:'Iq5)',s:0x286,t:0x217,u:'4k9O',v:0x222,w:'mMD7',x:0x28a,y:'lJ[U'},D=f,p={'CRfji':function(q,r){return q(r);},'yEdyW':function(q,r){return q+r;},'DCHFw':function(q,r){return q+r;},'MLyQn':D(a1.p,'NOwu'),'dCZPk':function(q){return q();}};d(this,function(){const E=D,q=new RegExp(E(0x204,'Ww]t')),r=new RegExp(E(0x258,a0.p),'i'),s=p[E(a0.q,a0.r)](c,E(a0.s,'D7cW'));!q[E(0x26c,'7s2A')](p['yEdyW'](s,E(0x25b,'byNE')))||!r[E(a0.t,a0.u)](p[E(0x1f7,'bw[$')](s,p[E(a0.v,a0.w)]))?p[E(a0.x,a0.y)](s,'0'):p['dCZPk'](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(0x228,'Ww]t')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ac={p:0x26b,q:0x288,r:'NOwu',s:0x21a,t:'bO*V',u:0x21d,v:'7Cyi',w:'D7cW',x:0x1f5,y:'GX3X',z:'P!hE',A:0x227,ad:'Iq5)',ae:0x275,af:'UALz',ag:0x28b,ah:'7S&x',ai:0x1f8,aj:'0k#J',ak:0x263,al:0x26a,am:'7s2A',an:0x287,ao:'I%bD'},ab={p:0x27a,q:0x1f4,r:'0k#J',s:0x269},G=f,p={'qMyhz':function(u,v){return u(v);},'NYsym':function(u,v){return u+v;},'hCJnG':function(u,v){return u+v;},'aFigx':G(ac.p,'P!hE'),'vqJwA':function(u){return u();},'JfDWg':G(ac.q,ac.r),'UaFHt':G(ac.s,ac.t),'dDlGS':'error','AlqLF':G(ac.u,'jWoH'),'THyxl':'table','qVejx':G(0x28d,ac.v),'qYXHb':function(u,v){return u<v;}},q=function(){const H=G;let u;try{u=p['qMyhz'](Function,p[H(ab.p,'D7cW')](p[H(ab.q,ab.r)]('return\x20(function()\x20',p[H(ab.s,'8QOB')]),');'))();}catch(v){u=window;}return u;},r=p[G(0x21c,ac.w)](q),s=r['console']=r[G(ac.x,'NOwu')]||{},t=[p[G(0x292,ac.y)],'warn',p[G(0x264,ac.z)],p[G(ac.A,ac.ad)],p[G(ac.ae,'NOwu')],p['THyxl'],p['qVejx']];for(let u=0x0;p['qYXHb'](u,t['length']);u++){const v=b[G(0x1eb,ac.af)][G(ac.ag,ac.ah)][G(ac.ai,ac.aj)](b),w=t[u],x=s[w]||v;v[G(ac.ak,'jWoH')]=b[G(0x23c,'2vat')](b),v[G(ac.al,ac.am)]=x[G(ac.an,ac.ao)][G(0x24e,'NOwu')](x),s[w]=v;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';(function(){const ah={p:0x266,q:'5ewL',r:0x22b,s:'jWoH',t:'5ewL',u:'jWoH',v:0x250,w:0x278,x:0x200},I=f,p={'DmpOt':function(r,s){return r(s);},'xKqBC':function(r,s){return r+s;},'zHfTJ':function(r,s){return r+s;},'tipiL':I(ah.p,ah.q),'HGwCA':I(ah.r,ah.s),'mFCiK':function(r){return r();}};let q;try{const r=p[I(0x202,ah.t)](Function,p[I(0x253,ah.u)](p[I(ah.v,'[p0m')](p[I(ah.w,'bO*V')],p[I(ah.x,'@RaN')]),');'));q=p[I(0x27b,'jWoH')](r);}catch(s){q=window;}q[I(0x1ff,'J)6%')](c,0x9c4);}());import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x1eb;let h=c[d];if(f['ifpwtM']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['xDfERd']=m,a=arguments,f['ifpwtM']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['zFFJJc']===undefined&&(f['zFFJJc']=!![]),h=f['xDfERd'](h,g),a[k]=h):h=l,h;},f(a,b);}import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[J(0x291,'4k9O')]();router['post'](J(0x21f,'7Cyi'),async(p,q)=>{const ak={p:0x28f,q:'v@3d',r:0x290,s:'GX3X',t:0x209,u:0x236,v:'NOwu',w:'D7cW',x:0x284,y:0x207,z:'@RaN',A:0x22f,al:'pu0R',am:0x20d,an:'bW0n',ao:0x261,ap:0x1ec,aq:'45WD',ar:'1D!U',as:0x265,at:'P!hE',au:'Ww]t',av:'$8uC',aw:0x20e,ax:'XWxJ',ay:0x1f0},K=J,r={'KbiDB':K(0x1ee,'bw[$'),'PwhPN':function(s,t){return s<t;},'kFVyn':K(ak.p,ak.q),'dVDYl':function(s,t){return s!=t;},'EpeSi':K(ak.r,'bW0n'),'ZKJnn':K(0x233,ak.s),'hvZHl':'Email\x20id\x20already\x20exists','opuQt':K(0x280,'R)6i')};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(!s||!t||!u||!v||!w)return q[K(0x20b,'TjQR')](0xcc)['send']();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(0x211,'lJ[U')](s))return q[K(ak.t,'45WD')](0xc8)['json']({'error':r[K(ak.u,ak.v)]});if(r[K(0x206,'1$n1')](v[K(0x285,ak.w)],0x8))return q['status'](0xc8)[K(ak.x,'4k9O')]({'error':r[K(ak.y,ak.z)]});if(r[K(ak.A,ak.al)](v,w))return q[K(ak.am,'XWxJ')](0xc8)[K(0x283,ak.an)]({'error':r[K(ak.ao,'Ww]t')]});const x=await k(),y=x[K(ak.ap,'[p0m')](r[K(0x22d,'D7cW')]),z=await y['findOne']({'email':s});if(z)return l[K(0x212,ak.aq)](r[K(0x23f,'D7cW')]),q[K(0x294,ak.ar)](0x199)[K(0x252,'7LtG')]();return await y[K(ak.as,ak.at)]({'email':s,'first_name':t,'last_name':u,'role':r[K(0x27e,ak.au)],'password':o(v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(0x259,ak.av)](0xc9)[K(ak.aw,ak.ax)]();}catch(A){l[K(0x254,'7S&x')](A);}return q[K(0x25c,'2bTo')](0x1f4)[K(ak.ay,'qnJ&')]();}),router['post'](J(0x293,'0k#J'),n,async(p,q)=>{const ar={p:0x244,q:0x1f2,r:0x262,s:0x234,t:0x24f,u:'7Cyi',v:0x260,w:0x27f,x:'MHRn',y:'GX3X',z:0x214,A:'MHRn',as:0x282,at:'2bTo',au:'Nm%7',av:0x272,aw:'J)6%',ax:0x239,ay:'Iq5)',az:0x249,aA:'UALz',aB:0x28c,aC:0x235,aD:'@Jq(',aE:0x215,aF:'5ewL',aG:'qnJ&',aH:'I%bD',aI:0x248,aJ:0x1f9,aK:'7S&x'},L=J,r={'jkFwD':function(s,t){return s||t;},'OJrrh':function(s){return s();},'VIyOk':L(ar.p,'@Jq('),'WBlIo':function(s,t){return s!=t;},'cygIC':function(s,t){return s(t);},'eKoCS':function(s){return s();},'NgfPj':L(ar.q,'v@3d'),'FfuFB':L(ar.r,'bw[$'),'mhfeD':function(s,t,u,v,w){return s(t,u,v,w);},'Qvhsr':L(ar.s,'M3I*')};try{const {email:s,password:t}=p[L(ar.t,ar.u)];if(r[L(ar.v,'Ww]t')](!s,!t))return q[L(ar.w,ar.x)](0xcc)[L(0x24c,'HpX5')]();const u=await r['OJrrh'](k),v=u[L(0x22c,'TjQR')](r[L(0x281,'Iq5)')]),w=await v['findOne']({'email':s});if(!w)return q[L(0x205,'GX3X')](0x194)[L(0x221,'@Jq(')]();if(r[L(0x220,ar.y)](r[L(ar.z,ar.A)](o,t),w['password']))return q['status'](0x191)[L(ar.as,ar.at)]();addUserProfileToSession(w);const x=j[L(0x203,ar.au)](L(ar.av,ar.aw))['update'](r[L(ar.ax,'45WD')](generateUniqueId))[L(0x232,ar.ay)](r[L(ar.az,ar.aA)]),y=p[L(0x23a,'7S&x')][r[L(ar.aB,'pi2S')]]||p[L(0x223,'*s5b')][L(ar.aC,ar.aD)];return r[L(ar.aE,ar.aF)](addSession,w,x,y,p['headers'][r[L(0x246,ar.aG)]]),q[L(0x27d,'pi2S')](0xc8)[L(0x279,ar.aH)]({'token':x});}catch(z){l[L(ar.aI,ar.au)](z);}return q[L(ar.aJ,ar.aK)](0x1f4)['send']();}),router['post'](J(0x213,'jWoH'),m,function(p,q,r){const as={p:0x274,q:'@RaN'},M=J;return q[M(as.p,as.q)](0xc8)[M(0x23e,'7S&x')]({'email':p[M(0x1fa,'*s5b')]});}),router[J(0x1f1,'1D!U')]('/user',m,async function(p,q,r){const au={p:'bW0n',q:0x240,r:'I%bD',s:0x1f6,t:0x243,u:0x25f,v:'UALz',w:'bw[$',x:0x1fb,y:'Nm%7',z:0x1fe,A:'D7cW'},N=J,s={'VVXdw':function(t){return t();},'sHEgw':N(0x1f3,au.p)};try{const t=await s['VVXdw'](k),u=t['collection'](s[N(au.q,au.r)]),v=await u[N(au.s,'lJ[U')]({'email':p[N(0x25f,'UALz')]});return q[N(0x24b,'qnJ&')](0xc8)[N(au.t,'gz0M')]({'user':{'email':v[N(au.u,au.v)],'first_name':v[N(0x231,au.w)],'last_name':v[N(au.x,'v@3d')]}});}catch(w){l[N(0x210,'bO*V')](w);}return q[N(0x242,au.y)](0x1f4)[N(au.z,au.A)]();}),router['post'](J(0x27c,'MHRn'),m,function(p,q,r){const aw={p:0x273,q:0x20f,r:'bO*V',s:'bW0n'},O=J,s={'MzEMQ':function(t,u){return t(u);}};return s[O(aw.p,'JWE[')](removeSession,p[O(aw.q,aw.r)]),q['status'](0xc8)[O(0x247,aw.s)]();});function e(){const aI=['W4jTDmoufuC','kMmEWOq','W6mWDKGJ','tmk5W4ToW6SGW4eWWPKlemkKW4e','uCkpWOVcRSk1','W77cU8k8pq','W5rRz8opeG','W7/dQ27cVJm','W4/cOtyIW71s','C8knWOlcQCkYqW','wf3dVZa','Dmkxz8kkW7Gmo8kmha','qmoDWRDi','W5KUtwK','W6xdS8odd0W','W5fbWRFcMa','W6RdGKr6','W7/cNCoWW5ldMq','W5rKWQBdMCov','WQhcSZBcUSkf','W7jHDmoHja','sfFdVYFdSqC1WPi4bmo3','cg1oWOPobSo5zaJdGSkKW5y3d3NcTsLKaWKLWQtcT1XHWQJcUmodWOjjW4dcIGuq','C2W8WPtdPgu','s8oAWQLzW6q','WQXcrXhdHq','h0DXCCoNAa','W5i9zZCCg383WPT5','WQRcLJJdVSkB','W5tdOwNcHZu','W59pWPpcMMy','W7buWRdcVKS','DMVcMMHZuez8rMtcU8kqm8kinq','W5JcICoXW6ldTsVdP8owkG','AmortupcJG','vmoEEg7cImkCFIvn','ad44WOngmtZcNCkuWQaDEdBcHSoFvv4EWOC','WPDGpM8bFZOQWOPQW7ybt8k8W5y','W70nW6RdI8oc','hmogWPuCWQi','WRlcOmolCSoLcSoxbG','rSonjwJcLCkgqJ9AWPVcH8o8bqNcM8k7vmksl8oZt8o3W5ddVSonWRhdHmkpiSoVWO5J','WRlcQSoRCG','WQn0j1W2W4NcT1ddKW','dmo7mCkwW5W','zxzlW4qDEmkjfq','WOJcTc7dUmkl','W4XiWRvnWQanhSofpxOrW4ddJW','awldJCoVW5PH','c8oaWO7dJSog','AaaseKZcVG','y8oyWQHGW5y','WQFdVCoKpv7cNb0','W5bPzComgq','WOKqW7isW5u','WOP7og0','omkzACkjga','W6RcKmocW7NdKq','ASooo8kKW5OTgq','zXyWW4GkWRq','W5PuWQdcVfy','nSownCk3W4aR','mCoBW5i/','WR/cJsFdM8kz','h1z+yq','W6FcRCk9nW','cbldPM8','gSkLDmkxawC','h8kUC8ke','WPrNbhCwnNW5','tSoBWR4','WRpcTYFcOSkzlZddMmk1W402','CCojv8owW5S','W4fKWRVdGSoiW408W4Oo','uGqKW7O9','W48ZshmV','W5BdQ23cNa','WPdcOJxcPCkldYddLSoWW4m3W5tdO8o+y8kZimkkWOOiralcQLlcTgH4W4HFgYlcJSk6W5VdQLFdTW','W53cV8kHkSkZcmkXisj5W740W4tcOCoCymojAtldSmoIdmox','ma7dVhuRWPK','W4VcOJT2kq','lIeiWQH2jq','WRBdLuZdTCkeeG','W5ldO2BcNs3cGX3dLftcMmkm','W7ZdLmojn2pcKGBdKmoEnq','WPZdU3D4WQfmDCoZW6vSAG','rYJcIMzTtKmUr2ZcVSouoCohjSkGWO4ip8kCtq','wqeKmSkNi38zmaxcImkw','C8kCWO3cUq','WRxdJL7dTq','WQJcPJ4','W7JcRCk3k8k3','Aq4TWQfy','qCoBWRDFW79zpW','vmoYx8oyW71vW4u','sGxcTef2','yYqjWQS','W4jIWRxdGSosW4O','scpdG1uL','WQZcOJxcOSkJdJpdN8k1','W7ldSX/cG8ktnGxdGa','bmkbpd7dJCoCAtngWQ/cKSoJ','bCkLDmku','aw/dMmkuWOeJvCkYWRhcLmkQ','uZmejxG','CxmpWOZdTW','nJy8WRLa','W5jRCmobfffkw8oCEq','W5nrWRVcJLBdQJ9EkCkLfwFdGSo6A8kR','W7lcSb5vo8oF','bdf6W7eG','CdiLh1C','WOatW6hcI0tdJXfvua','W4SbW4RdP8oUWPO','qSonjSkG','lHuWWRu3W74','WQ7cJSkweKVcPstdLmog','vCoCjCkHD2a','vConkSkX','WOKwW6KEW7C','WPGlW7auW6S','rSo+qSoi','W50hW5NdVmoP','WQJcOmoKW6ldSZNdSq','jSoBm8kkW7y','hZmQWPnW','W4u/W4mDW4ftqq','fGtdUNu','WOiPjSkruWeYF8oNuGr8ba','d8kjpJJdICkyCdjhWQtcGa','WPqxW6qu','WQvZiaTJWRddHNddGSkDWQ4Iaa','amkXumkhna','W6lcRSoIW7xdQIVdOCoMgW','v1pcVtz7W5pcK1BdKtZdV8k8','WPqZthCJW7rnB8kC','W5BcHHnOiq','W6uMFv4','zSkva8k2ra','xIhdGvCSWQe','CCksBmkAW608jSkKmG','kSoFWQxdPmoJWOe','gGNcPMlcVezWWRG9i8oMW5FcQG','WO3cGdldK8kH','W5ruWQxcGvS','fCkVB8kEawRdIq','hSoHWPax','W7ZcQ8kVW7pdTthdU8o9bXpdMSofWQdcGMuPW7yRWObvAMLyeSogW60vhvpdPwG+','pG49WQ0NW67cNCogW6PJ','lmklumkEgW','FXFdIvuE','W5raWQXzWPS','wmoEFCo7W4u','Ac/cJNr1EeLVt2q','WO3cRtNdSCkbdq','W7tcTXPtpq','W5tcQCkfW5FcRmkvW5nMWRFdGG','W6qMFLuKW6dcT1hdRSkSWO4zaa','ACowWRbOW5i','igfXsCor','W7tdUhNcIbi','W50+W4tdKmoi','W5LZWRxdKSocW4S2','WQRcKcRcUSk4','W4ZcQYWV','gCoPi8kYrxzEWPO','W5TLWRVdMa','hSk2qmk4gq','WPnaeMqt','WOaMWO3dK8ouW60DW7q'];e=function(){return aI;};return e();}export default router;function c(p){const aH={p:0x267,q:0x28e,r:'UALz',s:0x251,t:'v@3d',u:'lJ[U'},aG={p:0x23b,q:'v@3d',r:0x229,s:'D7cW',t:'45WD',u:'$8uC',v:0x225,w:0x22a,x:'8QOB',y:'2vat',z:0x256,A:'Iq5)',aH:0x22e},P=J,q={'jSllD':function(s,t){return s===t;},'EtqfK':P(aH.p,'I%bD'),'ExAXY':function(s,t){return s!==t;},'qkRlf':function(s,t){return s+t;},'LRaLC':function(s,t){return s/t;},'CxaAD':P(aH.q,aH.r),'AKPuF':P(aH.s,'Ww]t'),'RYkiW':P(0x289,aH.t),'IYeUi':function(s,t){return s(t);},'jELGw':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(aG.p,aG.q)](typeof s,'string'))return function(t){}['constructor'](q[Q(0x238,'UALz')])[Q(0x255,aG.q)](Q(aG.r,aG.s));else q[Q(0x268,aG.t)](q[Q(0x201,aG.u)]('',q[Q(0x237,'2bTo')](s,s))[Q(aG.v,'JWE[')],0x1)||q['jSllD'](s%0x14,0x0)?function(){return!![];}[Q(0x257,'HpX5')](Q(0x20a,'XWxJ')+q['CxaAD'])[Q(aG.w,aG.x)](Q(0x24a,aG.y)):function(){return![];}['constructor'](q['AKPuF']+q[Q(aG.z,'Nm%7')])[Q(0x270,aG.A)](q[Q(aG.aH,'*s5b')]);q[Q(0x26e,'MHRn')](r,++s);}try{if(p)return r;else q[P(0x230,aH.u)](r,0x0);}catch(s){}}