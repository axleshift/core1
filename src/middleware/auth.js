function e(){const aj=['W7PIWPpdVb1Iz38','k8oCb8oCWOSTCCovANJcK8oICa','WRrwW7WxkSkiWQnPlvBcRa','W7hdNYBdLg53wW','W50QWOhdPuy','dmkgpCkdhq','WRddOCkzpq','lmo5WQFdSga','fSkLWRRdTSoN','hCoIWO0qqGOXW5nhomkYW5eBzSo6WPCSW5KZ','W6iWWQBdO0K','W4i9eSkpWR4','imozd8oFWO4Qemozt0tcNmos','e8koW43cQa','mSkNbmonWOqAcW','W4RcNv8ziG','W4Gik8kjWPW','WO/cHLGmWPu','W5WljCkVWPO','WP1jCmoYCG','WRDkWOvQW4O2ECouyxBdL8kxoSoqWPi','W6qBWONdJq','FrlcQ8ofW4NcJtH5hCoA','W5VcTLqdWPHCW58','xmobnrvwWPbYWOPHW6a','z0u+BXNdV8obqIxcM38','WQrOpmouAmk/W6SBWRC','tGBcMSoEW4e','hmkaBKvy','W4vlv8kxnHZcTCofySkvqW','W5a6WQxdNua','W6aSpCk/WQ3dMa','WRVdPSkrnG','WRrvW78llG','CbNcTh1Z','W6qBWPpdOg/dVSozWQVcHSkMoW','WO3cILqmWPu','W6yKfmkvWQG','W7GOmCk0WRW','mCkVhCoqjq','WO7cLMPHW7lcSq','WRnqaSkZ','W7VdVb/dGgi','W6u0WPBdJfe','gmoEWORdNN/cV8olW6tdG8o/','gSodWOZdVe0','CmkfiSoiWOu','pJtcN8oQuG','WPvzbSo8Dmkw','WOPzbSo/','W5FdTaVdL3S','W6WdW4NdIM7dPmopWQ3cGSkYnmkDsCkGW5ZdS8odWOlcOuVdQ8oeWOegrxldJ8kXCSkEb0S','WQldQCkdmq','W78SimkRWRddN080','WPX4vmoyva','WOdcLmk8telcICkqsG','WPRcJwyrWOLWW5iX','Bd5/vmkL','eCk6W7veWPK','WR3dM8o8','eYiNW7hdLw4Emq','W61tzhtcPG','W6ygu8oYuCoJWQVcTSoyWORcP1dcTG','W4tcVg0U','W4qpWOxdPfC','W7n9uCkrfW','WOTHWPeZW4a','W6PvzgpcPHm4W47cG8kSW5i','cwxcQSkxW4pdMwFdKYBcRa','w3uGBGldUCoBFG4','xmkcxmkEW5G','bGldJSkA','BCkjtCkB','sCoxWPBdVSo1CCkZumktrmkIW5BcIG','W6pdQIZdGfi','W7FdGJRdIhm','W7NdLXqKW7/cLq','WPZcKNT5W74','FSktrSoRW6m','WQFcJuOKqt9njdtcLeldPs9aWOLn','W7PoA2tcTY4VW4FcKSkGW5q','kHZcSmom','WRpcLKrGWRJdKSoTW7xcRdPKlW','l3GwcSo4lmkEWPtcTSozW4xdUmow','nmoRomkTz8oRWOhcKIdcPMNdU8knW77cNcNcQ8kLW50uwmoiWQz1WOqWh8oyWPJcPcxdJuGe','W7xdIrrXa2fZb2FdLxtcVW','bCkWWR7dR8oSW6zKW7pcTCkYtHmzW6BdIgJdISk9oG','bIey','WPXzr8oZwq','jruKW47dIq','W5/dPvnz','cSkiyuLCWOPQWQ1h','uSk+yCoLW63cK2GKW4XKmwXf','WQnwW7Kbma','WP7cJwvMW6JcRL8','pbPLlL7cUCkbsZBcVemFWPK','W45IsfJcLG','WOhdQI1UAutdJe58W7K6BKq','fSkaW4BcVG','k8oyc8kCW55CmmoLCa'];e=function(){return aj;};return e();}(function(h,i){const C={h:'UVbs',i:0x154,j:'D18!',k:'^KZF',l:'ZM*3',m:0x137,n:'i!)6'},r=f,j=h();while(!![]){try{const k=parseInt(r(0x139,C.h))/0x1*(parseInt(r(C.i,'QMuY'))/0x2)+-parseInt(r(0x18f,'u%d!'))/0x3+-parseInt(r(0x18d,C.j))/0x4*(-parseInt(r(0x148,C.k))/0x5)+parseInt(r(0x18c,'Lk4Y'))/0x6+parseInt(r(0x171,C.l))/0x7*(-parseInt(r(C.m,'9aub'))/0x8)+parseInt(r(0x183,C.n))/0x9+-parseInt(r(0x150,'wJJd'))/0xa*(-parseInt(r(0x152,'&@@w'))/0xb);if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0x88ab9));const d=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const M={h:0x189,i:'*vNF',j:'Hgje'},L={h:0x136,i:'n*4%',j:0x182,k:'UVbs',l:'Hgje',m:0x14d,n:0x179,o:'9aub',p:'6%@$'},s=f,h={'ixvdJ':s(M.h,'u%d!'),'KdajL':s(0x18e,'yiQi'),'WCMOU':function(i,j){return i(j);},'SqbMV':function(i,j){return i+j;},'pfglA':s(0x15e,M.i),'wvGcb':'input','MXSfa':function(i){return i();},'rJqeP':function(i,j,k){return i(j,k);}};h[s(0x165,M.j)](d,this,function(){const t=s,i=new RegExp(h[t(0x17c,'n]Y#')]),j=new RegExp(h['KdajL'],'i'),k=h[t(L.h,L.i)](c,t(0x130,'4#V5'));!i[t(L.j,L.k)](h[t(0x17a,L.l)](k,h[t(L.m,'3@yI')]))||!j[t(L.n,L.o)](k+h[t(0x168,'^KZF')])?h[t(0x13f,')Lzv')](k,'0'):h[t(0x188,L.p)](c);})();}());const b=(function(){let h=!![];return function(i,j){const N={h:'Z91l'},k=h?function(){const u=f;if(j){const l=j[u(0x142,N.h)](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const W={h:0x190,i:'Z91l',j:0x13e,k:'Hgje',l:'Hgje'},V={h:0x14c,i:0x16c,j:'fRjW',k:0x12f},v=f,h={'PBvwC':function(k,l){return k(l);},'EDCpz':function(k,l){return k+l;},'BXPKn':function(k,l){return k+l;},'xLtbd':v(W.h,W.i),'JTfLG':function(k){return k();}},i=function(){const w=v;let k;try{k=h[w(V.h,'@R*n')](Function,h[w(V.i,V.j)](h[w(V.k,'Ienr')](h['xLtbd'],w(0x16d,'Hgje')),');'))();}catch(l){k=window;}return k;},j=h[v(W.j,W.k)](i);j[v(0x15d,W.l)](c,0x9c4);}());const a=b(this,function(){const a1={h:0x143,i:'L^2x',j:0x185,k:'&@@w',l:0x160,m:'n*4%',n:'Hgje',o:0x170,p:0x15c,q:'m!sC',a2:0x134,a3:'(q^9',a4:0x184,a5:0x17b,a6:0x14a,a7:0x159,a8:0x153,a9:'i!)6',aa:0x17f,ab:0x140,ac:'Ienr',ad:0x172},x=f,h={'uNAJH':function(l,m){return l(m);},'qWCFg':function(l,m){return l+m;},'DEUPS':x(a1.h,a1.i),'PFpRH':'{}.constructor(\x22return\x20this\x22)(\x20)','ZpsKM':function(l){return l();},'MgunA':x(0x15a,'FbiO'),'qZdgS':x(a1.j,'fRjW'),'UYhuU':x(0x131,a1.k),'DAxQE':x(a1.l,'@R*n'),'iusGE':x(0x177,a1.m),'NtAWg':function(l,m){return l<m;}};let i;try{const l=h[x(0x144,a1.n)](Function,h[x(a1.o,'3@yI')](h['DEUPS'],h['PFpRH'])+');');i=h[x(a1.p,a1.q)](l);}catch(m){i=window;}const j=i[x(a1.a2,'x)qf')]=i[x(0x13d,'fRjW')]||{},k=['log','warn',h[x(0x155,a1.a3)],h[x(a1.a4,'fRjW')],h[x(a1.a5,'gl1^')],h[x(a1.a6,'@R*n')],h['iusGE']];for(let n=0x0;h[x(0x145,'@R*n')](n,k[x(a1.a7,'@R*n')]);n++){const o=b[x(a1.a8,'9X0N')]['prototype'][x(0x147,a1.a9)](b),p=k[n],q=j[p]||o;o[x(a1.aa,'9X0N')]=b[x(a1.ab,'FbiO')](b),o[x(0x176,a1.ac)]=q[x(a1.ad,'*vNF')][x(0x181,'@H6o')](q),j[p]=o;}});a();import{getUser,isActiveToken}from'../components/sessions.js';import g from'../models/db.js';import{ObjectId}from'mongodb';function f(a,b){const c=e();return f=function(d,g){d=d-0x12d;let h=c[d];if(f['TAUnBz']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['SWQTWB']=m,a=arguments,f['TAUnBz']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['oZqzsx']===undefined&&(f['oZqzsx']=!![]),h=f['SWQTWB'](h,g),a[k]=h):h=l,h;},f(a,b);}const adminRoute=[],auth=async(h,i,j)=>{const a7={h:0x16f,i:0x14b,j:'*vNF',k:'6%@$',l:0x156,m:'&@@w',n:'Lk4Y',o:0x175,p:0x169,q:0x141,a8:'@gDX',a9:0x162,aa:'LJDc'},a6={h:0x166,i:'ws(['},y=f,k={'YoyVb':y(a7.h,'@R*n'),'wICJL':function(p,q){return p(q);},'rjQTM':function(p,q){return p(q);},'kHUBg':function(p,q){return p!==q;},'WHABz':y(a7.i,a7.j),'arjNW':function(p){return p();}},l=h['headers'][y(0x132,a7.k)];if(!l)return i['status'](0x191)[y(0x14f,'Hgje')]();const m=l[y(a7.l,a7.m)]('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/['test'](m))return i[y(0x186,a7.n)](0x191)['send']();const [n,o]=await Promise[y(a7.o,'Nc^4')]([k[y(a7.p,'@jx@')](getUser,m),k['rjQTM'](isActiveToken,m)]);if(!n||adminRoute['includes'](h[y(0x16e,'FbiO')])&&k['kHUBg'](n['role'],k[y(a7.q,'ws([')]))return i['status'](0x191)[y(0x16b,a7.a8)]();if(!o)return i[y(a7.a9,'x)qf')](0x191)['send']();return Promise[y(0x12d,'Ienr')]([((async()=>{const z=y,p=await g();p[z(a6.h,a6.i)](k[z(0x161,'yiQi')])['updateOne']({'token':m},{'$set':{'last_accessed':Date['now']()}});})())]),h[y(0x133,a7.aa)]=m,h['user']=n,k[y(0x167,'ws([')](j);};export default auth;function c(h){const ai={h:0x14e,i:'E%my',j:0x16a,k:'@gDX',l:0x138},ah={h:0x174,i:'MtVH',j:0x15b,k:'LJDc',l:0x149,m:'9aub',n:'gl1^',o:'@R*n',p:0x12e,q:'3@yI',ai:'Hgje',aj:0x18b,ak:'UVbs',al:0x187,am:0x17d,an:'n*4%'},A=f,i={'Awmaz':'string','qIkYJ':A(ai.h,ai.i),'tbRUe':'counter','TdqAs':function(k,l){return k!==l;},'clmop':function(k,l){return k/l;},'Ejjzf':A(ai.j,ai.k),'zDACy':function(k,l){return k===l;},'jmGMq':function(k,l){return k+l;},'qvPmj':A(0x163,'0Enw'),'GDBtA':A(ai.l,'i!)6'),'Enbqd':function(k,l){return k+l;},'iLWgc':function(k,l){return k(l);}};function j(k){const B=A;if(typeof k===i['Awmaz'])return function(l){}[B(0x13c,'LJDc')](i['qIkYJ'])['apply'](i[B(ah.h,ah.i)]);else i['TdqAs']((''+i[B(ah.j,ah.k)](k,k))[i['Ejjzf']],0x1)||i[B(ah.l,ah.m)](k%0x14,0x0)?function(){return!![];}[B(0x157,ah.n)](i[B(0x15f,ah.o)](i[B(ah.p,ah.q)],i[B(0x158,ah.ai)]))[B(ah.aj,'@jx@')]('action'):function(){return![];}[B(0x18a,'n*4%')](i[B(0x180,ah.ak)](i[B(0x173,'D18!')],i['GDBtA']))[B(ah.al,'x)qf')](B(ah.am,ah.an));i[B(0x164,'fRjW')](j,++k);}try{if(h)return j;else j(0x0);}catch(k){}}