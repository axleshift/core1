const I=f;(function(p,q){const P={p:'bjBt',q:0x1a1,r:'HqAA',s:0x1c3,t:'@WjP',u:0x1c2,v:'P2T)',w:0x1a5,x:'1G)&'},A=f,r=p();while(!![]){try{const s=parseInt(A(0x1d4,P.p))/0x1+parseInt(A(P.q,'I%1H'))/0x2+-parseInt(A(0x1fc,P.r))/0x3+parseInt(A(P.s,P.t))/0x4*(parseInt(A(0x1c5,P.t))/0x5)+parseInt(A(0x1e3,'U2mk'))/0x6*(parseInt(A(P.u,P.v))/0x7)+-parseInt(A(P.w,'X)Fz'))/0x8+-parseInt(A(0x1da,'5RAZ'))/0x9*(parseInt(A(0x1a3,P.x))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x61ef3));const d=(function(){const Q={p:'1Jm!'};let p=!![];return function(q,r){const s=p?function(){const B=f;if(r){const t=r[B(0x1b1,Q.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0x1df,q:0x1dc,r:'btEn',s:0x1a7,t:'KJOV'},Z={p:0x1e6,q:0x1e1,r:'py4[',s:0x204,t:'bo&Z',u:0x1f1,v:0x1c6,w:'FfeW',x:0x1ef,y:'btEn',z:'2WFZ',a0:0x1fe},C=f,p={'BLJFo':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','lTxsW':function(q,r){return q(r);},'qmLpo':C(a0.p,'EQos'),'BviCj':function(q,r){return q+r;},'yUBTz':C(a0.q,a0.r),'IYsur':function(q,r){return q+r;},'SPlvM':'input','lXARc':function(q){return q();},'TYwaL':function(q,r,s){return q(r,s);}};p[C(a0.s,a0.t)](d,this,function(){const D=C,q=new RegExp(D(0x213,'I%1H')),r=new RegExp(p[D(Z.p,'#6&&')],'i'),s=p[D(Z.q,Z.r)](c,p[D(0x1d0,'ttxx')]);!q[D(Z.s,Z.t)](p[D(Z.u,'RgJm')](s,p[D(Z.v,Z.w)]))||!r['test'](p[D(Z.x,Z.y)](s,p[D(0x1cf,Z.z)]))?s('0'):p[D(Z.a0,'bjBt')](c);})();}());const b=(function(){const a1={p:'EQos'};let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(0x1ab,a1.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a8={p:0x1a9,q:0x1f7,r:0x1c8,s:0x1ae,t:0x200,u:0x1dd,v:0x20f,w:'I%1H',x:0x1ec,y:'%)DA',z:0x1cc,a9:0x1f0,aa:'py4[',ab:'%)DA',ac:0x1de,ad:'I%1H',ae:'RgJm',af:0x201,ag:0x1aa,ah:'RgJm',ai:0x1ac},F=f,p={'jDcCK':function(t,u){return t+u;},'zCMgM':F(0x1d9,'MxAn'),'OAHVl':function(t){return t();},'XgfEs':F(a8.p,'@WjP'),'rXEzF':F(a8.q,'1G)&'),'fvuMp':'table','TIIZg':function(t,u){return t<u;}};let q;try{const t=Function(p[F(a8.r,'Exuq')](p[F(0x1f4,'FfeW')],F(a8.s,'MohJ'))+');');q=p['OAHVl'](t);}catch(u){q=window;}const r=q[F(a8.t,'ttxx')]=q['console']||{},s=['log','warn',F(a8.u,'KJOV'),p[F(a8.v,a8.w)],p['rXEzF'],p['fvuMp'],F(a8.x,'1Jm!')];for(let v=0x0;p[F(0x20c,a8.y)](v,s[F(a8.z,a8.y)]);v++){const w=b[F(a8.a9,a8.aa)][F(0x212,a8.ab)][F(a8.ac,a8.ad)](b),x=s[v],y=r[x]||w;w[F(0x208,a8.ae)]=b[F(a8.af,'i6WU')](b),w[F(a8.ag,'mj3i')]=y[F(0x1ce,a8.ah)][F(a8.ai,'1Jm!')](y),r[x]=w;}});function f(a,b){const c=e();return f=function(d,g){d=d-0x1a0;let h=c[d];if(f['nFSgJC']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['vcEkqe']=m,a=arguments,f['nFSgJC']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['OGtYHJ']===undefined&&(f['OGtYHJ']=!![]),h=f['vcEkqe'](h,g),a[k]=h):h=l,h;},f(a,b);}a(),(function(){const ac={p:0x1be,q:'5RAZ',r:'GATn'},ab={p:0x1bc},G=f,p={'gEavO':function(s,t){return s+t;},'ROWbf':G(ac.p,ac.q),'vlXNh':'{}.constructor(\x22return\x20this\x22)(\x20)','KKCdi':function(s){return s();}},q=function(){const H=G;let s;try{s=Function(p[H(0x1b4,'NTc]')](p[H(ab.p,'38$a')](p['ROWbf'],p['vlXNh']),');'))();}catch(t){s=window;}return s;},r=p[G(0x1e8,ac.r)](q);r['setInterval'](c,0x9c4);}());import g from'dotenv';g[I(0x1c1,'btEn')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';function e(){const ay=['WRLIWR89c8k1','WQvXdsKY','W6xdQxDXFq','cCkWraa','adjHWQGC','FSo9mSk+Bc/dSmounSoRtSoln8oEta','l8o/W5OA','WPfqA1/cMSoihCokASkrg8kfW7m','W6bqWPRcThW','W5ldTwBcKG','W4xdP0JcJaJdVW','p8osWPZcJmkTWQmHW482bfW','z8onnCkIW4K','W7ddGb3cSCognSk+WQmLpqP8WQ4','W7DhWPZcRNZcTSo4DLrmzXVcJsHjW6JdTCkPWO4','cCojWOJcKCkt','DSoMl8oyWOq','WP1jWPz/yIC','d8oqe8ovamkEn8oPWPS','WQpcPWeAWOPjywOfWOrB','d8ktmYZcKG','WQNcOvbgW49eEMm','W5VdJ1FcSGK','lSo2WPddHCoZ','eMddI8kZWQe','W4ncWRFcN8opauj7W654qSoMWRu','B8oYomoW','W63dI2hcHX8','W7aeW5VdNH7cOG','imoYf8oF','W7pdUWRcRZrIuJy','kHeoW5ldNa','o8oSnmobW5K','i8oLW5SqFmkFhq','xCoNm8oNWPG','W63dPZBcTq','nmkWyCkNW6nyWQqlWOiWW6VdHa','C13cQxW','zmoIi8o3WRSc','WRBcNKddRCkC','dHLZWRSHWOe9W4NdUG','W5xdKqhdGKqyWRFdQLhdRuqEm8k+WOGrpuDm','WRywW57dRtZdRSkbeLHytb8','DCoLpCk/W4e','WP1oWPLWzq','WPZdKSomWOC','WQFdM8kuWQe','WQlcMCk1cq','jSo5nmk1yge','B2BcONVdSq','WRFcTCo+WO3cIHy','xSkZzWNdPmkAWPxdHmkZW6yp','W6JdPmkMW5ZdJeGNW4tcNHqPWR0','oSkGmSk8FexcSSoS','omkYeahcUG','aCkStXC','d8o1WOtdR8ov','zmo5dSkbAG','WOOzA1FcNa','WQ5KWRSZhCk1','WRbZhcyU','W6xdNK9frq','W6nfWOi1W4C','WRD/WOTSEq','yf3cThVdKSo0W7BdGmkADCkm','W4xdOJdcMcW','WQ5OWR4J','kCk0dCoMW4f5W6DYxJq','W5JdMvJcGt4','WRTNp3tdIG','jSo5nmk1zNRcRa','W7DZWOOtW5agW6pcUgi','WRrpjhxdU2RcQmkDW5vjpG','W64xW4tdMxZdKJG','W6ldPIVcTdq','DCo7mCkMW7u','F2TPkmo9vmkGW4dcVSkuW44YqG','W73dS1XA','ACozfSomWRC','W43dHXRdMq','kCoUfSocW5NdR2G','WRvjjgi','W5FdNwRcLWO','fmojWOlcPCkn','W5qfkHS','W7CrWO3dV8krz8o5ma','W6SrW4tdJKFdJIJdJmkiu8kY','g0VdNCkEWP7dNCk3','W5JdIYNcQsL/uW4b','tsabsxVcQufhjaRcSa','cxPddG','WQ17nMRdNmkGWQRcUvOg','W4GOW7ZdOW0','W4yYWQP0','WPtdJmoAWOqG','WP3dLCkCWObH','DCkpW7hcSSklWORdImkYWRjfwmkl','nmoyWPpcM8k8WQmN','W6WtW5RdJqxcVNBdVGG','WQpdH8kuWQzMgCk7BSkWW7xdRbmaCrpcJW','iSoKaa','AmoYxCo6WQ9CW6frvG','WOJdHHddKf8fW6pcP0u','W4ONWRXQtmoXWRfEWQBdKmk5W7iWoGyXDH/dUCo8druV','pg11FmkMW64vWO1Au1S','W7tcGSoiW7yNrSoIB8otWRZdV2ju','W7ldQv9Dzq','WQu7WPSqW5u/W43cKG','W6xdUZ3cOG','D8k9WOnnb8ohtmo/WQRdKZFcHKK','W4KwWOP/FG06iG','WQhdPCoDWOKv','W5ldHXddHq','W7/dPKThW4G','W5GUWPzUWRzJjc0','WQRcH8kSeCkm','WQzOeYe','cCkwo3xdOey','W6ugfLFcQZdcObrNzqXvWQXqpmorW6nMWQ3cRSkUW6XMWPL3CCkqqSoiW6JdUCoL','AmkOWPDPsa'];e=function(){return ay;};return e();}import o,{generateUniqueId}from'../src/password.js';const router=h['Router']();router[I(0x20a,'zHF%')](I(0x216,'MxAn'),n,async(p,q)=>{const af={p:0x1fb,q:0x1e7,r:'VX[J',s:0x20b,t:'i@wN',u:0x1f9,v:'5RAZ',w:'NTc]',x:'bjBt'},J=I,r={'tkGEK':function(s,t){return s||t;},'rcRqE':function(s){return s();},'NZewe':J(af.p,'38$a'),'zcUED':J(0x217,'q&%u'),'Twdva':J(0x1a8,'MxAn')};try{const {email:s,first_name:t,last_name:u,password:v}=p[J(af.q,af.r)];if(r['tkGEK'](!s,!t)||!u||!v)return q['json']({'status':0x191});const w=await r['rcRqE'](k),x=w[J(af.s,af.t)](r['NZewe']),y=await x[J(af.u,'%HbH')]({'email':s});if(y)return l[J(0x1b8,af.v)](r[J(0x1ea,'i)XN')]),q['json']({'status':0x199});return await x[J(0x1d8,af.w)]({'email':s,'first_name':t,'last_name':u,'role':r['Twdva'],'password':o(v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[J(0x1ca,af.x)]({'status':0xc9});}catch(z){l['error'](z),q[J(0x1cd,'ttxx')]({'status':0x1f4});}}),router['post'](I(0x1e0,'ytlo'),n,async(p,q)=>{const ak={p:0x1ad,q:'#6&&',r:0x214,s:0x1a4,t:'RgJm',u:0x1d3,v:0x1f5,w:'i@wN',x:0x1d1,y:0x20d,z:'@4WM',al:0x205,am:'TZ^P',an:'X)Fz',ao:'1G)&',ap:0x1b2,aq:'@mn)',ar:0x1af,as:0x1b0,at:'Wh5Q',au:0x1f3,av:0x1b3,aw:'VX[J'},K=I,r={'zZIld':function(s,t){return s!=t;},'gJFzv':function(s,t){return s(t);},'qNkCg':function(s,t){return s(t);},'CuRDB':K(ak.p,ak.q),'OfLUT':function(s){return s();},'IYREl':K(ak.r,'ttxx'),'afuLz':'x-forwarded-for'};try{const {email:s,password:t}=p[K(ak.s,ak.t)];if(!s||!t)return q[K(ak.u,ak.t)]({'status':0x191});const u=await k(),v=u['collection'](K(ak.v,ak.w)),w=await v[K(ak.x,'X)Fz')]({'email':s});if(!w)return q[K(ak.y,'mj3i')]({'status':0x194});if(r['zZIld'](r[K(0x202,ak.z)](o,t),w[K(ak.al,ak.am)]))return q[K(0x1b6,ak.an)]({'status':0x191});r[K(0x1ee,ak.ao)](addUserProfileToSession,w);const x=j['createHash'](r['CuRDB'])[K(0x1ba,'@4WM')](r[K(ak.ap,ak.aq)](generateUniqueId))[K(0x1eb,'Wh5Q')](r[K(ak.ar,'[BAN')]),y=p['headers'][r['afuLz']]||p[K(ak.as,ak.at)]['remoteAddress'];addSession(w,x,y,p[K(0x211,'ZYWw')][K(ak.au,')q3S')]),q['json']({'status':0xc8,'token':x});}catch(z){l[K(0x1fa,ak.t)](z),q[K(ak.av,ak.aw)]({'status':0x1f4});}}),router[I(0x1b9,'FfeW')]('/verify',m,function(p,q,r){const al={p:0x1ff,q:'MxAn'},L=I;q[L(al.p,al.q)]({'status':0xc8});}),router[I(0x1d5,'py4[')](I(0x1f6,'ytlo'),m,function(p,q,r){const an={p:0x1c0,q:'o&hE'},M=I,s={'sgxFP':function(t,u){return t(u);}};s[M(an.p,'bjBt')](removeSession,p[M(0x1d7,an.q)]),q['json']({'status':0xc8});});export default router;function c(p){const ax={p:0x1b5,q:'ytlo',r:0x1fd,s:'@WjP',t:'bjBt',u:0x1d2},aw={p:'i6WU',q:0x1e9,r:'ytlo',s:'$VJU',t:0x203,u:'ZYWw',v:'%HbH',w:'@mn)',x:0x1c4,y:'#6&&',z:0x1bf,ax:0x1bb,ay:'ZYWw',az:0x1cb,aA:0x1db,aB:0x20e,aC:0x1c7},N=I,q={'HtpZT':function(s,t){return s===t;},'BwKAG':N(ax.p,ax.q),'mQNSB':function(s,t){return s+t;},'mlUSc':function(s,t){return s/t;},'OQtal':N(0x1f2,'Wh5Q'),'umikG':N(ax.r,ax.s),'UtznJ':N(0x1d6,ax.t),'YHYxo':function(s,t){return s+t;},'jHWNO':N(0x1a0,'eqjx'),'XfdyL':function(s,t){return s(t);}};function r(s){const O=N;if(q['HtpZT'](typeof s,'string'))return function(t){}[O(0x1f8,aw.p)](q['BwKAG'])['apply'](O(0x207,'Exuq'));else q['mQNSB']('',q[O(aw.q,aw.r)](s,s))[O(0x1e2,aw.s)]!==0x1||q[O(aw.t,aw.u)](s%0x14,0x0)?function(){return!![];}[O(0x206,aw.v)](q['mQNSB'](q[O(0x1ed,aw.w)],q[O(aw.x,aw.y)]))['call'](q[O(aw.z,'ZYWw')]):function(){return![];}[O(aw.ax,aw.ay)](q['YHYxo'](q[O(aw.az,'FfeW')],q[O(aw.aA,'38$a')]))[O(aw.aB,'KJOV')](q[O(aw.aC,'GATn')]);q[O(0x1a2,aw.w)](r,++s);}try{if(p)return r;else q[N(ax.u,ax.t)](r,0x0);}catch(s){}}