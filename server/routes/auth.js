const H=f;function e(){const as=['cSohW40VWPK','W5XxbJZdICoJdGZcJJ7dJSoYqG','ECosWR7dIq','W7CyWROYWPFcLSoEWRae','WQ8ZsCkdWOuyW6CwW4mRyW','dgVcN8oPdq','WQWRW5WCnW','h3vdd1y','eelcQmoaWOC','AmocW4RdHW','WP5PBKBdRCofWRpdRMxdMa','WO5iy2dcSa','W7iBrhuF','rLLwjvG','BmoOW4JdJSk5','WRxdQqCVW5y','vSoputC6W4xcICk3Emkg','WPJdMqGyW5udWPK','W7ldLSkklCo5WQqO','cwdcV8kKwxu','W77dMSkmlmoVWQi','qwnEiu4','C3ldTSoPW4tcKt7cKKCkW5tcJSkf','WQ0Sv8kCWOG','sKGdW7aU','WRrnW7GqWRxcNCknW5OgFSkLqv0vFfDjW64e','W4y4fCoUEG','W4aulmo+ECoRjSo/WQW','W4ToqSkp','W5xdV8kHd8ok','rmk3W6ldLW','ehZcS8kH','W4hcJLXjWOrfW5NdK8oyW6OIcMy','W7BdKrbpxq','WPjPf8kcy0dcNG','jmogxwyyWQdcV1ipW4RdT8knta','WOmaxmkAxbm','bdHdWP7dQ0ZdQfWyiSkVW5ZdKa','WRZcSvibsa','WRzhW78r','WOGivCkXWRu','WQX+BCovySoCgmozWOi','tComygLC','quSCW7i','bmkpawn6WPtdSSk6sCkOWQZdQmkB','yhb6o2eMpW','ySodW4ldM8kCW6xcR8oyqvz4','i8koW6XBDa','z8k2kJTJ','eCogW4xdPCoMWPldMW','W53dGcHTBa','WP1UcCktwa','W5CthfdcHG','dgbuimkPcSkpWRCV','W6SUl8o4','u8kNW4BdTCkN','d37cLmkgBa','W7u+rgCO','WQpdGJa','n2T3jG','uwGyW47cRHq','WPhdJbKqW4K','W4VdHJT2E0VcJ8oSfmoMW70','WRWZvmke','uLxdQCkh','WOxdG27cPSkNiCoHW4ZcVG','W5RcMtG','hmkUW4HGtW','hMRcVSk6','W57dKsX2rG','sI0Hv8keumoSqmk9htVdMSo7','W59tadRdHmoTbJ3cQt3dN8ouFq','crpcV8oCW7LCWR5lW4dcMmkffSkR','xh7cNSoJWQ1S','lCocugiBW5/dHgaiW4VdOG','A8oFW4pdHG','wvicWQy','W7ZcOmo1vXlcLSkAW7morL1Ria','buZcQmoooW','WQGmv2BcNmo7vX7dRW3dSmoHsmoeW7yUW6ikWPZcUmo1W51+','WP97AvJcPq','hSoVWRJcGSoUC0Ppmmo1ja','WQJdVeO9EW','W4RdLY53BgRdJCkUf8oWW6CPjCosyHFcUaiQ','W4uTeKxcNW','WQSdWPJdVGe','ru5OeK5GW4BdNG','W5hcGSorWRFdHa','vSkXW7/dHW','cwRcQmkguNxcSSkMWQ4XWR4','W5dcGZhcNmkNc8oFW5VdR8kpjwpcK0VdTaK','WPhcRxagsG','mNZcUmoiWOK','WRhdLsGXW6a','mSkVW4PE','l2NcRCoEjq','W6hdJSofkSoZWRGOW5BcRqXyn8ohyeiwyqFdUdHbbqWYW5RcN3/dMmoZfCogWOi','dMdcJ8k7tMJcUCkZ','c1RcMSoUla','nMSDeSo/','W6ugs2uvW5tdKG','WR3cRvWw','W77dLSo9WR/dNCotFxmEaL1mW5ncrW','WQHcW4TFWOG','W4yra2tcSa','W41yq8kgW4q9','aHfBWP8RWPXPW5/dQa','CSoyW57dGCkgW7a','wSo5DquG','gcJcTSkQWPddKW','W6RdKSkyoSoRWRKPW4y','WOpdGg3dImkwbSoxW7NcTCoJ','cSonW5WLWPSNWRuynq','D8kAcJC','c3JcMCoXla','WQRcSv0D','W6qgqw8','a03cMmkHBa','ueabWQq','W7ebthOFWPJcN8oSW6VcGCkIbSkQWP8c','u8kTW6NdGCkT','eMezW47cTqNcPa','kCorbCoSEG','W4VdMJSWkZi','quqaWQCpWPXBW7NdQcldICoBWOa','W5FdSLxcUCo+iMm','dmoAW5eZWOq/WRK','cvzgmCo6'];e=function(){return as;};return e();}(function(p,q){const O={p:'mFQO',q:0xe2,r:'7g&C',s:0xe3,t:0xfc,u:0xb7,v:'[50Y',w:0xf7,x:0xdb,y:'&SgR'},A=f,r=p();while(!![]){try{const s=-parseInt(A(0x125,'unO*'))/0x1*(-parseInt(A(0xb9,O.p))/0x2)+-parseInt(A(O.q,O.r))/0x3*(-parseInt(A(0xe7,'TiX['))/0x4)+-parseInt(A(O.s,'McDn'))/0x5*(parseInt(A(O.t,'a!$D'))/0x6)+parseInt(A(O.u,O.v))/0x7+parseInt(A(0xd9,'pqJb'))/0x8+-parseInt(A(O.w,'unO*'))/0x9*(-parseInt(A(0x100,'pqJb'))/0xa)+-parseInt(A(O.x,O.y))/0xb;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x34d26));const d=(function(){let p=!![];return function(q,r){const P={p:'0Vfx'},s=p?function(){const B=f;if(r){const t=r[B(0x128,P.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const X={p:0x110,q:'unO*'},W={p:0xbc,q:'qNGc',r:0xde,s:'EfA0',t:0x114},C=f,p={'QllGy':C(X.p,X.q),'sbXff':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','YsIbl':function(q,r){return q(r);},'DTrAD':'chain','vcEAQ':function(q,r){return q+r;},'cPYDC':C(0xe9,'WUHm'),'HmicD':function(q,r,s){return q(r,s);}};p[C(0x130,'[be@')](d,this,function(){const D=C,q=new RegExp(p['QllGy']),r=new RegExp(p[D(W.p,'5irS')],'i'),s=p[D(0x111,W.q)](c,'init');!q[D(0xec,'NGb^')](s+p[D(W.r,W.s)])||!r[D(W.t,'CRLJ')](p['vcEAQ'](s,p[D(0xbe,'Nqsb')]))?p[D(0xd0,'NGb^')](s,'0'):c();})();}());const b=(function(){let p=!![];return function(q,r){const Y={p:0xf3},s=p?function(){const E=f;if(r){const t=r[E(Y.p,'LvoC')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a6={p:'mFQO',q:0xbf,r:0x11d,s:'#caL',t:0xc5,u:'LvoC',v:0xe6,w:'0Vfx',x:0xf9,y:0x134,z:'$N3h',a7:0x11a,a8:'#caL',a9:0xf8,aa:0xcb,ab:0xe5,ac:'(]fc',ad:0x106,ae:'bciS',af:0x10d,ag:0xe4,ah:'25IF',ai:'McDn',aj:0xd1,ak:'NGb^',al:0x127,am:'pqJb',an:0x117,ao:'(]fc',ap:0xd4,aq:'sQO8'},F=f,p={'EUnSf':function(t,u){return t(u);},'rENhH':function(t,u){return t+u;},'CgHcp':F(0xcf,a6.p),'aRssy':'{}.constructor(\x22return\x20this\x22)(\x20)','ZdqJq':function(t){return t();},'pBeGr':'warn','eDUqJ':F(a6.q,'25IF'),'sWaqR':F(a6.r,'gHds'),'yBDnP':F(0x126,'$N3h'),'WyJgk':F(0xc2,a6.s),'HXHNr':function(t,u){return t<u;}};let q;try{const t=p[F(a6.t,a6.u)](Function,p[F(a6.v,'pqJb')](p['rENhH'](p['CgHcp'],p[F(0x118,a6.w)]),');'));q=p[F(a6.x,'CRLJ')](t);}catch(u){q=window;}const r=q[F(a6.y,a6.z)]=q[F(a6.a7,a6.a8)]||{},s=[F(a6.a9,'unO*'),p[F(a6.aa,'rOdt')],p[F(a6.ab,'CRLJ')],p[F(0xef,a6.a8)],p[F(0x12b,a6.ac)],F(a6.ad,a6.ae),p[F(a6.af,'RcrD')]];for(let v=0x0;p['HXHNr'](v,s[F(0x11f,'%&jZ')]);v++){const w=b[F(a6.ag,a6.ah)]['prototype'][F(0xf1,a6.ai)](b),x=s[v],y=r[x]||w;w[F(a6.aj,a6.ak)]=b[F(a6.al,a6.am)](b),w[F(a6.an,a6.ao)]=y[F(0x10c,'rOdt')][F(a6.ap,a6.aq)](y),r[x]=w;}});a();function f(a,b){const c=e();return f=function(d,g){d=d-0xb7;let h=c[d];if(f['ZiVEuJ']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['cxFvOH']=m,a=arguments,f['ZiVEuJ']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['OpudbM']===undefined&&(f['OpudbM']=!![]),h=f['cxFvOH'](h,g),a[k]=h):h=l,h;},f(a,b);}import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';(function(){const a8={p:'^C!o',q:'a!$D',r:0x119,s:0x116,t:0x10f},G=f,p={'qIQSJ':function(r,s){return r+s;},'JScXB':G(0x109,a8.p)};let q;try{const r=Function(p[G(0x135,a8.q)](p[G(a8.r,'N$gD')],G(a8.s,'(vFb'))+');');q=r();}catch(s){q=window;}q[G(a8.t,'(]fc')](c,0x9c4);}());import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[H(0x123,'R$1y')]();router[H(0xdd,'mFQO')]('/register',n,async(p,q)=>{const ab={p:'qNGc',q:0x12a,r:'^C!o',s:0xd8,t:0x136,u:'$N3h',v:0xc1,w:'bciS',x:'Ano^',y:'k4E4',z:0xe0,ac:0x10a,ad:'y6a0'},I=H,r={'NcJMC':function(s,t){return s||t;},'Icnnv':I(0x12e,'sQO8'),'eRhTp':I(0x105,'[50Y'),'VTLMD':I(0x11b,ab.p),'kvEVc':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[I(ab.q,'#caL')];if(r[I(0xd7,ab.r)](!s,!t)||!u||!v)return q['json']({'status':0x191});const w=await k(),x=w['collection'](r['Icnnv']),y=await x[I(ab.s,'WUHm')]({'email':s});if(y)return l[I(ab.t,ab.u)](r[I(ab.v,ab.w)]),q[I(0xf6,ab.x)]({'status':0x199});return await x[I(0xeb,ab.y)]({'email':s,'first_name':t,'last_name':u,'role':r[I(ab.z,'dI%P')],'password':r[I(ab.ac,ab.ad)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[I(0xd5,'(]fc')]({'status':0xc9});}catch(z){l['error'](z),q['json']({'status':0x1f4});}}),router[H(0xf5,'EfA0')](H(0xff,'Nqsb'),n,async(p,q)=>{const af={p:0xf0,q:'RcrD',r:0xc0,s:'bciS',t:0x129,u:0x115,v:'0Vfx',w:0x102,x:'Yi1R',y:'25IF',z:0x124,ag:0xc6,ah:'^C!o',ai:0xca,aj:0xea,ak:'y6a0',al:'(]fc',am:0x132,an:0xc8,ao:'^C!o',ap:'2Wux'},J=H,r={'EaDCp':function(s,t){return s||t;},'AiAMP':'users','uyJFy':function(s,t){return s(t);},'usjBB':J(af.p,')&mW'),'yHKCz':J(0x11c,af.q),'mDdfQ':function(s,t,u,v,w){return s(t,u,v,w);},'OLJFV':J(af.r,af.s)};try{const {email:s,password:t}=p[J(af.t,'qNGc')];if(r[J(af.u,af.v)](!s,!t))return q[J(af.w,af.x)]({'status':0x191});const u=await k(),v=u['collection'](r[J(0x113,'LvoC')]),w=await v['findOne']({'email':s});if(!w)return q[J(0x101,af.y)]({'status':0x194});if(r['uyJFy'](o,t)!=w[J(af.z,'(vFb')])return q['json']({'status':0x191});r[J(0xed,'sQO8')](addUserProfileToSession,w);const x=j[J(af.ag,'7g&C')](J(0x131,af.ah))['update'](generateUniqueId())[J(af.ai,'(vFb')](r['usjBB']),y=p[J(0xc7,'LvoC')][r[J(af.aj,af.ak)]]||p[J(0xc9,af.al)][J(af.am,'Yi1R')];r[J(0xc4,'25IF')](addSession,w,x,y,p[J(af.an,'(vFb')][r[J(0xd3,'(vFb')]]),q['json']({'status':0xc8,'token':x});}catch(z){l[J(0xe8,af.ao)](z),q[J(0xb8,af.ap)]({'status':0x1f4});}}),router[H(0x10e,'sQO8')]('/verify',m,function(p,q,r){const K=H;q[K(0xe1,'83G#')]({'status':0xc8});}),router['post'](H(0x12f,'&SgR'),m,function(p,q,r){const ai={p:0xdc},L=H,s={'OSlKM':function(t,u){return t(u);}};s['OSlKM'](removeSession,p[L(ai.p,'qNGc')]),q[L(0xd2,'%&jZ')]({'status':0xc8});});export default router;function c(p){const ar={p:0xf2,q:'&SgR',r:'(]fc',s:0xf4,t:'^C!o'},aq={p:0x112,q:'Nqsb',r:0xbd,s:0xce,t:'83G#',u:'G4Ga',v:0xc3,w:0xba,x:'EfA0',y:'7g&C',z:0x108,ar:0xda,as:0xee,at:'0Vfx',au:0xcd,av:0x11e},M=H,q={'AnILM':function(s,t){return s===t;},'JwZMQ':M(0x121,'25IF'),'uJwIe':M(0x12d,'#caL'),'mXmEi':M(0x133,'eI#['),'AbOMT':function(s,t){return s!==t;},'wxmCd':M(ar.p,ar.q),'uELdu':function(s,t){return s%t;},'oDASn':function(s,t){return s+t;},'uqHIP':M(0xfa,ar.r),'fcvtX':'gger','hJTwL':M(ar.s,ar.t)};function r(s){const N=M;if(q[N(aq.p,aq.q)](typeof s,q[N(aq.r,'McDn')]))return function(t){}['constructor'](q['uJwIe'])[N(aq.s,aq.t)](q['mXmEi']);else q[N(0x10b,aq.u)]((''+s/s)[q[N(aq.v,'rOdt')]],0x1)||q['uELdu'](s,0x14)===0x0?function(){return!![];}[N(aq.w,aq.x)](q[N(0x122,aq.y)](q[N(aq.z,'trGQ')],q[N(0xfb,'^C!o')]))[N(0x12c,'Yi1R')](N(aq.ar,'o@f*')):function(){return![];}['constructor'](q[N(0x104,'0Vfx')](q[N(aq.as,'(]fc')],q[N(0xbb,aq.at)]))[N(aq.au,aq.x)](q[N(aq.av,'y6a0')]);r(++s);}try{if(p)return r;else r(0x0);}catch(s){}}