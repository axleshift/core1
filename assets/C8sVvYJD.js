import{j as e,r as s}from"./kqbr3HuW.js";import{F as r,b as i}from"./CwLTBdlj.js";import{a,V as t,c as l}from"./C7o2jNGn.js";import{P as n}from"./CgN-7aKy.js";import{p as d}from"./B51y9YVM.js";import{r as c,m as o,n as u,o as m,p as j,a6 as h,ad as x,ae as p,af as y,ag as b,ah as g,ai as v,C as q,aj as R,ak as f,al as N,am as w,an as S}from"./CUIyObC5.js";import{i as K}from"./B8H-rvok.js";import{E as C}from"./URk2IvX2.js";import{d as _}from"./DFarnK1O.js";import"./BgRKNlhe.js";import"./uhX4GmSj.js";import"./CxGBFDck.js";import"./c0eKk1Db.js";import"./BbX1BUwh.js";import"./CQYGjB7w.js";import"./DbzcfNKS.js";import"./BGKE3O6B.js";import"./DJeUPDeV.js";import"./B0UoamS-.js";import"./DdgNchEJ.js";import"./omosduih.js";import"./D3yCfJ5s.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./_iZV8NMP.js";import"./CJ2-25UQ.js";import"./BqHrj3jM.js";const T=()=>e.jsx(e.Fragment,{children:"This will list down all user & admin activities"}),A=()=>e.jsx(e.Fragment,{children:"This will list down all api auth token created by user, there last accessed and its allowed ip addresses."}),F=()=>e.jsx(e.Fragment,{children:"This will show the graphs for panels, such as number of api request this week and compared to last month, number of detected issues in past week compared to last week."}),O=({query:s,setQuery:a,state:t,setState:l,priority:n,setPriority:q,order:R,setOrder:f,result:N})=>e.jsxs(e.Fragment,{children:[0===N.scm.length&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(c,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})}),0!==N.scm.length&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(u,{className:"mb-3",children:[e.jsx(m,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:s,onChange:e=>a(e.target.value)}),e.jsx(j,{id:"basic-addon",children:e.jsx(r,{icon:i})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(h,{value:t,onChange:e=>l(e.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(h,{value:n,onChange:e=>q(e.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(h,{value:R,onChange:e=>f(e.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(x,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(p,{children:e.jsxs(y,{children:[e.jsx(b,{children:"#"}),e.jsx(b,{children:"State"}),e.jsx(b,{children:"Scope"}),e.jsx(b,{children:"Manifest"}),e.jsx(b,{children:"CVE"}),e.jsx(b,{children:"Summary"}),e.jsx(b,{children:"Severity"}),e.jsx(b,{children:"Last Updated"})]})}),e.jsx(g,{children:N.scm.map((s=>e.jsxs(y,{children:[e.jsx(v,{children:s.number}),e.jsx(v,{children:s.state}),e.jsx(v,{children:s.scope}),e.jsx(v,{children:s.manifest}),e.jsx(v,{children:s.cve}),e.jsx(v,{children:s.summary}),e.jsx(v,{children:s.severity}),e.jsx(v,{children:d(new Date(s.updated_at).getTime())})]},s.number)))})]})]})]});O.propTypes={query:n.string.isRequired,setQuery:n.func.isRequired,state:n.string.isRequired,setState:n.func.isRequired,priority:n.string.isRequired,setPriority:n.func.isRequired,order:n.string.isRequired,setOrder:n.func.isRequired,result:n.shape({scm:n.arrayOf(n.shape({number:n.number.isRequired,state:n.string.isRequired,scope:n.string.isRequired,manifest:n.string.isRequired,cve:n.string.isRequired,summary:n.string.isRequired,severity:n.string.isRequired,updated_at:n.string.isRequired})).isRequired}).isRequired};const P=()=>e.jsx(e.Fragment,{children:"This will setup maintenance status to the system denying user access temporarily."}),L=({query:s,setQuery:a,state:t,setState:l,priority:n,setPriority:q,order:R,setOrder:f,result:N})=>e.jsxs(e.Fragment,{children:[0===N.sentry.length&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(c,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any issues."}),e.jsx("p",{children:"Should we add one? :)"})]})}),0!==N.sentry.length&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(u,{className:"mb-3",children:[e.jsx(m,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:s,onChange:e=>a(e.target.value)}),e.jsx(j,{id:"basic-addon",children:e.jsx(r,{icon:i})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(h,{value:t,onChange:e=>l(e.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(h,{value:n,onChange:e=>q(e.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(h,{value:R,onChange:e=>f(e.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(x,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(p,{children:e.jsxs(y,{children:[e.jsx(b,{children:"#"}),e.jsx(b,{children:"Title"}),e.jsx(b,{children:"Culprit"}),e.jsx(b,{children:"Level"}),e.jsx(b,{children:"Status"}),e.jsx(b,{children:"Priority"}),e.jsx(b,{children:"Count"}),e.jsx(b,{children:"Last Updated"})]})}),e.jsx(g,{children:N.sentry.map((s=>e.jsxs(y,{children:[e.jsx(v,{children:s.id}),e.jsx(v,{children:s.title}),e.jsx(v,{children:s.culprit}),e.jsx(v,{children:s.level}),e.jsx(v,{children:s.status}),e.jsx(v,{children:s.priority}),e.jsx(v,{children:s.count}),e.jsx(v,{children:d(new Date(s.updated_at).getTime())})]},s.id)))})]})]})]});L.propTypes={query:n.string.isRequired,setQuery:n.func.isRequired,state:n.string.isRequired,setState:n.func.isRequired,priority:n.string.isRequired,setPriority:n.func.isRequired,order:n.string.isRequired,setOrder:n.func.isRequired,result:n.shape({sentry:n.arrayOf(n.shape({id:n.string.isRequired,title:n.string.isRequired,culprit:n.string.isRequired,level:n.string.isRequired,status:n.string.isRequired,priority:n.string.isRequired,count:n.string.isRequired,updated_at:n.string.isRequired})).isRequired}).isRequired};const k=({result:s})=>e.jsx(e.Fragment,{children:e.jsxs(x,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(p,{children:e.jsxs(y,{children:[e.jsx(b,{children:"#"}),K&&e.jsx(b,{children:"User"}),e.jsx(b,{children:"Location"}),e.jsx(b,{children:"Device"}),e.jsx(b,{children:"Status"}),e.jsx(b,{children:"Last Accessed"})]})}),e.jsx(g,{children:s.sessions.map(((s,r)=>e.jsxs(y,{children:[e.jsx(v,{children:r+1}),K&&e.jsx(v,{children:s.user_id}),e.jsx(v,{children:s.ip_address}),e.jsx(v,{children:s.user_agent}),e.jsx(v,{children:s.active?"Active":"Inactive"}),e.jsx(v,{children:d(s.last_accessed)})]},r)))})]})});k.propTypes={result:n.shape({browser:n.string,os:n.string,sessions:n.arrayOf(n.shape({_id:n.string.isRequired,user_id:n.string,ip_address:n.string.isRequired,user_agent:n.string.isRequired,active:n.bool.isRequired,last_accessed:n.number.isRequired})).isRequired}).isRequired};const D=()=>{const{addToast:r}=a(),[i,n]=s.useState(!0),[d,c]=s.useState("2"),[o,u]=s.useState("1"),[m,j]=s.useState("1"),[h,x]=s.useState(""),[p,y]=s.useState({scm:[],sessions:[],sentry:[],apiToken:{}});_();return s.useEffect((()=>{(async()=>{await axios.get(`${t}/api/v1/securityManagement/`,{headers:{Authorization:`Bearer ${cookies.get(l)}`}}).then((e=>y(e.data))).catch((e=>{console.error(e);const s=C[e.status]||"Internal Application Error";r(s,"Fetch failed!")})).finally((()=>n(!1)))})()}),[]),e.jsxs("div",{children:[i&&e.jsx("div",{className:"loading-overlay",children:e.jsx(q,{color:"primary",variant:"grow"})}),e.jsxs(R,{activeItemKey:0,className:"mb-4",children:[e.jsxs(f,{variant:"underline-border",children:[e.jsx(N,{"aria-controls":"dashboard-tab-pane",itemKey:0,children:"Dashboard"}),e.jsx(N,{"aria-controls":"sessions-tab-pane",itemKey:1,children:"Sessions"}),e.jsx(N,{"aria-controls":"dependabot-tab-pane",itemKey:2,children:"Dependabot"}),e.jsx(N,{"aria-controls":"sentry-tab-pane",itemKey:3,children:"Sentry"}),e.jsx(N,{"aria-controls":"api-tab-pane",itemKey:4,children:"API Key"}),e.jsx(N,{"aria-controls":"activity-tab-pane",itemKey:5,children:"Activity"}),e.jsx(N,{"aria-controls":"maintenance-tab-pane",itemKey:6,children:"Maintenance"})]}),e.jsxs(w,{children:[e.jsx(S,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:e.jsx(F,{})}),e.jsx(S,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:e.jsx(k,{result:p})}),e.jsx(S,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:e.jsx(O,{query:h,setQuery:x,state:d,setState:c,priority:o,setPriority:u,order:m,setOrder:j,result:p})}),e.jsx(S,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:e.jsx(L,{query:h,setQuery:x,state:d,setState:c,priority:o,setPriority:u,order:m,setOrder:j,result:p})}),e.jsx(S,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:4,children:e.jsx(A,{setLoading:n,result:p})}),e.jsx(S,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:5,children:e.jsx(T,{setLoading:n,result:p})}),e.jsx(S,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:6,children:e.jsx(P,{setLoading:n,result:p})})]})]})]})};export{D as default};
