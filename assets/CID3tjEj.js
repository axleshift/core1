/**
 * Â© 2025 Melvin Jones Repol & its contributors . All rights reserved.
 * This project is licensed under the MIT License with Commons Clause.
*/
import{r as e,j as t}from"./CbKKHx2O.js";import{H as a}from"./VudaBnFI.js";import{u as r,b as s}from"./D_7Zx0tk.js";import{d as n}from"./D_eMUV-T.js";import{d as i,ao as l,U as o,al as c,a as d,a2 as p,a3 as h,a4 as u,a5 as j,a6 as m,b as x,c as v}from"./BCoDuBWI.js";import"./D9QqU1Un.js";import"./z-cSZRUs.js";import"./Bnu3OxD9.js";import"./BNqS-k40.js";import"./0NUvlLuB.js";import"./tM1qHAtJ.js";import"./DylAs1sT.js";import"./yJGO6Amu.js";import"./CvkuIoXT.js";import"./B3ZIOLOa.js";import"./U6rf_yqH.js";import"./D68gzNyG.js";import"./6thM_Rat.js";import"./Eji1Pm7n.js";import"./CUBhYDUo.js";import"./Bhaa8ZPc.js";import"./K-dupnmX.js";import"./B3MjVzzP.js";import"./cwKO6bxQ.js";import"./C3hrCPXF.js";import"./Dw0KO6EP.js";import"./CzGuHLZU.js";import"./Bd5YRvRe.js";import"./UUb1f1Eq.js";import"./ru3Q0AV5.js";import"./DqkGgfGl.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./C76xSmx-.js";import"./BPjVUy-D.js";import"./CTpwok2W.js";import"./Bzwk9agu.js";import"./BqHrj3jM.js";const g=()=>{const{user:g}=r(),[y,w]=e.useState({endDate:"",startDate:"",status:"",type:"",query:"",weight:""}),[f,b]=e.useState([]),[D,N]=e.useState(1),[S,C]=e.useState(0),[_,T]=e.useState(!1),{addToast:k}=s();n();const A=async(e,t=null)=>{T(!0),axios.post("/freight/deep-search",{page:e,...y,export_type:t}).then((e=>{if("text/csv"===e.headers["content-type"]){const t=new Blob([e.data],{type:"text/csv"}),a=window.URL.createObjectURL(t),r=document.createElement("a");return r.href=a,r.download="freight_report"+Date.now()+".csv",document.body.appendChild(r),r.click(),void document.body.removeChild(r)}const t=y.type?e.data.data.filter((e=>{var t;return(null==(t=e.invoice)?void 0:t.status)===y.type})):e.data.data;b(t),C(Math.ceil(t.length/e.data.pageSize))})).catch((e=>{var t,a;const r=(null==(a=null==(t=e.response)?void 0:t.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);k(r)})).finally((()=>T(!1)))};e.useEffect((()=>{A(D)}),[D]);const P=(e,t)=>{w((a=>({...a,[e]:t})))};return t.jsxs("div",{children:[t.jsx(a,{children:t.jsx("title",{children:"Reports | Axleshift"})}),_&&t.jsx("div",{className:"loading-overlay",children:t.jsx(i,{color:"primary",variant:"grow"})}),t.jsxs("div",{style:{marginBottom:"20px",display:"flex",gap:"6px",overflowY:"auto"},children:[t.jsx(l,{children:"Start Date:"}),t.jsx(o,{type:"date",max:y.endDate||"",onChange:e=>{const t=e.target.value;y.endDate&&new Date(t)>new Date(y.endDate)?k("Start date cannot be after end date"):P("startDate",t)}}),t.jsx(l,{children:"End Date:"}),t.jsx(o,{type:"date",min:y.startDate||"",onChange:e=>{const t=e.target.value;y.startDate&&new Date(t)<new Date(y.startDate)?k("End date cannot be before start date"):P("endDate",t)}}),t.jsxs(c,{onChange:e=>P("status",e.target.value),children:[t.jsx("option",{value:"",children:"All"}),t.jsx("option",{value:"to_pay",children:"To Pay"}),t.jsx("option",{value:"to_ship",children:"To Ship"}),t.jsx("option",{value:"to_receive",children:"To Receive"}),t.jsx("option",{value:"received",children:"Received"}),t.jsx("option",{value:"cancelled",children:"Cancelled"})]}),t.jsxs(c,{onChange:e=>P("type",e.target.value),children:[t.jsx("option",{value:"",children:"All"}),t.jsx("option",{value:"private",children:"Private"}),t.jsx("option",{value:"business",children:"Business"})]}),t.jsxs(c,{onChange:e=>P("type",e.target.value),children:[t.jsx("option",{value:"",children:"All"}),t.jsx("option",{value:"PAID",children:"Paid"}),t.jsx("option",{value:"EXPIRED",children:"Expired"})]}),t.jsxs(c,{onChange:e=>P("weight",e.target.value),children:[t.jsx("option",{value:"",children:"All"}),t.jsx("option",{value:"1",children:"< 1 KG"}),t.jsx("option",{value:"5",children:"< 5KG "}),t.jsx("option",{value:"10",children:"< 10KG "}),t.jsx("option",{value:"20",children:"< 20KG "}),t.jsx("option",{value:"40",children:"< 40KG "}),t.jsx("option",{value:"60",children:"< 60KG "}),t.jsx("option",{value:"70",children:"< 70KG "}),t.jsx("option",{value:"71",children:"> 71KG "})]}),t.jsx(o,{placeholder:"Tracking number",onChange:e=>P("query",e.target.value)}),t.jsx(d,{color:"primary",onClick:e=>A(D),children:"Apply Filters"}),t.jsx(d,{color:"secondary",onClick:e=>A(D,"csv"),children:"Export"})]}),t.jsxs(p,{stripedColumns:!0,hover:!0,responsive:!0,className:"table-even-width",children:[t.jsx(h,{children:t.jsxs(u,{children:[t.jsx(j,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Tracking Number"}),["super_admin","admin"].includes(g.role)&&t.jsx(j,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Customer"}),t.jsx(j,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),t.jsx(j,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Type"}),t.jsx(j,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Amount"}),t.jsx(j,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Payment"}),t.jsx(j,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Date"}),t.jsx(j,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Weight"})]})}),0!==f.length&&t.jsx(m,{children:f.map(((e,a)=>{return t.jsxs(u,{children:[t.jsx(j,{children:e.tracking_number}),["super_admin","admin"].includes(g.role)&&t.jsx(j,{children:e.user.first_name+" "+e.user.last_name}),t.jsx(j,{children:(r=e.status,"cancelled"===r?"Cancelled":"received"===r?"Received":"to_receive"===r?"To Receive":"to_ship"===r?"To Ship":"To Pay")}),t.jsx(j,{className:"text-capitalize",children:e.type}),t.jsx(j,{children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.amount.currency}).format(e.amount.value)}),t.jsx(j,{children:e.invoice?t.jsx(t.Fragment,{children:"PAID"===e.invoice.status?t.jsxs(t.Fragment,{children:[e.invoice.status," via"," ",e.invoice.payment_method]}):t.jsx(t.Fragment,{children:e.invoice.status})}):"NaN"}),t.jsx(j,{children:new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}),t.jsx(j,{children:e.total_weight+"kg"})]},a);var r}))})]}),0===f.length&&t.jsx(x,{className:"justify-content-center my-5",children:t.jsxs(v,{md:6,children:[t.jsx("h1",{className:"text-truncate text-center",children:y.query}),t.jsxs("div",{className:"clearfix",children:[t.jsx("h1",{className:"float-start display-3 me-4 text-danger",children:"OOPS"}),t.jsx("h4",{children:"There was no shipment found."}),t.jsx("p",{children:"Double check your search query."})]})]})})]})};export{g as default};
