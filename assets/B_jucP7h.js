import{r as c,R as S,j as e}from"./D3kDgYDB.js";import{F as E,z as w}from"./OE35V6-p.js";import{R as A}from"./D0iU1EWp.js";import{u as N}from"./CQ-yZ3vu.js";import{E as k}from"./DJvUpxU9.js";import{d as b}from"./FDBtgKq2.js";import{c as R,C as I,D as P,E as _,P as B,Q as D,R as F,K as O,M as T,O as $}from"./CRebGdRz.js";import"./CNSOrHVr.js";import"./WyM-ksIe.js";import"./dB90dn3U.js";import"./Dw8pycEM.js";import"./8JwjhRSi.js";import"./BmHAl9XU.js";import"./D3kAHpSt.js";import"./BQBsAJpH.js";import"./tpRZQFqq.js";import"./CzFDRTuY.js";import"./CWmxXzlZ.js";import"./BZxJdD1U.js";const re=()=>{const u="6LcbAQopAAAAAPqiUSbgE4FWJrHdKfpFIK_s6rU-",[h,m]=c.useState(!1),[p,f]=c.useState({error:!1,message:""}),[n,g]=c.useState(["","","","","",""]),l=cookies.get("RCTSESSION"),o=b(),d=S.useRef();N();const x=async()=>{if(l===void 0)return o("/login");await axios.post("http://142.93.121.73:5051/api/v1/auth/verify",{},{headers:{Authorization:`Bearer ${l}`}}).then(s=>{if(s.data.is_email_verified)return o("/")}).catch(s=>{if(!s.response)return console.error(s);cookies.remove("RCTSESSION"),o("/login")})};c.useEffect(()=>{x()},[o]);const y=(s,t)=>{const a=s.target.value.replace(/[^0-9]/g,"");if(a.length<=1){const r=[...n];r[t]=a,a&&t<5&&document.getElementById(`otp-input-${t+1}`).focus(),g(r)}},j=(s,t)=>{s.key==="Backspace"&&!n[t]&&t>0&&document.getElementById(`otp-input-${t-1}`).focus()},v=async s=>{s.preventDefault(),m(!0);const t=await d.current.executeAsync(),a=new FormData;a.append("otp",n),a.append("recaptcha_ref",t),await axios.post("http://142.93.121.73:5051/api/v1/auth/verify/otp",a,{headers:{Authorization:`Bearer ${l}`}}).then(r=>{const i=new URLSearchParams(window.location.search),C=i.get("n")?i.get("n"):"/";o(C)}).catch(r=>{console.error(r);const i=k[r.status]||"An unexpected error occurred";f({error:!0,message:i})}).finally(()=>{m(!1)})};return e.jsxs("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"auth-bg"}),e.jsxs(R,{children:[h&&e.jsx("div",{className:"loading-overlay",children:e.jsx(I,{color:"primary",variant:"grow"})}),e.jsx(P,{className:"justify-content-center",children:e.jsx(_,{md:8,lg:6,xl:5,children:e.jsxs(B,{className:"p-1 p-md-4 shadow",children:[p.error&&e.jsxs(D,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(E,{className:"flex-shrink-0 me-2",icon:w,size:"xl"}),e.jsx("div",{children:p.message})]}),e.jsx(F,{children:e.jsxs(O,{onSubmit:v,children:[e.jsx("h1",{children:"OTP"}),e.jsx("p",{className:"text-body-secondary",children:"Enter the 6digit code that was sent to your email address."}),e.jsx(A,{ref:d,size:"invisible",sitekey:u}),e.jsx("div",{className:"d-flex justify-content-center gap-2 mb-3",children:n.map((s,t)=>e.jsx(T,{type:"text",id:`otp-input-${t}`,value:s,onChange:a=>y(a,t),onKeyDown:a=>j(a,t),className:"otp-input",maxLength:"1"},t))}),e.jsx($,{type:"submit",color:"primary",className:"me-2 rounded",children:"Submit"})]})}),e.jsx("div",{className:"ms-auto",children:e.jsx("a",{href:"https://stats.uptimerobot.com/5l58Mua0Wi",target:"_blank",rel:"noopener noreferrer",className:"link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",children:"System Status"})})]})})})]})]})};export{re as default};
