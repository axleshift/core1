(function(h,i){const C={h:0x107,i:0xc5,j:'Cbde',k:'OT)P',l:0x10d,m:0xf8,n:'oFbH'},r=f,j=h();while(!![]){try{const k=-parseInt(r(C.h,'K&lE'))/0x1*(parseInt(r(0xd7,'b^r1'))/0x2)+-parseInt(r(0xe6,'mWD%'))/0x3+-parseInt(r(C.i,C.j))/0x4+parseInt(r(0xd5,C.k))/0x5*(parseInt(r(0xc4,'OT)P'))/0x6)+parseInt(r(C.l,'b%$E'))/0x7+parseInt(r(C.m,'OT)P'))/0x8+-parseInt(r(0xff,C.n))/0x9;if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0x983a0));const d=(function(){let h=!![];return function(i,j){const k=h?function(){const s=f;if(j){const l=j[s(0xca,'6toK')](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const M={h:0x11d,i:'(&Bf',j:'(Ze4'},L={h:'b%$E',i:'lA!N',j:0xfa,k:'nx]5',l:0x10c,m:'aR]j',n:0xef,o:'iBFU',p:'kK)s',q:'zNlg'},t=f,h={'obBWK':t(M.h,M.i),'JqEFR':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','cIXgb':function(i,j){return i(j);},'mndUk':t(0x11c,M.j),'fOSic':function(i,j){return i+j;},'zwwpX':t(0x10e,'ZP)['),'kFvIA':function(i,j){return i(j);},'MkjAQ':function(i){return i();}};d(this,function(){const u=t,i=new RegExp(h[u(0x10b,'oFbH')]),j=new RegExp(h[u(0xd0,L.h)],'i'),k=h[u(0x11b,L.i)](c,h[u(0x103,'Cvhe')]);!i[u(L.j,'K&lE')](h[u(0x11a,L.k)](k,h[u(L.l,L.m)]))||!j[u(L.n,L.o)](h[u(0x119,L.p)](k,'input'))?h[u(0x10a,L.q)](k,'0'):h[u(0x113,L.k)](c);})();}());const b=(function(){const N={h:0xca,i:'6toK'};let h=!![];return function(i,j){const k=h?function(){const v=f;if(j){const l=j[v(N.h,N.i)](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const V={h:0xbe,i:0xce,j:'b^r1',k:'Cbde',l:0xeb,m:0x116,n:'YI(@',o:0xec,p:'mWD%',q:0xf3,W:0x105,X:'rZGv',Y:'EilK',Z:0xf9,a0:'vYKA',a1:0xdf,a2:0xea,a3:'OT)P',a4:0xe3,a5:0xe1,a6:0x118,a7:'ZP)[',a8:0xe7,a9:0x100,aa:'b^r1',ab:0xc7,ac:'cHol',ad:0xd1,ae:'Vq@2',af:0xc9},w=f,h={'zEnvk':function(l,m){return l(m);},'JGMTM':function(l,m){return l+m;},'ToMMl':w(V.h,'5dqo'),'VWRGS':function(l){return l();},'AEOuN':'warn','PkssK':w(V.i,'Vq@2'),'LfhGW':'error','vHDTV':'exception','oPeHh':'table','egNeM':w(0xd9,V.j),'sYzPz':function(l,m){return l<m;}};let i;try{const l=h[w(0xf7,V.k)](Function,h['JGMTM'](h[w(V.l,'3x^7')](h[w(V.m,V.n)],w(V.o,'M0sM')),');'));i=h[w(0x110,V.p)](l);}catch(m){i=window;}const j=i[w(V.q,'b%$E')]=i[w(V.W,V.X)]||{},k=[w(0xdc,'iBFU'),h[w(0x101,V.Y)],h[w(V.Z,V.a0)],h['LfhGW'],h[w(0xbf,'M0sM')],h[w(V.a1,'#1@z')],h['egNeM']];for(let n=0x0;h[w(V.a2,V.a3)](n,k[w(V.a4,'kK)s')]);n++){const o=b[w(V.a5,'b%$E')][w(0xcb,'#1@z')][w(V.a6,V.a7)](b),p=k[n],q=j[p]||o;o[w(V.a8,'b^r1')]=b[w(V.a9,V.aa)](b),o[w(V.ab,V.ac)]=q[w(V.ad,V.ae)][w(V.af,'oFbH')](q),j[p]=o;}});(function(){const a0={h:0xe4,i:'b^r1',j:0x106},x=f,h={'cmBNO':function(j,k){return j(k);},'yeFFn':function(j,k){return j+k;},'rCxUM':function(j,k){return j+k;},'LumiQ':x(0xe9,'!NN$'),'fYamX':'{}.constructor(\x22return\x20this\x22)(\x20)','GoiVz':function(j){return j();}};let i;try{const j=h[x(0xcc,'Sv])')](Function,h['yeFFn'](h['rCxUM'](h[x(0xbd,'oFbH')],h[x(a0.h,a0.i)]),');'));i=h['GoiVz'](j);}catch(k){i=window;}i[x(a0.j,'ecGV')](c,0x9c4);}()),a();import{getUser,isActiveToken}from'../components/sessions.js';import g from'../models/db.js';import{ObjectId}from'mongodb';function f(a,b){const c=e();return f=function(d,g){d=d-0xbc;let h=c[d];if(f['Hsyygu']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['bJmTBt']=m,a=arguments,f['Hsyygu']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['agycMs']===undefined&&(f['agycMs']=!![]),h=f['bJmTBt'](h,g),a[k]=h):h=l,h;},f(a,b);}function e(){const ag=['vmkWit3dOCkaW4WlW5C','WQ4Kh8oXW5y','W4evirZcUZhdMmo5W6ZcUCkYWOanfu5jhCkmW70','jHvGy8o4','suFcRCkuaa','W5nJgmoUW4OkW6xdRh5rvCkMz8k5W5fuWQldSIrqaCkqW7hdHMRcTCkIWP/dTmoRu8kq','iMBcQCkz','W70owSozW70','WOJdUCkkW64','s27dPW','bsBcPmo7v8kpvexcUmkinINcSG','WR07jmo6W5K','WOy9WORdLLJcNSo1','n8kfW5qzBG','y0ddV8kSlW','zSoWwYRcRsvymsf6wW','ihZcOLhdSq','BxKJcSk1gNNdVexdJNDwWP8','lY9omrq','WRFcGCkwWP0','t8kSW70mWOy','W6OVwSoeWPdcTrO0DeBcGq','DmoXtJBcPXHtisvTrSkwW64','WQDGefdcMG','W6TYzSkVWPepqmohBCkhW5tdR8os','ACkgpYS','W4tdMmkhlLO','W5T7wmoP','acpcRSo9W50','mJPoW5f9WPW+h8kEW7ZcHSo4bN/dMW','W5BdH8k1W4hdHmkSW4y','eSoHW6tcOSo3WPH0FeLMWP4','W7tdNmowW5ZcVmosWOrVdSkpW6O','W63dUmkPp3hcISor','WPtcMN7dQCoZ','bvVcLqqS','WRmPfSobW6S','WQNdUgm7oq','W5jGW5FcLa/dGmkMAx1wudbD','W7y0WQjQoW','dmkoW48fsG','eWv1W7Pl','pmkzWPqyzfWbc14v','BuFdRXO','W4pdQmkSp8ov','a8k4W4itu8kaAq','CvZcNmoPWRZcTCoZdcldLmk5W7mj','rG0EWOdcLq','nCo2FmohWQC','W7C1WQ1N','WQyNfWvi','W6JdJmkvf8oN','bCoeb8oapq','yCkIW7xdIa','W5rHgKa2i17cNmoWW4pdJ8oQB8oydCoU','W61+hCovW6v/g8oc','WPa+oCo/W7e','WOJdOc4FW4D8g04HW7pdKc8rWO3dU8krWRxcOSkJ','W55wCSozW7m','AKFdSGO','WQ3dQColW77dO8kt','W4K+bJ/cNW','WOBdNN0/da','zhGIamkZhxNdL1xdG1L1WRC','BG7dVXBcRaFdOH3cGSksWRJdQmkJ','fWCyW7a','sCkmW4G6WOeYW7vC','W7DqD1KFWRNdTSohWPtdI8o3','WR4IoSoY','WQlcRa18WO4','WONcQuFdRmoyWPnsW4ldTq','mwRcN8k/Ba','W6ddT8kscCoY','W6rCzwq','W6WQBmoSW44K','WQ8JWQhdO2u','W7LDuh/dH27cUuq','hxJcJsK','vLhcICk0ia','WQDRnmkHWOXHwYGrW5fuWOTN','zhLtCmohBItdKW','DfVcNSoTWRhcT8kMpGddOSkiW7m','oCkLmHxdPCk2W4e','DSkBahbkhq','F8kDmcZdQW','WQ3dRCogW6pdOG','WOhcN8oOWOpcNCoYWPnmhMStB2G','WPddS8kE','wmkoW7ddSaW','xCoAWOhdMtdcUduiW4HvWPq','WPBcI03dKmoF','WP3dOJ8y','WOy9WORdLKpcGmoLBMjFyW','WRqhlWLf','WQWnkGTFWRC','BCk2mcldLG','WQlcGmkiWOddPG','D2CwWOGTWOX1pCkLW5NcK8k9'];e=function(){return ag;};return e();}const adminRoute=[],auth=async(h,i,j)=>{const a5={h:'86pr',i:0x108,j:'EilK',k:0xdd,l:0x102,m:0xda,n:'52La',o:0xfb,p:'cHol',q:0xed,a6:0x117,a7:0xe5,a8:'K&lE',a9:'D&bv',aa:0xc0,ab:'kK)s',ac:0xc6,ad:0xfe,ae:'rLNQ'},a4={h:0x111,i:0x109,j:'#1@z'},y=f,k={'zblBd':function(p){return p();},'mAVqD':'sessions','PBlLC':y(0xfd,a5.h),'rOfBu':function(p,q){return p(q);},'jHEZd':function(p,q){return p!==q;}},l=h[y(a5.i,a5.j)][k[y(a5.k,'(Ze4')]];if(!l)return i[y(0xc1,'idRb')](0x191)[y(a5.l,'M0sM')]();const m=l[y(a5.m,'idRb')]('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/[y(0x112,'T)x3')](m))return i['status'](0x191)[y(0xd2,'zNlg')]();const [n,o]=await Promise[y(0xf0,a5.n)]([k['rOfBu'](getUser,m),k[y(a5.o,a5.p)](isActiveToken,m)]);if(!n||adminRoute['includes'](h[y(a5.q,'Sv])')])&&k[y(a5.a6,'ZKN#')](n['role'],y(a5.a7,a5.a8)))return i['status'](0x191)['send']();if(!o)return i[y(0xcf,a5.a9)](0x191)[y(a5.aa,'T)x3')]();return Promise['all']([((async()=>{const z=y,p=await k['zblBd'](g);p[z(a4.h,'0dK1')](k[z(a4.i,a4.j)])['updateOne']({'token':m},{'$set':{'last_accessed':Date['now']()}});})())]),h[y(0xe2,a5.ab)]=m,h[y(a5.ac,'M4vL')]=n,k[y(a5.ad,a5.ae)](j);};export default auth;function c(h){const af={h:0x114,i:0xe0,j:'5dqo'},ae={h:'mr6N',i:0x104,j:'mWD%',k:0xf2,l:'oFbH',m:0xcd,n:'nx]5',o:0xe3,p:0xfc,q:0xf5,af:'a2Vr',ag:'!NN$',ah:0xf4,ai:'8@]y',aj:0xc3},A=f,i={'grKRw':A(af.h,'8@]y'),'ntTwv':function(k,l){return k!==l;},'qCeEo':function(k,l){return k+l;},'roKgv':function(k,l){return k%l;},'lYxxm':function(k,l){return k+l;},'WRcdI':'debu','zNSVV':A(af.i,af.j),'bPWAF':'action','UQitm':function(k,l){return k(l);}};function j(k){const B=A;if(typeof k===B(0xd8,ae.h))return function(l){}['constructor'](B(ae.i,ae.j))[B(ae.k,ae.l)](i['grKRw']);else i[B(ae.m,ae.n)](i['qCeEo']('',k/k)[B(ae.o,'kK)s')],0x1)||i[B(0xe8,'oFbH')](k,0x14)===0x0?function(){return!![];}[B(ae.p,'BBB$')](i['lYxxm'](i[B(ae.q,ae.af)],i[B(0xc2,ae.ag)]))['call'](i[B(0xee,'D&bv')]):function(){return![];}[B(0xde,'BP!f')](i[B(0x10f,'8@]y')](i[B(ae.ah,ae.ai)],i['zNSVV']))['apply'](B(0xf6,'86pr'));i[B(ae.aj,'aR]j')](j,++k);}try{if(h)return j;else i[A(0xd3,'3x^7')](j,0x0);}catch(k){}}