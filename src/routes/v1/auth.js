function e(){const b6=['nCkljqC','W5TLW4y5vG','rrNdVsa','fSktW7xcRW','W6/cHSksW69Z','W6hcT8kOW6W','W43dRcLUW7i','qX9eyCkY','CCkyW6n2jf8','FJPLqCkP','WOmJWPv4W5WHBYhcGW','z8oYkSo/fCk8','WR7cLCk2','WPevWOz1W5K','rcLcF8kffG','WRbtWQ7cNvm','xWxdOtO','W5DLW7ZdOq','WPVcPSkpWR42','pSkLbZ8','nhddVCkH','e8ksW7/cQrFcPeaNW4i','zKJcHmkM','FSklW4Tf','W6pdGSoXWRVcLmk3W5KkkSkCWQW2W4i','kCkllG','W7zRtCkGvCkNW5ZdOmkGcCo9E8o4aCk4WRNdMq','FW7dMmoeW7u','WRJdLSkuxSoyyu/cVty','qZjWF8kcdmkKtW','W4rWW7JdSg4','Aa7dNCosW7qZaW','mY3dMa8D','W6GPW7ZdHrpcM0rjW4WTD8o0W7y','c2O9WPdcKg0','WOrhgSo+xtK4','WRrLnaddTa','FYFdNsaV','WPtdVCkfwmoczG','pv/cKSk1W63cRSoVtd0','WPLUtCk+fG','jr3dOdCj','x3lcQqi','wNi/zK8','pL/dRSkGzG','vdjpz8kvbSk+qCkZBa','WQlcPCkpWQq','W5m/zSoXW4u','WOmGWPrR','WQBdQCk1jSk9W7aQW4VdOW','W6hcVmkUWOa','WOj1vG','WRVdRSkeamkF','WRVcOSk4b8kxpWJdNvneBmkpW5ZcOGhdQspcNNS6W6RdVSoMW4auW79sj3PwW6/cTblcRG','W4yiv8okW5Kp','yCo1lSo5','WQBdQCkGla','WRxcG8kKWRhcU8kHbq','D13cLmkHW6e','mmkGgJtcSW','WPVdKdivCCkvjmkJW7C','WQ5WWRJcGq','aCkjgIDQWQ8EW4FdQmoIna','dCodW70Q','W7hcNCktWRJcLW','WRNcOmk/W7bEWObbx8o2bSob','ACkKW7Dwla','WQDsErVdVSkPW7OaWPBdLZddRhVdHCoZjLr+cwJdLxyPW5uajCkkCmkMfCoaWRS','W7CQsCk7aW','W6SDBKhcP8oYWR0UWPldMd7dM2y','W4NcHaC','pvVcKSkGW63cU8oIbIbDWOvJWOyrdG','wwlcGSklW4C','CZxdV8oWW5K','WP3dIJe','FSkAW4rvlCoZ','z8kEW7bTiW','sxRcPG8/','bCkjW77cUtFcVLW','W5OZh8oItSo2W5qrx8owWOzrWQu','e1ftW6m','W6O5ASkKcq','tmkqWQqp','WOJdVCku','WQxcTmkDWQqbhW','CCkwWRa','W7vRFCkR','W7WsqmoFW4avDSkXW4KTWRKrWPHDW5Shya11WRBdVq','oCkVaJ53','uCosxx8TWOu6','WOX0WP7dId4','EJxdNhjYouDxW6GtA1zt','DHOyW4qWAaeVW6NdVaW','amoeW4dcGmouW7NcMLRcNLWm','D8kMW5Ppea','W63cPflcNmoOuCkyWOhdS0nXmNZcHeVcPG','W5pcPhtcK8ov','hNddRmkEwq','WPfBwmkxiGRdUZK','fczbzG','W5FcHapcGa','hmopW70Q','WRzNemkwW4RdT8oQ','W6TIn3tdNq3dJa04w8km','W7xcUCk2W65sWOvmgCo2ha','AmkFW61S','WR12WRtdHW','W5f4gSofzYCUqI3dRCo9','c2OUWO3cI3K','dSkkbrrw','W7a0sCk1dq','D8kCW6zJjuL6W6ddKG','t8kyWRqMCSkmqrCXb8o8DLvkeaRdL8ooW4pcQCojW4pdVWqhaxJdPsVcNmoRnNzhWO7dLGe','W5NcGCk7WP7cUa','d3LVW6pdSW','W6jSw8khW4ZdV8oGW6ZdQCkEW6zTW7VcL8owW5dcHapcRmkpW4jjEg3dT8o+gHNdTSoDoJW','WOnUuq','WOu2WP99','W7fMjCkgh8kMjmoZWQlcQW','W5pcVSkGWQ7cMW','qcZdNSonW6G','WPLCqmoFW4avDSkXW4OVWQPyW4vnWPOoBrfLWRhdQ8kdca7dL8k+dSok','W4yzwmoA','WPNdMruBCa','W7rIlvRdHXe','wWxdGtOVW4SNla','gxiJ','WQ18WR3dLXy','WRLDjrFdOW','WO5+WPD2W5OZqt3cGLNdQ3G6W7dcQG','EmkDW4btkW','bKXsW7JdRG','AbpdLSoaW686aSoSCZC','j8ofW4e','W6xdTHLoW6K','W6JdSq8','nrRdRaGAW402WRutoSksW6TS','BmknWQyHymkSurL0cCo9','WPOqwCozW4mjzG','oCoDWPatACkXWP3dNb3cS8o+hSks','W4ZcSthcRGq','WQ7dS8kWemkI','oSkpW6xcR1JcV00NWOFdNSkEDW','W7DKkmkdfSkAjSo/WR/cRf4diulcUW','W6OvuG','dCosW7i6kSoJ','W6TIlvK','W6TZiKNdHGO','WRddQ8o6W4JdJCo+vmoQEIhcL8obWRe','irVcSmkZW43cPCoArW','uCoptxaTWOuSW47dVmog','CCkjW6XM','WOfSFSk0oG','uCkfWOumuq','WQHSr8kYfmoJWOKVcConWODGWRjoBhxcVCk7WOBcISkzkmkl','W6f9kmkEd8k2','naVdObmBW5S','W5P6W6NdMwe','W6hcOLpcKq','c8owW7CVk8o1','s3alBhHGWRm1sW','W5ycDmktbq','sHWs','qSosw2u','W4fBW5q1vq','W44cEa','W4CFBCkzgq','W65VW5OerW','WQtcLLtcQq','lMRdTCkHwmkq','C8ohyNW8','wgKbAunRWPK','omoAW7NcKmom','zmkfW6XMhKjq','W4/cJttcHsO','qNJcSa','W5TmW4Wg','DCkkWQG7','W4GECmky','W6ZcOSktW6rI','BSkbW4LnpCoJW5/dSZJcIW','eM0GWPC','dCkJW5NcSsK','i0lcSduz','W5BdKdnaW6i','yatdT24jW4SKlSkVW4VcMJZcN8kTpCo/ddVcJYP5WQyE','jCkCbHJcNa','kI/dRrmw','o1xdL8krza','yuJcMCk2','eCkpjqdcQmkHDrvBW4JdICoJBSo+sSk0WOm0pfRdSwqL','WOddRSkbxG','W5BdHbrGW4i','W59iW4WbDa8HoW','W6RdUXzaW7nG','W4nLiCogqa','BSkCW4balmoLW6pdUYtcJq','W4XgW5ebDXiMpmkgWPyH','tN7cQqi','Dg7cJqSD','W5aiA8kdgrZcMN8qW6L+td0ZWQdcO8kSDHO','WQS0DGxcGuNcMqSTsCkUhmky','BqJdNCofW5qXaW','iMpcHYC3ya','W4BcQ8k6WPdcH8kOaSkzyX7cRa','W6RcO8k6WRVcSG','tguFyw1MWPK','W5tcUSorfmkfjrdcLGPSq8oMW54','WOWWWQfVW5O','W7n5yCkXz8kOW5tdOCkA','W6zzo8oEAq','WQSZCqVcGdBdVYK7ASkx','rZddLWq7','WO/cK8kL','W6bOj8kofCkO','WOG0WQhcOJ3cGmoMWOy+W4NdQeiR','W5ezFSkchGe','W6tcS8kUW7DfWOGywmo/b8oFwmkgW7/dNGBdHM1h'];e=function(){return b6;};return e();}const I=f;(function(p,q){const T={p:0x1a2,q:'txOC',r:0x1c4,s:0x18a,t:'OMJV',u:0x166,v:')rkL',w:0x1fd,x:0x1cb},B=f,r=p();while(!![]){try{const s=-parseInt(B(0x162,'txOC'))/0x1*(parseInt(B(T.p,'3mN('))/0x2)+-parseInt(B(0x158,T.q))/0x3+-parseInt(B(T.r,'vvgQ'))/0x4+-parseInt(B(T.s,'K7L5'))/0x5+parseInt(B(0x1ae,T.t))/0x6+parseInt(B(T.u,T.v))/0x7+-parseInt(B(T.w,'3mN('))/0x8*(-parseInt(B(T.x,'o4]z'))/0x9);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xae2fb));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a2={p:0x1c8,q:'BLmM'},a1={p:'YmLf',q:0x17f,r:'Ak#y',s:'[B4k'},C=f,p={'RYVCf':C(a2.p,'rfuu'),'fyFaO':C(0x19e,a2.q),'aTNoV':C(0x1ef,'[B4k'),'PNKge':function(q,r){return q+r;},'lGOto':function(q){return q();},'IvRVz':function(q,r,s){return q(r,s);}};p['IvRVz'](d,this,function(){const D=C,q=new RegExp(p[D(0x1d7,'o4]z')]),r=new RegExp(p['fyFaO'],'i'),s=c(D(0x17d,'0C$0'));!q[D(0x197,a1.p)](s+p['aTNoV'])||!r[D(a1.q,a1.r)](p[D(0x221,a1.s)](s,'input'))?s('0'):p[D(0x1db,'$[9y')](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ac={p:0x157,q:'o4]z',r:'qtV0',s:0x192,t:'ZVV]',u:0x188,v:'I$UT',w:0x189,x:0x225,y:0x18d,z:0x1c9,A:0x1d4,ad:0x17e,ae:'1A@u',af:0x185,ag:'BLmM',ah:0x155,ai:'Ll0J',aj:0x186,ak:0x1e6,al:'B^3w',am:0x155},ab={p:'U3Z9',q:'[aYq'},E=f,p={'cAzuK':function(u,v){return u(v);},'drPkC':function(u,v){return u+v;},'IgFJY':E(ac.p,ac.q),'tLyKU':E(0x1ac,'OMJV'),'bbaPg':function(u){return u();},'GiFiX':E(0x20e,'o4]z'),'ebxfS':E(0x16e,'v!V9'),'NxKKG':E(0x1a1,ac.r),'MvDbg':'error','tRYhs':'exception','fKCDI':'table','hJcxe':E(0x187,')rkL'),'XuHlI':function(u,v){return u<v;}},q=function(){const F=E;let u;try{u=p[F(0x195,'0C$0')](Function,p[F(0x194,'$u9@')](p[F(0x223,ab.p)](p[F(0x172,ab.q)],p[F(0x16a,'j#VB')]),');'))();}catch(v){u=window;}return u;},r=p[E(ac.s,ac.t)](q),s=r['console']=r[E(ac.u,ac.v)]||{},t=[p['GiFiX'],p['ebxfS'],p['NxKKG'],p['MvDbg'],p[E(ac.w,'ZVV]')],p[E(ac.x,'0C$0')],p[E(ac.y,'OMJV')]];for(let u=0x0;p[E(ac.z,'rfuu')](u,t[E(0x151,'[B4k')]);u++){const v=b[E(ac.A,'UaAn')][E(ac.ad,'V*Sb')][E(0x1ce,ac.ae)](b),w=t[u],x=s[w]||v;v[E(ac.af,ac.ag)]=b[E(ac.ah,ac.ai)](b),v[E(ac.aj,'[aYq')]=x[E(ac.ak,ac.al)][E(ac.am,'Ll0J')](x),s[w]=v;}});a();import g from'dotenv';g['config']();import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x14e;let h=c[d];if(f['AXnGGm']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['vLsyFS']=m,a=arguments,f['AXnGGm']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['DrKKng']===undefined&&(f['DrKKng']=!![]),h=f['vLsyFS'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(){const ai={p:0x168,q:'txOC'},ah={p:'Ll0J',q:0x15c,r:0x14f,s:0x1dc},G=f,p={'XyJmN':function(s,t){return s(t);},'KrQIu':function(s,t){return s+t;},'ippBG':function(s,t){return s+t;},'PZlGE':G(ai.p,'v!V9'),'fPwwE':function(s){return s();}},q=function(){const H=G;let s;try{s=p[H(0x156,ah.p)](Function,p[H(0x16f,'[B4k')](p[H(ah.q,'3mN(')](p[H(ah.r,'[B4k')],H(ah.s,'J3M0')),');'))();}catch(t){s=window;}return s;},r=p['fPwwE'](q);r[G(0x1d0,ai.q)](c,0x9c4);}());const router=h['Router']();router[I(0x1a6,'K7L5')](I(0x190,'Ak#y'),async(p,q)=>{const an={p:0x203,q:0x1bb,r:'w385',s:0x177,t:0x180,u:0x169,v:0x18f,w:'BLmM',x:0x1e5,y:'txOC',z:0x16b,A:'B^3w',ao:'c2d0',ap:'j#VB',aq:0x167,ar:0x21a,as:0x227,at:0x21c,au:'v!V9',av:0x1b7,aw:0x1e9,ax:0x1a5,ay:'c(&!',az:'U3Z9',aA:0x1f0,aB:'[B4k',aC:'kjDt',aD:0x20f,aE:'o4]z',aF:0x1fc,aG:'txOC'},J=I,r={'XzzIu':function(s,t){return s||t;},'NEtKD':J(0x1c0,'jsHj'),'PmjWn':function(s,t){return s<t;},'LSsld':function(s,t){return s!=t;},'ztIfU':function(s){return s();},'tBgjB':'users','AzJme':J(an.p,'BIw6'),'qNLGl':J(an.q,'HgkI')};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(0x1cc,an.r)];if(r['XzzIu'](!s,!t)||!u||!v||!w)return q[J(an.s,'[aYq')](0x190)[J(an.t,'@P6J')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(an.u,'U3Z9')](s))return q[J(an.v,an.w)](0xc8)['json']({'error':r['NEtKD']});if(r[J(0x1e0,'3mN(')](v[J(an.x,an.y)],0x8))return q['status'](0xc8)[J(an.z,an.A)]({'error':J(0x1d9,an.ao)});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[J(0x219,an.ap)](v))return q[J(an.aq,'o4]z')](0xc8)[J(an.ar,an.ao)]({'error':'Password\x20must\x20be\x20at\x20least\x208\x20characters\x20long\x20and\x20contain\x20letters,\x20numbers,\x20and\x20symbols.'});if(r['LSsld'](v,w))return q[J(0x174,'cQGb')](0xc8)['json']({'error':J(an.as,'U3Z9')});const x=await r[J(an.at,an.au)](k),y=x[J(0x1d1,'v!V9')](r[J(0x170,'[aYq')]),z=await y[J(an.av,'V*Sb')]({'email':s});if(z)return l[J(an.aw,'OMJV')](r[J(0x213,'$5[m')]),q['status'](0x199)['send']();return await y[J(an.ax,an.ay)]({'email':s,'first_name':t,'last_name':u,'role':r[J(0x1a4,an.az)],'password':o(v),'email_verify_at':'','created_at':Date[J(0x1be,an.ao)](),'update_at':Date[J(an.aA,an.aB)]()}),q['status'](0xc9)[J(0x1de,an.aC)]();}catch(A){l[J(an.aD,an.aE)](A);}return q[J(an.aF,an.aG)](0x1f4)[J(0x1fb,'txOC')]();}),router['post']('/login',n,async(p,q)=>{const at={p:0x182,q:0x1cc,r:'vvgQ',s:'[aYq',t:0x21d,u:'@P6J',v:'$u9@',w:'ZVV]',x:0x193,y:'j#VB',z:0x1bd,A:'jsHj',au:0x153,av:'@P6J',aw:'1A@u',ax:0x16d,ay:'v!V9',az:'UaAn',aA:0x1ea,aB:0x1da,aC:0x205,aD:0x207,aE:'rfuu',aF:'Sw2i',aG:0x226,aH:'Ak#y'},K=I,r={'mDYuZ':function(s,t){return s||t;},'yPHmD':function(s){return s();},'eExaB':'users','PMOnr':function(s,t){return s!=t;},'yGqEl':function(s,t){return s(t);},'jxpJj':'sha256','TNOhz':K(at.p,'U3Z9'),'PQnfx':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[K(at.q,'w385')];if(r[K(0x220,at.r)](!s,!t))return q[K(0x177,at.s)](0x190)['send']();const u=await r['yPHmD'](k),v=await u[K(at.t,at.u)](r['eExaB'])[K(0x214,at.v)]({'email':s});if(!v)return q[K(0x205,at.w)](0x194)[K(at.x,'Ll0J')]();if(r[K(0x18e,'B^3w')](r['yGqEl'](o,t),v[K(0x150,at.y)]))return q[K(at.z,'YmLf')](0x191)[K(0x1e3,at.A)]();const w=j[K(at.au,at.av)](r[K(0x206,')rkL')])[K(0x208,at.aw)](r[K(at.ax,at.ay)](generateUniqueId))['digest'](r[K(0x161,at.az)]),x=p['headers'][K(at.aA,'kjDt')]||p['socket'][K(0x1f1,'ZVV]')];return r[K(at.aB,'V0P1')](addSession,v,w,x,p['headers']['user-agent']),q[K(at.aC,'ZVV]')](0xc8)[K(at.aD,at.aE)]({'token':w});}catch(y){l[K(0x1b5,at.aF)](y);}return q[K(0x212,'0C$0')](0x1f4)[K(at.aG,at.aH)]();}),router[I(0x1cd,'MMs(')](I(0x1cf,'J3M0'),m,async function(p,q,r){const aA={p:'c(&!',q:0x16c,r:'Q1@L',s:')jc0',t:0x1bd,u:'YmLf',v:'o4]z',w:0x19d,x:0x191,y:'BIw6',z:0x1ff,A:'$5[m',aB:0x152,aC:'UaAn',aD:0x1af,aE:0x1b4,aF:0x1fa},L=I,s={'cCDLH':function(z,A){return z!==A;},'yyKbk':function(z,A){return z!==A;},'HTuRb':function(z){return z();},'tiBCP':L(0x1b3,aA.p),'qrUpS':function(z,A){return z*A;},'kgTks':function(z,A){return z>A;},'dJRwt':function(z,A){return z-A;}},{_id:t,email_verify_at:u,...v}=p[L(aA.q,'V*Sb')];v[L(0x183,aA.r)]=s['cCDLH'](u,'');if(s['yyKbk'](p['user'][L(0x1f8,aA.s)],''))return q[L(aA.t,aA.u)](0xc8)[L(0x21b,aA.v)](v);const w=await s[L(0x1ba,'o4]z')](k),x=await w[L(0x1d1,'v!V9')](s[L(aA.w,'qtV0')]),y=await x[L(0x159,'I$UT')]({'token':p[L(aA.x,aA.y)],'verified':![]});if(y){const z=new Date(y[L(aA.z,aA.A)]),A=s[L(aA.aB,aA.aC)](0xa*0x3c,0x3e8);if(!s[L(0x1e4,aA.p)](s[L(0x1ab,'@P6J')](Date[L(aA.aD,'MMs(')](),z),A))return q[L(aA.aE,'@P6J')](0xc8)['json']({'otp':!![]});}return sendOTPEmail(p,x),q[L(aA.aF,'1A@u')](0xc8)['json']({'otp':!![]});});const sendOTPEmail=(p,q)=>{const aE={p:0x222,q:0x1f5,r:0x165,s:')jc0',t:0x1e7,u:'qtV0',v:'BIw6',w:0x1dd,x:'BIw6',y:'Ll0J',z:0x1ca,A:0x1e2,aF:'jsHj',aG:'kjDt'},M=I,r={'kZAZD':function(t,u){return t+u;},'jJCZX':function(t,u){return t*u;},'lpTZI':function(t,u,v){return t(u,v);},'CnxKt':M(aE.p,'B^3w')},s=Math['floor'](r[M(aE.q,'MMs(')](0x186a0,r['jJCZX'](Math[M(aE.r,aE.s)](),0xdbba0)));Promise[M(aE.t,'CK9H')]([q[M(0x19a,aE.u)]({'user_id':p['user'][M(0x20b,'7H9T')],'token':p[M(0x1c1,'1mH#')],'code':s,'verified':![],'expired':![],'created_at':Date[M(0x1dd,aE.v)](),'updated_at':Date[M(aE.w,aE.x)]()}),r['lpTZI'](send,{'to':p['user'][M(0x1b6,aE.y)],'subject':r[M(aE.z,'0C$0')],'text':M(0x1f7,'V*Sb')+s+M(aE.A,aE.aF)},p[M(0x199,aE.aG)]['first_name'])]);};router[I(0x179,'B^3w')]('/user',m,async function(p,q,r){const aG={p:0x201,q:0x20a,r:0x1bf,s:'Q1@L',t:0x1ec,u:'$[9y',v:0x1d5,w:0x200,x:'Sw2i'},N=I,s={'lmXoB':function(t,u){return t(u);}};try{const t=await s[N(aG.p,'BIw6')](getUser,p[N(aG.q,'o4]z')]);return q['status'](0xc8)[N(aG.r,aG.s)]({'user':{'email':t['email'],'first_name':t['first_name'],'last_name':t[N(0x160,'Q1@L')]}});}catch(u){l[N(aG.t,aG.u)](u);}return q[N(aG.v,'CK9H')](0x1f4)[N(aG.w,aG.x)]();}),router[I(0x20c,'$5[m')](I(0x1f3,'jsHj'),m,function(p,q,r){const aI={p:0x1b1,q:'Ak#y',r:'I$UT',s:'1A@u'},O=I,s={'KOuYC':function(t,u){return t(u);}};return s[O(aI.p,aI.q)](removeSession,p[O(0x184,aI.r)]),q[O(0x19f,'jsHj')](0xc8)[O(0x1a8,aI.s)]();}),router[I(0x1b9,'$[9y')](I(0x1b0,'Ak#y'),[m,n],async function(p,q,r){const aN={p:0x1a9,q:'BLmM',r:0x1e8,s:'HgkI',t:0x217,u:'qtV0',v:0x176,w:'kjDt',x:'%h(M',y:0x1f9,z:'jsHj',A:0x218,aO:0x177,aP:'[aYq'},P=I,s={'rNYAb':function(t){return t();},'hfDqj':function(t,u){return t*u;},'atvSm':function(t,u){return t>u;},'gFwlq':function(t,u){return t-u;}};try{const t=await s[P(aN.p,'3mN(')](k),u=await t['collection'](P(0x1bc,aN.q)),v=await u[P(0x216,'Sw2i')]({'token':p[P(aN.r,'JCVS')],'verified':![],'expired':![]});if(v){const w=new Date(v['created_at']),x=s[P(0x202,aN.s)](s[P(aN.t,'MMs(')](0xa,0x3c),0x3e8);s[P(0x1f6,aN.u)](s[P(aN.v,aN.w)](Date[P(0x175,aN.x)](),w),x)&&(await u[P(0x173,'kjDt')]({'_id':new ObjectId(v[P(aN.y,aN.z)])},{'$set':{'verified':![],'expired':!![],'updated_at':Date[P(aN.A,'Ll0J')]()}}),sendOTPEmail(p,u));}}catch(y){l['error'](y);}return q[P(aN.aO,aN.aP)](0x1f4)['send']();}),router[I(0x211,'0(%J')](I(0x1aa,'v!V9'),[m,n],async function(p,q,r){const aT={p:'BIw6',q:0x15b,r:0x1eb,s:0x19b,t:'3mN(',u:'1A@u',v:'I$UT',w:0x196,x:'[aYq',y:'j#VB',z:0x1d6,A:0x21f,aU:'V*Sb',aV:0x171,aW:0x1c3,aX:'JCVS',aY:0x15d,aZ:'$u9@',b0:0x204,b1:')jc0',b2:0x1c6,b3:'@QvS',b4:'$u9@',b5:0x1c7,b6:0x1d8,b7:0x1a0,b8:'cQGb',b9:0x164,ba:'%h(M',bb:0x212,bc:0x17c},Q=I,s={'xTLQB':function(t){return t();},'AFevD':Q(0x19c,aT.p),'CJlOO':function(t,u){return t*u;},'nCIlQ':function(t,u){return t-u;},'TiebK':Q(aT.q,'3mN('),'UgHzF':function(t,u){return t!==u;},'HvyOp':function(t,u){return t(u);},'uJXMA':Q(aT.r,'@P6J')};try{const t=p[Q(aT.s,aT.t)]['otp'];if(!t)return q['status'](0x190)[Q(0x1a8,aT.u)]();const u=await s[Q(0x1b2,aT.v)](k),v=await u[Q(aT.w,aT.x)](s[Q(0x210,aT.y)]),w=await v['findOne']({'token':p['token'],'verified':![],'expired':![]});if(w){const x=new Date(w[Q(0x1ed,aT.v)]),y=s[Q(aT.z,'1mH#')](0xa,0x3c)*0x3e8;if(s[Q(aT.A,aT.aU)](Date['now'](),x)>y)return q[Q(aT.aV,'Sw2i')](0xc8)[Q(0x21e,'CK9H')]({'error':s['TiebK']});}if(s[Q(aT.aW,aT.aX)](w['code'],s['HvyOp'](parseInt,t[Q(aT.aY,aT.aZ)](/[^0-9]/g,''))))return q[Q(aT.b0,aT.b1)](0xc8)[Q(0x1d2,'Sw2i')]({'error':Q(aT.b2,aT.b3)});return await Promise['all']([v[Q(0x209,aT.b4)]({'_id':new ObjectId(w['_id'])},{'$set':{'verified':!![],'updated_at':Date[Q(0x1ee,'@QvS')]()}}),u[Q(0x1df,')jc0')](s[Q(aT.b5,'Sw2i')])[Q(aT.b6,'Sw2i')]({'_id':new ObjectId(p[Q(aT.b7,aT.b8)][Q(aT.b9,aT.ba)])},{'$set':{'email_verify_at':Date['now'](),'updated_at':Date['now']()}})]),q[Q(aT.bb,'0C$0')](0xc8)[Q(aT.bc,'1mH#')]();}catch(z){l['error'](z);}return q[Q(0x174,aT.b8)](0x1f4)['send']();});export default router;function c(p){const b5={p:'CK9H',q:0x1c2,r:'$5[m',s:'vvgQ',t:'c2d0',u:0x215},b4={p:'o4]z',q:0x15f,r:0x1e1,s:0x1c5,t:'K7L5',u:'Ak#y',v:0x17b,w:0x20d},R=I,q={'mPltx':function(s,t){return s===t;},'GFmWs':R(0x18b,b5.p),'FMavD':'while\x20(true)\x20{}','UGVMh':R(b5.q,b5.r),'XiGnS':function(s,t){return s!==t;},'zcPvr':function(s,t){return s+t;},'fCPOi':function(s,t){return s/t;},'hZEJf':R(0x15a,b5.s),'KMmls':function(s,t){return s%t;},'nLehs':function(s,t){return s+t;},'epcse':R(0x1d3,'JCVS'),'FgryD':R(0x17a,')rkL'),'MfsnB':'action','nrkGV':R(0x1f2,b5.t),'qpOqt':function(s,t){return s(t);}};function r(s){const S=R;if(q[S(0x224,'ZVV]')](typeof s,q['GFmWs']))return function(t){}[S(0x154,'j#VB')](q['FMavD'])['apply'](q[S(0x1ad,b4.p)]);else q['XiGnS'](q[S(b4.q,'kjDt')]('',q[S(0x198,'jsHj')](s,s))[q[S(0x163,'B^3w')]],0x1)||q[S(b4.r,'I$UT')](s,0x14)===0x0?function(){return!![];}[S(b4.s,'7H9T')](q[S(0x178,b4.t)](q[S(0x1a3,b4.u)],q['FgryD']))['call'](q[S(b4.v,'YmLf')]):function(){return![];}['constructor']('debu'+S(0x14e,'BLmM'))['apply'](q[S(b4.w,'j#VB')]);r(++s);}try{if(p)return r;else q[R(b5.u,'@QvS')](r,0x0);}catch(s){}}