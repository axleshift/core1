import{R as e,r as s,j as a}from"./B29SdWEC.js";import{F as t,z as i,P as r,H as o,I as n,C as l}from"./CW_edERI.js";import{R as c}from"./Cri8ushB.js";import{a as m,b as d,V as j,e as p}from"./D9DjP_Z5.js";import{c as h,a as u,b as x,P as f,Q as b,S as g,y as v,T as y,W as N,X as z,i as C}from"./BO3pT5LR.js";import"./ucIcx5RQ.js";import"./E8MUDNEF.js";import"./4RmQ9_ev.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BFKNndIN.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./BmTZu7tj.js";import"./CxXfFpkk.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./DShVK1TZ.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./D0A342eN.js";import"./DPAjA2jz.js";import"./OBe_9qlD.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const _=()=>{const{user:_,setUser:w}=m(),S=e.useRef(),D=Intl.supportedValuesOf("timeZone"),{addToast:A}=d(),[F,R]=s.useState({first_name:_.first_name,last_name:_.last_name,timezone:_.timezone}),[T,$]=s.useState({email:_.email}),[k,I]=s.useState(!0),[E,U]=s.useState("/images/default-avatar.jpg");s.useEffect((()=>{_&&_.ref&&U(`${j}/u/${_.ref}.png`),I(!1)}),[]);const q=(e,s)=>{const{id:a,value:t}=e.target;if("accountDetails"===s)return R((e=>({...e,[a]:t})));$((e=>({...e,[a]:t})))},G=async e=>{const s=await S.current.executeAsync();I(!0);const a={...e,recaptcha_ref:s};axios.post("/auth/user",a).then((e=>{if(e.data.error)return A(e.data.error);w(e.data),A("Your changes has been saved.")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||"Server is offline or restarting please wait";A(t,"Fetch failed!")})).finally((()=>I(!1)))};return a.jsxs("div",{children:[k&&a.jsx("div",{className:"loading-overlay",children:a.jsx(h,{color:"primary",variant:"grow"})}),a.jsx(c,{ref:S,size:"invisible",sitekey:p}),a.jsxs(u,{xs:{cols:1},sm:{cols:2},children:[a.jsxs(x,{children:[a.jsx("h4",{children:"Account details"}),a.jsx(f,{className:"mb-3",children:a.jsx(b,{children:a.jsxs(g,{onSubmit:e=>{e.preventDefault(),G(F)},children:[_.avatar?a.jsx(v,{crossOrigin:"Anonymous",src:`${j}/u/${_.avatar}.png`,className:"rounded-5",fluid:!0,width:"40px",height:"40px",loading:"lazy"}):a.jsx("div",{className:"rounded-pill bg-primary d-flex align-items-center justify-content-center mb-3 fs-4",style:{width:"70px",height:"70px",color:"white"},children:(L=_.first_name,L?L.charAt(0).toUpperCase():"")}),a.jsx(y,{id:"profile_pic",type:"file",className:"mb-3",disabled:!0}),a.jsxs(u,{children:[a.jsx(x,{md:6,className:"mb-3",children:a.jsxs(N,{children:[a.jsx(z,{children:a.jsx(t,{icon:i})}),a.jsx(y,{id:"first_name",type:"text",placeholder:"First Name",autoComplete:"given-name",value:F.first_name,onChange:e=>q(e,"accountDetails")})]})}),a.jsx(x,{md:6,className:"mb-3",children:a.jsxs(N,{children:[a.jsx(z,{children:a.jsx(t,{icon:i})}),a.jsx(y,{id:"last_name",type:"text",placeholder:"Last Name",autoComplete:"family-name",value:F.last_name,onChange:e=>q(e,"accountDetails")})]})})]}),a.jsxs(N,{className:"mb-2",children:[a.jsx(z,{children:a.jsx(t,{icon:r})}),a.jsx(y,{type:"text",id:"timezone",placeholder:"Timezone",list:"timezone-options",value:F.timezone,onChange:e=>q(e,"accountDetails")}),a.jsx("datalist",{id:"timezone-options",children:D.map((e=>a.jsx("option",{value:e},e)))})]}),"user"===_.role&&a.jsxs("div",{className:"mb-3",children:[a.jsxs(C,{color:"secondary",className:"mb-1 me-2 rounded",size:"sm",disabled:!0,children:[a.jsx(t,{icon:o})," ",_.oauth2&&_.oauth2.google?_.oauth2.google.email:"Connect Google"]}),a.jsxs(C,{color:"secondary",className:"mb-1 me-2 rounded",size:"sm",disabled:!0,children:[a.jsx(t,{icon:n})," ",_.oauth2&&_.oauth2.github?_.oauth2.github.email:"Connect Github"]})]}),a.jsx(C,{type:"submit",color:"primary",className:"d-block me-2 rounded",children:"Save changes"})]})})})]}),a.jsxs(x,{children:[a.jsx("h4",{children:"Contact info"}),a.jsx(f,{className:"mb-3",children:a.jsx(b,{children:a.jsxs(g,{onSubmit:e=>{e.preventDefault(),G(T)},children:[a.jsxs(N,{children:[a.jsx(z,{children:a.jsx(t,{icon:l})}),a.jsx(y,{disabled:"user"!==_.role,type:"email",id:"email",placeholder:"Email",autoComplete:"email",value:T.email,onChange:e=>q(e,"contactInfo")})]}),"user"===_.role&&a.jsx(C,{type:"submit",color:"primary",className:"mt-3 me-2 rounded",children:"Save changes"})]})})})]})]}),"user"===_.role&&a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"text-danger",children:"Delete account"}),a.jsx(f,{className:"mb-3",children:a.jsxs(b,{children:[a.jsxs("p",{children:["If you wish to delete your account, please note that this action is irreversible and will remove all your data permanently.",a.jsx("br",{}),"To proceed with the deletion of your account, please click the button below:"]}),a.jsx("span",{className:"text-muted",children:"We cannot process your account deletion request, if you have unpaid invoices or inroute shippment"}),a.jsx(C,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:!0,children:"Request account deletion"})]})})]})]});var L};export{_ as default};
