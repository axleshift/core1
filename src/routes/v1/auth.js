const H=f;(function(p,q){const Q={p:'aWWB',q:'SQ!m',r:0x1f1,s:'MnZT'},B=f,r=p();while(!![]){try{const s=-parseInt(B(0x1f5,')dfq'))/0x1+parseInt(B(0x276,'aWWB'))/0x2*(-parseInt(B(0x245,Q.p))/0x3)+-parseInt(B(0x205,Q.q))/0x4+parseInt(B(0x237,'!VdH'))/0x5+parseInt(B(0x1e5,'#g7a'))/0x6+parseInt(B(Q.r,Q.s))/0x7+-parseInt(B(0x211,'Kl$j'))/0x8;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xd9b70));function f(a,b){const c=e();return f=function(d,g){d=d-0x1df;let h=c[d];if(f['DjIuyP']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['fTqqVJ']=m,a=arguments,f['DjIuyP']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['bZUAWf']===undefined&&(f['bZUAWf']=!![]),h=f['fTqqVJ'](h,g),a[k]=h):h=l,h;},f(a,b);}const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x26a,'zaq7')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:'kTCH',q:0x246,r:'Uv$z',s:'QKHD'},a0={p:0x217,q:'9^#4',r:0x21e,s:'Uv$z',t:0x1e8,u:'w^^l',v:'%xS2',w:0x1e1,x:0x22b,y:0x202,z:'cE7)'},D=f,p={'puUmX':D(0x228,a1.p),'DWpRj':function(q,r){return q(r);},'dnHco':D(a1.q,a1.r),'sxnxu':function(q,r){return q+r;},'WFKNX':'chain','XyeGZ':D(0x260,a1.s),'ibieB':function(q,r){return q(r);},'UKCQq':function(q){return q();},'fneYS':function(q,r,s){return q(r,s);}};p['fneYS'](d,this,function(){const E=D,q=new RegExp(E(a0.p,a0.q)),r=new RegExp(p[E(a0.r,a0.s)],'i'),s=p[E(0x1f7,'1Ec6')](c,p[E(a0.t,']*RD')]);!q[E(0x24b,a0.u)](p['sxnxu'](s,p[E(0x1e3,a0.v)]))||!r[E(a0.w,'[oiQ')](s+p[E(0x23d,'kTCH')])?p[E(a0.x,'J9hL')](s,'0'):p[E(a0.y,a0.z)](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(0x20c,'%xS2')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a9={p:0x225,q:'sA%4',r:0x1f2,s:'Uw[8',t:0x24d,u:0x270,v:0x227,w:'J9hL',x:0x1ec,y:'SQ!m',z:0x26d,A:'[eaR',aa:0x20a,ab:'kjF]',ac:0x213,ad:0x24f,ae:0x25f,af:'GFXi',ag:'!VdH',ah:0x21c},G=f,p={'VMRuA':function(t,u){return t(u);},'CDeTC':function(t,u){return t+u;},'bwgWe':G(a9.p,a9.q),'GqjlG':G(0x1e2,'35@t'),'bjRJc':function(t){return t();},'ZZcEO':G(a9.r,'#g7a'),'VKTCD':G(0x250,'aWWB'),'TuEIY':G(0x22a,'1Ec6'),'CujQj':G(0x263,a9.s),'nHFZE':G(0x23e,'6K@G')};let q;try{const t=p['VMRuA'](Function,p['CDeTC'](p[G(a9.t,'1!*p')]+p[G(0x1e9,'#qYF')],');'));q=p['bjRJc'](t);}catch(u){q=window;}const r=q[G(a9.u,'beor')]=q[G(a9.v,a9.w)]||{},s=[p[G(0x238,'r9ZK')],'warn',p[G(a9.x,a9.y)],p['TuEIY'],p[G(a9.z,a9.A)],G(0x222,'r9ZK'),p[G(a9.aa,a9.ab)]];for(let v=0x0;v<s[G(a9.ac,'8PF6')];v++){const w=b[G(0x22c,'#K(i')]['prototype'][G(0x25a,'1Ec6')](b),x=s[v],y=r[x]||w;w[G(a9.ad,'QKHD')]=b[G(a9.ae,a9.af)](b),w[G(0x212,a9.ag)]=y['toString'][G(a9.ah,'DmVJ')](y),r[x]=w;}});a();function e(){const aE=['wmkTg1e','WQX/W5nQjbe','aSo7FGhcIW','EbqldMO','WRXKW55YnafpA8kPW5S','W4X4W47dVtjb','l3dcHfnG','CSo/xmoglG','e2X1WRVcSW','CJndeCklicWDWQldSSoYFtu','EmoREmohiG','WRBdNCoKW5OlnCkvFcxdR1BdVsK','AaOZ','zSowghvlpmo3srZcKctcQfldM8k0','fv7cVNDqkW','WOy9WP/cUNCcWQhdNK7dRCoZWRq','qCk2uSkm','B8kstCkWWPq','WR0MFSo2WR4','WPtcSCovqa','k3PWW57dV0RcHW','csDiW6e','amo8waBcQ3RdVW','W7iboaO','edxdLJTzqSo5WPPeWOPbWR86hSo2WPqHorBdK8k+W6xdPCkHDdSyhw7cUCkqW6ZcIsPbxeW7aSoQE8o9WPegF8k0CcjiW6KOWQ/cL8o4w8oyemoLWPhdGxBcMKqIvmoqW5mFWRSGW6rTW5Svxmk+EmowqSktfSo/WOaZWQJcNq','pmkRWOJdGMC','pZdcQ8kwWQG','F0qVWRhcHCk1wbG6W67cNazBWPz+','qSo5xSo7hq','WO44WPC8WQ3dNmoiW47dHt0','A0mOWQ7cLmoNbq88W7tcIW','tq7dPcquCYBdMmozWOxdISkDuG','WOdcSuBdSa','fhrpWRO','g2hdSSo2W6K','W7BcKmk2WPHiDq','WRzNbc92','iXzHaw0','W41dfSoWfW','W51JW4VdSa','ldlcJ8oiW4O','CryXWOxdOa','W5pcS8k7WR5Y','W79YjCoCW5ldU8k2x8kBW5WSWPf7','W7ZcJWGMufJdK0S','WPZcU1VdO8oOea','W70pWRZdQvC','Fmo9B8oljG','WQ0azq','WOZdImkSWOjipgS9W4qBWPtdSSkHWRqiWQ4','DCknmxtdUCohCSo1qWBcH8kcBYzcWQ5FWORdSG','umk4e8kbWPeWxLpcTmkEWOGQwCo9WQHeW59/WReBWOFdJN8iWRyxW5G4iwnPWO0','WP8WWOBdVhC','tSkrm0nH','yJ9agG','q8k4e0JdIq','WQFdNd1NqG','BJpdPmkLcxmuWRddRCoKWR7dK8onc8knnmo9WRymjmkqkf97oa7dU8kWaZupqmkZW5lcSIxdJa','CCkaW65ZWR/dPGJcRrOXCq','Dmknk2u','jslcUmkVWRu','WR9ijWC','eaKobutdNa','etftW7PzWQDyWQZdKCkvzCoDWRPwhxD2v8oQ','WOBdMmkSWOzipq','gx7dRmoPW7/dQ2e','u8kenmoXWRGYWPeWWPmpW5G0WQzUW4pcN8kYW5dcJ8oyiIrCrSo1W7pdRdNdKSk5W6C2W5RcHW','WRZdUeNcPSk+','tSk3t8knWOW','e3pdQ8o/W5i','WOJdKMxcLmktlmkFyCkwW78I','W4RcL8keWQzO','W63cKIK9ua','WQtdJazU','DuldHHa','WRv4W51W','W4TPW5ZdVq','WQldMG14','bmkGt2bi','ArJcRhi','WOVdJCkYWO1f','WR/dKMPJgWNcJvv/W7baW6OS','cXNcUCkgWP8','pSoCWPHaxG','WO/dLgZcGSkukG','c3rfWQBdRrhcGhrzWP0','ze7dGq0LWRm','v8owdCkDW4i','wmk6cuBdKG','W4aKWOBdQNiaW59e','W5zIW5ZdRdvgWR3dSKW','WQTBiWfgDG','kMLzWR7cIa','WOpcRCousW','iIBcTmkN','b2hcRSoMrI0fWOlcGSoeWQRdPW','WR7dHWf+','W7hdVmkTWQtcSmoQ','egldRCo0','W5XJW4hdUJnaWOFdV13dSCo7','bIzvW6bz','CuJdHHa','WRDUW5n6nbbi','WO8GWPWhWQ0','WQ7dV0hcQ8k9','W7ZdJmkOWQlcUSoSW6VdSHa','vZZdSCk5','oSkLt0zr','lSk1qh9VW6u','WR80FmkDWPFcUG','dZvuW7T0WQCzW6NdKG','kmoCWO9wAq','adTjW6LcWQ4','j1OJWQ/cICoZcq','zmoxC8oo','Ca7cRxG','sCkSu8kg','kJPrW65hWQaCWQtdKSknASoxWQiFe306dmkVW6/cSq','W7VcHtu2','W59hb8oOc8oWiCkDW5BcIfu','WRFcSSkCWPzAy8ou','hg5oWRa','W4RdVCkOWQxcOq','rSk7b0S','W7eAorFcQZO','omk5qM5QW6irWPlcGG','wdVdPCkLcKmiWRxcOmoS','WPGguSkOxSkpE8kVW5lcUgRdTxG','kvRcO2ntlgZdPmkyWRldRSkatbKVWRBcKCoRsfm+kvi','zSkXrmkiWQO','WPXlaq5Lba','kL/dKamJWQ7cIYRcQa','WQlcQIGLWOa','W4H5W6VdQcm','zmkndKXO','WRijsgJdHa','WQZcTSotC8oa','WOn8W4BcRZnCWPrryGxdUmohAW','yCkkW7rjWR7dVGG','jM1JW5xdQa','DmkCjhxdVSoA','hSodWOTgqe1pWR7cKNFcOw0IiSk5WRtcMCopWR5MW5KUsq','yZLadCklnXGAWRldR8oL','WRdcRJK9WOZdJW','datdNmkSgxKE','F0jIEW','WPTqcX9+','WPTAeW4','imotW4rmqWnvWQ7dGgpcRMSOmCo1W6/dI8opWRj6W5G0gHldLmknn8oKW4RcQ0BcNG','W7T1lCosnG','WR8OFmoBW5FdVW','pvXGW4BcPCojFw1JWR0NWOCd'];e=function(){return aE;};return e();}import g from'dotenv';g[H(0x256,'sA%4')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';(function(){const ad={p:0x218,q:0x219,r:'1Ec6',s:0x26b,t:')dfq',u:0x267},I=H,p={'aqZSM':function(r,s){return r(s);},'wuDad':function(r,s){return r+s;},'MtyjT':I(ad.p,'Tq8R'),'QIiDM':I(ad.q,ad.r),'WEBAY':function(r){return r();}};let q;try{const r=p['aqZSM'](Function,p[I(ad.s,ad.t)](p[I(ad.u,'1Ec6')],p['QIiDM'])+');');q=p[I(0x229,'#K(i')](r);}catch(s){q=window;}q[I(0x220,'beor')](c,0x9c4);}());import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';const router=h[H(0x247,'QKHD')]();router[H(0x206,'8PF6')](H(0x269,'w^^l'),async(p,q)=>{const ah={p:'sA%4',q:0x273,r:0x243,s:'&89u',t:'4SQL',u:0x1e7,v:'6K@G',w:0x1eb,x:0x226,y:'9^#4',z:0x252,A:0x248,ai:'GFXi',aj:0x1fe,ak:']V#e',al:'[oiQ',am:'SQ!m',an:0x1f0,ao:'cE7)',ap:0x271,aq:'$*0N'},J=H,r={'zvpVQ':function(s,t){return s||t;},'Wdthi':J(0x25b,ah.p),'eMAlB':function(s,t){return s<t;},'PjMYX':function(s){return s();},'oYemN':J(ah.q,'35@t')};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(ah.r,ah.s)];if(r[J(0x26c,ah.t)](!s,!t)||!u||!v||!w)return q[J(ah.u,'SAlT')](0x190)[J(0x221,'Tq8R')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(0x1e6,ah.v)](s))return q[J(ah.w,')dfq')](0xc8)[J(0x1fb,ah.p)]({'error':r[J(0x20e,'z^yR')]});if(r[J(0x1ed,'cE7)')](v[J(ah.x,ah.y)],0x8))return q[J(ah.z,'Uw[8')](0xc8)[J(ah.A,'J9hL')]({'error':J(0x21f,'aWWB')});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[J(0x232,')dfq')](v))return q[J(0x275,'zaq7')](0xc8)[J(0x207,ah.ai)]({'error':J(ah.aj,ah.ak)});if(v!=w)return q[J(0x268,ah.al)](0xc8)[J(0x231,'SAlT')]({'error':J(0x266,ah.am)});const x=await r[J(0x21b,'4SQL')](k),y=x[J(0x203,'1!*p')]('users'),z=await y['findOne']({'email':s});if(z)return l[J(0x239,'35@t')](r[J(ah.an,ah.ao)]),q[J(0x272,'Tq8R')](0x199)[J(0x1df,'ukoB')]();return await y[J(0x240,')dfq')]({'email':s,'first_name':t,'last_name':u,'role':J(0x1f9,'&89u'),'password':o(v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[J(0x253,'Kl$j')](0xc9)['send']();}catch(A){l[J(ah.ap,ah.aq)](A);}return q[J(0x209,'MnZT')](0x1f4)['send']();}),router[H(0x230,'w^^l')](H(0x224,'#qYF'),n,async(p,q)=>{const an={p:0x20f,q:')dfq',r:'GFXi',s:0x268,t:'[oiQ',u:0x235,v:'9TFH',w:'SAlT',x:'r9ZK',y:']*RD',z:0x252,A:'Uw[8',ao:0x244,ap:0x22d,aq:0x23f,ar:0x23a,as:'lTKJ',at:0x1fa,au:'$*0N',av:0x1f3,aw:'4SQL',ax:'DmVJ',ay:'m&]%',az:'MnZT',aA:'6K@G',aB:0x22e,aC:'!VdH',aD:0x258,aE:'cE7)'},K=H,r={'mkUos':function(s,t){return s||t;},'vRGRw':function(s){return s();},'nsqUx':K(an.p,'#g7a'),'uBKFr':function(s,t){return s!=t;},'OsSJU':function(s,t){return s(t);},'sJJsO':K(0x1e4,'Kl$j'),'BGxvf':function(s,t,u,v,w){return s(t,u,v,w);},'VWlRO':K(0x23b,'GFXi')};try{const {email:s,password:t}=p[K(0x20d,an.q)];if(r[K(0x1ee,an.r)](!s,!t))return q[K(an.s,an.t)](0x190)[K(an.u,an.v)]();const u=await r['vRGRw'](k),v=await u[K(0x1ea,an.w)](r[K(0x200,an.x)])[K(0x1fc,an.y)]({'email':s});if(!v)return q[K(an.z,an.A)](0x194)[K(an.ao,an.x)]();if(r['uBKFr'](r[K(an.ap,'MnZT')](o,t),v[K(an.aq,'6#Yw')]))return q['status'](0x191)[K(0x22f,'Uv$z')]();const w=j['createHash'](r['sJJsO'])['update'](generateUniqueId())[K(an.ar,'#K(i')](K(0x216,an.as)),x=p[K(an.at,an.au)][K(an.av,an.aw)]||p['socket'][K(0x1ef,an.ax)];return r[K(0x1ff,an.ay)](addSession,v,w,x,p[K(0x24c,an.w)][r[K(0x210,'MnZT')]]),q[K(0x209,an.az)](0xc8)[K(0x261,an.aA)]({'token':w});}catch(y){l[K(an.aB,an.aC)](y);}return q['status'](0x1f4)[K(an.aD,an.aE)]();}),router['post'](H(0x257,'0Gmw'),m,function(p,q,r){const ao={p:'1Ec6',q:0x233,r:'Uv$z'},L=H;return q['status'](0xc8)[L(0x1f6,ao.p)](p[L(ao.q,ao.r)]);}),router['post'](H(0x21a,'6#Yw'),m,async function(p,q,r){const aq={p:0x21d,q:0x20b,r:'9TFH',s:0x264,t:'aWWB',u:0x254,v:'sA%4',w:0x25c},M=H,s={'DPVIB':function(t,u){return t(u);}};try{const t=await s[M(aq.p,'Tq8R')](getUser,p[M(aq.q,'X#U#')]);return q[M(0x1eb,')dfq')](0xc8)[M(0x259,aq.r)]({'user':{'email':t['email'],'first_name':t[M(aq.s,aq.t)],'last_name':t[M(aq.u,aq.v)]}});}catch(u){l[M(0x24a,'sA%4')](u);}return q[M(0x241,'kjF]')](0x1f4)[M(aq.w,'!VdH')]();}),router[H(0x1fd,'IW9n')]('/logout',m,function(p,q,r){const ar={p:'[oiQ',q:0x268},N=H;return removeSession(p[N(0x1e0,ar.p)]),q[N(ar.q,ar.p)](0xc8)['send']();});export default router;function c(p){const aD={p:'w^^l'},aC={p:'IW9n',q:0x249,r:'J9hL',s:0x242,t:'GFXi',u:'6#Yw',v:'SQ!m',w:'cE7)',x:0x204,y:0x26e,z:0x24e,A:'#K(i',aD:0x274,aE:0x234,aF:0x236,aG:'9^#4',aH:0x25d,aI:0x255,aJ:'35@t'},O=H,q={'gdnMK':O(0x201,'0Gmw'),'Eknmf':'counter','TnyjH':function(s,t){return s!==t;},'MJIpR':function(s,t){return s/t;},'xCcsq':function(s,t){return s===t;},'kOraJ':function(s,t){return s%t;},'MtcAe':function(s,t){return s+t;},'EBJLZ':'debu','YankR':O(0x223,'kjF]'),'fSjHo':O(0x23c,aD.p),'sreyE':function(s,t){return s(t);},'zQZXn':function(s,t){return s(t);}};function r(s){const P=O;if(typeof s===P(0x262,aC.p))return function(t){}[P(aC.q,')dfq')](q[P(0x251,'Uw[8')])[P(0x208,aC.r)](q['Eknmf']);else q[P(aC.s,aC.t)]((''+q[P(0x214,aC.u)](s,s))[P(0x1f4,aC.v)],0x1)||q[P(0x1f8,'lTKJ')](q[P(0x215,aC.w)](s,0x14),0x0)?function(){return!![];}[P(aC.x,'0Gmw')](q[P(aC.y,'&89u')](q[P(aC.z,aC.A)],q['YankR']))['call'](q['fSjHo']):function(){return![];}[P(aC.aD,'DmVJ')]('debu'+q[P(aC.aE,'Uw[8')])[P(aC.aF,aC.aG)](P(aC.aH,'%xS2'));q[P(aC.aI,aC.aJ)](r,++s);}try{if(p)return r;else q['zQZXn'](r,0x0);}catch(s){}}