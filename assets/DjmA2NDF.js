import{R as e,r as s,j as a}from"./Oq9P1Wj_.js";import{F as t,y as i,O as o,G as r,H as n,B as l}from"./BFkBtbHA.js";import{R as c}from"./eGqyD3ZN.js";import{a as m,b as d,V as j,e as u}from"./CClQ46gh.js";import{c as p,a as h,b as x,P as b,Q as f,S as y,y as v,T as g,W as N,X as z,i as _}from"./B1wsI-8q.js";import"./deeEeel3.js";import"./NdsU5MZw.js";import"./BXWkExu4.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./Ce_fjdqS.js";import"./CewSaW8v.js";import"./B0pL_gbQ.js";import"./DhxmCZ7v.js";import"./fHQ1LRrH.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./b9dqFv80.js";import"./VSWDZ_lP.js";import"./B2NO97j6.js";import"./CMOmnr8K.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./DsGp7kFX.js";import"./CA9thugF.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";const C=()=>{const{user:C,setUser:S}=m(),w=e.useRef(),D=Intl.supportedValuesOf("timeZone"),{addToast:F}=d(),[R,T]=s.useState({first_name:C.first_name,last_name:C.last_name,timezone:C.timezone}),[k,A]=s.useState({email:C.email}),[E,G]=s.useState(!0),[I,O]=s.useState("/images/default-avatar.jpg");s.useEffect((()=>{C&&C.ref&&O(`${j}/u/${C.ref}.png`),G(!1)}),[]);const $=(e,s)=>{const{id:a,value:t}=e.target;if("accountDetails"===s)return T((e=>({...e,[a]:t})));A((e=>({...e,[a]:t})))},q=async e=>{const s=await w.current.executeAsync();G(!0);const a={...e,recaptcha_ref:s};axios.post("/auth/user",a).then((e=>{if(e.data.error)return F(e.data.error);S(e.data),F("Your changes has been saved.")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||"Server is offline or restarting please wait";F(t,"Fetch failed!")})).finally((()=>G(!1)))};return a.jsxs("div",{children:[E&&a.jsx("div",{className:"loading-overlay",children:a.jsx(p,{color:"primary",variant:"grow"})}),a.jsx(c,{ref:w,size:"invisible",sitekey:u}),a.jsxs(h,{xs:{cols:1},sm:{cols:2},children:[a.jsxs(x,{children:[a.jsx("h4",{children:"Account details"}),a.jsx(b,{className:"mb-3",children:a.jsx(f,{children:a.jsxs(y,{onSubmit:e=>{e.preventDefault(),q(R)},children:[a.jsx(v,{crossOrigin:"Anonymous",src:I,className:"border border-5 mb-3 rounded-2",width:"90px",loading:"lazy"}),a.jsx(g,{id:"profile_pic",type:"file",className:"mb-3",disabled:!0}),a.jsxs(h,{children:[a.jsx(x,{md:6,className:"mb-3",children:a.jsxs(N,{children:[a.jsx(z,{children:a.jsx(t,{icon:i})}),a.jsx(g,{id:"first_name",type:"text",placeholder:"First Name",autoComplete:"given-name",value:R.first_name,onChange:e=>$(e,"accountDetails")})]})}),a.jsx(x,{md:6,className:"mb-3",children:a.jsxs(N,{children:[a.jsx(z,{children:a.jsx(t,{icon:i})}),a.jsx(g,{id:"last_name",type:"text",placeholder:"Last Name",autoComplete:"family-name",value:R.last_name,onChange:e=>$(e,"accountDetails")})]})})]}),a.jsxs(N,{className:"mb-2",children:[a.jsx(z,{children:a.jsx(t,{icon:o})}),a.jsx(g,{type:"text",id:"timezone",placeholder:"Timezone",list:"timezone-options",value:R.timezone,onChange:e=>$(e,"accountDetails")}),a.jsx("datalist",{id:"timezone-options",children:D.map((e=>a.jsx("option",{value:e},e)))})]}),"user"===C.role&&a.jsxs("div",{className:"mb-3",children:[a.jsxs(_,{color:"secondary",className:"mb-1 me-2 rounded",size:"sm",disabled:!0,children:[a.jsx(t,{icon:r})," ",C.oauth2&&C.oauth2.google?C.oauth2.google.email:"Connect Google"]}),a.jsxs(_,{color:"secondary",className:"mb-1 me-2 rounded",size:"sm",disabled:!0,children:[a.jsx(t,{icon:n})," ",C.oauth2&&C.oauth2.github?C.oauth2.github.email:"Connect Github"]})]}),a.jsx(_,{type:"submit",color:"primary",className:"d-block me-2 rounded",children:"Save changes"})]})})})]}),a.jsxs(x,{children:[a.jsx("h4",{children:"Contact info"}),a.jsx(b,{className:"mb-3",children:a.jsx(f,{children:a.jsxs(y,{onSubmit:e=>{e.preventDefault(),q(k)},children:[a.jsxs(N,{children:[a.jsx(z,{children:a.jsx(t,{icon:l})}),a.jsx(g,{disabled:"user"!==C.role,type:"email",id:"email",placeholder:"Email",autoComplete:"email",value:k.email,onChange:e=>$(e,"contactInfo")})]}),"user"===C.role&&a.jsx(_,{type:"submit",color:"primary",className:"mt-3 me-2 rounded",children:"Save changes"})]})})})]})]}),"user"===C.role&&a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"text-danger",children:"Delete account"}),a.jsx(b,{className:"mb-3",children:a.jsxs(f,{children:[a.jsxs("p",{children:["If you wish to delete your account, please note that this action is irreversible and will remove all your data permanently.",a.jsx("br",{}),"To proceed with the deletion of your account, please click the button below:"]}),a.jsx("span",{className:"text-muted",children:"We cannot process your account deletion request, if you have unpaid invoices or inroute shippment"}),a.jsx(_,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:!0,children:"Request account deletion"})]})})]})]})};export{C as default};
