const G=f;(function(p,q){const T={p:0x183,q:0xe8,r:'s)]9',s:'vJ5c',t:0xa6,u:0xb0,v:'xO6E',w:0xa9,x:'$I![',y:'$I![',z:'rUl!',A:0x12c,B:'0jlD'},C=f,r=p();while(!![]){try{const s=parseInt(C(T.p,'fwr@'))/0x1*(parseInt(C(T.q,T.r))/0x2)+parseInt(C(0x145,T.s))/0x3+-parseInt(C(T.t,'fwr@'))/0x4+parseInt(C(T.u,T.v))/0x5+-parseInt(C(T.w,'tJxl'))/0x6+-parseInt(C(0xd8,T.x))/0x7*(parseInt(C(0x124,T.y))/0x8)+parseInt(C(0x153,T.z))/0x9*(parseInt(C(T.A,T.B))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x57caa));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());function f(a,b){const c=e();return f=function(d,g){d=d-0x9c;let h=c[d];if(f['iYPqBk']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['kIrsoX']=m,a=arguments,f['iYPqBk']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['hqBPVz']===undefined&&(f['hqBPVz']=!![]),h=f['kIrsoX'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(){const a3={p:'tJxl',q:0x16d,r:'rUl!',s:'FgD3'},a2={p:0x16c,q:'Y%&c',r:0x111,s:0x155,t:'r4uX',u:0xe5,v:0xba,w:'s)]9'},D=f,p={'wsySf':D(0x10e,a3.p),'ZnWUv':D(a3.q,a3.r),'VlUyu':function(q,r){return q(r);},'xCaHC':D(0xd3,a3.s),'lHpsy':function(q,r){return q+r;},'CJaNe':'input','FKfYB':function(q){return q();},'ZvCcd':function(q,r,s){return q(r,s);}};p['ZvCcd'](d,this,function(){const E=D,q=new RegExp(p[E(a2.p,'DeyJ')]),r=new RegExp(p[E(0x154,a2.q)],'i'),s=p['VlUyu'](c,p[E(a2.r,'A[]x')]);!q[E(0x14b,'(U1d')](p['lHpsy'](s,E(a2.s,a2.t)))||!r[E(a2.u,'xO6E')](s+p[E(a2.v,a2.w)])?s('0'):p['FKfYB'](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ac={p:0x166,q:'2b6X',r:0x16a,s:0x11b,t:'!5DL',u:'*c^6',v:'k3p#',w:0xcc,x:0x16e,y:'lJwj',z:0x17c,A:'fwr@',B:'EyAo',ad:0xee,ae:'tJxl',af:'[Pph',ag:'5KpH',ah:0x15d,ai:'Es2b',aj:0xb9,ak:'6(!^',al:0x100,am:0x169,an:'50AB'},F=f,p={'lCReh':function(t,u){return t(u);},'JIrsd':function(t,u){return t+u;},'ydDqK':F(0x14a,'50AB'),'vcenH':F(0xfc,'FwJA'),'zZauj':function(t){return t();},'Edmvo':F(ac.p,ac.q),'SIBUZ':'warn','aqHec':F(ac.r,'DeyJ'),'LUwPz':F(0x134,'Es2b'),'qaApK':F(ac.s,ac.t),'fnVJj':function(t,u){return t<u;}};let q;try{const t=p[F(0xf6,ac.u)](Function,p['JIrsd'](p[F(0xd6,ac.v)]+p[F(0xc2,'2b6X')],');'));q=p['zZauj'](t);}catch(u){q=window;}const r=q[F(ac.w,ac.u)]=q[F(ac.x,ac.y)]||{},s=[p[F(ac.z,ac.A)],p[F(0x150,ac.B)],F(0x119,ac.B),p['aqHec'],p[F(ac.ad,ac.ae)],p[F(0xe3,ac.af)],F(0x13f,'dM!b')];for(let v=0x0;p[F(0x161,ac.ag)](v,s[F(ac.ah,ac.ai)]);v++){const w=b[F(0x167,'o4Bs')][F(ac.aj,ac.B)][F(0x13b,ac.ak)](b),x=s[v],y=r[x]||w;w[F(ac.al,'MLRS')]=b[F(ac.am,'yh$3')](b),w[F(0x157,ac.an)]=y['toString'][F(0x120,'5KpH')](y),r[x]=w;}});a();import g from'dotenv';g[G(0x12f,'J7e*')]();import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';(function(){const ah={p:0x9c,q:'b*81',r:'FgD3',s:0x122},ag={p:0xe7,q:0xaf},H=G,p={'jIzId':function(s,t){return s+t;},'MxAki':function(s,t){return s+t;},'FxYGl':'return\x20(function()\x20','BKGdi':H(ah.p,ah.q),'vKJwT':function(s){return s();}},q=function(){const I=H;let s;try{s=Function(p['jIzId'](p[I(ag.p,'(U1d')](p[I(0x147,'iTgO')],p[I(ag.q,'xO6E')]),');'))();}catch(t){s=window;}return s;},r=p[H(0xbb,ah.r)](q);r[H(ah.s,'g2y3')](c,0x9c4);}());import{send}from'../../components/mail.js';const router=h[G(0x104,'J7e*')]();router[G(0xb7,'EyAo')]('/register',async(p,q)=>{const am={p:0xb2,q:'0jlD',r:0xf0,s:0xb5,t:0x105,u:'vJ5c',v:0x160,w:0xa4,x:0x162,y:0x117,z:0x137,A:'MLRS',B:0x149,an:'FgD3',ao:'9lf8',ap:'NcG6',aq:'FwJA',ar:'IoI4',as:0x140,at:'lJwj',au:0xf7,av:0x125,aw:'fwr@',ax:'r4uX',ay:0x109},J=G,r={'kRccY':function(s,t){return s||t;},'zgRsI':'Invalid\x20email\x20address','dkQvg':function(s,t){return s<t;},'LLstM':'Password\x20must\x20be\x20greater\x20than\x208\x20digit','mdmgs':function(s,t){return s!=t;},'QErLV':'Password\x20does\x20not\x20match','pfjFa':J(am.p,'FwJA'),'vJRld':J(0xf2,am.q),'whRsQ':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(0x139,'g2y3')];if(r[J(am.r,'NcG6')](!s,!t)||!u||!v||!w)return q[J(0xd5,'A[]x')](0x190)[J(am.s,'[Pph')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(am.t,am.u)](s))return q[J(am.v,'TcsT')](0xc8)[J(am.w,'EyAo')]({'error':r[J(am.x,'tJxl')]});if(r[J(am.y,'J7e*')](v[J(am.z,'DeyJ')],0x8))return q[J(0x182,am.A)](0xc8)['json']({'error':r['LLstM']});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[J(am.B,am.an)](v))return q[J(0xa1,am.ao)](0xc8)[J(0x172,am.ao)]({'error':'Password\x20must\x20be\x20at\x20least\x208\x20characters\x20long\x20and\x20contain\x20letters,\x20numbers,\x20and\x20symbols.'});if(r[J(0xe0,'jAT[')](v,w))return q['status'](0xc8)[J(0xe6,am.ap)]({'error':r[J(0x178,am.aq)]});const x=await k(),y=x[J(0xf8,am.ar)](J(am.as,am.at)),z=await y[J(am.au,'s)]9')]({'email':s});if(z)return l[J(0x174,'IoI4')](r[J(0x171,'$I![')]),q[J(am.av,am.aw)](0x199)['send']();return await y['insertOne']({'email':s,'first_name':t,'last_name':u,'role':r[J(0x12d,'Gfub')],'password':r[J(0x14e,am.ax)](o,v),'email_verify_at':'','created_at':Date['now'](),'update_at':Date[J(0xa0,'FwJA')]()}),q['status'](0xc9)['send']();}catch(A){l['error'](A);}return q[J(am.ay,'Y%&c')](0x1f4)['send']();}),router[G(0x152,'r4uX')]('/login',n,async(p,q)=>{const at={p:0xe4,q:0xda,r:'UgkI',s:0xb6,t:'Gfub',u:0x129,v:'J7e*',w:0x10b,x:'NcG6',y:'!%g6',z:0xd2,A:'rUl!',B:0xdf,au:'50AB',av:0xdd,aw:'r4uX',ax:0x116,ay:0xc1,az:'g2y3',aA:'Y%&c',aB:'$I![',aC:'5KpH',aD:'r4uX'},K=G,r={'sMDxw':function(s,t){return s||t;},'NKdVZ':function(s){return s();},'iYxNo':function(s,t){return s!=t;},'HbXSn':function(s,t){return s(t);},'hOrQj':function(s){return s();},'xIVLo':K(0xea,'$I!['),'ArLIL':K(0x17b,'fwr@'),'TMbSL':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[K(at.p,'Es2b')];if(r['sMDxw'](!s,!t))return q[K(at.q,at.r)](0x190)['send']();const u=await r[K(at.s,at.t)](k),v=await u['collection'](K(at.u,at.v))[K(at.w,'k3p#')]({'email':s});if(!v)return q[K(0x109,'Y%&c')](0x194)[K(0x151,at.x)]();if(r[K(0x159,at.y)](r['HbXSn'](o,t),v[K(at.z,at.A)]))return q['status'](0x191)[K(at.B,at.au)]();const w=j['createHash'](K(at.av,at.t))['update'](r[K(0xbe,at.aw)](generateUniqueId))[K(at.ax,'DeyJ')](r[K(at.ay,at.az)]),x=p[K(0x10f,at.aA)][r[K(0x179,'tJxl')]]||p[K(0x17e,at.aB)][K(0x177,'kWFw')];return r[K(0xed,'EyAo')](addSession,v,w,x,p[K(0x112,at.aC)]['user-agent']),q[K(0x103,'b*81')](0xc8)['json']({'token':w});}catch(y){l[K(0x121,at.aD)](y);}return q['status'](0x1f4)[K(0xd1,'A[]x')]();}),router[G(0x123,'Es2b')]('/verify',m,async function(p,q,r){const aB={p:0xd0,q:'b*81',r:'rUl!',s:'Y%&c',t:0xf4,u:'r4uX',v:0xa7,w:0x144,x:'aJGa',y:0xd4,z:'6(!^',A:'vJ5c',B:'FgD3',aC:0x12a,aD:'50AB'},L=G,s={'CmLEN':function(z,A){return z!==A;},'xdxKV':function(z){return z();},'RHSGS':function(z,A){return z*A;},'rjpvr':function(z,A){return z*A;},'ydrdO':function(z,A){return z>A;},'bPAcz':function(z,A){return z-A;},'qJzbg':function(z,A,B){return z(A,B);}},{_id:t,email_verify_at:u,...v}=p['user'];v[L(aB.p,aB.q)]=s[L(0xa8,aB.r)](u,'');if(s[L(0xf5,aB.s)](p[L(0xc8,'7wxI')][L(0x175,'UgkI')],''))return q['status'](0xc8)[L(0x10d,'Es2b')](v);const w=await s[L(aB.t,aB.u)](k),x=await w[L(aB.v,'dM!b')](L(aB.w,'DeyJ')),y=await x[L(0x15b,aB.x)]({'token':p[L(aB.y,aB.z)],'verified':![]});if(y){const z=new Date(y[L(0x11c,aB.A)]),A=s[L(0x17a,'MLRS')](s[L(0xa3,'J7e*')](0xa,0x3c),0x3e8);if(!s[L(0xae,aB.B)](s[L(aB.aC,'7wxI')](Date['now'](),z),A))return q['status'](0xc8)[L(0x114,'68yh')]({'otp':!![]});}return s[L(0x133,'iTgO')](sendOTPEmail,p,x),q[L(0xc7,'xO6E')](0xc8)[L(0xce,aB.aD)]({'otp':!![]});});const sendOTPEmail=async(p,q)=>{const aE={p:0xde,q:'68yh',r:0xcf,s:0x113,t:0xf9,u:'dM!b',v:0x136,w:'5KpH',x:'o4Bs',y:'r4uX',z:'!%g6',A:0x15a,B:'!%g6',aF:0x9d},M=G,r={'bHSCL':function(t,u){return t*u;},'pqjtL':function(t,u,v){return t(u,v);}},s=Math[M(aE.p,aE.q)](0x186a0+r[M(aE.r,'xO6E')](Math[M(0xc5,'6(!^')](),0xdbba0));await q[M(aE.s,'(U1d')]({'user_id':p[M(aE.t,aE.u)]['_id'],'token':p[M(0x16f,'FgD3')],'code':s,'verified':![],'expired':![],'created_at':Date[M(aE.v,aE.w)](),'updated_at':Date[M(0xa2,aE.x)]()}),r['pqjtL'](send,{'to':p[M(0x12b,aE.y)][M(0xef,aE.z)],'subject':M(0x15e,'J7e*'),'text':M(aE.A,'(tTN')+s+M(0x138,aE.B)},p[M(aE.aF,'A[]x')][M(0x146,'0jlD')]);};function e(){const b5=['smk9xmk2ua','sYWtW60B','WQz7fCosW7pdVCkdACoy','gafBW7FdJa','CSkhfcVcGG','WPNcKmof','WRxcVqCbWOFdL8kedmkolWhdJY0','q8otW6O+W5BcOMGCt0u','W6zrW4ZcPG8','WQzvamo8na','eWCgtq','pmkBfHuvW5WnimooaSk+smkMWRnCW4PuW73cVa','W48MW51P','W4DoW7dcKW','AZX4c8o3','bqvtW6hdJG','qSkXDSk6WOS','W6zOFXBdIG','WQjlDmo9','aGjYW6y','WPNcQmoAE8kAWPRcJYtcHGm','vmodAdCJ','eqvGW7VdSq','BSoeW48','oSkrmrqvW5TdBW','W45gW6i','qM/cQrFcMG','zmoLWPtdLmkBW5fsWOjbW6VdR1K','WQaUW47dRMrhWOG','hSkRW4rRC1OV','h8ksW6xdLSkJW4y','lWjhW7b4Fq3dTJ3dSSkdWQurW7pdK3uQfx8otSknoG','W6BcT8owWQCS','W47dISkeWQldQ8oU','W7GGD8olW5e','E8oxW61VW6i','WPm1W4K','W7WhW6jpEq','W6GiWOvzAeO','W5meiq','W4yrsdfHzwe4yqfW','w8k4leeEw2tcMmowWRpdKa','WORdTL41','WPpcLSohcCk9','WRewrddcUCo+W5xdQue','WOhcL8omnCkP','W7BcTSkXy8oBW7FdG1hdIYbOWObJa8kOW6JcT8kMpCkwrrJcMCk8zSkbuCkdvhC1tqZdMa','xtayW6WhW5qp','eW0ExhG','WPG/W67dUeS','omkDsxPw','FCkgcsO','cmoorfPfW4hdTSorW7C','W4tcQKNdUqG','dWpcIKNdUmoCeIJdKxVdSSk4a8ooWOW','WOxcGCoBaG','WQVdNdNdQmklgmoGWQi8xbFdHLy','lmo7uNDN','qmocW7nvW6C','AgNcUSobxa','sSkRdCktzCoHrSozWOWYkhnxWPpdNq','D8oIbSkkEa','WRrAg8ouyaG','o8kuqfDsW74','xfNdMNBdGCoNdGZdMW','W5lcReNdVXr/','emkMW4zlua','svxcImoYELW','bmkXwSkQqSoYtCoQWPa','WPuuWO/dUwjirmkYvCo9e8k4W6rXW6dcGNb8DCo9nCkhuuhdGbDXWOtdPCkltb8','W64NWOnV','WOGaW5pdQxL5wCkNsSoT','CYjyW4KRW6fM','e8orvW','zmkbbZdcHta','W4Sruq','eGzsWQzE','W59suI0','W7ORq8o0','c8kYu8oiiCkUB8omWQm5bYC','x8kGuCk5uaylWRRdPKu','W6NdSmkHdCk1','mSkbWOSKWP5uomkqErzAWRDh','W4OkvG','WPCrW61HW5a','WR4LvtBcQa','W7utWPm','hGyhxvK','W67cJCobWOuk','WP7dT8kZW5DvcGybdvpcVNhdJW','W5NcRWHJWR9tc8oJW7VdUSkX','omotqvjDWOtdKmoBWRi9k8kuhSkby3BdHSk9WR8CrZRcLq','ySkfaIxcHcBdNsOJ','W4dcO8oOWOyxva','WRrlfmoe','W5u3WOb7rW','W4votJC','sJaDW7Og','W4vtuJFdV8oTWPxdU8oS','uczkiCoW','esK/tKi','pCkkaXqsW4e','W4lcQCoX','gIjZW4pdTq','uSkKlvW','mSkdtwTK','W4NcSSkfW5v/','W4Kii8o8gG','wu7cHCoQAKWUW7meuG','FSo8gCk5Eq','WP5Bd8oEnmoa','W4JdN1PMW4i','W5/cSSoNWPuwtW','ydHtW58','WRLgaCkDWP8','W67cKSk3','W5WTWQ1orq','w8k4leefrxq','dCkRW4jX','jmkndq4','W47cJSovWQiV','WOCAW77dV2bhxSkQEmo+fCk+W6jLWQhdHwy','W6GXWOH5','W5RdVmkEo8kmWRlcMqO','dGWCtq','WPHvcSoFnq','W6GGWODPW6BdUW','umoWWP3dPhu','w8k4lL4psMxcKSonWRi','ECokeaHMW7WGWRGMqW','xqfUW7xdSbfs','grRcILtdOCoW','vCo9W5ScW6m','W4FcSvxdSJv2Aq','W6GuWOuFka8','WPbLk8k9WQC','pCkBdaq','WQKcttBcVG','rmkkga8hWPZdSCoyW5KYdmkF','WORdSfqO','WRzpo8oqxG','eCkyW6/dIa','W5JcO8o1WPu','WRTDDCo3','W7y7W692DW','k1KFpmoDWQtcOcNcVG','ECo9WP7dU20','imkEwW','W6GjWPv3xG','W5L8n8k3WQC','W6fSxXddNa','tCoLW4HmW5e','tLVcSddcMq','WRP8ECo6W5y','WQFcTCoAkCk2','umojW70/','WRuIW47dRG','cGL5W5NdIq','tCoaCYCB','vmkuefCc','Dqvfc8oAWRRcKG','W4lcT1FdUH97EflcJCov','sCk8wmkN','W7JdHSkvWR/dRmo4WQz5lwaM','W5ykrZzWwhyXCa12','bSoddLHEW4RdISolW6aPjmksfmkslY3cLmk9WRmarIddHKe2nmoujmkOWOxcMCkv','W6ldM8kdaSkI','W7ddOf9rW5O','W5dcMmkNW7b/WRe','zx7cMCo0yfS1W4u0','C8ovW49WW4OcAq','W7WBWOfF','WP0DW4ddRNHv','mGnxWQrjzG','W7ddQKDa','eCkxbG','mmkcWOWPWPHwp8kQyYDmWQv9','cX7cM0ZdRq','FCozxHyGWOm','zI5yW4K','t8o9WRFdSxhdMZy','W4dcP8o1WPu8uLCLhW','gCkeW6tdNW','z8ofW5f/W58iy8kTeuLkW6u1WPNdOSk5','zSoixGyWWOig','WPZdSfS0W6e','W6mxWODvW5a','W7yRqmoLW57dV8kN','W5iTW514BmoxbmkQW5e','WPX6k8k8','WPSAW4tdQa','WPlcJCosa8k8WOu','baDZWQzl','W5NcTCoJWPmq','W5XpwYW','WQRdJtxdS8kkdG','cCkLW5nPyG','W6FdVvfvW4dcHCotoSk9hW','W4WFj8oMj8oI','W4pcSSo2','W5ztwcldPmo8WOJdLmoOW68','W7WNt8oL','fX9ZW73dRq','W4lcNSkNW5b+WQSMW4XDdmkk','a8kyW7JdHq','ESokfq0bW6aAWRm2zSoU','qCoYcSkiySoL','W606qmo1W47dVG','W7SJqmoOW5C','W5VcImk8W7C','fr9hWQjF','DXT3W44E','bX5KW6a','fmkkWQb/WPlcVM8eAfFdSG','W602WRzbEq','dg5dWQLEWO5AfxffWQhdHYG','aWnmWRzfCW','mbJcMM/dHG','fW0gtq','WP9Fd8oE','W5fJW6/cGWq','fSkpW6JdLmkNW5Pmrrq','cq0c','W7aHvG','WPRcGCoBaCk7WPK','bXBcPZJcMqBdUSkTW6vhi3xdPCoUWPHnrSkZW6TQWRdcGCkYW5hdVCk5BCoD','W5pcLmk3W6a','e8k5wmkNxamgW7ZdPL84','WO5td8oE','WQX/f8kWWO3dP8kFrCoOEXO','W6FdOfHyW5hcG8oddmkZbq','fCo0Bhfx'];e=function(){return b5;};return e();}router[G(0x123,'Es2b')](G(0xec,'68yh'),m,async function(p,q,r){const aG={p:'UgkI',q:'*c^6',r:'5KpH',s:'b*81',t:0x10c,u:0x165,v:'Gfub'},N=G,s={'ZvqOR':function(t,u){return t(u);}};try{const t=await s[N(0x130,aG.p)](getUser,p['token']);return q[N(0x126,'5KpH')](0xc8)[N(0xbf,aG.q)]({'user':{'email':t[N(0x127,aG.r)],'first_name':t[N(0x9e,aG.s)],'last_name':t[N(aG.t,'xO6E')]}});}catch(u){l['error'](u);}return q[N(aG.u,aG.v)](0x1f4)['send']();}),router[G(0xcd,'!5DL')](G(0xd9,'r4uX'),m,function(p,q,r){const aI={p:'s)]9',q:0x110,r:'yh$3',s:0x132,t:'6(!^'},O=G,s={'xPSdb':function(t,u){return t(u);}};return s[O(0x14d,aI.p)](removeSession,p[O(aI.q,aI.r)]),q[O(0x17d,'[Pph')](0xc8)[O(aI.s,aI.t)]();}),router[G(0x131,'FgD3')]('/verify/otp/new',[m,n],async function(p,q,r){const aO={p:'o4Bs',q:0xc0,r:'$I![',s:'*c^6',t:0xdc,u:0xfe,v:'vJ5c',w:0x11f,x:'k3p#',y:0x173},P=G,s={'zxnWS':function(t){return t();},'bTAZZ':P(0xaa,aO.p),'uqVJy':function(t,u){return t*u;},'PiGnS':function(t,u){return t>u;},'LzrEn':function(t,u){return t-u;},'vVObF':function(t,u,v){return t(u,v);}};try{const t=await s[P(aO.q,aO.r)](k),u=await t[P(0xd7,aO.s)](s['bTAZZ']),v=await u[P(aO.t,'IoI4')]({'token':p[P(aO.u,aO.v)],'verified':![],'expired':![]});if(v){const w=new Date(v[P(aO.w,'EyAo')]),x=s['uqVJy'](0xa*0x3c,0x3e8);s[P(0xe9,aO.x)](s[P(0xc4,'fwr@')](Date['now'](),w),x)&&(await u[P(aO.y,'FwJA')]({'_id':new ObjectId(v['_id'])},{'$set':{'verified':![],'expired':!![],'updated_at':Date[P(0xbd,'xO6E')]()}}),s[P(0x170,'b*81')](sendOTPEmail,p,u));}}catch(y){l[P(0x143,'9lf8')](y);}return q[P(0xbc,'50AB')](0x1f4)['send']();}),router['post'](G(0x13a,'dM!b'),[m,n],async function(p,q,r){const aT={p:0xfa,q:'xO6E',r:0xe2,s:'yh$3',t:'2b6X',u:'7wxI',v:0xc3,w:0x156,x:'tJxl',y:0x9f,z:0xc6,A:'vJ5c',B:0x15f,aU:'jAT[',aV:0x163,aW:0x128,aX:0x14f,aY:'iF16',aZ:0x101,b0:'xO6E',b1:0x172,b2:0xca,b3:0x13d,b4:'vJ5c',b5:0xf1,b6:'DeyJ',b7:'jAT[',b8:0x115,b9:0xad,ba:0x158,bb:'aJGa',bc:0x121,bd:'r4uX',be:0x176},Q=G,s={'LPnRv':function(t,u){return t*u;},'JqPFO':function(t,u){return t>u;},'zCuge':function(t,u){return t-u;},'uUaeI':Q(aT.p,'TcsT'),'QgTCt':function(t,u){return t(u);},'QQoOy':Q(0x118,aT.q)};try{const t=p[Q(aT.r,aT.s)][Q(0x11e,aT.q)];if(!t)return q[Q(0x11d,aT.t)](0x190)[Q(0x10a,aT.u)]();const u=await k(),v=await u[Q(aT.v,'MLRS')](Q(aT.w,aT.x)),w=await v[Q(aT.y,'7wxI')]({'token':p[Q(0xb8,'lJwj')],'verified':![],'expired':![]});if(w){const x=new Date(w['created_at']),y=s[Q(aT.z,aT.A)](s['LPnRv'](0xa,0x3c),0x3e8);if(s[Q(aT.B,aT.q)](s[Q(0xac,aT.aU)](Date[Q(aT.aV,'*k*f')](),x),y))return q['status'](0xc8)[Q(aT.aW,'g2y3')]({'error':s['uUaeI']});}if(w['code']!==s[Q(aT.aX,aT.aY)](parseInt,t[Q(aT.aZ,'tJxl')](/[^0-9]/g,'')))return q[Q(0xc7,aT.b0)](0xc8)[Q(aT.b1,'9lf8')]({'error':'Invalid\x20OTP'});return await v[Q(0xb3,'9lf8')]({'_id':new ObjectId(w[Q(aT.b2,'g2y3')])},{'$set':{'verified':!![],'updated_at':Date[Q(0x135,'FgD3')]()}}),await u[Q(aT.b3,aT.b4)](s[Q(aT.b5,aT.b6)])[Q(0x16b,aT.b7)]({'_id':new ObjectId(p[Q(aT.b8,'b*81')][Q(0x106,'50AB')])},{'$set':{'email_verify_at':Date[Q(aT.b9,'Gfub')](),'updated_at':Date[Q(aT.ba,'iTgO')]()}}),q[Q(0xc7,'xO6E')](0xc8)[Q(0xf3,aT.bb)]();}catch(z){l[Q(aT.bc,aT.bd)](z);}return q[Q(0x11a,'kWFw')](0x1f4)[Q(aT.be,'DeyJ')]();});export default router;function c(p){const b4={p:0x15c,q:0xa5,r:'5KpH',s:0xff,t:0x14c,u:0xfb},b3={p:'Gfub',q:'rUl!',r:0x142,s:0xcb,t:'6(!^',u:'!5DL',v:'68yh'},R=G,q={'suqZC':function(s,t){return s===t;},'HFnJY':R(0x180,'IoI4'),'jlZeS':'while\x20(true)\x20{}','GQIcX':R(b4.p,'!5DL'),'JoaFo':function(s,t){return s!==t;},'pGCOA':function(s,t){return s/t;},'jKSyC':R(0xb4,'xO6E'),'mbwNW':function(s,t){return s%t;},'OOEOJ':function(s,t){return s+t;},'hJLJf':R(b4.q,b4.r),'HYzsV':R(b4.s,'g2y3'),'GDLRg':R(b4.t,'iTgO'),'pemPL':R(b4.u,'o4Bs'),'Sjakq':function(s,t){return s(t);}};function r(s){const S=R;if(q[S(0xeb,b3.p)](typeof s,q[S(0xfd,b3.q)]))return function(t){}['constructor'](q[S(b3.r,'r4uX')])['apply'](q[S(b3.s,'Gfub')]);else q[S(0x148,b3.t)]((''+q[S(0xdb,'0jlD')](s,s))[q[S(0xab,'*k*f')]],0x1)||q[S(0x181,b3.u)](s,0x14)===0x0?function(){return!![];}['constructor'](q[S(0xc9,b3.v)](q[S(0x13e,'FwJA')],S(0x102,b3.p)))['call'](q['HYzsV']):function(){return![];}[S(0x168,'*c^6')]('debu'+q[S(0x164,'(U1d')])[S(0x108,'UgkI')](q['pemPL']);q['Sjakq'](r,++s);}try{if(p)return r;else q['Sjakq'](r,0x0);}catch(s){}}