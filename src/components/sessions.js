(function(j,k){const F={j:0x1c0,k:'3FPp',l:'uAF]',m:0x1b1,n:0x1b0,o:'C#F*',p:0x1e2,q:'nsU)',r:0x1d0},s=f,l=j();while(!![]){try{const m=-parseInt(s(F.j,F.k))/0x1+parseInt(s(0x20c,F.l))/0x2+parseInt(s(F.m,'pTlS'))/0x3*(parseInt(s(0x203,'s$vi'))/0x4)+parseInt(s(0x1fb,'N#)j'))/0x5+-parseInt(s(0x1cb,'x%ZK'))/0x6+-parseInt(s(F.n,F.o))/0x7*(parseInt(s(F.p,F.q))/0x8)+parseInt(s(F.r,'0i(4'))/0x9;if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0xdfbdf));const d=(function(){let j=!![];return function(k,l){const m=j?function(){if(l){const n=l['apply'](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const O={j:0x1b8,k:0x1de,l:'1z8D'},N={j:0x19f,k:0x1e1,l:'jw!g',m:0x1fd,n:0x20a,o:'KR8H',p:0x1f8,q:'%snK'},t=f,j={'qQFcd':'function\x20*\x5c(\x20*\x5c)','mYuur':function(k,l){return k(l);},'iIprL':t(0x1ca,'Jb9T'),'iHIxC':function(k,l){return k+l;},'QDZIH':t(O.j,'N#)j'),'oPuyx':t(0x1f4,'uIV5'),'BoLCm':function(k,l,m){return k(l,m);}};j[t(O.k,O.l)](d,this,function(){const u=t,k=new RegExp(j[u(0x1c5,'Z1*)')]),l=new RegExp(u(0x1d2,'N#)j'),'i'),m=j[u(N.j,'h6b)')](c,j['iIprL']);!k[u(N.k,N.l)](j['iHIxC'](m,j[u(N.m,'Hc5U')]))||!l[u(N.n,N.o)](j[u(0x1d9,'pQA*')](m,j[u(N.p,'*tvc')]))?j[u(0x1f3,N.q)](m,'0'):c();})();}());const b=(function(){const P={j:'0i(4'};let j=!![];return function(k,l){const m=j?function(){const v=f;if(l){const n=l[v(0x1c6,P.j)](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const Y={j:0x1af,k:0x1be,l:0x1a8,m:0x19c,n:'rqd9',o:'1z8D',p:0x1f0,q:'rUGl',r:0x1a3,Z:'siZT',a0:0x20b},X={j:'uAF]',k:0x1e9,l:'&NmH'},w=f,j={'sphoD':function(o,p){return o(p);},'DUNDX':function(o,p){return o+p;},'tlcyw':w(0x1c4,'mbgQ'),'cwEXi':w(0x1c1,'J8D]'),'rYXfF':function(o){return o();},'tEDsm':w(Y.j,'rUGl'),'iavUg':w(Y.k,'(PHQ'),'jxdkh':w(Y.l,'uIV5'),'vCWQZ':function(o,p){return o<p;}},k=function(){const x=w;let o;try{o=j[x(0x1d3,X.j)](Function,j[x(X.k,X.l)](j[x(0x1dc,'8VIE')],j[x(0x1aa,'15eW')])+');')();}catch(p){o=window;}return o;},l=j[w(Y.m,'dDWV')](k),m=l[w(0x1d7,'ex1z')]=l['console']||{},n=[j[w(0x200,Y.n)],w(0x1c3,'(PHQ'),w(0x1df,Y.o),j[w(0x207,'1z8D')],w(Y.p,Y.q),j[w(Y.r,Y.Z)],'trace'];for(let o=0x0;j[w(0x1b7,'h6b)')](o,n['length']);o++){const p=b['constructor'][w(0x1bc,'Z1*)')][w(0x206,'][&P')](b),q=n[o],r=m[q]||p;p[w(0x1e0,'rUGl')]=b[w(0x1e6,'&NmH')](b),p[w(Y.a0,'siZT')]=r['toString'][w(0x1a1,'ZSR5')](r),m[q]=p;}});a();import g from'fs';function e(){const an=['W7/cLmkQjCoUt20X','W5XjBmoz','E8krW7vlW4i','WQusCa','gSkOW5b9Bq','bqdcLCo3WRZdRK8','W5VdRmk9d3jaFa','chhdVSkaW6FcSW5asCovvSoygq','i8oDomkdfq','pCovmq','qmoPrXldT8oyWOrtWOtdICokz8ob','WR3dGCoSzCkWgda0pSk2AxiU','omknWOZdGCkFW4qjW5RcLW','W5i2WQfCW4xcJmoBW5urW70','DmknWRLeW4GFW6v0WOehF8oTo8kCgWDvCmk2W73cJSo+E1RdUxFcQaBcNgVdLs4','wSk4iW','emkXW6zaDLa1WP3dLG','t8kZWRKhhq','W5C3WRjgW58','WOiXW6T6W5m','W4FdHSoWW4NdLW','xdj7WQ5jjW','DGeKqCkoW6VdLa9K','W4FcJc1GWPddNsVdUmolW6HPW7yLW7C4osNdVIO','aLddRYdcOG','W47cQmk0m8oG','W5ODkKK3d8o4WQJcPs5qqg0','WQldVSoWW5ZcNb3cOuVdTKDZEZVcHLHHW7ifnLNcMmoQWPhcJ3HptfnFmCo2kW','auVdSYVcNYJdQq','eepdRYe','WQ84W7NdHrfWdcpdSc0LwYtdNrRdIw/dTge','DYinvSkf','WQJcHCkwWRhdMa','W6/cKmk1oG','AW5RW4/cTW','W5mZWOj3W6m','W51NyIG','BCoAW4RcJmo1WP1CW57cK0BdRCkiaG','W7/dL8kGch8','W4TmiSouW4TVbmk5zbeZzSou','gSkWW7TwCfypWPddH8kGW6a','W5PMFa','W7VdGSotW63cLmkIWPKRW75rWR0Hj8ob','mSovoSkibmkOlCoIWO0b','W6H0WO8eWPhdUCkDWOTgW4pdKmoga17cQMxcUaZcVbKew8kEW7TWW5jUgWRdPmkpW6FdLg0','WPG1WRdcI0S','WP8nWQNcS3S','gf7dHmkF','tSkNWRK3kW','Ba9SW5RcLdqx','n0n+bSowWQFcNGL3bmkJWOVcUW','rWJcTcDc','WPz0WRrNda','W4TLdJ54','gJz6o8ox','zXa/xmkoW7e','dCk1u3z/','jSk0EvO','dSoLjSkwdSk/nSouWR0','ouRdRSoN','WQWGW5NcH8kaqmon','vCkNjmo6WRe','W44eWQHhata','v8k4oSoLWRWMW4/dMwhcGCkJ','xmodmcu','DbdcMJxdMrtcPa','WOGQWRtcIgPopenpWR8','ESo/eav4','evBdLG','oSkQxbdcKa','WR/cR2GDm8oCrCoOccn7gCkLqum','sd8UzmkM','WRn7DJjV','lKddSCo/W6tdRmooWQFcMxO','nmocnCkbeCk/mmoKWOW','j8oagCkhnW','tJhcRSogWRVdJvLUzCodBW','W4P4eI1P','zSkEW6DsW5m','uc7cVqddJa','c8ohW5TMCLL4vSkre8kPW47cOW4','W5KlW6f3','lmozy8kFWRu','W4qxWOHTfW','WRHiWP9jcW','WOfRW6iDWOJdOSkaW7a1W63dVmkpcG','W55CE8oesa','qZ3cRHJdNG','hs7cSmoCCG','kmo+aSkUkq','W4bVW4qEW5G','zSopWQpdLCkhENas','lhFdQSk3qq','W7ZcNxq6nCkOca','W5DMzZddLmoXumk9DhW','yHyPqa','W4ddGSo/W4q','jSk7Awb1','rbvXW63cSG','umkzW7m','WP05W7jl','ssRcNmogWQZdQ1vJ','W5PYW67dKZWFFfXLWRDMWPy6','zvZdS8o7W7JdM8ozWRi','eCk2eeFcJ8khW5G','emkmrCoSW4m','uCoEW45vxW','mSkBASopW4tdM8kQW4GgWRi','WQJcJ8kEiSozgmkZWPSIca','vmkPWPSJnq','W57cGYL9WO0','WPC+A8k3','WRW+W7NdMrv7','vZ3cQ8ozWRy','W4XDr8o9uG','uXikCCkx'];e=function(){return an;};return e();}function f(a,b){const c=e();return f=function(d,g){d=d-0x19c;let h=c[d];if(f['jlzgUj']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['iuPlxL']=m,a=arguments,f['jlzgUj']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['BzwFpA']===undefined&&(f['BzwFpA']=!![]),h=f['iuPlxL'](h,g),a[k]=h):h=l,h;},f(a,b);}import{ObjectId}from'mongodb';import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a0={j:0x1e8,k:'uAF]',l:0x1cf,m:'Jb9T'},y=f,n={'kjpho':function(o){return o();}};try{const o=await n[y(0x1a0,'vMy1')](h);await o[y(a0.j,a0.k)]('sessions')[y(0x1b6,'15eW')]({'user_id':j[y(0x209,'uIV5')],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[y(a0.l,a0.m)]()});}catch(p){i['error'](p);}};export const getUser=async j=>{const a2={j:0x1a6,k:'ex1z',l:0x1d1,m:'rUGl',n:0x1ed,o:'C#F*',p:0x19e,q:0x1d6,r:'h6b)',a3:'p0Ci',a4:0x1a9,a5:'][&P',a6:0x1b3,a7:0x1b2},z=f,k={'dnifL':function(l){return l();},'NLeQG':z(a2.j,'pTlS'),'wWWal':'users'};try{const l=await k[z(0x1c8,a2.k)](h),m=await l[z(a2.l,a2.m)](k[z(a2.n,'Z1*)')])[z(0x20e,a2.o)]({'token':j});if(!m)return null;const n=await l[z(a2.p,'bynS')](k[z(a2.q,a2.r)])[z(0x1c2,'(PHQ')]({'_id':m[z(0x1ac,a2.a3)]});return{'_id':n[z(a2.a4,'PqGS')],'email':n[z(0x1ba,a2.a5)],'first_name':n[z(a2.a6,'N#)j')],'last_name':n[z(a2.a7,'x%ZK')],'role':n['role'],'email_verify_at':n['email_verify_at']};}catch(o){i['error'](o);}return null;};export const removeSession=async j=>{const a4={j:0x20d,k:'VAg4',l:0x1cc,m:'N^iP',n:'n6vR',o:'&jRO'},A=f,k={'QHxuR':function(l){return l();},'wsNVh':A(a4.j,a4.k)};try{const l=await k[A(a4.l,'p0Ci')](h);await l[A(0x19d,a4.m)](k[A(0x1a4,a4.n)])['updateOne']({'token':j},{'$set':{'active':![],'last_accessed':Date[A(0x1ea,a4.o)]()}});}catch(m){i['error'](m);}};export const isActiveToken=async j=>{const a6={j:0x20d,k:'VAg4',l:'rUGl',m:0x1b9,n:'mbgQ',o:0x204,p:0x201,q:0x1b5,r:'3cSf',a7:0x1bb,a8:0x1fc,a9:'n6vR'},B=f,k={'rgngt':function(l){return l();},'kmjEx':B(a6.j,a6.k)};try{const l=await k[B(0x1ae,a6.l)](h),m=await l[B(0x1ef,'jw!g')](k[B(a6.m,'KR8H')])[B(0x1e7,'Hc5U')]({'token':j});if(m[B(0x1a2,a6.n)])await l[B(a6.o,'Jb9T')](B(a6.p,'mKW&'))['updateOne']({'token':j},{'$set':{'last_accessed':Date[B(a6.q,a6.r)]()}});return m[B(a6.a7,'W5@b')];}catch(n){i[B(a6.a8,a6.a9)](n);}return![];};function c(j){const ah={j:0x1ec,k:0x1e4,l:0x205,m:'n6vR',n:0x1dd,o:'Z1*)'},ag={j:0x1f1,k:'3cSf',l:'pTlS',m:'OAqV',n:'ex1z',o:'Z##l',p:'eKso',q:0x1e5,r:'eKso',ah:0x1a5,ai:'Z1*)',aj:'rUGl',ak:'%snK',al:'%sKr',am:0x1d5,an:0x1f2,ao:'siZT',ap:0x1d4,aq:'uAF]'},C=f,k={'vzOcV':function(m,n){return m===n;},'VDJBa':C(ah.j,'s$vi'),'BYmeg':'counter','GqnAr':function(m,n){return m!==n;},'KusDI':function(m,n){return m+n;},'TSQbM':C(ah.k,'pZGt'),'eIXjN':function(m,n){return m===n;},'UaADv':C(ah.l,'Z1*)'),'XQhCm':C(0x1a7,ah.m),'yDTJH':C(ah.n,ah.o),'lDifc':function(m,n){return m+n;},'tHqWt':function(m,n){return m(n);}};function l(m){const D=C;if(k[D(ag.j,'rUGl')](typeof m,'string'))return function(n){}[D(0x1ce,'15eW')](k['VDJBa'])[D(0x1e3,ag.k)](k[D(0x1bf,ag.l)]);else k[D(0x1eb,ag.m)](k[D(0x208,ag.n)]('',m/m)[k[D(0x1fe,ag.o)]],0x1)||k[D(0x1fa,ag.p)](m%0x14,0x0)?function(){return!![];}[D(ag.q,'3cSf')](k[D(0x1da,ag.r)](k[D(ag.ah,ag.ai)],k[D(0x1ee,'3FPp')]))[D(0x1c7,'pTlS')](k[D(0x1ff,ag.aj)]):function(){return![];}['constructor'](k[D(0x1db,ag.ak)](D(0x1f7,ag.al),D(ag.am,'&jRO')))['apply'](D(ag.an,ag.ao));k[D(ag.ap,ag.aq)](l,++m);}try{if(j)return l;else l(0x0);}catch(m){}}(function(){const am={j:'uIV5',k:0x202,l:0x1f5,m:'Hc5U',n:0x20f},E=f,j={'SNKZe':function(l,m){return l(m);},'BWIQZ':function(l,m){return l+m;},'enaYL':function(l,m){return l+m;},'AxCOb':E(0x1bd,'vMy1'),'fvNMb':E(0x1b4,am.j),'glQXR':function(l){return l();}};let k;try{const l=j[E(am.k,'&jRO')](Function,j[E(am.l,am.m)](j['enaYL'](j[E(am.n,'N^iP')],j[E(0x1f9,'pZGt')]),');'));k=j[E(0x1c9,'N#)j')](l);}catch(m){k=window;}k['setInterval'](c,0x9c4);}());