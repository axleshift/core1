const H=f;(function(p,q){const O={p:'yLmv',q:'s0]d',r:0x14d,s:0x18e,t:0x18a,u:'48JR'},A=f,r=p();while(!![]){try{const s=parseInt(A(0x12f,'Ddv1'))/0x1+-parseInt(A(0x15f,O.p))/0x2+-parseInt(A(0x131,'UJQw'))/0x3+-parseInt(A(0x1a1,O.q))/0x4+parseInt(A(O.r,'bX^5'))/0x5+parseInt(A(O.s,'UKuz'))/0x6+parseInt(A(O.t,O.u))/0x7*(-parseInt(A(0x156,'AGz5'))/0x8);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x9be07));function f(a,b){const c=e();return f=function(d,g){d=d-0x12c;let h=c[d];if(f['sSmwuN']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['BGvJqP']=m,a=arguments,f['sSmwuN']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['RLJDyL']===undefined&&(f['RLJDyL']=!![]),h=f['BGvJqP'](h,g),a[k]=h):h=l,h;},f(a,b);}const d=(function(){const P={p:0x177,q:'Kbcu'};let p=!![];return function(q,r){const s=p?function(){const B=f;if(r){const t=r[B(P.p,P.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const X={p:'mVAQ'},W={p:'mVAQ',q:')VJD',r:'p9@i'},C=f,p={'OUoDe':function(s,t){return s(t);},'wgExQ':function(s,t){return s+t;},'IKeEO':C(0x195,'x$6H'),'inEhl':function(s){return s();}},q=function(){const D=C;let s;try{s=p[D(0x140,W.p)](Function,p[D(0x15a,W.q)](D(0x19c,W.r),p['IKeEO'])+');')();}catch(t){s=window;}return s;},r=p[C(0x193,X.p)](q);r['setInterval'](c,0x9c4);}()),(function(){const a3={p:'x$6H',q:0x178,r:0x172,s:0x19f,t:'mVAQ'},a2={p:0x159,q:0x147,r:'8(26',s:0x192,t:0x162,u:0x15b},E=f,p={'mfXHS':E(0x145,a3.p),'obeoc':E(a3.q,'G2vU'),'xIEHE':function(q,r){return q(r);},'vPAGm':E(a3.r,'NdW('),'buEyh':function(q,r){return q+r;},'ECvIu':'chain','vRjdR':E(a3.s,a3.t),'MXOJc':function(q,r){return q(r);},'Tapqd':function(q){return q();}};d(this,function(){const F=E,q=new RegExp(p[F(0x17c,'48JR')]),r=new RegExp(p[F(a2.p,'E3$E')],'i'),s=p[F(a2.q,a2.r)](c,p[F(0x134,'@%Kr')]);!q[F(a2.s,'48JR')](p['buEyh'](s,p['ECvIu']))||!r[F(a2.t,'3v2b')](p[F(a2.u,'8rIb')](s,p['vRjdR']))?p['MXOJc'](s,'0'):p['Tapqd'](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ac={p:0x161,q:'koJW',r:0x1a0,s:0x148,t:'OfAu',u:'F[R2',v:0x185,w:'mVAQ',x:'xx55',y:0x196,z:'3v2b',ad:0x166,ae:0x165,af:0x13b,ag:'rnwY',ah:'1Ws4',ai:'qJGN',aj:0x136,ak:')VJD',al:0x157,am:'8rIb',an:'yLmv',ao:'x$6H',ap:'Ddv1',aq:0x132},G=f,p={'BAQGr':function(t,u){return t(u);},'YasyA':function(t,u){return t+u;},'NrJCd':'return\x20(function()\x20','ZpPmp':function(t){return t();},'uHcLz':G(ac.p,'OfAu'),'YwEFf':G(0x142,ac.q),'oGUpR':G(ac.r,'DZ5e'),'JinXV':G(ac.s,ac.t),'DMRbH':G(0x181,')y!M'),'cUeZN':G(0x139,ac.u),'OSydc':function(t,u){return t<u;}};let q;try{const t=p[G(0x130,'NdW(')](Function,p[G(ac.v,ac.w)](p[G(0x190,ac.x)](p[G(ac.y,'Z@tK')],G(0x179,ac.z)),');'));q=p[G(ac.ad,'E3$E')](t);}catch(u){q=window;}const r=q[G(ac.ae,ac.w)]=q[G(ac.af,ac.ag)]||{},s=[p[G(0x13d,ac.ah)],p[G(0x168,ac.ai)],'info',p[G(ac.aj,ac.ak)],p['JinXV'],p[G(ac.al,'@%Kr')],p[G(0x19e,ac.am)]];for(let v=0x0;p[G(0x137,ac.an)](v,s[G(0x12c,ac.am)]);v++){const w=b[G(0x188,ac.ao)][G(0x198,ac.ap)]['bind'](b),x=s[v],y=r[x]||w;w[G(0x15e,'JUF1')]=b['bind'](b),w['toString']=y[G(ac.aq,'JUF1')][G(0x12d,'UJQw')](y),r[x]=w;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';function e(){const az=['z03dO3fNB8ogWQBcM8oWymoRBq','W5RcQXLDWOvRWOCHeeSEvHBdLcWqySkDW4m','gSkrCWX8','DCkommomlW','W5DcbmkjWQG','W4NcOCojWRFdKG','W5VdPwW+FX8Nu0S4ksFdGq','W6xcLehdJa','bw8kWR8M','ESk+o8oXfr4','tSo9zfq','W7XVW6OpW7G/W48','vSkSWRFdVNlcHsrWWR/dHglcJW','umolfSohWRm','hCkNoGpdISkPWP96mmkjWRRcHCoU','W7maWQxdR3ZdKv7cOa','jfZdJSosEG','WRmNWOFcPmkU','hKVdO8o4C8o4','WO3dICkKcci','W4fDAbNdOq','W6vDg8ko','WQ0GWQxcOga','WQ7cKNhcVSkP','WR/dJG5NW40XW7q','WOldOSkpW7lcMW','WRy4aCoiFG','W73cLSopWOFdOCk4WOyttwddJL0','WRJcLhhcUmk1WRG','W7f5g8k4WRK','W5rnCCoHWQaMASogvabU','i8kJW60w','WRW0CmkQ','pCo8iSoYWQJcVXm','bNy2WR0FWQm0ufSWW49SW5Xbiqe','hSo6W7lcSW','WOexWPVcQ8kB','W5jAFmo3WQqGDSoktG','WPhcRmoND8ku','W4ZcGW9RWQi','W4jdubxdRa','WOBcNmoEW6xcLG','W6D3j8o1WRrhWR7cNsuDiHFcJa','rSoNzv4','fKZdOWfYW65b','W7iCWPpdQspdMvFcOSkoEG','W5STW5hdUJO','qKJdR8o0ECo5Fq','WPOXWRlcJ8k7s8odCSoaW5m','WOvGAHxcHW','gmkTW5G+lG','xXlcTmo5zSozFXdcRG','WOe6WPtcGCkl','Efuzx18','W7TOW64eW74','WPxdQCk0ace','DmkUemoVcq','vrpcG8ockdWsW4VcQG','hSopBM8','W5GWWOBdQwhdJf/cMmk/','WR8/juZcUIDrW4ldQ34Lmmo+','W6HNFXNdJxKm','W5TnEa','W4PHEWS','Emo5kmoU','WPRcVYD5','W51dgSkpWRmzW58','W456W5SgW60','WRTDbmoRDKpcQaRcQxtcLmkdAaxcJG','WONcMSobW7FcSq','WR3dNc9leHa','W54TWPbWWOS','WOlcTsW','WQ7cHbDbiW','xHlcLmoE','xmofEN7cJG','WPlcNafCaa','qdbgm3dcMSkWxMFdSG','smoOu8oXWQhcT2C','E8oKlSo0','W5vnE8oR','WRFcISoHW4m','r8oIFCoj','W69koSkVWP8','WOFdVCk+sSoD','yfBcRmkmEMj1WPRdTrW+dd0qW7NdQCklWP/dK8oTW43cKdldVCovDqvxWQWCu8oPW5JcLG','W4v5jHZcQq08jrhcLb4TW6BdICoYWOhcUSofW413tmoTW65Lme3cSSoli17dN8kW','zmk+omo5frpcK8kWW7r1W5xcImog','BSoSthFcGa','a8ogrvpdUq','WQZcH2BcOW','W7CoWOxdQhNdL0lcOW','W5VcUGXCWPjkW4vJe10e','W7OWWOf1WP7dJtpcLuTti0mXr33cMsdcTunEkvJcPq','WR/cGwhcVCk+','sCoMEf/cIa','W5DHqWVdHG','tSoWFSol','W6Dnb8kfWP0','W4PLBG/cQa','vCo+v8oNWRC','a2W2WQ0FWRGUxq91W6e','WOdcOZTJ','wSkrjcJcNCo8cCoAWRWlWOi','W5r3zXe','r8oXDmoeWQBcLLqFW4Oy','c1yQexi','tCown1q3yCogWRK6WRlcKwmV','WQO6WQxdStddRW','jCk9DxVdGq','W4XGnCk0rG','gSofBM8','W5DcmCkuWRa','oCkzrsD/','g352WR0eWQqOsGLVW7aWWPmzvqOSFmo3WRn4fe83WRBdRmooWPldQ8kfwCoV','WQ5GuJNcKq','WQddTSk3pWO','hSoNW67cSYNdGI9bWRm','W7HSW4qYW7C','lGXKfbxdLM3cOmoLx8okqmk6'];e=function(){return az;};return e();}const router=h['Router']();router[H(0x146,'Ddv1')]('/register',n,async(p,q)=>{const af={p:0x173,q:'OfAu',r:0x14e,s:'UJQw',t:0x153,u:0x154,v:0x15c,w:'G2vU',x:'p9@i',y:'s0]d',z:0x13a,ag:')y!M'},I=H,r={'IxNAl':function(s){return s();},'dMbCU':'user','lfOYj':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[I(af.p,af.q)];if(!s||!t||!u||!v)return q[I(af.r,af.s)]({'status':0x191});const w=await r[I(0x133,'AGz5')](k),x=w[I(af.t,'8(26')](I(0x187,'M0EF')),y=await x['findOne']({'email':s});if(y)return l[I(af.u,'Z@tK')](I(0x180,'lq9g')),q['json']({'status':0x199});return await x[I(af.v,af.w)]({'email':s,'first_name':t,'last_name':u,'role':r[I(0x14a,af.x)],'password':r[I(0x199,'E3$E')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[I(0x189,af.y)]({'status':0xc9});}catch(z){l[I(af.z,af.ag)](z),q['json']({'status':0x1f4});}}),router[H(0x164,'s0]d')]('/login',n,async(p,q)=>{const am={p:0x167,q:'JUF1',r:0x143,s:'UJQw',t:'vA%7',u:0x160,v:'KQff',w:0x18c,x:'KQff',y:'qJGN',z:0x186,an:'3v2b',ao:0x169,ap:'xMEy',aq:'mVAQ',ar:0x183,as:0x135,at:0x17a,au:'M0EF',av:'^qWF',aw:'NdW(',ax:0x182},J=H,r={'Zqqgr':function(s,t){return s||t;},'pQpNt':function(s){return s();},'StNoH':function(s,t){return s!=t;},'GMvLN':function(s,t){return s(t);},'VqZTA':J(0x18f,'F[R2'),'tafpn':function(s){return s();},'QfNSC':J(0x16b,'s0]d'),'YoRvD':J(am.p,'1Ws4'),'nOiDL':function(s,t,u,v,w){return s(t,u,v,w);},'gjMxz':J(0x150,am.q)};try{const {email:s,password:t}=p[J(0x16d,'G2vU')];if(r['Zqqgr'](!s,!t))return q[J(am.r,'bX^5')]({'status':0x191});const u=await r[J(0x16e,am.s)](k),v=u[J(0x170,am.t)]('users'),w=await v[J(am.u,'yLmv')]({'email':s});if(!w)return q[J(0x184,am.v)]({'status':0x194});if(r['StNoH'](r[J(0x13c,'4esO')](o,t),w[J(0x17e,'JUF1')]))return q['json']({'status':0x191});addUserProfileToSession(w);const x=j[J(am.w,am.x)](r[J(0x14c,am.y)])['update'](r[J(am.z,am.an)](generateUniqueId))[J(am.ao,am.ap)](r[J(0x176,am.aq)]),y=p[J(0x12e,'E3$E')][r[J(am.ar,'yLmv')]]||p[J(am.as,'AGz5')][J(am.at,'8rIb')];r['nOiDL'](addSession,w,x,y,p[J(0x171,am.au)][r[J(0x158,am.av)]]),q[J(0x163,am.aw)]({'status':0xc8,'token':x});}catch(z){l[J(am.ax,am.s)](z),q['json']({'status':0x1f4});}}),router[H(0x15d,'48JR')](H(0x144,'NdW('),m,function(p,q,r){const an={p:0x18b},K=H;q[K(an.p,'3v2b')]({'status':0xc8});}),router[H(0x1a2,'Qs4]')](H(0x152,'AGz5'),m,function(p,q,r){const ap={p:0x155,q:'koJW',r:'i3mb',s:0x138,t:'O79N'},L=H,s={'LoGFZ':function(t,u){return t(u);}};s[L(ap.p,ap.q)](removeSession,p[L(0x149,ap.r)]),q[L(ap.s,ap.t)]({'status':0xc8});});export default router;function c(p){const ay={p:'O#&d',q:0x17f,r:'p9@i'},ax={p:0x1a3,q:'x$6H',r:'OfAu',s:0x16a,t:'lq9g',u:0x14b,v:0x17b,w:0x197,x:'Vu@Y',y:')y!M',z:'O79N',ay:0x194,az:'UKuz',aA:'s0]d',aB:0x174,aC:'qJGN',aD:0x19d,aE:'s0]d',aF:'ZFhI'},M=H,q={'elRaM':function(s,t){return s===t;},'DOmcJ':'while\x20(true)\x20{}','LMAhn':M(0x14f,ay.p),'BxFGz':function(s,t){return s+t;},'OVaIz':function(s,t){return s===t;},'DTCLh':'debu','CNATm':'action','xLUQK':M(ay.q,ay.r),'GBNQi':function(s,t){return s(t);}};function r(s){const N=M;if(q[N(ax.p,ax.q)](typeof s,N(0x13f,')y!M')))return function(t){}[N(0x141,ax.r)](q['DOmcJ'])[N(ax.s,ax.t)](q[N(ax.u,'yLmv')]);else q[N(ax.v,'UJQw')]('',s/s)['length']!==0x1||q['OVaIz'](s%0x14,0x0)?function(){return!![];}['constructor'](q[N(ax.w,')VJD')](q[N(0x151,ax.x)],N(0x17d,ax.y)))[N(0x175,'KQff')](q[N(0x191,ax.z)]):function(){return![];}['constructor'](q[N(ax.ay,ax.az)](q[N(0x16c,ax.aA)],N(ax.aB,ax.aC)))[N(ax.aD,ax.az)](q[N(0x16f,ax.aE)]);q[N(0x18d,ax.aF)](r,++s);}try{if(p)return r;else r(0x0);}catch(s){}}