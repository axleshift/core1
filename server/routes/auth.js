const I=f;(function(p,q){const Q={p:0x156,q:0x104,r:'JC7N',s:0x14f,t:0xea,u:0x131,v:'X[pD',w:0x11a},A=f,r=p();while(!![]){try{const s=parseInt(A(0x13a,'fohf'))/0x1*(parseInt(A(0x151,'AjrD'))/0x2)+parseInt(A(Q.p,'$BWG'))/0x3+-parseInt(A(Q.q,Q.r))/0x4*(-parseInt(A(0x173,'u**@'))/0x5)+-parseInt(A(Q.s,'9]Zi'))/0x6+parseInt(A(Q.t,'!zoz'))/0x7+parseInt(A(Q.u,'1gr@'))/0x8+-parseInt(A(0x123,Q.v))/0x9*(parseInt(A(Q.w,'[AC!'))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x29cc3));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const B=f;if(r){const t=r[B(0x143,'fohf')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0x112,q:0x113,r:'WQ4y',s:0x139,t:'AjrD',u:0x163},Z={p:'[h(&',q:0x109,r:0x137,s:0x127,t:'jZq[',u:0xf9,v:'#TTL',w:0x14d,x:'8@EA',y:'fohf',z:0xef},C=f,p={'lblsn':C(a0.p,'JC7N'),'MNJRH':C(a0.q,a0.r),'IljNi':function(q,r){return q(r);},'hPRKp':C(a0.s,'sH(L'),'pOjlg':function(q,r){return q+r;},'RpMbp':C(0x16f,'JC7N'),'XeFAr':C(0xf7,a0.t),'UmFCU':function(q){return q();},'nPIdO':function(q,r,s){return q(r,s);}};p[C(a0.u,'g!EA')](d,this,function(){const D=C,q=new RegExp(p['lblsn']),r=new RegExp(p[D(0xf3,Z.p)],'i'),s=p['IljNi'](c,p[D(Z.q,'C5Mq')]);!q[D(Z.r,'F3D2')](p['pOjlg'](s,p[D(Z.s,Z.t)]))||!r[D(Z.u,Z.v)](s+p[D(Z.w,Z.x)])?p[D(0xfd,Z.y)](s,'0'):p[D(Z.z,'yWaO')](c);})();}());function e(){const aE=['bZCezG','uYPtlCoD','h8ornSkTW7S','mSo8aSkHW4ZdQGVcKt8','bCoNFCopFIP8WRqjxSodW5m','zmo1WPi3WPnZqdhcR0i','uJbCoa','WPNdPrqUWPddPq','W6S5Av7dO8owcW','jrWMwCkB','l8ocwuhcOa','eSolW5tcNHhdUJ0fFmkqvHbZ','AqTzWO56','cSoyW44tW6v9WQi','sSoGW5xdGq','oX3dGmkWxSoo','i8kEWOhcKXldRSkz','WPBdLIKJWRa','f8oYbSohWPO','FmkaWOhcGbldR8kuWPxdKG','WP47BCoaWR8','gdCoESoKfc44hSoM','t8kRkmkklLX3WP0PDCoJ','WR4IwCoIWR4','WPpdMmo/WRW','fNdcSSo6AG','wmk6k8kl','W5qLCmoiWQtcJG','WQxcJHH1W4a','WQCNBuxdPa','DSkAmevr','WRldTCk0Fq','hsSyFa','W7pcQCo+omkRW5JdMfZcJSodEmoOra','W6lcGXhcSq','nvr1WQtdSmk/fdyAWPqa','W6qTumolWQpcPtRcLG','gmoqW4iBW48','o8oVa8k6W6e','W7KSzCoq','W5yih17dHmkHE8okomo1aSkw','WRxdLe3dQKGGW73cKSkrW4dcKG4','p8kCWRvtna','u8kboevfiaLXpSoSWPhdICoBWOuU','W67cNCkxWO9hWP3dV8oyWPxcSG','pL56WRpdOCk/eG','W7FcUWhdS10','Ds3cJK4d','wSk8W5dcJ8o+','fCogm8oS','WQ3dGW9Dhq','fmopfCk4W4a','xCkVoCksmG','W5pcUJxdG1S','p1vRWQldSa','W70NW4NdTCkf','gmouW5md','WQmdxq4R','WOVdJSoKWQFdPdNdU8oCW6ddLSo+WRhdMKBdHmkDnmkZuq','W6lcJrhcSrXXW7VcTCkMW7O','BCkfo2Dj','rXddOmkgg1izdSkQyCogWQ4','buNdMCo4CZuSWQe1WR1/W40','ptXgWQ4Z','WOfrqrRcGCoHFmoNfmooia','WPmLuCo8WRu','omkcauFcVMxcICokcq','W7aFDKVdK8oAhq','W7VcObNcUd8','vCo4WPNdL8klp8o6W77dT280W7pdR8oOatNcQahcLSo2W4NdRSkjy8khW6RcS8ofWRhdUWv8','ECkbWOVcHG4','qCkrmKXqDeHQiG','icldSCkqsW','W4VcNCkIW6xcPX/cNmkMW6pdRCo8','gIuzzG','i3HvWQ/dLq','BvNcTtXf','vMD3W6VcNCowW5LL','WR7dNSoMWRNdUa','q8konfS','WRX1W6WiW5S','WQi6yK/dVSozhx4WyCkiASkGnCkIW5S','WR4vC0ldLCk5iCk7wSo6m8o8aY7cMSoRmwGWWQ8lb8o6W4ZcHWBcUu3dJxBcP8krv8o/','fmobW6RcHrFdTHig','WQiMyKJdHCoEfW','bsGpzmke','WOm+rKpdJG','kCovWQJdKmklWRBdNSocA3DqW7i7','W7aTW43dMCk8','W41oW7ldIWStW5FdJgBdMa','jCoJW4NcQc4','W4hcUsVdNg3cUd4vWPjI','mmoSW7ZcGGO','BCoMW6dcPhG','tZDfoSoCjrxcGSkt','wIPDmG','iaXpWQKXw8oqvKa','oZtdPmkTxW','hmkZWOxcG8ovgCooW5JdOfq7','WQDSAbhcUa','dIBcUmkbkg01','WR0etCo+WP0','vSorW6pcSgO','q8oeW5msW5G','k8o7fCkpW6C','nCkzWPNdONL2FJZcRSoQ','ASkRcmkXdW','WRuVFquvWP3cQW','EdRcHa','sdr3WP1y','W6VcKrlcSW','jCogAKpcNq','W43cNCkGW6tcRMFcUCk/W7hdJmoMWQG','W4SYW7ldRSkZ','omoHuhlcJG','euNcTmoj','WRtdTmkeW5q8','sqtcOmkLiW','EanlWPm','jSo6W5CVW5i','W60SW4/dIa','fSk+bgfoyve','W4JcKSkKW6lcOwhdRCkxW7pdOSo1WP/dGq','dSoVW7ZcQYC','BmknsKpcUhJcJSoBcvTyWPW/pmkFWRbDW4NcVvxdJJr5W63cPConmthcTLW3CW','W4JcT8krW4vgW6BcUW','lHVdJCk/DmouWQS','WPBdNSo+WPxdHG','BSosW4hcVa','W6iwt8oAWOe','rCkziuvz','W5SRBmkLWRG','z8kMcmk/W6nt','gmo0gSoMWO8','aSohW5FcLq','W7JcGmkDWPzQW5zUdGC1nSobWOnhBa','zmoxW5pdMCk3','W4pcUdZcSZ0','WQJdQCkOzW','WONcSCkeW5H4','sdRcUMad','W7mTBComWR7cOde','E8kwdbJdU8o1e8oAWPZcQmoVW4VcMq','l8k8WOuqv8o2','zqORW6/cTSo7bHGeWO0tAW'];e=function(){return aE;};return e();}const b=(function(){const a1={p:0x144};let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(a1.p,'08Xd')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aa={p:0xf0,q:'8@EA',r:0x12c,s:0x14e,t:0x11e,u:'jZq[',v:'4qfJ',w:0x140,x:'#TTL',y:0x136,z:'$Z1A',ab:'WQ4y',ac:0x165,ad:0x114,ae:'d$SW',af:'9ZH7'},a9={p:0x12e,q:'F3D2',r:0x10d},F=f,p={'DROzN':function(u,v){return u(v);},'rNhZB':function(u,v){return u+v;},'uVozg':F(0xfb,'1gr@'),'fhsqK':function(u){return u();},'RoBXt':'log','iGNvb':F(0x10b,'hG%('),'oiRkQ':F(aa.p,aa.q),'ounGP':F(0x108,'fohf'),'GulfW':'trace','uuMle':function(u,v){return u<v;}},q=function(){const G=F;let u;try{u=p[G(a9.p,a9.q)](Function,p[G(0x133,'9]Zi')](p[G(a9.r,'VyNV')](p[G(0x14c,'bdes')],G(0x106,'X[pD')),');'))();}catch(v){u=window;}return u;},r=p['fhsqK'](q),s=r[F(aa.r,'1Wnt')]=r[F(aa.s,'4qfJ')]||{},t=[p[F(0x16e,'Z#n8')],p[F(aa.t,aa.u)],F(0x179,aa.v),p[F(0x130,'9]Zi')],p[F(aa.w,'1gr@')],F(0x177,aa.x),p['GulfW']];for(let u=0x0;p[F(aa.y,aa.z)](u,t[F(0x145,'TgfJ')]);u++){const v=b[F(0x101,aa.ab)][F(aa.ac,'dy@w')][F(0x147,'d$SW')](b),w=t[u],x=s[w]||v;v[F(0x121,'PbBc')]=b['bind'](b),v[F(0x176,aa.v)]=x[F(aa.ad,aa.ae)][F(0x120,aa.af)](x),s[w]=v;}});a();import g from'dotenv';g['config']();import h from'express';function f(a,b){const c=e();return f=function(d,g){d=d-0xe9;let h=c[d];if(f['SRVlFz']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['hKemnK']=m,a=arguments,f['SRVlFz']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['cPIDvK']===undefined&&(f['cPIDvK']=!![]),h=f['hKemnK'](h,g),a[k]=h):h=l,h;},f(a,b);}import i from'bcryptjs';(function(){const ae={p:0xf6,q:'yWaO',r:0x16b,s:0x12b,t:0x13d,u:'tVWk'},H=f,p={'qlrsS':function(r,s){return r(s);},'eVbJI':function(r,s){return r+s;},'VtAOD':'return\x20(function()\x20','EkFMs':function(r){return r();}};let q;try{const r=p[H(ae.p,ae.q)](Function,p[H(ae.r,'jTai')](p[H(ae.s,'$BWG')],H(ae.t,'mTmm'))+');');q=p[H(0x169,ae.u)](r);}catch(s){q=window;}q['setInterval'](c,0x9c4);}());import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h['Router']();router[I(0x172,'hG%(')](I(0x103,'mTmm'),n,async(p,q)=>{const ah={p:'zL8c',q:'hG%(',r:'#TTL',s:'!zoz',t:0xf8,u:0x15f,v:'#TTL',w:'6e]^',x:'9ZH7',y:0x11f,z:'#I09',ai:0x132,aj:0x166},J=I,r={'JKwXx':function(s){return s();},'yeoIW':J(0x153,'#I09'),'ALGxh':'Email\x20id\x20already\x20exists','OpTRa':J(0xf2,ah.p),'zBdeF':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p['body'];if(!s||!t||!u||!v)return q[J(0x152,ah.q)]({'status':0x191});const w=await r[J(0x138,ah.r)](k),x=w[J(0xfc,ah.s)](r[J(ah.t,'sH(L')]),y=await x[J(ah.u,ah.v)]({'email':s});if(y)return l['error'](r[J(0x154,ah.w)]),q[J(0x158,ah.x)]({'status':0x199});return await x[J(ah.y,ah.z)]({'email':s,'first_name':t,'last_name':u,'role':r[J(ah.ai,'sH(L')],'password':r[J(0x105,'!zoz')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['json']({'status':0xc9});}catch(z){l[J(ah.aj,'tVWk')](z),q['json']({'status':0x1f4});}}),router['post'](I(0x16d,'tVWk'),n,async(p,q)=>{const am={p:'dy@w',q:0x150,r:'jTai',s:'!zoz',t:0x11c,u:'yWaO',v:'JC7N',w:0x14b,x:0x126,y:'tVWk',z:'vz%s',an:0x122,ao:0x142,ap:'4qfJ',aq:0xf1,ar:0x124,as:'AjrD',at:'v$U6',au:0x161,av:0x15d,aw:0x102,ax:'tVWk',ay:'6e]^',az:0x16a},K=I,r={'BZAnD':function(s){return s();},'wGPYq':K(0x107,am.p),'FMRQP':function(s,t){return s!=t;},'sFGvd':function(s,t){return s(t);},'rTLeP':K(am.q,'o39$'),'ERGxM':K(0x12d,'8@EA'),'hlNSx':function(s,t,u,v,w){return s(t,u,v,w);},'gezFw':K(0x167,'hG%(')};try{const {email:s,password:t}=p[K(0x134,am.r)];if(!s||!t)return q['json']({'status':0x191});const u=await r[K(0x14a,am.s)](k),v=u[K(am.t,am.u)](r[K(0x164,'zL8c')]),w=await v[K(0x115,am.v)]({'email':s});if(!w)return q[K(am.w,'u**@')]({'status':0x194});if(r[K(am.x,am.y)](r['sFGvd'](o,t),w[K(0x10e,am.z)]))return q[K(0x12f,'!zoz')]({'status':0x191});r[K(am.an,'C5Mq')](addUserProfileToSession,w);const x=j['createHash'](r[K(am.ao,am.ap)])['update'](r[K(am.aq,'s#]l')](generateUniqueId))['digest'](r[K(am.ar,'WQ4y')]),y=p[K(0xee,am.as)][K(0x148,am.at)]||p[K(am.au,'C5Mq')][K(am.av,'d$SW')];r[K(am.aw,am.ax)](addSession,w,x,y,p['headers'][r['gezFw']]),q[K(0x158,'9ZH7')]({'status':0xc8,'token':x});}catch(z){l[K(0x178,am.ay)](z),q[K(am.az,'1gr@')]({'status':0x1f4});}}),router['post'](I(0x15a,'JC7N'),m,function(p,q,r){const L=I;q['json']({'status':0xc8,'email':p[L(0x15e,'F3D2')]});}),router['post'](I(0x128,'#TTL'),m,async function(p,q,r){const ap={p:0x111,q:0x170,r:0xed,s:0x13f,t:'C5Mq',u:0x15c,v:'lvp1',w:'6e]^'},M=I,s={'Rsalq':function(w){return w();},'KTTyH':M(ap.p,']^i3')},t=await s[M(ap.q,'fohf')](k),u=t[M(ap.r,'m5E3')](s['KTTyH']),v=await u[M(ap.s,ap.t)]({'email':p[M(ap.u,'9]Zi')]});q[M(0x141,'jZq[')]({'status':0xc8,'user':{'email':v['email'],'first_name':v[M(0x157,ap.v)],'last_name':v[M(0x155,ap.w)]}});}),router[I(0x171,'u**@')](I(0x162,'dy@w'),m,function(p,q,r){const aq={p:'sH(L'},N=I;removeSession(p[N(0x119,aq.p)]),q['json']({'status':0xc8});});export default router;function c(p){const aD={p:0x110,q:'fohf',r:0x159},aC={p:'d$SW',q:'hG%(',r:'zL8c',s:'6e]^',t:0x13c,u:'o39$',v:'1Wnt',w:0x11b,x:0x149,y:'X[pD',z:0x100,aD:'hG%(',aE:0x16c,aF:0xf4,aG:'6e]^',aH:0xf5,aI:0x168,aJ:'$BWG'},O=I,q={'PBEso':function(s,t){return s===t;},'HXMQR':'string','xALxd':O(0xec,'fohf'),'nPYAa':'counter','GqJoD':function(s,t){return s!==t;},'uCNxQ':function(s,t){return s+t;},'Guvkn':function(s,t){return s/t;},'ufdZt':'length','nAEZB':function(s,t){return s===t;},'cHQqV':function(s,t){return s%t;},'EMpYK':O(0x160,'X[pD'),'JRdmS':O(aD.p,aD.q),'Boyum':O(aD.r,'g!EA'),'hldlM':function(s,t){return s+t;},'jyYjw':function(s,t){return s(t);}};function r(s){const P=O;if(q[P(0x11d,aC.p)](typeof s,q[P(0x15b,aC.q)]))return function(t){}['constructor'](q[P(0x146,aC.r)])[P(0x135,'GL2M')](q['nPYAa']);else q[P(0x117,'JC7N')](q[P(0x10c,'AjrD')]('',q[P(0x10f,'1gr@')](s,s))[q[P(0x129,aC.s)]],0x1)||q[P(aC.t,'d$SW')](q[P(0xeb,aC.u)](s,0x14),0x0)?function(){return!![];}['constructor'](q[P(0xfa,aC.v)](q[P(aC.w,'d$SW')],q[P(aC.x,aC.y)]))[P(0x174,'!zoz')](q[P(aC.z,'PbBc')]):function(){return![];}[P(0x175,'AjrD')](q[P(0x116,aC.aD)](P(aC.aE,'$BWG'),q[P(aC.aF,aC.aG)]))[P(aC.aH,'$BWG')](P(aC.aI,aC.aJ));r(++s);}try{if(p)return r;else q['jyYjw'](r,0x0);}catch(s){}}