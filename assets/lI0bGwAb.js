import{R as e,r as s,j as t}from"./_LxKj9PG.js";import{R as a}from"./CD8lARB7.js";import{b as o,e as r}from"./C_hIR-2K.js";import{d as l,b as i,c as n,a as c,C as m,U as d,ar as j,e as h,f as p,g as x,h as u,i as b}from"./BRvZdRVW.js";import"./C_9exQ7i.js";import"./Itq7e1c5.js";import"./BGnBE-TB.js";import"./c7OvE8pj.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BJRa5TG-.js";import"./tRrjmjzN.js";import"./BFk34ZWe.js";import"./lcqsW1nY.js";import"./DIrOWF5t.js";import"./D74OPSAh.js";import"./COFYN2eQ.js";import"./DcHTRIdl.js";import"./BXbwj-H9.js";import"./K-dupnmX.js";import"./ZZM5rHs7.js";import"./Dw1DiDGf.js";import"./YiBEvX-Q.js";import"./rRm29nvs.js";import"./CzGuHLZU.js";import"./B8Let_61.js";import"./CZm-rpfG.js";import"./CUCxJel0.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const f=()=>{const f=e.useRef(),{addToast:g}=o(),[k,v]=s.useState(!1),[y,N]=s.useState([]),[C,w]=s.useState([]),[L,S]=s.useState(!1);s.useEffect((()=>{(async()=>{axios.get("/sec/webhooks").then((e=>{N(e.data),w(e.data)})).catch((e=>{var s,t;const a=(null==(t=null==(s=e.response)?void 0:s.data)?void 0:t.error)||e.message||"Server is offline or restarting please wait";g(a)})).finally((()=>v(!1)))})()}),[]);const W=(e,s,t)=>{const a=[...y];a[e][t]=s,N(a)};return k?t.jsx("div",{className:"loading-overlay",children:t.jsx(l,{color:"primary",variant:"grow"})}):t.jsxs("div",{children:[t.jsx(a,{ref:f,size:"invisible",sitekey:r}),t.jsxs(i,{className:"align-items-center mb-2",children:[t.jsx(n,{children:t.jsx("h4",{className:"mb-0",children:"Webhooks"})}),t.jsxs(n,{className:"text-right d-flex justify-content-end",children:[t.jsx(c,{color:"primary",onClick:()=>{N([...y,{url:"",checked:!1}])},children:"New"}),t.jsx(c,{color:"danger",onClick:()=>{if(0===y.filter((e=>e.checked)).length)return g("Please select at least one Webhook to delete.");S(!0)},className:"ms-2",children:"Delete"})]})]}),0===y.length&&0===C.length&&t.jsx(m,{className:"my-5",children:t.jsx("div",{className:"text-center",children:t.jsxs("div",{className:"text-body-secondary",children:[t.jsx("h1",{className:"d-block text-danger",children:"No Webhooks added yet."}),t.jsx("span",{children:'Please click "New" to add a Webhook.'})]})})}),y.map(((e,s)=>t.jsxs("div",{className:"d-block d-md-flex mb-2 gap-2",children:[t.jsx("input",{className:"me-3",type:"checkbox",checked:e.checked,onChange:e=>((e,s)=>{const t=[...y];t[e].checked=s,N(t)})(s,e.target.checked)}),t.jsx(d,{type:"text",value:e.url,floatingLabel:"URL",onChange:e=>W(s,e.target.value,"url"),className:"me-2 mb-2 mb-md-0"}),t.jsx(d,{type:"text",floatingLabel:"Token",value:e.token,onChange:e=>W(s,e.target.value,"token"),className:"me-2 mb-2 mb-md-0"}),t.jsxs(j,{value:e.action,floatingLabel:"Action",onChange:e=>W(s,e.target.value,"action"),className:"me-2 mb-2 mb-md-0",children:[t.jsx("option",{value:"",children:"Choose"}),t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"invoices",children:"Invoices"}),t.jsx("option",{value:"shipments",children:"Shipments"}),t.jsx("option",{value:"documents",children:"Documents"})]})]},s))),t.jsx(c,{color:"primary",onClick:async()=>{const e=await f.current.executeAsync();v(!0),axios.post("/sec/webhooks",{recaptcha_ref:e,WebhooksLocationList:y}).then((e=>{if(e.data.error)return g(e.data.error);g("Webhooks updated successfully"),w(y)})).catch((e=>{var s,t;const a=(null==(t=null==(s=e.response)?void 0:s.data)?void 0:t.error)||e.message||"Server is offline or restarting please wait";g(a)})).finally((()=>v(!1)))},className:"mb-4",disabled:0===y.length&&0===C.length,children:"Apply all changes"}),t.jsxs(h,{alignment:"center",scrollable:!0,visible:L,onClose:()=>S(!1),"aria-labelledby":"M",children:[t.jsx(p,{children:t.jsx(x,{children:"Confirm Delete?"})}),t.jsxs(u,{children:[t.jsx("ul",{children:y.filter((e=>e.checked)).map(((e,s)=>t.jsx("li",{children:e.url},s)))}),"Are you sure you want to delete the selected Webhooks? This action cannot be undone."]}),t.jsxs(b,{className:"d-flex justify-content-end",children:[t.jsx(c,{color:"secondary",onClick:()=>{S(!1),N(y.filter((e=>!e.checked)))},children:"Delete"}),t.jsx(c,{color:"primary",onClick:()=>{S(!1)},className:"ms-2",children:"Cancel"})]})]})]})};export{f as default};
