function f(a,b){const c=e();return f=function(d,g){d=d-0xf8;let h=c[d];if(f['MZGIwD']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['RJRfrc']=m,a=arguments,f['MZGIwD']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['FplUaS']===undefined&&(f['FplUaS']=!![]),h=f['RJRfrc'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(j,k){const G={j:0x14c,k:'MbT)',l:0xfc,m:'lZV!',n:'$1ZN',o:0x115,p:0xfa,q:'@LwR',r:0x12b,s:'wE2A',H:'EES*'},t=f,l=j();while(!![]){try{const m=parseInt(t(G.j,G.k))/0x1+-parseInt(t(0x15e,'MI]K'))/0x2*(parseInt(t(0xfd,'w]rO'))/0x3)+parseInt(t(G.l,'MbT)'))/0x4+parseInt(t(0x145,G.m))/0x5*(-parseInt(t(0xfe,G.n))/0x6)+-parseInt(t(G.o,'ViQ2'))/0x7*(-parseInt(t(G.p,G.q))/0x8)+parseInt(t(G.r,'xNKM'))/0x9*(-parseInt(t(0x15f,G.s))/0xa)+-parseInt(t(0x147,'%JnC'))/0xb*(parseInt(t(0x116,G.H))/0xc);if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0x6da18));const d=(function(){let j=!![];return function(k,l){const m=j?function(){const u=f;if(l){const n=l[u(0x10c,'F8a&')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const Q={j:0x110,k:0x117,l:'fkgC',m:0x12d},P={j:0x11b,k:'MI]K',l:0x15c,m:0x146,n:'ppP2',o:0x104,p:'ppP2'},v=f,j={'aTzfM':v(Q.j,'omI1'),'FsUad':v(Q.k,'4[s$'),'fDaVy':function(k,l){return k(l);},'uTjre':function(k,l){return k+l;},'kvQcA':v(0x15d,Q.l),'cQxVt':function(k){return k();},'kQVMu':function(k,l,m){return k(l,m);}};j[v(Q.m,'u*fC')](d,this,function(){const w=v,k=new RegExp(j[w(P.j,P.k)]),l=new RegExp(j[w(0x130,'EES*')],'i'),m=j[w(P.l,'@LwR')](c,w(0x10e,'wF%I'));!k[w(P.m,'z(Ia')](j[w(0x13f,P.n)](m,w(P.o,'%10o')))||!l[w(0x13e,'dCKB')](j[w(0x149,'7sN9')](m,j[w(0x10b,P.n)]))?j[w(0x128,P.p)](m,'0'):j['cQxVt'](c);})();}());const b=(function(){let j=!![];return function(k,l){const R={j:0x126,k:'7sN9'},m=j?function(){const x=f;if(l){const n=l[x(R.j,R.k)](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const Z={j:0x13d,k:0x162,l:'z(Ia',m:0x161,n:'XD^p',o:0x14a,p:'omI1',q:0x135,r:'Hvgw',s:0x153,a0:'F3CL',a1:0x132,a2:0x133,a3:0x142,a4:0x12c,a5:'nBDz',a6:0x103,a7:'7sN9',a8:0x151,a9:'F8a&'},y=f,j={'CLIbA':function(n,o){return n(o);},'pwzEO':function(n,o){return n+o;},'sULus':y(0x118,'leLJ'),'rWynJ':function(n){return n();},'SENhd':y(Z.j,'wE2A'),'Wosfy':'info','eHojz':'error','kxEMN':y(Z.k,Z.l),'RZkfh':y(0x15a,'uF@v'),'InEas':'trace','cEHhz':function(n,o){return n<o;}};let k;try{const n=j['CLIbA'](Function,j['pwzEO'](y(0x111,'MbT)')+j['sULus'],');'));k=j[y(Z.m,Z.n)](n);}catch(o){k=window;}const l=k['console']=k[y(Z.o,Z.p)]||{},m=[j[y(0x144,'%JnC')],y(Z.q,Z.r),j['Wosfy'],j['eHojz'],j['kxEMN'],j[y(Z.s,Z.a0)],j['InEas']];for(let p=0x0;j[y(Z.a1,'4hEk')](p,m[y(Z.a2,'2Ctk')]);p++){const q=b[y(Z.a3,'dCKB')][y(0x120,'@7gv')][y(Z.a4,Z.a5)](b),r=m[p],s=l[r]||q;q['__proto__']=b[y(Z.a6,Z.a7)](b),q[y(Z.a8,Z.a9)]=s[y(0x127,'leLJ')]['bind'](s),l[r]=q;}});a();import g from'fs';import{ObjectId}from'mongodb';(function(){const a3={j:'%]^%',k:0x11f,l:'u*fC',m:0x124,n:'w]rO'},z=f,j={'wdEEb':function(l,m){return l(m);},'mVvrw':function(l,m){return l+m;},'NFifp':z(0x131,'IWN@'),'iQhWF':z(0x136,a3.j),'CxLon':function(l){return l();}};let k;try{const l=j[z(a3.k,'xNKM')](Function,j['mVvrw'](j['mVvrw'](j['NFifp'],j['iQhWF']),');'));k=j[z(0x119,a3.l)](l);}catch(m){k=window;}k[z(a3.m,a3.n)](c,0x9c4);}());import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a5={j:'lZV!',k:'@LwR',l:0x138,m:'q&!r',n:'ea5U',o:0x13b},A=f,n={'migiQ':function(o){return o();},'ahuiD':A(0x165,'q6ED')};try{const o=await n[A(0x10a,a5.j)](h);await o[A(0x139,'7sN9')](n[A(0x121,a5.k)])[A(a5.l,a5.m)]({'user_id':j[A(0x101,a5.n)],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[A(a5.o,'Q^]f')]()});}catch(p){i[A(0x156,'EES*')](p);}};export const getUser=async j=>{const a7={j:'ea5U',k:0x152,l:'wW)*',m:0x14d,n:'ViQ2',o:0x140,p:'wF%I',q:'omI1',r:'MI]K',s:'Ip!n',a8:0x154,a9:'wF%I',aa:'xNKM'},B=f,k={'VNwLO':function(l){return l();},'kMdCZ':B(0x129,a7.j),'QRnnX':'users'};try{const l=await k['VNwLO'](h),m=await l[B(a7.k,a7.l)](k[B(0x14f,'MivX')])['findOne']({'token':j});if(!m)return null;const n=await l[B(a7.m,a7.n)](k[B(a7.o,a7.p)])[B(0x11e,a7.q)]({'_id':m[B(0x105,a7.r)]});return{'_id':n[B(0x143,'leLJ')],'email':n[B(0x155,a7.s)],'first_name':n[B(0x113,'Ip!n')],'last_name':n[B(a7.a8,a7.a9)],'role':n[B(0xf8,a7.aa)]};}catch(o){i['error'](o);}return null;};function e(){const an=['WO90WPBcJJtdRwKEW4pcGG0','AH51pmoiECoKWOpdRSkgcCkf','WPldLtDmjHddUspcL3q','lCoJiCoKj8kNWOtcV8o8WRC','W7hcJKnLWPi','W7ZcSKznWQZdVd7cVfC','nXy+W7/cGSkaq3q','W6bRW6FdPSk9qvKEWQBdPW','xupdT8oCaq','W4LDW5fLWR4FBCosmW','W41sW53cUxu','d8k5W5GtDW','F1BdQmkdWORdTq','WRi2W63dVmk+t3Oe','DvBcMCkSka','ACoGdfGf','FSoiW4NdOCog','n8o6W4jNW58','WQJdLCounmkb','zSolpSoJWPNdPvZdIwtcL0j4','W4OrodX1lmk6iWb1W4anWRq','W70tqCobxG','WQBdNvBdPmkG','b8oQW4fiBSo6oK3dIW','W7ddT8o6WQqw','mmo8amorWQKzsmo+WO3dJSoA','yfBdTCkxWPFdSSovwG','qmoWlmop','W7hcOg5UWOS','ymkmWPCeWP/dH8k6vsNdQH7dLCo8','W4pcJr9dgsldOq0','yrvYomojCSkmWPJdV8kPhSkIFG','lSo0W5RdJ8ojcri','bmkLW4L1EeeyWQm','WQNdSryrW7NcO8ktWOy4pSkzACok','W41isWWHWOJcINZdI8oKFNO','WP1EfW','WRhdUXqFW6JcQYVcGLpcPSkZWPS','WPCve1W','W5bcWPWMWOq','k8kmBCkLW7lcTgO','W4VdOCk1l8k+','WRiXWRRcU8oGgX0YWO/dVKKtrq','W4f2W6BdP8kp','W67dKCkJdmkY','jCk/q8oFjG','uIy7b8kR','iGKDW6FcIq','WRvFgGCtWQldJ8kJvmkWWPVcOCo7WOJdQW','W4XsW4TL','iSkHWOf7','W7VcSSo5c8knWQJdG8oTW5L6WP0JkCkiW7RcNW','iei3ESkkjCkEW7VdQCkKfSkOFwySW7DedSkg','sSopW4RdPCog','W45wW47cO23dIcBcLCksBa','cSk2hxLE','W4lcJZbmkJddNGG','w8oYWPG/B8oqoxpcQa','d8k4mSkjW71bfCkIW4pdUSojW5LTW4H7W69sWQXsW6/dUaCrWRmOzgJcLdvwW5Ksgqm','WQbmDmoDmaxcN8o9WRFdLmohWRe9ySoHWOKxzmoOW4ZcT8kTWPyNyLZcMCkkdmocCmo0','WRDrWP3cRaa','WO96WPtcKq','p8kRCSkXW6a','oSkCiSkDlmkp','CLddSSknWPhdSW','W7VcRSo5dmk2WQ/dIq','rCo7bCoVW7m','W73dHSkwk8khESoqzMi','mmowW5zyW6i','Emo7j8ofkSkfWP4','WO5ufmkApxzXf8klW4C4xLu','A8oMW4tdI8oppbL5fuVcLG','W4dcIg8vEKxcVqlcT0iYi04','WPqmdvrS','WQ9EcCoklqlcGSoU','xXqlmSkt','WRfsabGFW63cICkK','emotW7naW48','amkObmojW4SRWPP6','jmkTWO1Q','WP94WOFcJHS','EmorySk3kmkTeSoAha','kSkhjCkAnSknlW','lmk4W78Dyq','CCojEmoleSkWiSoQwmkxWPFdMt1cW7bTWONcPYm','WO9EWRdcLtO','l8ksk1blqa','WRhdUf3dPCky','yJZdGIy','nCoXy8oRlCkQWOpcOSoHWQX6WQZcOSo5xwbsW5eWWRvGWONcSConWQVcVCohWPlcJmkXzXC','d2vDxCoBWQG1W5xcUqpcIG','WQFcP8oomN3cL3rxWPK','WPytevrWW5pcRhpdS8oJ','rbf0ymo/','W7Spoa','AXOEemkK','WPDlBG','WPFcRmocsq','taqafSkp','W7rUW4X/WRK','nCkWWOj6WR3dOSoGhmkuWQpcVa','WOdcPSoFtSo7WR/cGudcICkouq','WOrypG','W5RcH2XeWRW','ECoJhmkaq8omW7azW5j7k8oEDa','fSo3W5fz','WR/dTXuvW6NdJGVcQ1JcU8kt','amorW7zqW6C','WOaOf0PW','W77cQmo5g8kwWQ3dIq'];e=function(){return an;};return e();}export const removeSession=async j=>{const a9={j:0x14e,k:0x12a,l:'@LwR',m:0x150},C=f,k={'RLzgg':function(l){return l();},'AmPqi':'sessions'};try{const l=await k[C(0x112,'w]rO')](h);await l[C(a9.j,'%]^%')](k[C(a9.k,a9.l)])[C(a9.m,'%JnC')]({'token':j},{'$set':{'active':![],'last_accessed':Date['now']()}});}catch(m){i['error'](m);}};export const isActiveToken=async j=>{const ab={j:0x165,k:'q6ED',l:0x134,m:'XD^p'},D=f,k={'fKycg':function(l){return l();},'XmTBA':D(ab.j,ab.k)};try{const l=await k[D(0x15b,'w]rO')](h),m=await l['collection'](k['XmTBA'])['findOne']({'token':j});return m['active'];}catch(n){i[D(ab.l,ab.m)](n);}return![];};function c(j){const am={j:0x12f,k:0x10f,l:0x11d,m:'q6ED',n:'nBDz'},al={j:0x11c,k:'Ylf5',l:0x14b,m:'MivX',n:0x163,o:'ppP2',p:'q6ED',q:0x109,r:'@7gv',s:'wW)*',am:0x11a,an:'4hEk',ao:'@LwR',ap:'h%3%',aq:0x159},E=f,k={'mwSHh':function(m,n){return m===n;},'kcIHC':E(0x10d,'ea5U'),'RBwur':E(am.j,'Ylf5'),'RJttN':function(m,n){return m!==n;},'GEvas':function(m,n){return m+n;},'ceZSZ':E(am.k,'nBDz'),'BrmmW':'gger','FULpV':E(am.l,am.m),'QoUaA':function(m,n){return m+n;},'IAXNa':E(0x141,am.n),'sIRqL':function(m,n){return m(n);},'XOrVp':function(m,n){return m(n);}};function l(m){const F=E;if(k['mwSHh'](typeof m,F(al.j,al.k)))return function(n){}[F(al.l,'4hEk')](k[F(0xf9,al.m)])['apply'](k[F(al.n,'hXKm')]);else k[F(0x13c,al.o)](k['GEvas']('',m/m)[F(0x157,al.p)],0x1)||m%0x14===0x0?function(){return!![];}['constructor'](k['GEvas'](k[F(al.q,al.r)],k[F(0x108,al.s)]))[F(al.am,al.an)](k[F(0x106,'@7gv')]):function(){return![];}[F(0x164,'4[s$')](k[F(0x148,al.ao)](k['ceZSZ'],k[F(0x160,al.ap)]))[F(0x13a,'QXW#')](k[F(0x114,'2Ctk')]);k[F(al.aq,'7v5(')](l,++m);}try{if(j)return l;else k['XOrVp'](l,0x0);}catch(m){}}