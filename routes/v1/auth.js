const H=f;(function(p,q){const Q={p:'vIHy',q:'dH7r',r:'L!Ao',s:0x99,t:0xaf,u:0x7f,v:'xDrv',w:0xea,x:0xf5,y:'J(GA'},B=f,r=p();while(!![]){try{const s=parseInt(B(0x104,Q.p))/0x1*(-parseInt(B(0x106,Q.q))/0x2)+-parseInt(B(0xc8,Q.r))/0x3*(-parseInt(B(0xec,'J]&s'))/0x4)+-parseInt(B(Q.s,'xDrv'))/0x5*(-parseInt(B(0x77,'^kMx'))/0x6)+-parseInt(B(0x101,'U*Fh'))/0x7*(-parseInt(B(Q.t,'oTF0'))/0x8)+-parseInt(B(0xf3,'qy8o'))/0x9*(-parseInt(B(Q.u,'N$QY'))/0xa)+-parseInt(B(0xca,Q.v))/0xb*(-parseInt(B(Q.w,'Z0ck'))/0xc)+-parseInt(B(Q.x,Q.y))/0xd;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xaddc1));const d=(function(){let p=!![];return function(q,r){const R={p:0xbd,q:')4h]'},s=p?function(){const C=f;if(r){const t=r[C(R.p,R.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:'jRsG',q:'$(9d',r:0xb1,s:0xc5,t:0x8e,u:'5Hdi'},a0={p:0x10a,q:'N$QY',r:0x8b,s:')4h]',t:'dH7r',u:'^kMx',v:0x75,w:0x115,x:'DnMw'},D=f,p={'CVuRg':D(0x8d,a1.p),'jXVFD':D(0xd8,a1.q),'itazq':function(q,r){return q(r);},'zsaVj':D(0x10e,'N$QY'),'xgMmP':D(a1.r,'Xbhw'),'Vrlpg':function(q,r){return q+r;},'PnDyQ':D(a1.s,a1.p),'YJfRr':function(q,r){return q(r);},'qgEJh':function(q){return q();},'GcOrm':function(q,r,s){return q(r,s);}};p[D(a1.t,a1.u)](d,this,function(){const E=D,q=new RegExp(p['CVuRg']),r=new RegExp(p[E(a0.p,a0.q)],'i'),s=p[E(a0.r,'zBKc')](c,p[E(0xe6,a0.s)]);!q[E(0xab,a0.t)](s+p[E(0xaa,a0.u)])||!r['test'](p[E(a0.v,'J[R2')](s,p[E(a0.w,'7eL7')]))?p['YJfRr'](s,'0'):p[E(0xd2,a0.x)](c);})();}());const b=(function(){let p=!![];return function(q,r){const a2={p:0xa8,q:'xxBh'},s=p?function(){const F=f;if(r){const t=r[F(a2.p,a2.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aa={p:0xf4,q:0xcf,r:0xdd,s:'vIHy',t:0xee,u:'U*Fh',v:0xf7,w:'L&1q',x:'vIHy',y:0x84,z:0xc9,A:'khY[',ab:0x9f,ac:'gTze',ad:0x10d,ae:0x86,af:'oTF0',ag:0xad,ah:0x92},G=f,p={'PpqPF':function(t,u){return t+u;},'PcBXd':function(t,u){return t+u;},'WacKD':G(aa.p,'vUC0'),'cXzTs':G(aa.q,'J(GA'),'wnZpO':function(t){return t();},'rLgtE':G(aa.r,aa.s),'QKuzW':'error','QOdAi':G(aa.t,aa.u),'oQryG':function(t,u){return t<u;}};let q;try{const t=Function(p['PpqPF'](p['PcBXd'](p['WacKD'],p[G(aa.v,'lGTd')]),');'));q=p[G(0x80,aa.w)](t);}catch(u){q=window;}const r=q[G(0xa5,aa.x)]=q[G(aa.y,'(gTw')]||{},s=[p[G(aa.z,aa.A)],'warn','info',p[G(aa.ab,aa.ac)],p[G(0xd6,'7Pya')],'table',G(0x10c,'oTF0')];for(let v=0x0;p[G(aa.ad,'1uxp')](v,s[G(aa.ae,'zBKc')]);v++){const w=b[G(0x87,'xxBh')][G(0xc2,aa.af)][G(0xfc,'qy8o')](b),x=s[v],y=r[x]||w;w[G(aa.ag,'k9pu')]=b[G(0xe5,'zBKc')](b),w[G(0xa9,'eHJW')]=y[G(aa.ah,'Pies')][G(0xdb,'mAu(')](y),r[x]=w;}});a();import g from'dotenv';g[H(0xbc,')4h]')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x74;let h=c[d];if(f['wHQVSa']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['EMVeYm']=m,a=arguments,f['wHQVSa']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['lLlTZG']===undefined&&(f['lLlTZG']=!![]),h=f['EMVeYm'](h,g),a[k]=h):h=l,h;},f(a,b);}import l from'../../src/logger.js';function e(){const aG=['W7ZdVq3dVSk4','b8k3FCoXaq','eCkDW4RdLa','DCkyW7ZdQc/dMq','D8khW6ldOJ8','W7nSASk5Dfy','BuBcL2/cVmk5WOOyWRfSDNu','WQldQh4Kba','WPJdSSovW6NcQq','W6JdNYhdRCkLfvFcICow','uSkKW7mxkW','rSoOamkNDG','WOJdSSowWRJdVG','W6xdUmkOfSoB','WR4Mmf7cKCo2W7NdVSkfWP4X','De7dVCogWQhdRGCg','W61fy8kQrq','WQOaWQWnW6ldTZxcN1NcJq','W68MWPhcQ8klmZS','Bmk6D2pdIva','WOj3u0H3tCoAj8kTWO1qWQW','oCkMDSoEW5q','W6dcSZPHWPOBEmkAiNdcRaJdQ8k9n2ldL8o8W5NdNCo+WRhcU00yW6PreCojk8kmW6K','eYxcSa/cHW','WRJdL2xcGta','rSkXW4qYmq','W51PWO0KwW','W5bNWPzflCk/txlcVmkhtColwL8u','gSksCwtcR8kV','W6qjaJ0N','WQ49p1NcKmo3','W7rHWQWbF8oIbd/dOSk5smolrNflWQf6BW0KyCkZW6JcLCoeW4hdOCowwrqzWOldK2C','EZBdSL/cM8oljCo0','W6zlvb3dNW','WQi5WPRcVq','W5jttSkKra','WReMoq','sJldO2hcIa','EbxdRh7cKG','W5BcIf5BWOe','eSkxW5FdHa','W5RdTeL4W50','emkYz8oiW44','uSk7W6arnq','emkCwCoo','BmkeW7pdMcW','W6hdSKBdQCkuW7VdT29DWRVcQq','kGxdLmon','W7XsW7Ti','WRWAW7fNz2fahr5Q','mXZcKH/cOG','WOr7W7FdQspcHmorfGa7W4tdQW','WQG1WOW','ixe5kKKUW53dNg8','W4qCWPRdN3JcSqTzdcG','WOvlkdCQ','WPpdOLxcGdFdNW','ir4dWR0gW6tdJSoTzq','jSoiWRddQCkWW4LmhSk0WRpcKmkD','wIFdS1pcRa/dVSkSqd3dMSkhW6RdOmkQWQ4FpCoM','WQNdUI00W4bdmSoAaNxcOqNdNCke','WRa/WOFcRq','W4qRWOZdP24','WOldS8okWQhdR8kKFmoMW7BdUq','pg7dNshdImki','WRbwWPNdImo3WOa','WO0Olv7cKSoRW77dUCorWPuSp0xdUYxdMmoRW5xcMmkwW53cMmof','DCkvW67cUq','WQ3dSuFdVCkjW6C','WPNcT8kOWOZcKNhdUfdcQaz3','E8kMW4FcMSoT','W5qqW7qa','DZWyk1eWW7xdNa','W5eyWRHSeG','bSkhsCoaW4G2sCo3vmoJcCoCWR8','W659AXRdKSk3W7xdLmkzWPSViW','WOxdRCoKW4NcTcGW','W692rCkyW6rWtq','pt4yWQWX','mCk6b1z2WQvRl8kvra','t8kBEeRdPG','DCknqK7dQa','W5ddJ8kgb8omyW','W6ZdNY/dUSkV','WO/dH0BcJqu','DSk7FxW','BKxcKMVdO8oMWPmhWQja','nMWUoKS0WPtcM2FcVmo8dmkZWOhcMLHectW','W7TAxSk3CG','W6PrWRu4Eq','oWqrWQWbW6m','W61eW7XpWQNdScFcK17cKW','AvtcIwZcHG','pSkWbv1NWQ4','bCk0zSo0nG','W7LGDSkTDgeetmoyyG','xSoxjstdO8oOuZOUxCoIzG','W5SlW47cPG','xCkLW64w','W7PgqCkbWO0o','lttdVmoWWRO','rSkty3xcQa','n307o0WP','W6fpW6XBW5C','kSoHjepdLxaCW6tcVW','fCkwW77dGgi','W5aRbXuI','fG50yt0bW4K','W5hdGZJdUmkMceRdMCowfCkTeCkrmmoGrCksWQmyzva','eWH0DH0dW4K','vCkCW57dJYi','hSkqwConCLq','f8knsSoCW4GHFCoWrmo+hG','W77dQK15','pmk0u8ocoG','WO3dJ8oaWO7dQa','g8kbvSoqDW','WQKMnuJcIW','WOFdQCoiWQ7dVSkUz8oHWRNcVCkQW6K1th7cLq','W7yBW67cUGC','FSksW7pdQIpdJf0','eCkmW4xdHfJcHW','eCktyMFcJW','pb8JWQWgW7NdR8oK','EJlcJfJcHmoQfSoIWQe','WRrjwSkpWO0vzG','eCkAqSoeCLNcOq','W7PtWQm2F10','WRmKWPxcRCkhgIdcN8o/ESkH','fCkUqmo1W40','WQWhW5DXW6ldPdlcRW','fSkCumopDuG','W73dOfbP','WPJdU8oGW58','CwpcJL/cVa','W6X9zCkQDu0','bSkWW5RdUqW','bmkxW6FdTGO','WRSBWOeYrMHcpq','WR1VCSkL','iCkHcK5MWRu','W5OOW6NcQqy','WR4Mmf7cISoOW6K','FmkNCwNdMeevW4RcPqu','W4ulW7enb8om','fCksvmodW4u','WO7cT8kvWOVcLgRdO1q','eCkbxx3cIG','WQn5BSk/','W6VcIx1qWRe','gtdcHX/cVM/cJ8oTlq','phldNwFcImon','WQNcLxVcQSo/ubZcVSoFl8kydmkx','WPGmW55oW5S','W6hdTuNdS8ko','WOhdPKtcMdS','aWjUtbWBW4LBk8kTDW','WRvZhtOo','bajPCq','DCkME2y','l8kwW5JcJSoqWPDW','zmkzW67cUq'];e=function(){return aG;};return e();}(function(){const ae={p:0xde,q:0xc4,r:'Ss01',s:0xb3},I=H,p={'FjBNa':function(r,s){return r(s);},'izjkK':function(r,s){return r+s;},'uNhtE':I(0x110,'U*Fh'),'bpdGV':'{}.constructor(\x22return\x20this\x22)(\x20)','FGxqI':function(r){return r();}};let q;try{const r=p['FjBNa'](Function,p['izjkK'](p[I(0x107,'Pies')]+p[I(ae.p,'vUC0')],');'));q=p[I(ae.q,ae.r)](r);}catch(s){q=window;}q[I(ae.s,'(gTw')](c,0x9c4);}());import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h['Router']();router[H(0xe1,'L&1q')]('/register',async(p,q)=>{const aj={p:'oTF0',q:0x9c,r:'2qO%',s:0xfa,t:0x9e,u:'khY[',v:0x78,w:'5Hdi',x:'Z0ck',y:0xa0,z:0x74,A:'o3$@',ak:0x7d,al:'U*Fh',am:0xb6,an:0xc0,ao:'xDrv',ap:0xa2,aq:0xdf,ar:0x111,as:0x9d,at:'7eL7',au:'Pies',av:0x102,aw:'$(9d',ax:0x9b,ay:0xc3},J=H,r={'RJJsP':J(0x83,aj.p),'SlHuQ':function(s,t){return s<t;},'GzxHe':'Password\x20must\x20be\x20greater\x20than\x208\x20digit','yxufS':function(s,t){return s!=t;},'PWkXL':J(0xfb,'vIHy'),'dSZir':function(s){return s();},'HYCJk':J(0xeb,'k9pu'),'lSfCb':'Email\x20id\x20already\x20exists','lZGGd':J(aj.q,aj.r),'yRHFM':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(!s||!t||!u||!v||!w)return q[J(aj.s,'7v6N')](0x190)['send']();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(0xb5,'(gTw')](s))return q[J(aj.t,aj.u)](0xc8)[J(aj.v,aj.w)]({'error':r[J(0xd3,aj.x)]});if(r[J(aj.y,'gTze')](v[J(aj.z,aj.A)],0x8))return q[J(aj.ak,aj.al)](0xc8)[J(aj.am,'N$QY')]({'error':r[J(aj.an,'#Z1B')]});if(r[J(0x7e,aj.ao)](v,w))return q['status'](0xc8)[J(aj.ap,'dH7r')]({'error':r[J(aj.aq,'vUC0')]});const x=await r[J(aj.ar,'khY[')](k),y=x[J(0xef,'lGTd')](r[J(aj.as,aj.at)]),z=await y[J(0x82,'(gTw')]({'email':s});if(z)return l['error'](r[J(0x8a,'jRsG')]),q[J(0xf1,'1uxp')](0x199)['send']();return await y[J(0xf2,aj.au)]({'email':s,'first_name':t,'last_name':u,'role':r[J(0xff,'qy8o')],'password':r[J(aj.av,aj.aw)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['status'](0xc9)[J(aj.ax,'(xjZ')]();}catch(A){l[J(aj.ay,'DnMw')](A);}return q[J(0x113,aj.au)](0x1f4)['send']();}),router[H(0xf6,'mAu(')](H(0xfd,'Xbhw'),n,async(p,q)=>{const ao={p:0xf9,q:'mAu(',r:'$(9d',s:'xDrv',t:0x100,u:'caUI',v:0xf8,w:'jRsG',x:0xd7,y:'vIHy',z:'L!Ao',A:0xa6,ap:'N$QY',aq:'Z0ck',ar:'Pb2J',as:0x9a,at:'zBKc',au:0x8f,av:0xcc,aw:'xxBh',ax:0x105,ay:'2qO%',az:'L&1q',aA:'DnMw',aB:0x112,aC:0xae},K=H,r={'MFJYt':function(s,t){return s||t;},'UJGbV':function(s){return s();},'XAQur':function(s,t){return s!=t;},'mBGSV':function(s,t){return s(t);},'MZJzD':K(ao.p,'K]oH'),'diHFg':K(0xed,ao.q),'gkNRd':K(0xd4,ao.r),'dMVqE':K(0x114,ao.s)};try{const {email:s,password:t}=p[K(ao.t,ao.u)];if(r[K(0xe0,'J(GA')](!s,!t))return q['status'](0x190)['send']();const u=await r[K(0xd0,'k9pu')](k),v=u[K(ao.v,ao.w)]('users'),w=await v['findOne']({'email':s});if(!w)return q[K(ao.x,ao.y)](0x194)[K(0xbb,'L&1q')]();if(r[K(0xd1,'1uxp')](r[K(0x7b,ao.z)](o,t),w['password']))return q[K(0xa3,'o3$@')](0x191)['send']();addUserProfileToSession(w);const x=j[K(ao.A,ao.ap)](r[K(0xdc,'khY[')])[K(0x96,ao.aq)](r[K(0xf0,ao.ar)](generateUniqueId))[K(ao.as,ao.at)](r['diHFg']),y=p[K(ao.au,')4h]')][r['gkNRd']]||p[K(ao.av,'N$QY')][K(0x103,ao.aw)];return addSession(w,x,y,p[K(ao.ax,ao.ay)][r['dMVqE']]),q[K(0x90,ao.az)](0xc8)[K(0x79,ao.aA)]({'token':x});}catch(z){l[K(ao.aB,ao.aq)](z);}return q[K(ao.aC,'K]oH')](0x1f4)[K(0xb8,'qy8o')]();}),router['post'](H(0xcb,'mAu('),m,function(p,q,r){const ap={p:0xfa,q:'7v6N',r:0x81,s:'7Pya'},L=H;return q[L(ap.p,ap.q)](0xc8)['json']({'email':p[L(ap.r,ap.s)]});}),router[H(0x88,'(xjZ')](H(0x7c,'^kMx'),m,async function(p,q,r){const ar={p:0xa4,q:0x108,r:0xe4,s:'bieE',t:0xe8,u:'V810',v:'khY[',w:0xb4,x:0xd5},M=H,s={'kPHal':function(t){return t();}};try{const t=await s[M(ar.p,'5Hdi')](k),u=t[M(ar.q,'o3$@')]('users'),v=await u['findOne']({'email':p[M(ar.r,'DnMw')]});return q[M(0x10b,ar.s)](0xc8)[M(ar.t,'L!Ao')]({'user':{'email':v[M(0xb0,ar.u)],'first_name':v[M(0x76,ar.v)],'last_name':v['last_name']}});}catch(w){l[M(ar.w,'Pb2J')](w);}return q[M(ar.x,'^kMx')](0x1f4)['send']();}),router['post'](H(0x94,'MI#d'),m,function(p,q,r){const at={p:0x109,q:'N$QY',r:0x8c,s:'vIHy',t:'caUI'},N=H,s={'PNlBJ':function(t,u){return t(u);}};return s[N(at.p,at.q)](removeSession,p[N(at.r,at.s)]),q[N(0xa7,at.t)](0xc8)['send']();});export default router;function c(p){const aF={p:0x95,q:'zBKc',r:0x89},aE={p:')4h]',q:0xfe,r:0xb2,s:0xda,t:0x98,u:0xce,v:'xxBh',w:0xbe,x:'khY[',y:'^kMx',z:0xc7,A:0xba,aF:'J[R2',aG:'oTF0',aH:0x7a,aI:'bieE',aJ:0xe3,aK:0x97},O=H,q={'uzPDx':function(s,t){return s===t;},'CkLAd':'string','pGiRD':'while\x20(true)\x20{}','iuXBI':O(aF.p,aF.q),'aLdZq':function(s,t){return s!==t;},'TqwuP':function(s,t){return s+t;},'MDRqh':function(s,t){return s/t;},'xurwU':function(s,t){return s%t;},'dPCgr':'gger','FCOeb':function(s,t){return s+t;},'orYFk':function(s,t){return s(t);}};function r(s){const P=O;if(q[P(0xc1,'2qO%')](typeof s,q[P(0x85,aE.p)]))return function(t){}[P(aE.q,'eHJW')](q[P(0xac,'J(GA')])[P(aE.r,'1uxp')](q[P(aE.s,'9%82')]);else q[P(aE.t,'xxBh')](q[P(0xe2,'(xjZ')]('',q[P(aE.u,aE.v)](s,s))[P(aE.w,aE.x)],0x1)||q[P(0x91,aE.y)](s,0x14)===0x0?function(){return!![];}[P(aE.z,'vIHy')](q[P(aE.A,aE.aF)]('debu',q[P(0xb9,aE.aG)]))['call'](P(aE.aH,'MI#d')):function(){return![];}[P(0xe7,'Xbhw')](q[P(0xc6,aE.aI)](P(0xe9,'xDrv'),q[P(aE.aJ,'xxBh')]))['apply'](P(aE.aK,'mAu('));q['orYFk'](r,++s);}try{if(p)return r;else q[O(aF.r,'J[R2')](r,0x0);}catch(s){}}