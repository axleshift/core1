function e(){const ai=['CCkUi0FdHq','WQmfeCkXW6S','kSkZWOXwW6TKWQ8GgG','W6T/ESo2hW','F8oxBCoxtq','WP4LpSkRECoZnu/dGa','W6Hrn1D1qq','kmkoWPn9iG','WOv6W51bWRHeBmkTW7HSWRS','fmkPWQVdSmo+W5SCW4PZ','eIddT07dNa','W4BcRbBdNCkp','WO/cLKpcVmoMemoq','jCkWW78PeqL5Cmo4la','FSk0zCkIW5BdI8k2pSoBghhdOum','W4xcImk+W7tdScK9WPPDWRP4W4y','WOX/WRldPmkihLbsvSkhW50uW5q','WOWElmopjIy3WOi','WO8qn8oLoa','e3nQW6KE','vmojumoHrSkGW6e','W6rlW5VdHCojxq','W4ucta','W4XEWOeEWOq1W54K','lLLqW6q2','WQxcSsFdIsK','WRpcQsldGtpcKCkNESo0','cmodb8k4','W54ExIPBWQad','chTY','a2z3W4ek','ASo7W5OhWQSWWPi/gLJcQw4','W7TAW5tdLSoyEMHEx8kmvG','W69mFSoyeq','fSkWWOvnW5i','WO3cG3rAW68AWRvW','W6u3zSkBWQW','W4FcHmoUWQdcVLKaWP4','WORcKehcTmomhCobl114','pmkSWOrBW7PIWPqNefi','fmk8WQNdVmoIW7adW4bVW4xdQrBcO3/dSW','g8oCg8kXW4a','CwaqW45J','oaJcMGNdSt/dJhhdRCk0hvm','qmoHW7dcRmk6WPC0W6rBW5tdRqu','W4tdHG5j','W7LJW4bsW4ZcVCofW5VdMCkN','WPBcLGbZW68','ASoiWR3cPHC','WPO4aSkRzmoUiLG','g8krWQzbcq','W4Xvdxjs','WOZdRftdSa','WQRcTIe','WOfYW5za','lSkyWOv8ofCJW7e','vYi8WPLmumk6iSk5Fv7cP20','W4FcI8k4W7/dUs5mWOzfWR5tW7hdTW','WPq5aSki','W63dGSoDW75U','WRZdPSkGW752iNm8xa','W4lcTJtdI8kx','WOpdTaNdP8kgW5RdKcFdTLnDWPLjWQm3WQFdQ8k3WR1zsmodtSkNpsFdSxBcVbu8oq','W44UW7tcNSouxqvUAmk0W5W','W4hcTWRdLG','i8oCW4BdOIOxW53cHCk2ttK','W6eWw8kFWO3cVNSSjSkQhG','oSkUWOLEW7m','WOa4jG','W5xdNMPjW6a','WPSsW7tcTsu','W7Lmk1O','uL7cLCo4wI4','WP7dVeNdP8kDW53dJd3cPaXIW4ugW7TdWQW','WRFcOIDL','W7ZcTWa','t13cL8oDsW','k8kWWP9pW6S','naJdVKK','W7bpWOyUWPC','FmohC2Wy','WRtdUmkJW7D9','W4FcHZdcQLa','Dmk7mv4','W4PlW6xdQCot','l8oRmmo6WOxcMSo2dCoIoq','W6NdG8o5W5vz','W7ZcRSo1WOyVWRddLY/dOmkaW6hcR2iMWRnhW77dIr4aWRClzttdNSojBmkKWRFdH3z9WRH6','xvtcLCoSwJqNb8oOCCoC','WP7dOeNdOmkMW5RdHG','Cvm9W5Tw','bSkrd8kQgCo5WRiau8kNW4VcLe0','i8oFkSoOW4m','W7xdRxhcK37dHSkVy8o8W7BcJmk/','vSofsSo7x8kP','W7hcGvS','wflcLCo7ysG3','W4RcRSk7W75P','WOhdQSoRWPlcVq','fmkJWRRdUSo8','l8kyWOj6i1zTWQPwWRBcQvXPW6meqCoNa1q','qmoeWRPOWORdNuhcO1uIua93F8kQW6/cVhbeW61LWOZcRCo7WOrBW7iDDxRcPMW','WP3cVvFcKCog','nmkQWQLTW6K','WP7cL0tcTmomxSkDmKbJdCkhWOuTpa','e8ocg8kOW40','WP7dV8kzW6uK'];e=function(){return ai;};return e();}(function(i,j){const F={i:0x1b8,j:'V6pD',k:'9vWm',l:'NtGq',m:0x18b,n:'tcut',o:0x1a9,p:0x1be,q:'m(9p',r:']5Yz',G:0x1d2,H:'m(9p'},s=f,k=i();while(!![]){try{const l=parseInt(s(F.i,F.j))/0x1+-parseInt(s(0x1d1,F.k))/0x2+parseInt(s(0x1a7,F.l))/0x3+parseInt(s(F.m,F.n))/0x4+parseInt(s(F.o,'2rW2'))/0x5+parseInt(s(F.p,F.q))/0x6*(-parseInt(s(0x1c5,F.r))/0x7)+-parseInt(s(F.G,F.H))/0x8;if(l===j)break;else k['push'](k['shift']());}catch(m){k['push'](k['shift']());}}}(e,0x84398));const d=(function(){let i=!![];return function(j,k){const G={i:0x1ea},l=i?function(){const t=f;if(k){const m=k[t(G.i,'NEpH')](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}());(function(){const O={i:0x1e2,j:'SC$p',k:0x185,l:'&$!^',m:0x1e3,n:'Z6E5',o:0x1b2,p:'t426',q:'V6pD'},N={i:'vY!e',j:0x1ab,k:'*QEt'},u=f,i={'qxBaB':u(O.i,O.j),'Ssbpp':u(O.k,O.l),'pkhYw':function(j,k){return j(k);},'XFVrA':u(O.m,O.n),'gikmX':function(j,k){return j+k;},'MwRIE':u(O.o,'tcut'),'nyoap':u(0x197,O.p),'kiAZv':function(j,k,l){return j(k,l);}};i[u(0x195,O.q)](d,this,function(){const v=u,j=new RegExp(i['qxBaB']),k=new RegExp(i[v(0x18f,N.i)],'i'),l=i[v(N.j,N.k)](c,i['XFVrA']);!j[v(0x1cd,'SC$p')](i['gikmX'](l,i['MwRIE']))||!k[v(0x1e7,'M6nV')](l+i['nyoap'])?i['pkhYw'](l,'0'):c();})();}());function f(a,b){const c=e();return f=function(d,g){d=d-0x182;let h=c[d];if(f['Wdreme']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['nxMBDb']=m,a=arguments,f['Wdreme']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['ZjubAA']===undefined&&(f['ZjubAA']=!![]),h=f['nxMBDb'](h,g),a[k]=h):h=l,h;},f(a,b);}const b=(function(){const P={i:0x1e9};let i=!![];return function(j,k){const l=i?function(){const w=f;if(k){const m=k[w(P.i,'9Iwc')](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),a=b(this,function(){const W={i:'FaLZ',j:'tcut',k:0x1b7,l:'z]!Q',m:'AWy6',n:0x1d6,o:0x18a,p:0x1c3,q:'8@Aa',r:0x1ae,X:0x1db,Y:'Ma7l',Z:0x19e,a0:'%&BP',a1:0x1e0,a2:'z]!Q',a3:0x1ca},x=f,i={'zJEdt':function(m,n){return m+n;},'WpHLI':x(0x192,W.i),'SYqLz':function(m){return m();},'HqSEd':x(0x1ce,W.j),'ahPyj':'warn','IFPxV':'info','ghSwU':x(W.k,'9vWm'),'XyuWK':x(0x1a2,']5Yz'),'RMzsA':'table','kYHtT':function(m,n){return m<n;}};let j;try{const m=Function(i['zJEdt'](i[x(0x1cc,W.l)],x(0x1d7,'SC$p'))+');');j=i[x(0x19a,W.m)](m);}catch(n){j=window;}const k=j['console']=j[x(0x1ad,'YRwI')]||{},l=[i[x(0x19d,'YRwI')],i[x(W.n,'JOJ#')],i[x(0x184,'&$!^')],i[x(0x1bd,'Ma7l')],i['XyuWK'],i[x(0x1a3,'M6nV')],x(W.o,'kIKA')];for(let o=0x0;i[x(W.p,W.q)](o,l[x(W.r,'2gDA')]);o++){const p=b[x(W.X,W.Y)][x(W.Z,W.a0)][x(0x1d9,'JOJ#')](b),q=l[o],r=k[q]||p;p['__proto__']=b[x(W.a1,W.a2)](b),p[x(0x1ca,W.a0)]=r[x(W.a3,'%&BP')][x(0x1c6,']RzF')](r),k[q]=p;}});a(),(function(){const Z={i:0x192,j:'sR6i',k:'2gDA',l:'li1!',m:'V6pD',n:0x1c9,o:'Z6E5',p:0x1d8},y=f,i={'BePKn':function(k,l){return k(l);},'tswxt':function(k,l){return k+l;},'PVDkI':y(Z.i,'FaLZ'),'HZNbx':y(0x193,Z.j)};let j;try{const k=i[y(0x182,Z.k)](Function,i[y(0x198,Z.l)](i[y(0x1e6,Z.m)](i[y(Z.n,'eddv')],i[y(0x1c8,Z.o)]),');'));j=k();}catch(l){j=window;}j[y(Z.p,'2rW2')](c,0x9c4);}());import{ObjectId}from'mongodb';import g from'../models/db.js';import h from'./logger.js';export const addSession=async(i,j,k,l)=>{const a1={i:0x1d4,j:'&$!^',k:0x1c7,l:'4cXO',m:0x1aa,n:'*QEt',o:0x1d5,p:0x18d,q:0x1dd},z=f,m={'MGtSa':function(n){return n();}};try{const n=await m[z(a1.i,a1.j)](g);n[z(a1.k,a1.l)](z(a1.m,a1.n))[z(a1.o,'NEpH')]({'user_id':i[z(a1.p,'Fb*A')],'token':j,'active':!![],'ip_address':k,'user_agent':l,'last_accessed':Date[z(a1.q,'%&BP')]()});}catch(o){h['error'](o);}};export const getUser=async i=>{const a3={i:'05sI',j:'DfOM',k:0x18e,l:0x1a5,m:0x1b5,n:0x1e4,o:0x1dc,p:0x1a6,q:'s7^W',r:0x1b4,a4:'t426',a5:0x1c1,a6:0x191},A=f,j={'aRLVv':function(k){return k();}};try{const k=await j[A(0x1ba,a3.i)](g),l=await k[A(0x1bf,a3.j)]('sessions')[A(a3.k,'2clu')]({'token':i});if(!l)return null;const m=await k['collection'](A(0x1a0,'FaLZ'))[A(a3.l,'DfOM')]({'_id':l[A(a3.m,'kRv[')]});return{'_id':m[A(a3.n,'JOJ#')],'email':m[A(a3.o,'V6pD')],'first_name':m[A(a3.p,a3.q)],'last_name':m['last_name'],'role':m[A(a3.r,a3.a4)],'email_verify_at':m[A(a3.a5,']5Yz')]};}catch(n){h[A(a3.a6,']5Yz')](n);}return null;};export const removeSession=async i=>{const a4={i:0x1e5,j:0x1b3,k:'tcut'},B=f,j={'qflBe':B(0x1b0,'s!5[')};try{const k=await g();await k[B(0x183,'NtGq')](j[B(a4.i,'2clu')])[B(a4.j,a4.k)]({'token':i},{'$set':{'active':![],'last_accessed':Date[B(0x1b6,'9vWm')]()}});}catch(l){h['error'](l);}};export const getSession=async i=>{const a6={i:'V6pD',j:'SC$p',k:0x18c,l:'YRwI',m:0x1a4},C=f,j={'dyGnG':function(k){return k();},'IsmzM':C(0x1d0,'FaLZ')};try{const k=await j['dyGnG'](g),l=await k[C(0x1c0,'V6pD')](j[C(0x1bb,a6.i)])[C(0x187,a6.j)]({'token':i});if(l[C(a6.k,a6.l)])k['collection'](j['IsmzM'])[C(0x19b,'V6pD')]({'token':i},{'$set':{'last_accessed':Date[C(0x1af,'kRv[')]()}});return l;}catch(m){h[C(a6.m,'JOJ#')](m);}return null;};function c(i){const ah={i:0x196,j:'DfOM',k:'2clu',l:0x1d3,m:'AWy6',n:'^#xU',o:'2gDA',p:0x190,q:'m(9p'},ag={i:0x199,j:0x19c,k:'05sI',l:0x186,m:0x1ac,n:'FaLZ',o:0x1a1,p:0x1de,q:']5#Q',r:0x1c2,ah:0x1b1},D=f,j={'fmwaQ':D(ah.i,ah.j),'kjeaa':'counter','YyhcL':function(l,m){return l/m;},'eaHxx':D(0x1e1,ah.k),'rDGUB':function(l,m){return l===m;},'tBzIo':function(l,m){return l%m;},'ieytx':function(l,m){return l+m;},'ugoGf':D(ah.l,ah.m),'OttCz':D(0x1cf,ah.n),'FlPNX':'action','FXsUZ':D(0x1b9,ah.o),'HMUJN':function(l,m){return l(m);},'wVbUt':function(l,m){return l(m);}};function k(l){const E=D;if(typeof l===E(0x19f,'z]!Q'))return function(m){}[E(0x1da,'8EZL')](j['fmwaQ'])[E(ag.i,'yiFp')](j[E(0x188,'8@Aa')]);else(''+j['YyhcL'](l,l))[j[E(ag.j,ag.k)]]!==0x1||j['rDGUB'](j[E(0x194,'DfOM')](l,0x14),0x0)?function(){return!![];}[E(ag.l,'2clu')](j[E(0x1eb,')DU6')](j[E(ag.m,'9vWm')],j[E(0x1df,'^Knc')]))['call'](j[E(0x1cb,ag.n)]):function(){return![];}[E(ag.o,'^#xU')](j[E(ag.p,ag.q)](E(0x1ec,'yiFp'),j[E(0x1e8,'s!5[')]))[E(ag.r,'t426')](j['FXsUZ']);j[E(ag.ah,'9vWm')](k,++l);}try{if(i)return k;else j[D(ah.p,ah.q)](k,0x0);}catch(l){}}