import{j as s,r as e}from"./B29SdWEC.js";import{F as t,O as o}from"./6cdfdvti.js";import{b as a}from"./BPbvYWyy.js";import{P as r}from"./E8MUDNEF.js";import{a3 as i,a4 as n,q as l,r as c,a as d,b as p,a5 as m}from"./CMmVygpm.js";import"./ucIcx5RQ.js";import"./BIw_sdFo.js";import"./BFKNndIN.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./BmTZu7tj.js";import"./CxXfFpkk.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./B1ETHe3Q.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./CLdVYh6z.js";import"./DPAjA2jz.js";import"./OBe_9qlD.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const j=({color:e,title:t,value:o,data:a})=>s.jsx(i,{color:e,value:o,title:t,action:s.jsx(l,{alignment:"end",children:s.jsx(c,{color:"transparent",caret:!1,className:"text-white p-0"})}),chart:s.jsx(n,{className:"mt-3",style:{height:"70px"},data:{labels:Array(10).fill(""),datasets:[{label:"Data",backgroundColor:"rgba(255,255,255,.2)",borderColor:"rgba(255,255,255,.55)",data:a,fill:!0}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!1}},elements:{line:{borderWidth:2,tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4}},animation:{duration:0}}})});j.propTypes={color:r.string.isRequired,title:r.string.isRequired,value:r.any.isRequired,data:r.any.isRequired};const u=()=>{const[r,i]=e.useState(null),[n,l]=e.useState(!0),{addToast:c}=a(),[u,x]=e.useState([]),[g,b]=e.useState([]),h=s=>{const e=s.filter((s=>0!==s)),t=e.reduce(((s,e)=>s+e),0),o=e.length;return 0===o?0:t/o},v=async()=>{axios.get("/metrics/prometheus").then((s=>{const e=s.data;((s,e,t,o)=>{const a=(s+e)/(Date.now()/1e3-o);b((s=>[...s,parseFloat(a.toFixed(2))]))})(parseFloat(e.process_cpu_user_seconds_total[0].value),parseFloat(e.process_cpu_system_seconds_total[0].value),parseFloat(e.process_cpu_seconds_total[0].value),parseFloat(e.process_start_time_seconds[0].value)),x((s=>[...s,parseFloat(e.process_cpu_seconds_total[0].value.toFixed(2))]))})).catch((s=>{var e,t;const o=(null==(t=null==(e=s.response)?void 0:e.data)?void 0:t.error)||("network error"===s.message?"Server is offline or restarting please wait":s.message);c(o)})),axios.get("/metrics/mongodb").then((s=>{i(s.data)})).catch((s=>{var e,t;const o=(null==(t=null==(e=s.response)?void 0:e.data)?void 0:t.error)||("network error"===s.message?"Server is offline or restarting please wait":s.message);c(o)})).finally((()=>l(!1)))};return e.useEffect((()=>{v();const s=setInterval((()=>{v()}),5e3);return()=>clearInterval(s)}),[]),n?"":s.jsxs("div",{children:[s.jsx("h4",{children:"System"}),s.jsxs(d,{xs:{gutter:4},children:[s.jsx(p,{sm:6,xl:4,xxl:3,children:s.jsx(j,{color:"primary",title:"Average Load Time",value:`${h(g).toFixed(2)}ms`,data:g})}),s.jsx(p,{sm:6,xl:4,xxl:3,children:s.jsx(j,{color:"danger",title:"CPU Usage",value:`${h(u).toFixed(2)}%`,data:u})})]}),s.jsx("h4",{className:"mt-3",children:"Database"}),s.jsxs(d,{children:[s.jsx(p,{xs:4,children:s.jsx(m,{className:"mb-3 bg-body-secondary",icon:s.jsx(t,{icon:o}),title:`${r.connections[0].current} Connections`,value:(r.connections[0].current/r.connections[0].available*100).toFixed(2)+"%"})}),s.jsx(p,{xs:4,children:s.jsx(m,{className:"mb-3 bg-body-secondary",icon:s.jsx(t,{icon:o}),title:`${r.oplog[0].getMoreOps} per second`,value:r.oplog[0].networkBytes+" bytes"})}),s.jsx(p,{xs:4,children:s.jsx(m,{className:"mb-3 bg-body-secondary",icon:s.jsx(t,{icon:o}),title:`${r.operations[0].insert} insertions`,value:r.operations[0].query+" queries"})})]}),s.jsxs(d,{children:[s.jsx(p,{xs:4,children:s.jsx(m,{className:"mb-3 bg-body-secondary",icon:s.jsx(t,{icon:o}),title:`${r.operations[0].update} updates`,value:r.operations[0].delete+" deletes"})}),s.jsx(p,{xs:4,children:s.jsx(m,{className:"mb-3 bg-body-secondary",icon:s.jsx(t,{icon:o}),title:`${r.operations[0].getmore} getMore operations`,value:r.operations[0].command+" commands"})})]})]})};export{u as default};
