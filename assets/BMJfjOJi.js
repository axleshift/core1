import{r as s,j as e}from"./kqbr3HuW.js";import{F as r,C as t}from"./BNSBxhWN.js";import{d as i}from"./uw7PoZSV.js";import{c as o,o as a,q as m,a as n,b as d}from"./CueHWfgz.js";import{V as l}from"./DzpMfFJN.js";import{P as p,i as j}from"./B8H-rvok.js";import{p as c}from"./B51y9YVM.js";import{k as u}from"./DFarnK1O.js";import{Y as f,Z as h,s as x,aa as g,m as y}from"./DNgB2NZJ.js";import"./BgRKNlhe.js";import"./CgN-7aKy.js";import"./BYT_-xmR.js";import"./CFK1l90-.js";import"./uhX4GmSj.js";import"./BJ13bZ6b.js";import"./c0eKk1Db.js";import"./oXqQd4Ap.js";import"./CQYGjB7w.js";import"./DbzcfNKS.js";import"./BGKE3O6B.js";import"./DJeUPDeV.js";import"./B0UoamS-.js";import"./HSznFPq-.js";import"./omosduih.js";import"./D3yCfJ5s.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CJ2-25UQ.js";import"./BqHrj3jM.js";const v=()=>{const v=p(),[w,b]=s.useState([]),[N,$]=s.useState(""),D=s.useRef(null),[O,S]=s.useState(1),k=o(i,"messages"),A=j()?u().id:v.ref;s.useEffect((()=>{const s=a(m(k,n("timestamp")),(s=>{const e=s.docs.map((s=>({id:s.id,...s.data()}))).filter((s=>s.ref===A));b(e)}));return()=>s()}),[]),s.useEffect((()=>{D.current&&D.current.scrollIntoView({behavior:"smooth"})}),[w]);const C=async()=>{""!==N.trim()&&(await d(k,{text:N,sender:v.role,timestamp:Date.now(),ref:A}),$(""),S(1))};return e.jsx("div",{className:"row d-flex justify-content-center mx-0 mb-4",children:e.jsxs(f,{style:{height:"78vh",overflow:"hidden",padding:"0px"},children:[e.jsxs(h,{style:{position:"relative",height:"100vh",overflow:"auto"},children:[w.map(((s,r)=>{return e.jsxs("div",{className:"d-flex flex-row "+(s.sender===("user"===v.role?"admin":"user")?"justify-content-start":"justify-content-end"),children:[s.sender===("admin"===v.role?"user":"admin")&&e.jsx(x,{crossOrigin:"Anonymous",className:"rounded-5 me-2",src:"admin"===v.role?`${l}/u/${v.ref}.png`:"/images/default-avatar.jpg",style:{width:"45px",height:"100%"}}),e.jsxs("div",{children:[e.jsx("p",{className:"small p-2 mb-1 rounded "+(s.sender!==("user"===v.role?"user":"admin")?"bg-primary text-white me-3":"bg-body-tertiary ms-3"),children:(t=s.text,t.split("\n").map(((s,r)=>e.jsxs("span",{children:[s,r<t.split("\n").length-1&&e.jsx("br",{})]},r))))}),e.jsx("p",{className:"small ms-3 mb-3 text-muted "+(s.sender===("user"===v.role?"user":"admin")?"me-3":""),children:c(s.timestamp)})]}),s.sender===("user"===v.role?"user":"admin")&&e.jsx(x,{crossOrigin:"Anonymous",className:"rounded-5 ms-2",src:`${l}/u/${v.ref}.png`,style:{width:"45px",height:"100%"}})]},r);var t})),e.jsx("div",{ref:D})]}),e.jsxs("div",{className:"card-footer text-muted d-flex justify-content-start align-items-center p-3 gap-2",children:[e.jsx("div",{children:e.jsx(x,{crossOrigin:"Anonymous",className:"me-2 rounded-5",src:`${l}/u/${v.ref}.png`,style:{width:"40px",height:"100%"}})}),e.jsx(g,{value:N,onChange:s=>(s=>{const e=s.target.value;$(e);const r=Math.max(1,(e.match(/\n/g)||[]).length+1);S(Math.min(r,4))})(s),onKeyDown:s=>{if("Enter"===s.key){if(s.shiftKey)return $((s=>s+"\n")),S((s=>Math.min(s+1,4))),void s.preventDefault();C(),s.preventDefault()}},rows:O,style:{resize:"none"}}),e.jsx(y,{type:"submit",color:"primary",className:"me-2 rounded",onClick:C,children:e.jsx(r,{icon:t})})]})]})})};export{v as default};
