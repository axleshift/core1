const H=f;(function(p,q){const P={p:0xfc,q:'^!dk',r:0x126,s:0x138,t:0x120,u:0x108,v:'8oV)',w:'^AlS'},A=f,r=p();while(!![]){try{const s=parseInt(A(P.p,'JFql'))/0x1+-parseInt(A(0xf0,P.q))/0x2+-parseInt(A(P.r,'ZGTN'))/0x3*(parseInt(A(0x140,'yo)8'))/0x4)+-parseInt(A(P.s,'!*)O'))/0x5+-parseInt(A(P.t,'Lx#P'))/0x6+-parseInt(A(P.u,P.v))/0x7+parseInt(A(0xdd,P.w))/0x8;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xab996));function f(a,b){const c=e();return f=function(d,g){d=d-0xc7;let h=c[d];if(f['qNktDL']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['XvpGnr']=m,a=arguments,f['qNktDL']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['qmbmZi']===undefined&&(f['qmbmZi']=!![]),h=f['XvpGnr'](h,g),a[k]=h):h=l,h;},f(a,b);}const d=(function(){let p=!![];return function(q,r){const Q={p:'Rf$e'},s=p?function(){const B=f;if(r){const t=r[B(0x119,Q.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0xfd,q:'JFql',r:'pRK0',s:'4zjQ',t:'Rf$e'},Z={p:'GRoc',q:'yo)8',r:0x105,s:'!Voq',t:0x12f,u:0xd9,v:0xeb,w:0x113,x:0xf7},C=f,p={'UVglz':'function\x20*\x5c(\x20*\x5c)','bgJSF':C(a0.p,a0.q),'aBkoq':function(q,r){return q(r);},'sHLXT':function(q,r){return q+r;},'rAGWY':C(0x104,a0.r),'BlATB':function(q,r){return q+r;},'CjRrQ':C(0xc9,a0.s),'HdyID':function(q){return q();},'LqepA':function(q,r,s){return q(r,s);}};p[C(0x13e,a0.t)](d,this,function(){const D=C,q=new RegExp(p['UVglz']),r=new RegExp(p[D(0x12c,Z.p)],'i'),s=p[D(0x118,'uhYU')](c,D(0xd5,Z.q));!q[D(Z.r,Z.s)](p[D(Z.t,'bG21')](s,p[D(Z.u,'^!dk')]))||!r[D(Z.v,'F3tm')](p[D(0x11b,'Lx#P')](s,p[D(Z.w,'nlx3')]))?p['aBkoq'](s,'0'):p[D(Z.x,'Q8DY')](c);})();}());const b=(function(){const a1={p:0x13f};let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(a1.p,'M1hG')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aa={p:0xf1,q:0x139,r:'^!dk',s:'(Yq5',t:0xe7,u:0x11e,v:'g7JZ',w:0x11c,x:0x110,y:0x111,z:'@[!e',ab:0xe5,ac:'K9By',ad:0x12d,ae:'!Voq',af:'Pt3w'},a9={p:0x137,q:'4zjQ',r:0x114,s:'x#&9',t:0x13d},F=f,p={'QYBMQ':function(u,v){return u(v);},'TzpFi':function(u,v){return u+v;},'Orvif':F(0x12e,'9mFR'),'dNNTR':'{}.constructor(\x22return\x20this\x22)(\x20)','oCHUk':function(u){return u();},'SlChp':F(aa.p,'g7JZ'),'zoofZ':F(0xda,'nUcq'),'hrrVu':F(aa.q,aa.r),'hWTWH':'error','abbBj':F(0x10b,aa.s),'rodeQ':F(aa.t,'Uz96'),'JeYKH':function(u,v){return u<v;}},q=function(){const G=F;let u;try{u=p[G(0xcb,'JFql')](Function,p[G(a9.p,a9.q)](p[G(a9.r,a9.s)](p[G(0xd7,'(Yq5')],p[G(a9.t,'NtjA')]),');'))();}catch(v){u=window;}return u;},r=p[F(aa.u,aa.v)](q),s=r[F(aa.w,'pRK0')]=r['console']||{},t=[p[F(aa.x,'Rb$P')],p[F(aa.y,aa.z)],p[F(0xcf,'8oV)')],p['hWTWH'],'exception',p[F(aa.ab,aa.ac)],p['rodeQ']];for(let u=0x0;p[F(aa.ad,aa.ae)](u,t[F(0x123,'ENE^')]);u++){const v=b[F(0x10a,aa.af)]['prototype']['bind'](b),w=t[u],x=s[w]||v;v['__proto__']=b[F(0xec,'06o9')](b),v[F(0xde,'7ZFH')]=x[F(0x102,'Rb$P')]['bind'](x),s[w]=v;}});a();import g from'dotenv';g[H(0xe2,'!*)O')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[H(0xe1,'8oV)')]();router['post'](H(0xc8,'F3tm'),n,async(p,q)=>{const ae={p:0x101,q:'4zjQ',r:0x11a,s:'QhCb',t:0xf3,u:'GRoc',v:')UNn',w:'ZGTN',x:'^AlS',y:0xd3,z:'F3tm',af:0xe6,ag:'eiQz'},I=H,r={'omNzP':function(s,t){return s||t;},'oRVFo':function(s){return s();},'ARppw':I(0x136,'!*)O'),'IiMFB':'Email\x20id\x20already\x20exists','ZPqRK':'user','EeERb':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[I(ae.p,ae.q)];if(r[I(ae.r,ae.s)](!s,!t)||!u||!v)return q[I(ae.t,'QhCb')]({'status':0x191});const w=await r[I(0xf2,'NtjA')](k),x=w[I(0x10e,'^!dk')](r[I(0x10f,ae.u)]),y=await x[I(0x109,ae.v)]({'email':s});if(y)return l['error'](r['IiMFB']),q['json']({'status':0x199});return await x[I(0x10c,ae.w)]({'email':s,'first_name':t,'last_name':u,'role':r[I(0xee,ae.x)],'password':r[I(ae.y,ae.z)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[I(0xd4,'(Yq5')]({'status':0xc9});}catch(z){l[I(ae.af,')UNn')](z),q[I(0x107,ae.ag)]({'status':0x1f4});}}),router['post'](H(0x112,'nUcq'),n,async(p,q)=>{const ak={p:0xfa,q:0x13b,r:0x107,s:'eiQz',t:'(I&W',u:'GRoc',v:'06o9',w:0xca,x:0xed,y:0x13c,z:'^AlS',al:'nlx3',am:'nUcq',an:'9mFR',ao:0xd0,ap:'ToOE'},J=H,r={'jvmqd':function(s,t){return s||t;},'nXrux':function(s){return s();},'mqjQO':function(s,t){return s!=t;},'xmVzX':function(s,t){return s(t);},'uiuxJ':function(s){return s();},'wfMjM':J(ak.p,'@[!e'),'bpHgG':J(ak.q,'K9By'),'vKphA':'user-agent'};try{const {email:s,password:t}=p['body'];if(r['jvmqd'](!s,!t))return q[J(ak.r,ak.s)]({'status':0x191});const u=await r['nXrux'](k),v=u[J(0x131,ak.t)](J(0xff,'NtjA')),w=await v[J(0xfe,ak.u)]({'email':s});if(!w)return q[J(0xf4,ak.v)]({'status':0x194});if(r[J(0x117,'bG21')](o(t),w['password']))return q[J(0x127,'N18#')]({'status':0x191});r['xmVzX'](addUserProfileToSession,w);const x=j[J(0x135,'K9By')](J(0xe9,ak.s))[J(ak.w,'bG21')](r[J(ak.x,'M1hG')](generateUniqueId))[J(ak.y,ak.z)](r['wfMjM']),y=p[J(0x12a,ak.al)][r['bpHgG']]||p[J(0x106,ak.am)][J(0x130,ak.an)];addSession(w,x,y,p[J(ak.ao,ak.ap)][r[J(0x12b,'&URV')]]),q['json']({'status':0xc8,'token':x});}catch(z){l[J(0xc7,'nlx3')](z),q['json']({'status':0x1f4});}}),router[H(0x10d,'Lx#P')](H(0xe8,'Uz96'),m,function(p,q,r){q['json']({'status':0xc8});}),router[H(0xe4,'8oV)')](H(0xce,'[n4f'),m,function(p,q,r){const an={p:0x125,q:'pRK0',r:0xf8,s:'9mFR'},K=H,s={'tNIQm':function(t,u){return t(u);}};s[K(an.p,an.q)](removeSession,p[K(an.r,'Rf$e')]),q[K(0x116,an.s)]({'status':0xc8});}),(function(){const as={p:0x128,q:'g7JZ'},L=H,p={'laMWQ':function(s,t){return s(t);},'dTiJq':function(s,t){return s+t;},'qiqKv':L(as.p,as.q),'HJVGr':function(s){return s();}},q=function(){const M=L;let s;try{s=p[M(0x122,'9mFR')](Function,p[M(0x11d,'F3tm')](M(0xf6,'!*)O'),p['qiqKv'])+');')();}catch(t){s=window;}return s;},r=p['HJVGr'](q);r['setInterval'](c,0x9c4);}());export default router;function e(){const aH=['W7RcO8opW7pdMZSFgCoYWO5c','W5hdHLhcTGaNW7ekWRGvdgLHnW','W5bJWQPQeCoKuSow','cSkEWQXOW4O','WPmVWQNcJSoJ','n8kmnSkBW59m','thrbWQddTHG','W5NdKvxdQW','fCkmmmkB','owddTSkIwG','WPBcRmkJW43cLa','WR8KWQZcU8ow','W6qGWQJcQSoAhSk2','W7FdKSkTW5zPwq','WPH/W5FdSgyp','fCoBW4Cd','mdNcTKm','n8kkuxDu','WRNcOrpdL3G','qKjBWPxdTW','W4WjWRNcJmkyWPjisqDJW61Vja','CZ5L','qKZdLSkeca','DSo6W4f3','ocpcT0K','WPCCWPqCW6XsW6CAW78AAa','xx5BWRpdRreQW71uWQnQWQRdPd/dU2pdK8kAcG','WQnVW5ZdKeW','WOaCWPekW7y','WRLKtaxcLa','uSkGWQC','eSokW5udWRNcQCook8kVW6io','WPa+fKP8W5dcLNJdSmkdW4NdHa4','W70KF1fOW4NcIWRcHCkBW4BcHZZdPsNdGCktqYavnmkHlmoDWO7cP8otW5ehWRZdOSkzgSkD','W4xdK3LCW4hdL8ko','wg3dPCkWfa','W6LKWQ99dW','wbWNsq','d8oBq8kgWQKdDgG','W4jKySkvtG','W5K9W7tcP8ok','W7ddLwqR','BSoXFCkRdSoD','W67dICkJWOO','uSoqD8oBWO0gW7JcIgu/eSkEW54','WPxcT8k/W4BcQCoEeG','fJPwvrddQLmoW7KxhG','WPBcLKBdGSke','laVdU23cISonF1BdTW','WQFcGCoiWRS','WP1uW6ZdL8ooW4ieCtjc','W6ldQgDiW7K','kmoyu8kAWQS','qmkQWRbzW7W','mSoYCCkNaSoh','W77dNMxdRcG','udbVcSk4','nCkltwn7WRXibCoyWOHPW6emw8kh','W6v8ymk4','W4hdTSojWQ7cHa','vazSWPjZ','WPudWOOdW6e','C8oKW6bJcq','WPxcGSo6WPVdOq','W5K6W7VcVColWQ9D','bCoQW509WQ0','CbjkW7vt','WR9SEspcQq','W6tdMSkcW7VcKd4cWPBcJ8k0W6Cfmq','pmomW55Rzq','W6nUqSkbxq','wLuLW5NcPdS','vSkUWRtcSrm','W44BW5ZcN8oj','Df3cVKxcISoRx37dMq','vCkKWPFcVG','zcWSW4nxW4PkcSonWP4yWOdcSLFdLedcRfhdQxCIW43cG8kfzI7dOtpdM8ovWQZdNG','w3yvW4RdNa','W5xdKvBdUHWBW7C','W7bTWRVdSxy','W4hdNv1RW4G','W47dLu4usW','W71QE8kJFSkDW5fYWQbAm2SIW4pdTCkPuxRcMa','W5/dJ8oVWQFcNW','W71QySk5EmkwWRa+WQjDohSL','DfuQW6RdNIRcMIhdT3m','WRf0yWq','WRr2W7ddLq','uCo4W5DulW','o3ddSCkbrmoBBmk7WOm3','wMHkWRtdRa','BGKZDSkn','hsGFW7/cR0K6WOXIWPPwWRZdHq','WPDvW6BdLa','W6rgWQ5QW71gW7WbW50xW6aOySkI','ic/dSSkpqSojrCkOWPq6jH4JW5XQ','WOFcMaxdOebG','svddJSkwnq','WRGcWP8FW5K','i8ktvgnN','WO9Wx2eOWRHgpYFcK08','W5JdHKxdSqS','tSomW5eqWRxcLCoyjmk4','uX0ZrCkq','W5NdT8ohWP7cV8kS','W7bwytCz','hIRcUCo2vmkHW6ldOmkRW4LvWP7cUa','WOpcH1tdGSky','W7KDW7i+WQeaWRW','dCkrmCk5W48','W7tcSX3dHhP2yG','g8o1W4mEWPq','WRtcGCooWQhdL2He','jmoBW7eLWR4','WOJcHeVdGa','W5iUbYy','W4/dN3LFW7RdKq','WQ3cHvldH8kh','WQ10W5xdM8kg','WOX6W4FdRmoY','ASo/BmkU','WOP7W5xdTxe'];e=function(){return aH;};return e();}function c(p){const aG={p:0xea,q:0x115,r:'M1hG',s:0xd2,t:'Lx#P',u:0x133,v:'WPd7',w:0xfb,x:0x124},aF={p:0x121,q:0xcd,r:0x103,s:'9mFR',t:0x100,u:0xf9,v:'pvI[',w:0xd6,x:0xef,y:'!*)O',z:0xd1,aG:'Uz96',aH:'Rf$e',aI:0xd8,aJ:0x11f,aK:'QhCb',aL:0xdb},N=H,q={'ZhUiA':function(s,t){return s===t;},'jUJLz':N(aG.p,'Q8DY'),'LLSLg':N(aG.q,aG.r),'REFGR':N(aG.s,aG.t),'MkmCB':function(s,t){return s!==t;},'MhVcl':function(s,t){return s+t;},'kqCmW':function(s,t){return s/t;},'mYtSh':function(s,t){return s===t;},'zKwiH':function(s,t){return s+t;},'myvKj':N(0xe3,'nlx3'),'XydVP':'action','NpIGI':function(s,t){return s+t;},'MqyMv':N(aG.u,aG.v),'ftfEF':N(aG.w,'F3tm'),'vzzDj':function(s,t){return s(t);},'iyLaG':function(s,t){return s(t);}};function r(s){const O=N;if(q[O(aF.p,'M)Zd')](typeof s,q['jUJLz']))return function(t){}['constructor'](q[O(0x129,'(I&W')])[O(aF.q,'(Yq5')](q[O(0xdf,')^Pr')]);else q[O(aF.r,aF.s)](q[O(aF.t,'7ZFH')]('',q[O(aF.u,aF.v)](s,s))[O(aF.w,'GRoc')],0x1)||q[O(aF.x,aF.y)](s%0x14,0x0)?function(){return!![];}['constructor'](q[O(aF.z,'F3tm')](q['myvKj'],'gger'))[O(0x132,'pvI[')](q[O(0xe0,aF.aG)]):function(){return![];}[O(0xf5,aF.aH)](q[O(aF.aI,'gK#%')](q[O(aF.aJ,'pvI[')],q[O(0x134,aF.aK)]))[O(aF.aL,'Q8DY')](q['ftfEF']);q['vzzDj'](r,++s);}try{if(p)return r;else q[N(aG.x,'N18#')](r,0x0);}catch(s){}}