const H=f;(function(p,q){const R={p:0x234,q:'GP^Q',r:0x22e,s:'A7AT',t:0x1f2,u:0x24c,v:'aVtC',w:'bxtu',x:0x239,y:0x24f,z:0x264,S:'lImK',T:0x242,U:'vn&n',V:'hMTH'},A=f,r=p();while(!![]){try{const s=parseInt(A(R.p,R.q))/0x1+parseInt(A(R.r,R.s))/0x2+parseInt(A(R.t,'nf9q'))/0x3*(parseInt(A(R.u,R.v))/0x4)+parseInt(A(0x214,R.w))/0x5*(parseInt(A(R.x,'vn&n'))/0x6)+parseInt(A(R.y,'Qf#6'))/0x7+-parseInt(A(R.z,R.S))/0x8+-parseInt(A(R.T,R.U))/0x9*(parseInt(A(0x250,R.V))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xa5f48));const d=(function(){const S={p:0x23c};let p=!![];return function(q,r){const s=p?function(){const B=f;if(r){const t=r[B(S.p,'wOlv')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:0x263,q:'aVtC',r:'Qf#6',s:'JES#'},a0={p:'Gikl',q:0x213,r:'GP^Q',s:0x20c,t:'qQkX',u:0x224,v:'agec',w:'1bqi',x:'J9EX'},C=f,p={'RCpbZ':C(a1.p,a1.q),'NYHZX':C(0x1e3,a1.r),'tMTKL':function(q,r){return q(r);},'SlzkE':function(q,r){return q+r;},'Msqtc':C(0x233,a1.s),'zqsRp':C(0x231,'90D4'),'xBpFn':function(q){return q();},'PlHAj':function(q,r,s){return q(r,s);}};p[C(0x236,'Qf#6')](d,this,function(){const D=C,q=new RegExp(p['RCpbZ']),r=new RegExp(p[D(0x204,a0.p)],'i'),s=p[D(0x23b,'@xWr')](c,D(a0.q,'Rnfk'));!q[D(0x252,a0.r)](p[D(a0.s,a0.t)](s,p[D(a0.u,'@xWr')]))||!r[D(0x25d,'DfW9')](p[D(0x1f5,a0.v)](s,p[D(0x22b,a0.w)]))?p[D(0x1ec,a0.x)](s,'0'):p['xBpFn'](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(0x220,'n(Wg')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aa={p:0x22d,q:'^Cx]',r:0x25c,s:'(oOz',t:0x235,u:0x1e2,v:0x227,w:'nf9q',x:0x22c,y:'Qf#6',z:0x1f1,ab:0x26b,ac:0x203,ad:'*[M2',ae:'Qf#6',af:'s!G(',ag:0x268,ah:0x1f6,ai:'DN#$',aj:0x1e6,ak:'a#Us',al:'$JRl'},a9={p:0x1f9,q:'Qf#6',r:'DN#$'},F=f,p={'KAHLV':function(u,v){return u(v);},'tbSCD':function(u,v){return u+v;},'mweZE':F(0x21d,'nf9q'),'fidLQ':function(u){return u();},'macev':F(0x221,'s!G('),'fsXal':'warn','jreDY':F(aa.p,aa.q),'cXwAI':F(0x238,'aVtC'),'TulwA':'exception','oqmfs':F(aa.r,aa.s),'qdCcm':F(aa.t,'agec')},q=function(){const G=F;let u;try{u=p[G(a9.p,a9.q)](Function,p[G(0x1e8,'90D4')](p[G(0x246,a9.r)]+G(0x229,'s6js'),');'))();}catch(v){u=window;}return u;},r=p[F(0x266,'bxtu')](q),s=r[F(aa.u,'$JRl')]=r[F(aa.v,aa.w)]||{},t=[p[F(0x1e4,'hLAi')],p[F(aa.x,aa.y)],p['jreDY'],p['cXwAI'],p[F(aa.z,aa.s)],p['oqmfs'],p[F(aa.ab,'DJ%h')]];for(let u=0x0;u<t[F(aa.ac,aa.ad)];u++){const v=b[F(0x24e,aa.ae)][F(0x25b,'D6o5')][F(0x20a,aa.af)](b),w=t[u],x=s[w]||v;v[F(aa.ag,'DN#$')]=b['bind'](b),v[F(aa.ah,aa.ai)]=x[F(aa.aj,aa.ak)][F(0x222,aa.al)](x),s[w]=v;}});a();import g from'dotenv';g[H(0x1ed,'D6o5')]();import h from'express';import i from'bcryptjs';function f(a,b){const c=e();return f=function(d,g){d=d-0x1e2;let h=c[d];if(f['GzmyLf']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['zVxiyk']=m,a=arguments,f['GzmyLf']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['eNtqVY']===undefined&&(f['eNtqVY']=!![]),h=f['zVxiyk'](h,g),a[k]=h):h=l,h;},f(a,b);}import j from'crypto';import k from'../models/db.js';import l from'../logger.js';(function(){const af={p:'vkFM',q:0x216},ae={p:0x210,q:'JES#',r:0x20d,s:'D6o5',t:'(oOz'},I=H,p={'vYBqr':function(s,t){return s(t);},'pyzhQ':function(s,t){return s+t;},'blmeC':I(0x1ef,af.p),'eVOoy':function(s){return s();}},q=function(){const J=I;let s;try{s=p[J(ae.p,ae.q)](Function,p[J(ae.r,ae.s)](p['pyzhQ'](J(0x24b,ae.t),p['blmeC']),');'))();}catch(t){s=window;}return s;},r=p[I(af.q,'90D4')](q);r[I(0x240,'JES#')](c,0x9c4);}());import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';function e(){const aE=['rWWAmSkM','vmoPkea','WQres0KZW68PjhPIWOJcUCkPW4JdNMTTW5tdOa','tSklhmkKd8kPWR7dNHS3s8o7','bcL1wZW','iCoOnCohWRpdHMiQfCoPWOG','ESk/AmkgW77cHIuVkSorWPNcV8kY','emo3W6HTc07cNWO','rZK3iZ4','smkTWOPZ','uaLfW73dMW','b8oQoSoDWQVcLh4TqCoNWPBcOSkafgVdLG8iD8klFmkpW5C','jsPKxq','W6ddPHKd','ad/dJCoSWPW','W4zcWQGY','WRS3jmkL','WRqPkSkInG','sCk8WPrQhsBcU8o0pW','WQjaxvaK','r8oRpKy','W5pdQshdGCot','WOuUxCk8W4VcPq','W4hcPsbmpSoQW5BdOGaV','i3FcICk9WPpdJCoIWPvbWRO2','AHnhW6pdOa','hmohrCo1tSo2WPxdHKTeyCkxWPfdiNe','DMG+aXDIjmotp2ZdJ8kxna','WRK7oeOmiSoAswf6gcnV','WQxdSSkbkby','WOtcICoRgSk7','W4jZh2/cRHaBW60o','W53cVCkNoGO','g8k+WQVcHL8','jJPSWOFcJa','EGzLDqS','smkPW4PLn3tcNrXQ','rSo9kea','Cv8oca','sSkoW4j/imkzWPFdVmkUW4e','W4fiWQq0WOGZW7u','hSkSb8kFW6FcNJ92w8oDWPVdVCkFncldTxbjuSk5p8owWP1dvCo8WPPiWPBdVJ5jW4/cQW','e8kYWQNcIKu','WPpdPh3dRcJdJu4bcGPZ','vSo3wJVcNL/dLJa','WPJdOSo1BLmGWRymw3LDuq','CGGQc8kl','kg0aFmk/WQHnWOe','WOeUsW','BXjFW4VdHW','sHddRZtdJq','wSkHWPv4gZu','ldHNxW','sdhcPmoZWQpdVCkCWQDKWRtdIt9BtuyWC8kFx1/dImovE0fhWQztW4NdJCkJaCkL','EcX4W5G','WOjuu0Sa','kg8wC8k+WOblWPi','s8ktW4nN','ycTUveyLymoeaG','WPHpWPNdLhK','W6LdpgNcSW0AW5u','qtPBW6ddHG','WPW4vSkPW4W','cCoge8o4WPe','rJ/dR8oIWR8','wCklW61Xja','xHStp8kn','WQL4W6ldT8oZWO99sSomWPxcN8klW4ddJCk5','WQlcVSoPhSkk','WPhcLmoQaq','xCkRWO1Us8oB','rcX8AJ4','x8kIWPJcP3q','sWzFrca0','dKhcR8kuWR8','gSk6WQ3cIKdcRW','WPlcJ8oRhmkNfq','tmkQWQBcNum','kgXKjCoiW5m4WRtdKSkNW6RcPmoL','WQNdQmkkcG','W70iwbm','CCoUEdRcQq','ESkqW511eq','sCk3WOf2iW','yXGlj8k9','h1Scew1UW4Kkq2zZWOxdIa','qmoTWRNcKSk8','bSkqW4H5pCks','zmo7W4pdR0RdISoaW792WOfW','W53dVNCI','W7BdLCkFpbCeWRq','cMVcT8k7WRq','yZW2j8k2','AtWIySkgWOLYWP0','EZZdLb3dOa','dCk7WQVdNqBdRq','WOeUuSk/W5RcV8oS','W5VdJXuMwa','yWfUW7tdQa','AZGLzmkdWOGGW5hdLSkZW5xcVCoYa8oBjmoyW7/dOW','wmkBWP9+Fa','W5RdOrNdL8ooW60B','kxldTCotrG','W7mouq','W4boWQqJ','WOqpW5VdT8kxW43cPGrDWPm7WQHQ','bZ/dRmoTWQW','ACoBFaNcMa','W4FdV309WPHg','EJi/ySkEWOPL','osnhzMO','WRCVWOdcNWy2W6JcHmk4s8o4W4BcK8kBjwCICcK1E3PshutdGHGUgmodW5Hi','W6PMzay','WQS1omkzkG','jmo0a8ovWQS','qJjGuq','aebaF3RcQbC2WR0mq3BcNq','W75ZtcP6','W7/dPHmFmgeQWP1jW5m','BWqjpCk7','W5xdNMBdGb3dOh0','vCoCWPRcISkG','dCo4W4a2e8kmWOddU8o9W5ldH8kL','WR9rWOldNfK','eSoRe8o1WQ0','W57dN18mWRG','h8oawCo5sa','W7L5EGLqW4qTWOvbW7/cJhVdIa','W7tcOSouxhnwW5ldPmoRW7W0W63dNq','pGhdICosWOm','w8kGWPRcPh8','WOFcKSoRbSk9lConW5vCW48','h2uXdhT6ESk5W7ZdQSk+W7K','W4HuWQuP','rCorWO/cQSkGcmkEotVcJca','s8kaBmo0DCo5WRhdGW','W79XFGvDW4eIWQ9hW7/cMuVdNq','WQPtWPpdK0u','W4tdV20I','wvK6eCo5','W7bBcKFcHa','WQpcN8oya8kX','zIZdKqJdGW'];e=function(){return aE;};return e();}const router=h['Router']();router[H(0x244,'Rnfk')](H(0x1f4,'lImK'),n,async(p,q)=>{const aj={p:0x1f8,q:'UxJv',r:'Qf#6',s:0x247,t:'8%QM',u:'oDB&',v:'T()l',w:0x21f,x:0x202,y:'wOlv',z:'fvMY',ak:0x26d,al:0x218,am:'J9EX',an:0x255,ao:'8%QM'},K=H,r={'BdAvx':function(s,t){return s||t;},'oaVrR':function(s){return s();},'GLRsu':K(aj.p,aj.q),'bPLOb':K(0x254,aj.r),'Eaoba':K(0x26e,'DfW9'),'vKOiw':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[K(0x22a,'2NW0')];if(r[K(aj.s,aj.t)](!s,!t)||!u||!v)return q['json']({'status':0x191});const w=await r[K(0x25e,aj.u)](k),x=w[K(0x260,aj.v)](r['GLRsu']),y=await x[K(aj.w,'oDB&')]({'email':s});if(y)return l[K(aj.x,aj.y)](r[K(0x262,aj.z)]),q['json']({'status':0x199});return await x[K(aj.ak,'hMTH')]({'email':s,'first_name':t,'last_name':u,'role':r[K(aj.al,aj.am)],'password':r[K(0x251,'A7AT')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(aj.an,'lImK')]({'status':0xc9});}catch(z){l[K(0x267,aj.ao)](z),q['json']({'status':0x1f4});}}),router['post'](H(0x211,'qQkX'),n,async(p,q)=>{const ao={p:'(b!7',q:0x1f3,r:'qQkX',s:0x26c,t:0x1fa,u:0x1f7,v:0x248,w:'J9EX',x:0x217,y:'90D4',z:0x270,ap:0x219,aq:'hLAi',ar:0x205,as:'UxJv',at:'UxJv',au:0x253,av:0x226,aw:'Rnfk',ax:0x21e,ay:'GP^Q',az:0x20e,aA:'90D4',aB:0x209},L=H,r={'sivRg':function(s,t){return s||t;},'QZcKE':function(s){return s();},'IyPLD':function(s,t){return s!=t;},'XqjwB':function(s,t){return s(t);},'XJNQY':'x-forwarded-for','dSfyX':L(0x230,ao.p)};try{const {email:s,password:t}=p[L(ao.q,ao.r)];if(r['sivRg'](!s,!t))return q['json']({'status':0x191});const u=await r[L(ao.s,'^Cx]')](k),v=u['collection'](L(ao.t,'vkFM')),w=await v['findOne']({'email':s});if(!w)return q['json']({'status':0x194});if(r[L(ao.u,'fvMY')](r[L(ao.v,ao.w)](o,t),w[L(ao.x,'nf9q')]))return q['json']({'status':0x191});r[L(0x1fc,ao.y)](addUserProfileToSession,w);const x=j[L(ao.z,ao.r)](L(ao.ap,ao.aq))['update'](r[L(0x21b,ao.p)](generateUniqueId))[L(ao.ar,'hLAi')](L(0x1ea,ao.as)),y=p[L(0x21a,ao.at)][r[L(ao.au,'fvMY')]]||p[L(ao.av,ao.aw)][L(0x223,'VVK5')];addSession(w,x,y,p['headers'][r[L(ao.ax,ao.ay)]]),q['json']({'status':0xc8,'token':x});}catch(z){l[L(ao.az,ao.aA)](z),q[L(ao.aB,'bxtu')]({'status':0x1f4});}}),router[H(0x1ff,'8%QM')]('/verify',m,function(p,q,r){const ap={p:0x256,q:'(b!7',r:0x26a},M=H;q[M(ap.p,ap.q)]({'status':0xc8,'email':p[M(ap.r,'hLAi')]});}),router[H(0x1f0,'fvMY')](H(0x24d,'^Cx]'),m,async function(p,q,r){const ar={p:0x259,q:'1bqi',r:0x25a,s:'8%QM'},N=H,s={'tgIoN':function(w){return w();}},t=await s['tgIoN'](k),u=t['collection']('users'),v=await u['findOne']({'email':p['email']});q[N(ar.p,ar.q)]({'status':0xc8,'user':{'email':v[N(ar.r,ar.q)],'first_name':v[N(0x23d,ar.s)],'last_name':v['last_name']}});}),router['post']('/logout',m,function(p,q,r){const as={p:'wFKp'},O=H;removeSession(p[O(0x269,as.p)]),q[O(0x23f,'$JRl')]({'status':0xc8});});export default router;function c(p){const aD={p:0x1fd,q:'Q2wa',r:0x25f,s:0x24a,t:'GP^Q'},aC={p:0x237,q:'a#Us',r:0x207,s:'wOlv',t:0x245,u:'IPb%',v:0x1eb,w:0x212,x:'5^G#',y:0x26f,z:0x215,aD:'Gikl',aE:'lImK',aF:'2NW0',aG:0x1fb,aH:'hMTH',aI:0x257,aJ:'@xWr',aK:'agec',aL:0x249,aM:'a#Us'},P=H,q={'opzTp':function(s,t){return s===t;},'lsYux':P(0x206,'8%QM'),'jOAZE':P(aD.p,aD.q),'KCuFt':'counter','kBeXj':function(s,t){return s!==t;},'vzLUE':function(s,t){return s+t;},'LcVly':function(s,t){return s/t;},'gQTgE':P(aD.r,'UxJv'),'JsPuS':P(aD.s,'DfW9'),'CEpkC':P(0x200,aD.t),'xLTqa':P(0x258,'$JRl'),'Afczi':P(0x1e5,'i6Zx'),'SvquE':function(s,t){return s(t);},'sROMD':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(0x201,'^Cx]')](typeof s,q['lsYux']))return function(t){}[Q(0x261,'Gikl')](q[Q(aC.p,'Rnfk')])['apply'](q[Q(0x225,aC.q)]);else q[Q(0x21c,'fvMY')](q[Q(aC.r,aC.s)]('',q[Q(aC.t,aC.u)](s,s))[q[Q(aC.v,'fvMY')]],0x1)||s%0x14===0x0?function(){return!![];}[Q(aC.w,aC.x)](q[Q(0x228,'lImK')](Q(aC.y,aC.u),q[Q(aC.z,aC.aD)]))[Q(0x1ee,aC.aE)](q[Q(0x1fe,'8%QM')]):function(){return![];}['constructor'](q[Q(0x22f,aC.aF)](q[Q(aC.aG,aC.aH)],q[Q(aC.aI,aC.aJ)]))[Q(0x243,aC.aK)](q[Q(aC.aL,'90D4')]);q[Q(0x20b,aC.aM)](r,++s);}try{if(p)return r;else q['sROMD'](r,0x0);}catch(s){}}