import{j as e,r as s}from"./kqbr3HuW.js";import{F as r,d as a}from"./BNSBxhWN.js";import{a as i,V as t,c as l}from"./CRRLWr4S.js";import{E as n}from"./URk2IvX2.js";import{P as d}from"./CgN-7aKy.js";import{a2 as c,e as o,f as u,a3 as m,N as h,O as j,t as x,o as p,p as y,q as g,r as b,a9 as v,ad as q,ae as f,af as R,ag as N,ah as S,ai as _,C as w,aj as A,ak as K,al as C,am as O,an as T}from"./DJLAdtNU.js";import{p as P}from"./B51y9YVM.js";import{i as F}from"./B8H-rvok.js";import{d as L}from"./DFarnK1O.js";import"./BgRKNlhe.js";import"./uhX4GmSj.js";import"./BJ13bZ6b.js";import"./c0eKk1Db.js";import"./oXqQd4Ap.js";import"./CQYGjB7w.js";import"./DbzcfNKS.js";import"./BGKE3O6B.js";import"./DJeUPDeV.js";import"./B0UoamS-.js";import"./HSznFPq-.js";import"./omosduih.js";import"./D3yCfJ5s.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CJ2-25UQ.js";import"./BqHrj3jM.js";const k=()=>e.jsx(e.Fragment,{children:"This will list down all user & admin activities"}),D=()=>e.jsx(e.Fragment,{children:"This will list down all api auth token created by user, there last accessed and its allowed ip addresses."}),I=({color:s,title:r,value:a,data:i})=>e.jsx(c,{color:s,value:a,title:r,action:e.jsx(o,{alignment:"end",children:e.jsx(u,{color:"transparent",caret:!1,className:"text-white p-0"})}),chart:e.jsx(m,{className:"mt-3",style:{height:"70px"},data:{labels:Array(10).fill(""),datasets:[{label:"Data",backgroundColor:"rgba(255,255,255,.2)",borderColor:"rgba(255,255,255,.55)",data:i,fill:!0}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!1}},elements:{line:{borderWidth:2,tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4}},animation:{duration:0}}})});I.propTypes={color:d.string.isRequired,title:d.string.isRequired,value:d.any.isRequired,data:d.any.isRequired};const Q=()=>{const[r,a]=s.useState(null),[d,c]=s.useState(!1),{addToast:o}=i(),[u,m]=s.useState(Array(10).fill(0)),[x,p]=s.useState(0),[y,g]=s.useState(Array(10).fill(0)),[b,v]=s.useState(0),q=(e,s,r,a)=>{const i=r/(4*(Date.now()-a))*100;g((e=>{const s=[...e,i];return s.length>10&&s.shift(),s}));const t=y.reduce(((e,s)=>e+s),0);v(t)},f=async()=>{c(!0),await axios.get(`${t}/metrics/v1/prometheus`,{headers:{Authorization:`Bearer ${cookies.get(l)}`}}).then((e=>{const s=e.data;a(s),((e,s,r,a)=>{q(e,s,r,a);const i=s/(Date.now()-a);m((e=>{const s=[...e,i];return s.length>10&&s.shift(),s}));const t=u.reduce(((e,s)=>e+s),0);p(t)})(s.process_cpu_user_seconds_total[0].value,s.process_cpu_system_seconds_total[0].value,s.process_cpu_seconds_total[0].value,s.process_start_time_seconds[0].value)})).catch((e=>{if(401==e.status)return window.location.reload();console.error(e);const s=n[e.status]||"Internal Application Error";o(s,"Submit failed!")})).finally((()=>c(!1)))};return s.useEffect((()=>{f();const e=setInterval((()=>{f()}),1500);return()=>clearInterval(e)}),[]),e.jsxs(e.Fragment,{children:[r&&e.jsxs(h,{xs:{gutter:4},children:[e.jsx(j,{sm:6,xl:4,xxl:3,children:e.jsx(I,{color:"primary",title:"Average Load Time",value:x,data:u})}),e.jsx(j,{sm:6,xl:4,xxl:3,children:e.jsx(I,{color:"danger",title:"CPU Usage",value:`${b}%`,data:y})})]}),JSON.stringify(r,null,4)]})},U=({query:s,setQuery:i,state:t,setState:l,priority:n,setPriority:d,order:c,setOrder:o,result:u})=>e.jsxs(e.Fragment,{children:[0===u.scm.length&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(x,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})}),0!==u.scm.length&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(y,{className:"mb-3",children:[e.jsx(g,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:s,onChange:e=>i(e.target.value)}),e.jsx(b,{id:"basic-addon",children:e.jsx(r,{icon:a})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:t,onChange:e=>l(e.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:n,onChange:e=>d(e.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:c,onChange:e=>o(e.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(q,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(R,{children:[e.jsx(N,{children:"#"}),e.jsx(N,{children:"State"}),e.jsx(N,{children:"Scope"}),e.jsx(N,{children:"Manifest"}),e.jsx(N,{children:"CVE"}),e.jsx(N,{children:"Summary"}),e.jsx(N,{children:"Severity"}),e.jsx(N,{children:"Last Updated"})]})}),e.jsx(S,{children:u.scm.map((s=>e.jsxs(R,{children:[e.jsx(_,{children:s.number}),e.jsx(_,{children:s.state}),e.jsx(_,{children:s.scope}),e.jsx(_,{children:s.manifest}),e.jsx(_,{children:s.cve}),e.jsx(_,{children:s.summary}),e.jsx(_,{children:s.severity}),e.jsx(_,{children:P(new Date(s.updated_at).getTime())})]},s.number)))})]})]})]});U.propTypes={query:d.string.isRequired,setQuery:d.func.isRequired,state:d.string.isRequired,setState:d.func.isRequired,priority:d.string.isRequired,setPriority:d.func.isRequired,order:d.string.isRequired,setOrder:d.func.isRequired,result:d.shape({scm:d.arrayOf(d.shape({number:d.number.isRequired,state:d.string.isRequired,scope:d.string.isRequired,manifest:d.string.isRequired,cve:d.string.isRequired,summary:d.string.isRequired,severity:d.string.isRequired,updated_at:d.string.isRequired})).isRequired}).isRequired};const E=()=>e.jsx(e.Fragment,{children:"This will setup maintenance status to the system denying user access temporarily."}),$=({query:s,setQuery:i,state:t,setState:l,priority:n,setPriority:d,order:c,setOrder:o,result:u})=>e.jsxs(e.Fragment,{children:[0===u.sentry.length&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(x,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any issues."}),e.jsx("p",{children:"Should we add one? :)"})]})}),0!==u.sentry.length&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(y,{className:"mb-3",children:[e.jsx(g,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:s,onChange:e=>i(e.target.value)}),e.jsx(b,{id:"basic-addon",children:e.jsx(r,{icon:a})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:t,onChange:e=>l(e.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:n,onChange:e=>d(e.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(v,{value:c,onChange:e=>o(e.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(q,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(R,{children:[e.jsx(N,{children:"#"}),e.jsx(N,{children:"Title"}),e.jsx(N,{children:"Culprit"}),e.jsx(N,{children:"Level"}),e.jsx(N,{children:"Status"}),e.jsx(N,{children:"Priority"}),e.jsx(N,{children:"Count"}),e.jsx(N,{children:"Last Updated"})]})}),e.jsx(S,{children:u.sentry.map((s=>e.jsxs(R,{children:[e.jsx(_,{children:s.id}),e.jsx(_,{children:s.title}),e.jsx(_,{children:s.culprit}),e.jsx(_,{children:s.level}),e.jsx(_,{children:s.status}),e.jsx(_,{children:s.priority}),e.jsx(_,{children:s.count}),e.jsx(_,{children:P(new Date(s.updated_at).getTime())})]},s.id)))})]})]})]});$.propTypes={query:d.string.isRequired,setQuery:d.func.isRequired,state:d.string.isRequired,setState:d.func.isRequired,priority:d.string.isRequired,setPriority:d.func.isRequired,order:d.string.isRequired,setOrder:d.func.isRequired,result:d.shape({sentry:d.arrayOf(d.shape({id:d.string.isRequired,title:d.string.isRequired,culprit:d.string.isRequired,level:d.string.isRequired,status:d.string.isRequired,priority:d.string.isRequired,count:d.string.isRequired,updated_at:d.string.isRequired})).isRequired}).isRequired};const M=({result:s})=>e.jsx(e.Fragment,{children:e.jsxs(q,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(R,{children:[e.jsx(N,{children:"#"}),F&&e.jsx(N,{children:"User"}),e.jsx(N,{children:"Location"}),e.jsx(N,{children:"Device"}),e.jsx(N,{children:"Status"}),e.jsx(N,{children:"Last Accessed"})]})}),e.jsx(S,{children:s.sessions.map(((s,r)=>e.jsxs(R,{children:[e.jsx(_,{children:r+1}),F&&e.jsx(_,{children:s.user_id}),e.jsx(_,{children:s.ip_address}),e.jsx(_,{children:s.user_agent}),e.jsx(_,{children:s.active?"Active":"Inactive"}),e.jsx(_,{children:P(s.last_accessed)})]},r)))})]})});M.propTypes={result:d.shape({browser:d.string,os:d.string,sessions:d.arrayOf(d.shape({_id:d.string.isRequired,user_id:d.string,ip_address:d.string.isRequired,user_agent:d.string.isRequired,active:d.bool.isRequired,last_accessed:d.number.isRequired})).isRequired}).isRequired};const H=()=>{const{addToast:r}=i(),[a,d]=s.useState(!0),[c,o]=s.useState("2"),[u,m]=s.useState("1"),[h,j]=s.useState("1"),[x,p]=s.useState(""),[y,g]=s.useState({scm:[],sessions:[],sentry:[],apiTokens:{}});L();return s.useEffect((()=>{(async()=>{await axios.get(`${t}/api/v1/sec/management/`,{headers:{Authorization:`Bearer ${cookies.get(l)}`}}).then((e=>g(e.data))).catch((e=>{console.error(e);const s=n[e.status]||"Internal Application Error";r(s,"Fetch failed!")})).finally((()=>d(!1)))})()}),[]),e.jsxs("div",{children:[a&&e.jsx("div",{className:"loading-overlay",children:e.jsx(w,{color:"primary",variant:"grow"})}),e.jsxs(A,{activeItemKey:0,className:"mb-4",children:[e.jsxs(K,{variant:"underline-border",children:[e.jsx(C,{"aria-controls":"dashboard-tab-pane",itemKey:0,children:"Dashboard"}),e.jsx(C,{"aria-controls":"sessions-tab-pane",itemKey:1,children:"Sessions"}),e.jsx(C,{"aria-controls":"dependabot-tab-pane",itemKey:2,children:"Dependabot"}),e.jsx(C,{"aria-controls":"sentry-tab-pane",itemKey:3,children:"Sentry"}),e.jsx(C,{"aria-controls":"api-tab-pane",itemKey:4,children:"API Key"}),e.jsx(C,{"aria-controls":"activity-tab-pane",itemKey:5,children:"Activity"}),e.jsx(C,{"aria-controls":"maintenance-tab-pane",itemKey:6,children:"Maintenance"})]}),e.jsxs(O,{children:[e.jsx(T,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:e.jsx(Q,{})}),e.jsx(T,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:e.jsx(M,{result:y})}),e.jsx(T,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:e.jsx(U,{query:x,setQuery:p,state:c,setState:o,priority:u,setPriority:m,order:h,setOrder:j,result:y})}),e.jsx(T,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:e.jsx($,{query:x,setQuery:p,state:c,setState:o,priority:u,setPriority:m,order:h,setOrder:j,result:y})}),e.jsx(T,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:4,children:e.jsx(D,{setLoading:d,result:y})}),e.jsx(T,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:5,children:e.jsx(k,{setLoading:d,result:y})}),e.jsx(T,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:6,children:e.jsx(E,{setLoading:d,result:y})})]})]})]})};export{H as default};
