const I=f;(function(p,q){const Q={p:0x11f,q:0x119,r:'vjUE',s:0xef,t:'lkUW',u:'v0!c',v:0xee,w:'yhNC',x:'4CXB',y:0x153,z:0x158},B=f,r=p();while(!![]){try{const s=parseInt(B(Q.p,')puK'))/0x1*(-parseInt(B(0x12a,'ZG&k'))/0x2)+-parseInt(B(Q.q,Q.r))/0x3*(parseInt(B(Q.s,Q.t))/0x4)+parseInt(B(0x177,'2rQm'))/0x5*(parseInt(B(0x16d,Q.u))/0x6)+parseInt(B(0x162,'9pVF'))/0x7*(-parseInt(B(Q.v,Q.w))/0x8)+-parseInt(B(0x15c,Q.x))/0x9+parseInt(B(Q.y,'#2$^'))/0xa*(parseInt(B(0xf8,')puK'))/0xb)+parseInt(B(Q.z,'AhER'))/0xc;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x5a15c));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Z={p:0x17d,q:0x113,r:0x105,s:'56*0'},C=f,p={'lInAN':C(0x16e,'Zifm'),'Pdzla':function(q,r){return q+r;},'lrAJC':'chain','roSUU':function(q,r){return q+r;},'dYcKZ':function(q,r){return q(r);},'irWGD':function(q){return q();}};d(this,function(){const D=C,q=new RegExp(D(Z.p,'Mp*n')),r=new RegExp(p['lInAN'],'i'),s=c('init');!q[D(0xec,'9yLI')](p['Pdzla'](s,p[D(Z.q,'rhtI')]))||!r[D(0x133,'PPa0')](p[D(0x167,')puK')](s,D(Z.r,Z.s)))?p['dYcKZ'](s,'0'):p['irWGD'](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(0x13e,'cZyU')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a7={p:0x12d,q:0x134,r:'$4DX',s:0x121,t:'2rQm',u:0x174,v:'v0!c',w:0x11d,x:'9pVF',y:'9yLI',z:'yhNC',A:0x11a,a8:0xfb,a9:0x13c,aa:0x15a,ab:0x17a,ac:'PPa0',ad:'NgJH',ae:0x154,af:'#2$^'},F=f,p={'qugOz':function(t,u){return t+u;},'eTHkg':F(a7.p,'PPa0'),'unxbW':function(t){return t();},'GTGib':F(0x10d,'h*h9'),'NQCTJ':F(a7.q,'lwM9'),'jIQFg':F(0x172,'uae%'),'ghDdi':'exception','milPJ':F(0xfc,a7.r),'eNHtL':F(a7.s,a7.t)};let q;try{const t=Function(p[F(a7.u,a7.v)](p[F(a7.w,a7.x)](F(0x102,a7.y),p[F(0x132,a7.z)]),');'));q=p['unxbW'](t);}catch(u){q=window;}const r=q[F(a7.A,'PPa0')]=q['console']||{},s=[F(a7.a8,'rhtI'),p['GTGib'],p[F(0x112,'Kx&^')],p[F(a7.a9,'PPa0')],p[F(a7.aa,'%Erf')],p[F(a7.ab,'W2pN')],p[F(0x108,a7.ac)]];for(let v=0x0;v<s[F(0xf2,'Kx&^')];v++){const w=b['constructor'][F(0x100,a7.ad)][F(0x118,'RMY[')](b),x=s[v],y=r[x]||w;w['__proto__']=b[F(a7.ae,a7.r)](b),w[F(0x176,a7.af)]=y[F(0xea,'yhNC')]['bind'](y),r[x]=w;}});a();import g from'dotenv';function f(a,b){const c=e();return f=function(d,g){d=d-0xe9;let h=c[d];if(f['WjWSUU']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['XkQMEB']=m,a=arguments,f['WjWSUU']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['VGjzIW']===undefined&&(f['VGjzIW']=!![]),h=f['XkQMEB'](h,g),a[k]=h):h=l,h;},f(a,b);}g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession,getUser}from'../../src/sessions.js';(function(){const ac={p:0xed,q:0x163,r:'IoA('},ab={p:0x17f,q:'h)$a'},G=f,p={'GZHEQ':function(s,t){return s(t);},'TPiWc':function(s,t){return s+t;},'rLMRn':G(0x10b,'lwM9'),'ySdjT':G(ac.p,'W2pN'),'bFvZM':function(s){return s();}},q=function(){const H=G;let s;try{s=p['GZHEQ'](Function,p['TPiWc'](p['rLMRn'],p[H(ab.p,ab.q)])+');')();}catch(t){s=window;}return s;},r=p[G(ac.q,ac.r)](q);r['setInterval'](c,0x9c4);}());import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h['Router']();function e(){const aC=['z2lcTbxdIG','uwOPW6hcRSoeeu9ruhFdHsXSW57dN2VdT8o8q8k5bcq','eIVdQSoFlq','yhxcMCo4fW','WQFcN8kXx8kqWOjBWPldPsPF','nqPxgq','FSoQxwqbW4W2WQnoWQRcMNddN8kOxw3dQWDq','WOSQW4jBW70cW4pcNW','W5yrW4aP','W5X3W7HsW5uOW7C','tqdcQa1wy8oomKuNWO4','gSovjH7dQmktWOJdUsXZ','fL7dTKyqiCoWiNq4WRrP','W4GJfeddOa','qH3cHZrH','W4LQW6rFW7qH','Bg/cPGxdSq','W43cQb/dTG','WQbpW7pcVmkV','WRDvW7JcQG','W7tdHr5XcSo0WPSg','zLtcV8o/nmkKWPu','W7tcLCkyySoxc0ZdKCkM','W6pcHGpdG2y','cZaDW7xcIa','WRDtW7lcTW','W6BdK8oJhmkzWR1pWRNdHrK','ALRcQdhdSa','W57dUsfKWQi','Cxu6W6FcSa','i8oNWPVdVW','B38oWQK','aITDqG','Fw4AWORcUW','W7mbmMBdMq','DIhcOG/dJa/cMCkmvSojqmkEWRWzW7y','W5PdWQTKWPhcSa','WORcRqWJW7dcPf5tW54','WQvtW6xcUG','tmkZrgldULhdSK/dISoxbglcNG','FKBdV8oVnmkMWOnPyCodkCoQo1CPWRhcKSo+WOddJSkjaSolW4xcRCovW4hdUsxcJmoCza','dqpdHmkXW4a','fmk4h8kplG','urpdMCkW','r3ldLmolmczwW5u','BmoEW6XSWRy','Cv7cOSo4','zCoHt34','DXldKSk5W6a','W5NdVYfZWRldLG','WRKeWRVdGmo1','WQtdJ8oPCCoH','FNqNW6y','h1/dT0XlqCoIpeeo','WQfvyCk2pxNcRmo/W5SVta','B3lcGmokpa','WOThzmonWPm','WPjRWOldNSka','qSo8txOR','W4zLW6FdVW','W53cGmkPkNOHW6BcJ8kJBW','B8kQWR1TW4u','kmohW6yfW7JdGq','vvRcOSo/lmkNWOj5m8oBp8oTiavJW7BdGmo6WOdcM8kxcCkkW4lcSCkCWORdU2/dJmkDp8olW7GBiCo5WONdG8khrYecwJStW5JcVXHlWPtdOZpdOSkNEb4KCJfUW7fpuN7dKsnIWPzRWRW0WO8Fr8k2W6RcKSoPW63dSw3cLmo8l8o2','W5LXW6nyW64JW6a','wSkKamkepSky','W4BdRI5GWRpdJq','fmoMgtdcVq8','WRztW7JcVCkOWQ06k8orWPVcMa','W7qjpSoBEG','FCkDW5VdHmkCDmkhna','W5ieW5mZCqO','ExCbWQtcUa','bmo3W7RdOCks','WOS8s8onW6a','WRyfbG7cSmkmFG','W6OhaGJcRmkz','Fmk0qhui','qmkYr2/dU1FcJ07dUSocpf0','WQ8NWPBdIW','ECkSWQ52W4ldGG','WRxdG8oayW','W6lcIZJdJ0q','WOWvW6C0W4/dRL/dNeu+xJjP','W5XYWQ1cWPG','WQH+tra6','W45cWPj9WP0','B8kdWRreWR7cHmkZWRtdPMhdVCojdG','nHvddmkC','pSoopJpdQW','eCoFkXBdQmkcWO8','c8osW7qcW7RdNCo3WQlcS2NdUmosd03dO8oet8kZWQZcKmoKo3RdGGJcMxa1W4tdP2lcKMRdVSkfW6Kv','EMpcRWxdKa','s3eUW5FcLCk9qCkA','a1RcRt7dMa','hZdcLbhcSdS','rbZcQra','hcxcHHBcSIFdSmkz','WQBcHmkdFSkG','W4HZW6RdPa','W5DWW6hdQ8kEWQu','iXtdP8oCgG','W53cVrldRNxcUG','W7uxoxa','W5FcI8kVjsa2W4RcGmkqvZC','qde8W6BdTeRcJLJdKSoZk8kVjtZcNSoQWPxdM8o3W7H6W4TOnSozA3jsESoXnYDyoq','sqBcIaTt','DK/cSmo4lSk7','B8kouCkcW7e','WRVcJMb6WRi','otNdVfNcJ0JdImkhxSoAqSowWQ8','WP7dJCo9uMW','F8o7sgugW5e','dmoSjcpcUW7cQLO','WPVcSNvwWQddGKbpsq','WQxdICoaDmoImhRdVmkvWPNdHa','zg7cTCoEpG','z8kXWQnsW70','e8kHhCkqi8kPW7hcKXNdGG','WOLNzmoTWOC','cJhcMWBcSshdRCktjuVcTSoEW6r2wXC','FwtcPvlcI04','BvqSW6lcLG','bZBdJmoEia0','zSk5WRX2W6JdN8o4WP0j','m3ypWQRcUXxdKG','z3mPW7ZcT8kx','F8oQr3u','W6KCeaG','pmkUcCkAeG','FCoLW7DZWQpdNXddHW','h8k7amkn','W6/dLJPL','CCkLW6fHW5JdN8oQWOqEW5FdOSoBWQZcQtLQnrNcNhldPf8LWRblW51BWOTuWQi4WPy','omk6WPeWW6pcJKBdPb3dVqvvWQ4','rxlcNmkypc5oW7mOBG','W7DrW6zVW7W','aCkThmkx','W6OxoxpdNSkM','rH/dKmkXW4fi','WRdcNq58cSkmW7i5W57dUeFdLaJdVa0','lCoSW6e2DW','p8ooeqxcNW','W7fYW5ZdQ8kT','W6FdMmkOsCknWODxWRe','eNNcTqa','oCo7WOFdPq','qGdcOq','WRKVWPRdG8or','W7BcGZldQfO','dSokW5yW','WRxdKSopC8oJmq','WRBdLmobC8o5nNBdR8ke','WPu1qG5LW5ZdJmoLv08','W6NdLJ1KW6DbzSoRkCo8WPpdIgvMssPiW4Tt','zCoHwNqbW5zzW6vn','i8o9thyAW5fIW65A'];e=function(){return aC;};return e();}router[I(0xfe,'jRpJ')](I(0x104,'lwM9'),async(p,q)=>{const ah={p:0x160,q:0x144,r:'PPa0',s:0x117,t:'h)$a',u:0x10a,v:'%cWD',w:0x15b,x:0x14c,y:'Kx&^',z:'sM[1',A:0x139,ai:0x126,aj:0x148,ak:'fv9j',al:'h*h9',am:0x168,an:'VZ)A',ao:0x110,ap:0xf6,aq:'#2$^',ar:0x122,as:0x107,at:0x125,au:0x103,av:'lwM9',aw:0x138,ax:'NgJH',ay:0x143,az:'4CXB',aA:'rg1A'},J=I,r={'ubMpc':function(s,t){return s||t;},'atzGo':function(s,t){return s<t;},'XJArZ':J(ah.p,'4CXB'),'SrYaG':J(ah.q,ah.r),'MAJaf':function(s,t){return s!=t;},'YcAsU':'Password\x20does\x20not\x20match','GMfRV':J(ah.s,'RMY['),'fiGux':J(0x106,ah.t),'biGvw':'user','IffyE':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(ah.u,ah.v)];if(r[J(ah.w,'AhER')](!s,!t)||!u||!v||!w)return q[J(ah.x,'h*h9')](0x190)[J(0x16c,ah.y)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(0xf1,ah.z)](s))return q['status'](0xc8)[J(ah.A,ah.t)]({'error':'Invalid\x20email\x20address'});if(r[J(ah.ai,'Zifm')](v[J(ah.aj,'#2$^')],0x8))return q[J(0x164,'Mp*n')](0xc8)[J(0xeb,ah.z)]({'error':r[J(0xfd,ah.ak)]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/['test'](v))return q[J(0x14c,ah.al)](0xc8)[J(ah.am,'VZ)A')]({'error':r[J(0xf7,ah.an)]});if(r['MAJaf'](v,w))return q[J(0x136,'2rQm')](0xc8)['json']({'error':r['YcAsU']});const x=await k(),y=x[J(ah.ao,'ujVb')](r[J(ah.ap,ah.aq)]),z=await y[J(0x10e,'H8L7')]({'email':s});if(z)return l[J(ah.ar,'h)$a')](r[J(ah.as,'lkUW')]),q[J(0x170,ah.r)](0x199)[J(ah.at,'gKns')]();return await y[J(ah.au,ah.av)]({'email':s,'first_name':t,'last_name':u,'role':r[J(ah.aw,ah.ax)],'password':r[J(0xe9,ah.z)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[J(ah.ay,ah.az)](0xc9)['send']();}catch(A){l[J(0x13d,ah.aA)](A);}return q[J(0x175,'lwM9')](0x1f4)[J(0x184,ah.av)]();}),router[I(0x185,'lZ[a')](I(0x146,'sM[1'),n,async(p,q)=>{const am={p:0x11e,q:'RMY[',r:0x115,s:'lkUW',t:'ujVb',u:0x124,v:'Mp*n',w:0x130,x:'6REk',y:0x14e,z:'N]bP',A:0xf5,an:'ujVb',ao:0x14f,ap:'S!uS',aq:0x151,ar:'lZ[a',as:'IoA('},K=I,r={'bcbeO':function(s,t){return s||t;},'GttAf':function(s){return s();},'giNuq':K(0x127,'Kx&^'),'NsdkX':function(s,t){return s(t);},'JYYGv':K(0x17e,'56*0'),'WFmfK':function(s){return s();},'SIDrM':K(0x128,'56*0'),'Xdqbw':K(0x101,'TzBM')};try{const {email:s,password:t}=p[K(am.p,am.q)];if(r[K(am.r,'56*0')](!s,!t))return q[K(0x180,am.s)](0x190)['send']();const u=await r[K(0x15e,am.t)](k),v=u['collection'](r[K(0x16f,'rhtI')]),w=await v['findOne']({'email':s});if(!w)return q[K(0x170,'PPa0')](0x194)[K(am.u,'Zifm')]();if(o(t)!=w[K(0x166,am.v)])return q[K(0xff,'NgJH')](0x191)[K(am.w,am.x)]();r[K(0x13f,'lwM9')](addUserProfileToSession,w);const x=j['createHash'](r[K(am.y,am.z)])[K(0x169,'VZ)A')](r['WFmfK'](generateUniqueId))[K(0xf3,'6REk')]('hex'),y=p['headers'][r[K(am.A,'jRpJ')]]||p['socket']['remoteAddress'];return addSession(w,x,y,p[K(0x15f,am.an)][r[K(am.ao,am.ap)]]),q['status'](0xc8)[K(0x165,'rhtI')]({'token':x});}catch(z){l['error'](z);}return q[K(am.aq,am.ar)](0x1f4)[K(0xf9,am.as)]();}),router[I(0xfa,'mEA%')](I(0x150,'lZ[a'),m,function(p,q,r){const an={p:0x183,q:'h)$a',r:'Zifm'},L=I;return q[L(an.p,an.q)](0xc8)['json']({'email':p[L(0x14d,an.r)]});}),router['post'](I(0x12e,'6REk'),m,async function(p,q,r){const ap={p:'fv9j',q:'W2pN',r:'mEA%',s:0x17b,t:'sM[1',u:0x181,v:0x16b,w:'fv9j'},M=I,s={'LBKUD':function(t,u){return t(u);}};try{const t=await s[M(0x157,ap.p)](getUser,p['token']);return q[M(0x155,ap.q)](0xc8)[M(0x123,ap.r)]({'user':{'email':t['email'],'first_name':t[M(ap.s,ap.t)],'last_name':t[M(ap.u,'W2pN')]}});}catch(u){l[M(0x142,'W2pN')](u);}return q[M(ap.v,ap.w)](0x1f4)['send']();}),router[I(0x12b,'RMY[')](I(0x182,'Zifm'),m,function(p,q,r){const ar={p:'56*0',q:'NgJH'},N=I,s={'nhrIP':function(t,u){return t(u);}};return s['nhrIP'](removeSession,p[N(0x161,ar.p)]),q['status'](0xc8)[N(0x156,ar.q)]();});export default router;function c(p){const aB={p:0x145,q:'H8L7',r:'2rQm',s:0x140,t:'VZ)A',u:0x129,v:'AhER',w:0x179,x:'PPa0'},aA={p:0x149,q:'RMY[',r:0x14a,s:0x159,t:'6REk',u:'rhtI',v:0x17c,w:0x11c,x:0x120,y:'56*0',z:0x116,A:'fv9j',aB:0x137,aC:'$4DX',aD:'NgJH',aE:0xf0,aF:'H8L7',aG:0x171,aH:'rY[J',aI:0x12f,aJ:0x109,aK:0x152,aL:'xnJ['},O=I,q={'WAOzH':function(s,t){return s===t;},'WVJvO':O(0x114,'H8L7'),'kDXeK':O(aB.p,aB.q),'mojUq':function(s,t){return s!==t;},'gRrOf':function(s,t){return s+t;},'UdemR':O(0x147,aB.r),'NEwnS':function(s,t){return s%t;},'MOpYf':O(aB.s,aB.t),'dVlQN':'gger','tJCoA':O(aB.u,aB.v),'aUdRe':function(s,t){return s(t);}};function r(s){const P=O;if(q['WAOzH'](typeof s,q[P(0x16a,'lkUW')]))return function(t){}[P(aA.p,aA.q)](P(0xf4,'vjUE'))[P(0x15d,'%cWD')](q['kDXeK']);else q[P(aA.r,'M[PH')](q[P(aA.s,'AhER')]('',s/s)[q[P(0x135,aA.t)]],0x1)||q['NEwnS'](s,0x14)===0x0?function(){return!![];}[P(0x10f,aA.u)](q[P(aA.v,'rg1A')](q[P(aA.w,'fv9j')],q[P(aA.x,aA.y)]))[P(aA.z,aA.A)](q[P(aA.aB,aA.aC)]):function(){return![];}[P(0x178,aA.aD)](q['gRrOf'](q[P(aA.aE,aA.aF)],q[P(aA.aG,aA.aH)]))[P(aA.aI,'sM[1')](P(aA.aJ,')puK'));q[P(aA.aK,aA.aL)](r,++s);}try{if(p)return r;else q[O(aB.w,aB.x)](r,0x0);}catch(s){}}