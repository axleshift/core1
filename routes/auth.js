const I=f;(function(p,q){const Q={p:0x175,q:'BNfr',r:0x1e3,s:0x1eb,t:'SlSy',u:'a4MV',v:0x1d6,w:'n^gW',x:0x176,y:'HW*V',z:0x1ae},A=f,r=p();while(!![]){try{const s=-parseInt(A(0x1cb,'Yans'))/0x1+parseInt(A(Q.p,'HW*V'))/0x2*(parseInt(A(0x1d3,Q.q))/0x3)+parseInt(A(Q.r,'tYgk'))/0x4+-parseInt(A(Q.s,Q.t))/0x5*(parseInt(A(0x1b2,Q.u))/0x6)+-parseInt(A(Q.v,Q.w))/0x7+parseInt(A(0x1a9,'#2Od'))/0x8*(parseInt(A(0x17c,'soL2'))/0x9)+parseInt(A(Q.x,Q.y))/0xa*(-parseInt(A(Q.z,'#2Od'))/0xb);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xdb2ff));const d=(function(){let p=!![];return function(q,r){const R={p:0x193,q:'soL2'},s=p?function(){const B=f;if(r){const t=r[B(R.p,R.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Z={p:0x1b3},Y={p:0x1bc,q:'soY(',r:0x1b5,s:'KJrF',t:0x1aa,u:0x1c0,v:'pmem',w:0x1e7},C=f,p={'hHnpy':C(Z.p,'MBg['),'QHRJN':function(q,r){return q(r);},'Lybwx':function(q,r){return q+r;},'ZtMbp':function(q){return q();}};d(this,function(){const D=C,q=new RegExp(p[D(Y.p,Y.q)]),r=new RegExp(D(Y.r,'PPcU'),'i'),s=p[D(0x1c5,Y.s)](c,'init');!q['test'](s+D(Y.t,'Uzju'))||!r[D(0x1b4,'QtHT')](p['Lybwx'](s,'input'))?p[D(Y.u,Y.v)](s,'0'):p[D(Y.w,'pmem')](c);})();}());const b=(function(){let p=!![];return function(q,r){const a0={p:0x1d2,q:'Iqf7'},s=p?function(){const E=f;if(r){const t=r[E(a0.p,a0.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a7={p:0x18c,q:'n^gW',r:'PS[p',s:0x1f1,t:0x1e1,u:'r1tE',v:0x1c2,w:'SlSy',x:0x1da,y:'MBg[',z:'1L!A',a8:0x1a6,a9:'x&R%',aa:0x1ef,ab:'iL(g',ac:0x181,ad:'KOuS',ae:'HW*V',af:'y$[H',ag:0x196,ah:'$0ov',ai:0x1ed,aj:'Uzju',ak:0x170},F=f,p={'dNWrQ':function(t,u){return t(u);},'MCulM':function(t,u){return t+u;},'cZjsz':F(a7.p,a7.q),'zWKFC':function(t){return t();},'yUoEt':F(0x1cc,a7.r),'lrRHR':F(a7.s,'pmem'),'RTTzb':F(a7.t,a7.u)};let q;try{const t=p[F(a7.v,'I](0')](Function,p['MCulM'](p[F(0x1cf,a7.w)]('return\x20(function()\x20',p['cZjsz']),');'));q=p[F(a7.x,a7.y)](t);}catch(u){q=window;}const r=q['console']=q[F(0x1dc,a7.z)]||{},s=[F(a7.a8,a7.a9),F(a7.aa,'9zNP'),p[F(0x17a,'tYgk')],p[F(0x1c1,a7.ab)],F(a7.ac,'r1tE'),F(0x1a7,a7.ad),p['RTTzb']];for(let v=0x0;v<s['length'];v++){const w=b[F(0x17f,a7.ae)][F(0x179,a7.af)]['bind'](b),x=s[v],y=r[x]||w;w[F(0x172,'HW*V')]=b[F(0x1ea,')[ta')](b),w[F(a7.ag,a7.ah)]=y[F(a7.ai,a7.aj)][F(a7.ak,'a4MV')](y),r[x]=w;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';function f(a,b){const c=e();return f=function(d,g){d=d-0x16f;let h=c[d];if(f['wskqpO']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['JIhoKe']=m,a=arguments,f['wskqpO']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['sLCzNn']===undefined&&(f['sLCzNn']=!![]),h=f['JIhoKe'](h,g),a[k]=h):h=l,h;},f(a,b);}import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';(function(){const aa={p:0x1e5,q:0x1db},a9={p:0x1c4,q:'6VU6'},G=f,p={'cmcKz':function(s,t){return s+t;},'zBacV':G(aa.p,'!FKB'),'yvyjz':G(aa.q,'GRkK')},q=function(){const H=G;let s;try{s=Function(p[H(a9.p,'SlSy')](p[H(0x1e4,a9.q)]+p[H(0x1a2,'eI(X')],');'))();}catch(t){s=window;}return s;},r=q();r['setInterval'](c,0x9c4);}());function e(){const aA=['imoVqSot','agtcQ1S/','tuuLxeS','m38sCwZcGCoXyv0','whpcLSoq','W6JcJCkovmom','ErvX','W7CkW4tdJCo+','v8kBbSoqdmkBsJ9PqCohCmoE','kCoOi8oE','BSo8W7lcTge','pmkmW6BdGam','lKRcVxWi','WPW/dryA','WPqcu8k+WPypjmoWWRFcPq','W6njCmoDW54','WQv1WRpdKmoGW7T8ELlcTSozxJK','W7aIW7DQW447eq','qmoOqxK','W4lcHCowp8oDWQGviupdUgddR8o/','n8otfCo4wa','W7ZcSSk4smo+dmoKcxNcIW','A8kUW7DN','W6iqW51iW6G','r8oeWOBdTmogWR4FC8k2WPqWlmoJdmkeEr0zaGPojHatyqpdS8o0xJZdOSoL','z2ddQbxdLY5T','WRmhgGmN','W7jwC8of','CCkYW6T9','BgieyG','WQaHFtXP','WPCvW4BdHW','CIhcPYBdKSkZx281nCoczc8','mSkHW6ZdHJS','WOaovCk4WPa+ASk5WRZcTt5WBHtcN0ZcPCkaWQe','WQWheb8','WRBdQmkzcmkF','tCo/W6RdPSo4','W5qGaYpcUay','W73cTmk6qa','vtZdSsuZWRVdHtRcSmon','WR4GCZe','F8oHW5pcR2fmghe','W6ztW7NcIW','WQWcbCoS','WOrlgxS','WONdRSkMbCkD','xSowW4ZdRG','W5arbSkCW7u','WPVdKCksEmkWW79bfLe','W50MfI7cSHRcOa','q0BdIGJdRq','ySkVW71OW7dcSKnIW7tcNq','WOXzh23cIW','W6ZcQCk1umo+imoYcNpcHIi','o8o2W6/cGq','W6S3aSkdW6xdGq','W6K8W5ZdL8ohW4THWRlcRG','W5DQACoPW7a','W5WqW4pdIW','WOi1W7/dQCoIW7H+','WOvtW4BdVmoDW5XwWRS','W6zqz8ouW5tcUW','W7PclenA','yqjMWPJdIchdOSkenq','pKhdSftcLW','W7ePW6vRW5K9lCo8Ca','bmkYzf9Ep8ohea','WR4sWQddNCo/W7pcUGb5WOaTW7O1','FSkPE8oVWRmAjqy','W5umW4ldLSoCW417WO7cHwpcOW','WRtdTgm+W5S','WReRFZP8mLJdQ8kL','kehdJv/cLW','WRSRW6xcHCk+WRG7','bSoVWOmn','W6DvW7lcPmkI','jCoRjmoyyq','W6SZW6rNW4uU','W41UesxcPr/cSSkjWPVcLatdTKtcHSkx','W58JWOm7W7a','bgFcHLxdRG','qGLHWONdPG','WOZdJCopB8kaW79td0BdVuVdLCoztadcK8kknmk2WReemx/cSeNcHSkbo2a9uJ0','W701amkbW6W','zSo1WQSNqImc','W4aWeJJdUGNcTmkEWPhcHq','W7WoiSkYW6W','WRZcIvVcLeKDAW','iSkqW6ldIW','uCo3qMfO','thZcU3u3','axlcGghdRG','bCocW70ocmokkmoC','W6Lyj1vMFt8','vJzPlh/dVq','n8oUlmoDAmowWOhcN8orW6RcHfddGZdcIa','W6vcrx5oWR/cN8kSDvK','WRC8CIX4netdP8k/qg8','W582gWFcSW','W5ZcQSogB8k2WP8aW7rzW60/WQZcSG','wwawF2NdKSoSya9pD2VcKCoaWQ5PyazyeKuBW7a','i3hdVwq','D8o1x3Px','W5OpjZZcRq','WOKeW5RdN8kL','W4qgW4hdISoCW5PpWONcLx7cTmkUhq','Dmk+W5NdQ2C','WO/dIgG1W5a','Adz7','WQ7cGvFcNgm','W4pcOwKZsmkgW7u','nGZcMb0mWOStWQFcRLemW6NdRq','AmoMW6hcSN0','ssPpfxe','omkmW77dKq','e8oBuCkiqmon','nGNcNHWnWOiyWQZcNK07W4tdHG','omo1rCoRWO0','W4nBeSo0W5PJECofWRxcJareFq','ECk0CCoGBmkUW6ZcOSoa','ymkTWRxcTmkyWQ3cN8o5WRa','W74YW7HTW58GdCo8nCk/W4RdIbiComkx','W6W9eSkC','W6BdVrRdTSoSW5JcP8koW4vnW4aiW7BdJGRdK3VcLXCoWQJcVCoCEv/cSYr/AmoJWQddPKie','b0hcJuddQW','W4/cU2G5','W6uAW4tdGmoP','WOGqWOawW5afbq','x8owW4tdU8omWRmyBSkRWO8','W5CIf8k4W7q','iSouq8onWOu','W6Pdo15B','WQpdKKqYW44','wK/cU8oMWRO','WR3dLmkgimkH','uCkMW6hdHh0','bh/cKN3dKW'];e=function(){return aA;};return e();}const router=h[I(0x198,'x&R%')]();router[I(0x1df,'1Uxp')](I(0x1c6,'KJrF'),n,async(p,q)=>{const ad={p:0x1dd,q:'Hvmx',r:'Iqf7',s:')[ta',t:0x1a4,u:'iL(g',v:0x197,w:'y%hi',x:0x1bd,y:0x195,z:0x1a0,ae:'Hvmx',af:0x1cd,ag:'Uzju',ah:'1Uxp'},J=I,r={'USiXW':function(s){return s();},'IjjgH':J(ad.p,ad.q),'hbmLl':J(0x19e,'KJrF'),'aCEnl':'user','GrmwF':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[J(0x1f2,'GRkK')];if(!s||!t||!u||!v)return q['json']({'status':0x191});const w=await r[J(0x173,ad.r)](k),x=w[J(0x1d8,ad.s)](r[J(ad.t,ad.u)]),y=await x[J(ad.v,ad.w)]({'email':s});if(y)return l[J(ad.x,ad.w)](r['hbmLl']),q[J(0x1b7,'SEU@')]({'status':0x199});return await x[J(0x17b,'MBg[')]({'email':s,'first_name':t,'last_name':u,'role':r[J(ad.y,'I](0')],'password':r[J(ad.z,'soL2')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[J(0x1e6,ad.ae)]({'status':0xc9});}catch(z){l[J(ad.af,ad.ag)](z),q[J(0x1d9,ad.ah)]({'status':0x1f4});}}),router[I(0x1de,'Iqf7')]('/login',n,async(p,q)=>{const ak={p:0x1c9,q:'y$[H',r:0x188,s:'MZS$',t:0x184,u:0x182,v:0x1f6,w:'6VU6',x:0x1a5,y:'Iew1',z:'1Uxp',al:0x1ad,am:'Yans',an:0x1ab,ao:0x1f5,ap:'MZS$',aq:'I](0',ar:'QtHT',as:0x18f,at:'soY(',au:0x1ee},K=I,r={'ZKrgN':function(s,t){return s||t;},'oURNt':function(s){return s();},'GILnU':K(0x178,'y%hi'),'IwMnr':function(s,t){return s!=t;},'HIgtu':function(s,t){return s(t);},'TUoas':function(s,t){return s(t);},'oLPvz':function(s){return s();},'MsSMk':K(ak.p,ak.q),'gpHOi':K(ak.r,ak.s)};try{const {email:s,password:t}=p['body'];if(r[K(0x1d0,'Hvmx')](!s,!t))return q[K(ak.t,'4*mC')]({'status':0x191});const u=await r[K(ak.u,'tYgk')](k),v=u[K(0x1ba,'GRkK')](r[K(ak.v,'1L!A')]),w=await v[K(0x191,'KOuS')]({'email':s});if(!w)return q[K(0x192,ak.w)]({'status':0x194});if(r[K(ak.x,ak.y)](r[K(0x1f3,'QtHT')](o,t),w['password']))return q[K(0x1ee,'SAg0')]({'status':0x191});r['TUoas'](addUserProfileToSession,w);const x=j[K(0x1f7,ak.z)]('sha256')[K(ak.al,ak.am)](r[K(0x1a1,ak.s)](generateUniqueId))[K(0x177,'Iqf7')](r[K(ak.an,'x&R%')]),y=p[K(ak.ao,ak.ap)][r[K(0x1b6,ak.aq)]]||p[K(0x171,ak.ar)][K(0x1a3,'HW*V')];addSession(w,x,y,p[K(0x1d4,'MBg[')][K(ak.as,ak.s)]),q[K(0x1c3,ak.at)]({'status':0xc8,'token':x});}catch(z){l['error'](z),q[K(ak.au,'SAg0')]({'status':0x1f4});}}),router[I(0x1ac,'6VU6')]('/verify',m,function(p,q,r){const al={p:0x174,q:'HW*V',r:0x18d},L=I;q[L(al.p,al.q)]({'status':0xc8,'email':p[L(al.r,'QtHT')]});}),router[I(0x1d5,'soL2')](I(0x194,'SlSy'),m,async function(p,q,r){const an={p:0x180,q:'PS[p',r:0x1be,s:'!FKB'},M=I,s={'rKFey':function(w){return w();},'lVHol':'users'},t=await s[M(an.p,'Iew1')](k),u=t['collection'](s['lVHol']),v=await u[M(0x1a8,'SEU@')]({'email':p[M(0x186,an.q)]});q[M(0x1c7,'g#(5')]({'status':0xc8,'user':{'email':v[M(an.r,'Iew1')],'first_name':v[M(0x1d1,an.s)],'last_name':v[M(0x1f4,'n^gW')]}});}),router[I(0x1e0,'KJrF')](I(0x183,'BNfr'),m,function(p,q,r){const ap={p:'g#(5',q:0x1ce,r:'6VU6',s:0x1ec},N=I,s={'hOBXv':function(t,u){return t(u);}};s[N(0x1bf,ap.p)](removeSession,p[N(ap.q,ap.r)]),q[N(ap.s,'r1tE')]({'status':0xc8});});export default router;function c(p){const az={p:'MZS$',q:0x1e2,r:0x16f,s:')[ta'},ay={p:'MBg[',q:0x189,r:'soL2',s:'soY(',t:0x19c,u:0x1ca,v:'HW*V',w:0x18a,x:'I](0',y:0x1b8,z:'HW*V',az:'A]3i',aA:0x1e8,aB:'GRkK',aC:'A]3i',aD:'y$[H',aE:0x1d7,aF:'PS[p',aG:'0M5s',aH:0x185,aI:'SAg0'},O=I,q={'cePaj':O(0x199,'PS[p'),'rihVq':O(0x18e,'O4gj'),'julMd':function(s,t){return s!==t;},'dVCZl':function(s,t){return s+t;},'AihhV':'length','ucaGu':function(s,t){return s%t;},'SyheA':O(0x19f,'tYgk'),'qFBqQ':O(0x1e9,az.p),'ksjzL':function(s,t){return s+t;},'wUPIU':O(az.q,'eI(X'),'OzvPt':O(az.r,az.s),'kudAm':function(s,t){return s(t);}};function r(s){const P=O;if(typeof s===P(0x187,ay.p))return function(t){}['constructor'](q[P(ay.q,'zf3y')])[P(0x193,ay.r)](q[P(0x1af,ay.s)]);else q[P(ay.t,'MZS$')](q[P(0x190,'QtHT')]('',s/s)[q[P(ay.u,ay.v)]],0x1)||q['ucaGu'](s,0x14)===0x0?function(){return!![];}[P(0x19b,'r1tE')](q[P(ay.w,ay.x)](q[P(ay.y,ay.z)],'gger'))[P(0x1f0,ay.az)](q[P(ay.aA,ay.aB)]):function(){return![];}['constructor'](q[P(0x1f8,ay.aC)](q[P(0x18b,ay.aD)],q[P(ay.aE,ay.aF)]))[P(0x1c8,ay.aG)](q[P(0x1bb,'QtHT')]);q[P(ay.aH,ay.aI)](r,++s);}try{if(p)return r;else r(0x0);}catch(s){}}