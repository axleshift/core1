const J=f;(function(p,q){const W={p:0x16d,q:'ZRAg',r:0x138,s:'@2wY',t:0x16e,u:'eh22',v:0x147,w:'TW!7'},E=f,r=p();while(!![]){try{const s=parseInt(E(W.p,W.q))/0x1*(-parseInt(E(0x131,'miD4'))/0x2)+parseInt(E(W.r,W.s))/0x3+-parseInt(E(0xd7,'9F8Q'))/0x4+parseInt(E(W.t,'s]Wx'))/0x5+parseInt(E(0x126,'CRcY'))/0x6+parseInt(E(0xdb,W.u))/0x7+-parseInt(E(0xfb,'3soL'))/0x8*(parseInt(E(W.v,W.w))/0x9);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x8d715));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a6={p:0xb5,q:'9F8Q'},a5={p:0xd2,q:'1lNZ',r:0x177,s:'QnM4',t:0x156,u:0xc8,v:'[rCN',w:0x149,x:'52Ce'},F=f,p={'svSqf':'function\x20*\x5c(\x20*\x5c)','vxzBP':F(a6.p,'eh22'),'ynRBw':function(q,r){return q(r);},'ZQojD':F(0x125,'@2wY'),'xSHzM':function(q,r){return q+r;},'PCxJk':F(0x181,'ZRAg'),'HKIgu':function(q,r){return q+r;},'iRlXv':'input','FEnXl':function(q,r,s){return q(r,s);}};p[F(0xe3,a6.q)](d,this,function(){const G=F,q=new RegExp(p[G(0xed,'x#@b')]),r=new RegExp(p[G(a5.p,a5.q)],'i'),s=p['ynRBw'](c,p[G(a5.r,a5.s)]);!q[G(a5.t,'QnM4')](p[G(0x15b,'QBP1')](s,p[G(a5.u,'x$*w')]))||!r[G(0xc4,a5.v)](p[G(a5.w,'595R')](s,p[G(0xeb,a5.x)]))?s('0'):c();})();}());function e(){const b6=['qSk4vCo5u8o9W6FdNmkOhq','Dr3cVJux','u8oIurew','pWpcOZ0mya','W4tdQxRdSLFdRCor','W50jW6eWW7a','m8kQcX7cHvRcJcRcQ1a','vmknW6xdPW','WPdcKe3dOKNcKq','W6qxWOVcOmkb','W4y2rhpcHaa','W5RdVrPMsq','W5tdUCk0cSo/','WPNcSqFdVtbbErnpuG','lZWepCoHWPZcLSkLW73dI8k9W41CrCompZpdQfGMf1veW5SxhSkEfdJdGCkWemk4W7e7WPfkWRRcPefsWPBcNmkwW48zwSkop8kIcHpcU8kZeCoIWRTAWRlcL8kfW5RcU8kpvSo0smoaWOddGIjSj8oLW6iSjmkVW69SW6yvsaX9BW','qvnTW6xcRq','g0ngWQpcOG','WOLknIH+W4qkFvSE','xSk/WO3cLG','ghJcSmk3','W7XAfW','WRRcVmoWWRHGWPu','umo1rJ4','W6VdHSo/BSk2','m8owe2WT','e1VdLN/cKXS','uvTuWQ/cVa','W6P4dCkIW54','W6L5WQlcOYu','D8ozgmoqh3DQrYrRw3/cTH1iBXedwIK8ySkIW5ZcUSkDWPZcVq','WRldVaHfW7qAW4G','qJzCWORcOSkcWRy1bWRcP03dJq','W5yRqNNcLrfHWQxcISoT','W6NdGmo2FSk6ACoe','W6iqWO/cPSkhW5y','W5vXWRW','vCk2w8o5uW','W73dQxa','W4JdJ8kEbq','W48nW7aOW7XG','ESk5W7NdUqS','W4XNWP7cIW4','jSk3gbNcHhy','W5BdRbfLW7i','vhldQSoStG','q8khW7RdVYP0W4bQE0e','nI/cU13cOG','W5iwW6y','W7SMWRZcMmky','WQBcVmoH','W6ddGcfBW5i','uSkLW6lcLSoOWQiuBSoztg3dKHVdS8oZWRiHpSoiWRVdULGUuhmxm8kuadeXfa','W6BdTb1dAmkFvMTe','W5ZdGsq','wHSB','wdddP8oMuNZdQmkbaXBdH2tdHg9N','qSoBxXqj','w8k4WPi','mNZdUdLMW6CkBbpcVXvgrXXO','Dmkpc8odgNH3sc1Wwq','yadcVY4','W6elWP3cPG','W6utWQfZW5m','W5pdJrLMW6G','WOnklI9m','qZOGDvq','t8oTv18','xr4zzeNdUmo0','u2NdOmo9vxG','dhVcPCkPmG','W6tdT8kK','W6NdIH5cCmkes1a7W412W5S+i8kNWP1wW59CW7Lvdh0','W6BdH8oRF8khC8oUWQJcQa','W7FdHGTMW7C','wmkhW5JdPqi','dSk7vSoYwCoRW6C','W6BdMJjDW44','lLhcVSkWaa','W4RdNWXfCSky','isqbWPO','W4ORWRfqW4rJ','kW7cMgFcOSo5','WRpcSCoBWQ1t','W4WwW6iO','fmkyE0TBWQmeWQycW6BdK8kTW4vEW781WPxdJCkmy19kW5pdSqPNmCkdn05ZW6OWWQq','qCk/WOFcIG','WQRcP8o/WR9HWPqqC8kSWQBcKq','gHZcHSoZ','r8k4WOpcJaXE','yxbD','W5OTWR1qW5K','W7RdRLxdNvC','WPRcKSkJymoJk8k6WQ5jWQNcJCkvD33dHmoiW57dQeC','eenbW6hdSq','cx5lW4BdPW','omkviCorW4e+W6L/WQ7dGG','W5RdPJPGyG','fg0DW5BdOCoxW7e','W7pdVsbKFG','W7JcGJRdJW','pSkGW5tdHa','W6fbeSkyW7jW','sY0IAMi','AZqpsM0','W5qCW7a4W6XHWOS','WR3dKCkthG','cvJcPSkVdW','o8k0gGNcPW','abXUoW','rmk8eGSy','W6NdHNFdM3e','WPNcRa7dScfhAsvbsa','nbqgpq','W5tdUg7dLeG','WRBcNhqaWOTmWO1IeXm0eLi','yXVcRs4aqtxdGJKAWRa','w0D6W6tcIa','WOFcPmo2WQrB','xd3dRCo1FKvBW5mMWPOXcmkQ','hSk0dmoCba','lSkkc8od','WPdcGuldSG','ESkee1zjWRGEW5H8W43dH8oHW4y','mCkkaCoF','k8obqGepW6XKW7HlW5u','kCoquWKuW6C','WQRcMCoxWQbp','WQpcU8o+WQi','W7ilWORcTW','wmo3xeK','k07cU8kDjW','WPLanca','FMxdSsDQW6ihkHpcPq','yCkyjHS7W4S','ghVcSCkKpXqKW7yL','tmkDWRtcHCoU','fbpcK3xcUq','l8kSW5tdHa','Et3cOait','oCkwcSoi','WPdcKN/dP1O','W4VcJHH7WPy','cmkrW6RdT8k+','rSkbW7JdTWb5W5e','W6JcOa92','CWdcOIKkyJi','W4KkW7qUW7O','fs4yia','pHGblmoL','v8kAWRxcN8kZW7WHbCkNW6e0kSooytZcNSktWQRdJ8k9W7O','w8kzWQlcL8kZWRuSqCoIW605mCohidNcG8oxWR3dKSkNW7OyDG','o8ohrHqoW7O','pCkti8ozW6SZW7G','W5KQWR9zW5i3WRVcMg3dGmooWQPTrmke','WRVdUtj6WPRcJN3dJq','w8k5WQlcKCoOWQe','kaJcGfJcNW','dNHlW5hdT8oU','C8k1ktO7','CGBcJI8Y','W44nWOO','WPOVqMRcIbj8','lCobvq8j','pSkclSoyW5qPW7r5WQ8','W6tcObW','yWRcOJ4','aq4n','dmk5W6ddJCkj','WOtcKSk5CSoLlq','twPfECkHW4VdL8kjWRtdV8kPW6LG','W5G8W5mFW48','W7JcIcldNSoT','W6jAe8kf','W77cOdH7WOxcQNFdRG','yCkjkqS','W6VdQ8o5E8k6','B3pdPmkPDgldPmkwrYpdGJRdKxD6WR4Sv8oZWPy4W47cLW','WQhdKCkbdSoOW7/cKW','rCk9WQlcKSoZWQq','h1lcMmkVjG','W45XWQRcOa','WONcL0pdUa','kmkMW5hdHCkr','WQpdH8kpba','e2nD','W7NdVCkNWPNdRmkbE8o9WOiAea','kqyBpq','nJmbl8o6WPRcGmoHWPldSSky','W63cRd7dTCou','fqfVidS','B1fryXNdKJCphSotou5f','W7JdV8kMW7GIW5vvxSk7WOVcQu/dTa','vSoGtdSQWO1SjCkd','W6BdT8k0','WOvRkWbO','W77cOabQWPK','E8kclHS','WR/cQSoQW6pcSCogjSoSWPyDlM3cGa','BZmHjgtcGhC','hmkueZNcOG','vmoXrq','ptuF','W5xcIdZdICkJWPPyyXhdNSoIyq','WOBcKSkGzSo9imoUW7jkWQ4','W4tcLGDlWQC','W58Qshy','WP/cPCoKWPHF','W7JcGSk5h8oGW4dcHmov','ld3cQN84WRjddr/cIs8drW','a2tcOG','rCo8rZuS','v8o1wY4','mGNcLN0','BM/dSY8','mrtcINBcPCo+WRhdVgq','imoBDvH5WOddSSkuWQPza8okW40','kXqmiv8','W5K8sx/cLrW','u8kCW7FdPZPK','ms4bWPJdLCoM','W73dJmo1DCkbySoGWQlcQCk9FIJcIa','W58xy3COWPrgD1ywWQrlW6W','xr4IuMa','wSkSWQ3cGCoYWR8','WPLno3yUWPe','r8k3WRS','W4VdRNldUq','ySkQWPRcLdm','AxJdQc4','u8kYsCo5v8o9W7y','W5WxAxaSWPzkCK4YWP1XW40','oCkqamov','nMvUWQ3cUW','ASoYveiR','W7ZdNCo5BSkaDa','umkjWQFcMt4','xbasCG','whanW5/dVmobW7C/hq'];e=function(){return b6;};return e();}const b=(function(){let p=!![];return function(q,r){const a7={p:0xa6},s=p?function(){const H=f;if(r){const t=r[H(a7.p,'9F8Q')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const af={p:0xbd,q:0x11b,r:'7Bqj',s:0x143,t:'%NHO',u:0xbf,v:'U7rp',w:'3gtI',x:0xf2,y:'52Ce',z:'GRu6',A:'awfV',B:'scoh',C:'(ndf',D:'3soL',ag:0xc5},I=f,p={'zhlEq':function(t,u){return t(u);},'NlghN':function(t,u){return t+u;},'YYJDo':function(t,u){return t+u;},'dogtC':I(af.p,'7F$s'),'VmuTJ':I(0x122,'CRcY'),'cVwWN':I(af.q,af.r),'wiYPk':I(af.s,'1lNZ'),'pvZcv':I(0x104,'uQVQ'),'YfdAG':I(0x173,af.t),'AwMXN':I(af.u,'O)nO'),'KDDmv':function(t,u){return t<u;}};let q;try{const t=p['zhlEq'](Function,p[I(0xd6,af.v)](p['YYJDo'](p[I(0x166,af.w)],'{}.constructor(\x22return\x20this\x22)(\x20)'),');'));q=t();}catch(u){q=window;}const r=q['console']=q[I(af.x,af.y)]||{},s=[p[I(0x12f,af.v)],p[I(0x15a,af.z)],p['wiYPk'],'error',p['pvZcv'],p['YfdAG'],p['AwMXN']];for(let v=0x0;p['KDDmv'](v,s[I(0x113,af.A)]);v++){const w=b['constructor']['prototype'][I(0xe2,af.B)](b),x=s[v],y=r[x]||w;w[I(0x183,af.z)]=b[I(0x148,af.C)](b),w[I(0x10e,af.D)]=y['toString'][I(af.ag,'sSpE')](y),r[x]=w;}});a();import g from'dotenv';g[J(0x13c,'e*Oo')]();import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';function f(a,b){const c=e();return f=function(d,g){d=d-0xa4;let h=c[d];if(f['KzcxJW']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['nAUWSC']=m,a=arguments,f['KzcxJW']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['YnAdqo']===undefined&&(f['YnAdqo']=!![]),h=f['nAUWSC'](h,g),a[k]=h):h=l,h;},f(a,b);}import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';const router=h['Router']();router[J(0x18c,'HCZa')](J(0x14e,'s]Wx'),async(p,q)=>{const al={p:'L58E',q:0xa8,r:0x158,s:'HCZa',t:0xf7,u:'yf)3',v:'miD4',w:'7F$s',x:'3soL',y:0xc3,z:0x136,A:0x134,B:0xdc,C:'(ndf',D:0x17d,am:'5aUB',an:'eJ[Y',ao:0x12e,ap:'Pk%a',aq:0xab,ar:'QnM4',as:'L58E',at:'%NHO',au:0x144,av:0xad,aw:'ZRAg',ax:0xe4,ay:'TW!7',az:0x137,aA:'5aUB',aB:0x132,aC:'9F8Q',aD:0x160,aE:'TW!7',aF:0xf0,aG:0xa9,aH:0xba,aI:'ok8%',aJ:0x105,aK:0x106,aL:0x176,aM:'qGio'},K=J,r={'JVMUy':function(s,t){return s||t;},'nUBNu':K(0xf6,'yf)3'),'AuffX':function(s,t){return s<t;},'GhiXZ':'Password\x20must\x20be\x20greater\x20than\x208\x20digit','xoNvM':K(0x15d,al.p),'UDQWN':function(s,t){return s!=t;},'AEvbs':K(al.q,'GRu6'),'VfxlJ':K(al.r,al.s),'PeYTT':K(al.t,al.u),'Tmfgy':K(0x162,'9F8Q'),'FVJuk':function(s,t){return s(t);},'pViyi':function(s,t){return s===t;},'MpYfN':K(0x145,al.v),'vMlts':K(0x12c,al.w)};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w,newsletter:x}=p[K(0xf1,al.x)];if(r[K(al.y,'GRu6')](!s,!t)||!u||!v||!w||!x)return q['status'](0x190)[K(al.z,al.v)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(al.A,'g@5h')](s))return q['status'](0xc8)[K(al.B,al.C)]({'error':r[K(al.D,al.am)]});if(r['AuffX'](v[K(0x13a,'Pk%a')],0x8))return q[K(0xb9,'6CB4')](0xc8)['json']({'error':r['GhiXZ']});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[K(0xca,al.an)](v))return q['status'](0xc8)[K(al.ao,al.ap)]({'error':r[K(al.aq,al.ar)]});if(r[K(0x17a,'ZRAg')](v,w))return q['status'](0xc8)[K(0x118,al.an)]({'error':r[K(0xf5,al.as)]});const y=await k(),z=await y[K(0x14f,al.at)](r[K(al.au,'6CB4')]),A=await collection[K(0x170,'3gtI')]({'email':s});if(A)return l[K(al.av,al.aw)](r[K(0x18e,al.aw)]),q['status'](0x199)[K(al.ax,al.ay)]();await z[K(al.az,al.aA)]({'email':s,'first_name':t,'last_name':u,'role':r[K(0x16b,'TuM3')],'password':r['FVJuk'](o,v),'email_verify_at':'','created_at':Date[K(al.aB,al.aC)](),'update_at':Date['now']()});if(r['pViyi'](x,r['MpYfN'])){const B=await y[K(al.aD,al.aE)](r[K(0x167,'jQZy')]),C=await x[K(al.aF,'QnM4')]({'email':s});!C&&B[K(al.aG,'3gtI')]({'email':s,'created_at':Date[K(al.aH,al.aI)](),'update_at':Date[K(al.aJ,al.x)]()});}return q[K(0x164,'U7rp')](0xc9)[K(al.aK,'52Ce')]();}catch(D){l['error'](D);}return q[K(al.aL,al.aM)](0x1f4)['send']();}),router[J(0x18b,'52Ce')](J(0x152,'52Ce'),n,async(p,q)=>{const aq={p:0xc7,q:0x168,r:'otP1',s:'7Bqj',t:0xa4,u:0xcb,v:'9F8Q',w:0xfe,x:'O)nO',y:0xea,z:'sSpE',A:'eh22',B:'vrZi',C:'$cBI',D:0x159,ar:'Pk%a',as:0x13d,at:0xdf,au:0x112,av:'GRu6',aw:0x150,ax:'52Ce'},L=J,r={'pZUjd':function(s,t){return s||t;},'dSsjD':function(s,t){return s(t);},'rYMjm':L(0x141,'TW!7'),'ejCvS':function(s){return s();},'nwcdV':L(0x172,'TuM3'),'cQFlZ':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p['body'];if(r[L(aq.p,'x$*w')](!s,!t))return q[L(aq.q,aq.r)](0x190)['send']();const u=await k(),v=await u['collection'](L(0x139,aq.s))[L(aq.t,'x$*w')]({'email':s});if(!v)return q[L(0x14b,'3gtI')](0x194)[L(0x10f,'@2wY')]();if(r[L(aq.u,aq.v)](o,t)!=v['password'])return q[L(aq.w,aq.x)](0x191)[L(aq.y,aq.z)]();const w=j[L(0xdd,aq.A)](r[L(0x114,aq.v)])['update'](r['ejCvS'](generateUniqueId))[L(0xb1,aq.B)](r[L(0xcc,aq.C)]),x=p[L(0xc9,'qGio')][L(0x186,'iLmI')]||p[L(aq.D,aq.ar)][L(aq.as,'3gtI')];return r[L(aq.at,'U7rp')](addSession,v,w,x,p[L(aq.au,'eJ[Y')]['user-agent']),q[L(0xaf,aq.av)](0xc8)[L(0x161,'6CB4')]({'token':w});}catch(y){l[L(aq.aw,aq.ax)](y);}return q[L(0x140,'awfV')](0x1f4)[L(0x165,'g@5h')]();}),router[J(0xb4,'qGio')](J(0x102,'Pk%a'),m,async function(p,q,r){const ax={p:0xb6,q:0x13b,r:'QnM4',s:0xf4,t:'3gtI',u:0x15c,v:0xae,w:0x17b,x:'iLmI',y:'@2wY',z:'x$*w',A:'%h4c',B:'6CB4',C:0x116,D:'x#@b',ay:'HCZa'},M=J,s={'KbuKU':function(z,A){return z!==A;},'dBaaO':function(z){return z();},'CZkuK':M(0x12a,'e*Oo'),'xhHIQ':function(z,A){return z*A;},'VPUdV':function(z,A){return z>A;},'fiURf':function(z,A){return z-A;},'sPznq':function(z,A,B){return z(A,B);}},{_id:t,email_verify_at:u,...v}=p['user'];v['is_email_verified']=s['KbuKU'](u,'');if(p[M(ax.p,'6CB4')]['email_verify_at']!=='')return q[M(ax.q,ax.r)](0xc8)[M(ax.s,'L58E')](v);const w=await s[M(0x110,ax.t)](k),x=await w[M(ax.u,'mWoE')](s[M(ax.v,'9F8Q')]),y=await x['findOne']({'token':p[M(ax.w,ax.x)],'verified':![]});if(y){const z=new Date(y['created_at']),A=s['xhHIQ'](0xa,0x3c)*0x3e8;if(!s[M(0xce,ax.y)](s[M(0x13f,ax.z)](Date[M(0x163,ax.A)](),z),A))return q[M(0xb9,ax.B)](0xc8)[M(ax.C,ax.D)]({'otp':!![]});}return s['sPznq'](sendOTPEmail,p,x),q[M(0x171,ax.ay)](0xc8)['json']({'otp':!![]});});const sendOTPEmail=(p,q)=>{const aB={p:0x111,q:'iLmI',r:'g@5h',s:0xfc,t:'awfV',u:0x191,v:0x174,w:'3soL',x:0x119,y:0x16a,z:0x15f,A:'595R',B:0x123,C:'TW!7',D:0x16c,aC:0xd9},N=J,r={'Cojcg':function(t,u){return t+u;},'qsZOR':function(t,u){return t*u;},'xMmSB':function(t,u,v){return t(u,v);},'oNqDs':N(aB.p,aB.q)},s=Math[N(0x133,aB.r)](r['Cojcg'](0x186a0,r[N(0x178,'TuM3')](Math[N(aB.s,aB.t)](),0xdbba0)));Promise[N(0x185,'x$*w')]([q['insertOne']({'user_id':p[N(aB.u,'scoh')][N(aB.v,'1lNZ')],'token':p[N(0x124,aB.w)],'code':s,'verified':![],'expired':![],'created_at':Date[N(aB.x,'O)nO')](),'updated_at':Date[N(0x142,'awfV')]()}),r[N(aB.y,'%h4c')](send,{'to':p[N(0x162,'9F8Q')][N(aB.z,aB.A)],'subject':r[N(aB.B,aB.C)],'text':N(0x12b,'[rCN')+s+N(aB.D,'(ndf')},p[N(aB.aC,'(ndf')]['first_name'])]);};router[J(0x10d,'%h4c')](J(0x169,'595R'),m,async function(p,q,r){const aD={p:0xbb,q:'7Bqj',r:'$cBI',s:'Q0Uf',t:0xa5,u:'iLmI',v:0xda,w:'x#@b'},O=J,s={'eExpi':function(t,u){return t(u);}};try{const t=await s[O(0xe8,'awfV')](getUser,p[O(aD.p,'vrZi')]);return q['status'](0xc8)[O(0xd1,aD.q)]({'user':{'email':t['email'],'first_name':t[O(0x155,aD.r)],'last_name':t['last_name']}});}catch(u){l[O(0x11e,aD.s)](u);}return q[O(aD.t,aD.u)](0x1f4)[O(aD.v,aD.w)]();}),router['post'](J(0xac,'%NHO'),m,function(p,q,r){const aF={p:0x14b,q:0x115},P=J,s={'dcsOX':function(t,u){return t(u);}};return s['dcsOX'](removeSession,p['token']),q[P(aF.p,'3gtI')](0xc8)[P(aF.q,'TuM3')]();}),router[J(0xcd,'Q0Uf')](J(0x189,'miD4'),[m,n],async function(p,q,r){const aK={p:0x180,q:'QnM4',r:'qGio',s:0x153,t:0x117,u:'sSpE',v:'Pk%a',w:0xcf,x:'1lNZ',y:0xaa,z:'ZRAg',A:'ok8%',B:0x184},Q=J,s={'XLXkW':function(t){return t();},'dEBCF':Q(aK.p,'U7rp'),'KFcMi':function(t,u){return t*u;},'tnKTK':function(t,u){return t>u;},'NYlDP':function(t,u,v){return t(u,v);}};try{const t=await s['XLXkW'](k),u=await t[Q(0x17c,aK.q)](s[Q(0x10b,aK.r)]),v=await u[Q(aK.s,'1lNZ')]({'token':p[Q(aK.t,aK.u)],'verified':![],'expired':![]});if(v){const w=new Date(v[Q(0x16f,aK.v)]),x=s[Q(aK.w,aK.x)](0xa,0x3c)*0x3e8;s[Q(aK.y,aK.z)](Date[Q(0xba,aK.A)]()-w,x)&&(await u['updateOne']({'_id':new ObjectId(v[Q(aK.B,'ZRAg')])},{'$set':{'verified':![],'expired':!![],'updated_at':Date['now'](),'modified_by':'system'}}),s[Q(0x12d,'3soL')](sendOTPEmail,p,u));}}catch(y){l[Q(0x11e,'Q0Uf')](y);}return q['status'](0x1f4)['send']();}),router[J(0xb8,'(Bw7')](J(0x18a,'(ndf'),[m,n],async function(p,q,r){const aO={p:'(ndf',q:'x#@b',r:'TW!7',s:0x188,t:'6CB4',u:0xd0,v:'g@5h',w:0x11d,x:0xb2,y:0x135,z:'5aUB',A:'HCZa',B:0x146,C:0xf8,D:0xe0,aP:'7Bqj',aQ:0xa7,aR:0x108,aS:0xc0,aT:'uQVQ',aU:0xf3,aV:0x121,aW:'g@5h',aX:0x101,aY:'qGio',aZ:0xa7,b0:'CRcY',b1:0x179,b2:'$cBI',b3:0xb0},R=J,s={'aKwNW':function(t,u){return t*u;},'IWjTS':function(t,u){return t>u;},'ALFwD':'Expired\x20OTP','gNORH':function(t,u){return t!==u;},'iotkW':R(0x11c,'L58E'),'PpZmv':'system'};try{const t=p[R(0xec,aO.p)]['otp'];if(!t)return q[R(0x157,aO.q)](0x190)[R(0xe4,aO.r)]();const u=await k(),v=await u[R(0xe5,'miD4')](R(aO.s,aO.t)),w=await v[R(0xf9,'uQVQ')]({'token':p[R(0x10c,'[rCN')],'verified':![],'expired':![]});if(w){const x=new Date(w[R(aO.u,'mWoE')]),y=s[R(0x187,aO.v)](s[R(aO.w,'[rCN')](0xa,0x3c),0x3e8);if(s[R(0x128,'$cBI')](Date[R(0x129,'scoh')]()-x,y))return q[R(aO.x,'5aUB')](0xc8)[R(aO.y,aO.z)]({'error':s['ALFwD']});}if(s['gNORH'](w[R(0xe1,aO.A)],parseInt(t[R(aO.B,'%NHO')](/[^0-9]/g,''))))return q[R(aO.C,'eh22')](0xc8)[R(aO.D,'U7rp')]({'error':s[R(0x18f,'TW!7')]});return await Promise['all']([v[R(0xe7,'9F8Q')]({'_id':new ObjectId(w[R(0x107,aO.aP)])},{'$set':{'verified':!![],'updated_at':Date[R(aO.aQ,'CRcY')](),'modified_by':s[R(aO.aR,'sSpE')]}}),u[R(aO.aS,aO.aT)](R(aO.aU,'qGio'))[R(aO.aV,aO.aW)]({'_id':new ObjectId(p[R(0x162,'9F8Q')][R(aO.aX,aO.A)])},{'$set':{'email_verify_at':Date[R(0x17e,aO.aY)](),'updated_at':Date[R(aO.aZ,aO.b0)]()}})]),q[R(0xe6,'@2wY')](0xc8)['send']();}catch(z){l[R(0x103,'eh22')](z);}return q[R(aO.b1,aO.b2)](0x1f4)[R(aO.b3,'e*Oo')]();});export default router;function c(p){const aZ={p:0x175,q:'x$*w',r:0xde,s:0xd4,t:'52Ce'},aY={p:'ok8%',q:0xc6,r:'(ndf',s:0xe9,t:'O)nO',u:'sSpE',v:0xb3,w:'U7rp',x:'3soL',y:0x151,z:'g@5h',A:0x190,B:'x$*w',C:'U7rp',D:0x14a,aZ:'scoh',b0:0x154,b1:0x14c,b2:'6CB4'},S=J,q={'TXPWA':function(s,t){return s===t;},'aYnUu':S(0xfa,'vrZi'),'EMbmw':S(0xc2,'s]Wx'),'Lijfn':function(s,t){return s+t;},'mOkDs':function(s,t){return s/t;},'vYkdh':S(0x109,'7F$s'),'zyJaF':function(s,t){return s%t;},'AAsta':function(s,t){return s+t;},'jBRJj':S(aZ.p,'QBP1'),'pryKH':S(0x14d,aZ.q),'xMWuR':S(aZ.r,'eh22'),'Plfoc':function(s,t){return s+t;},'dEEaG':S(aZ.s,aZ.t)};function r(s){const T=S;if(q[T(0xd5,aY.p)](typeof s,T(aY.q,'%h4c')))return function(t){}['constructor'](q[T(0xff,'@2wY')])['apply'](q[T(0xd8,aY.r)]);else q[T(aY.s,'5aUB')]('',q[T(0xbe,aY.t)](s,s))[q['vYkdh']]!==0x1||q[T(0xef,aY.u)](q[T(aY.v,aY.w)](s,0x14),0x0)?function(){return!![];}['constructor'](q[T(0xee,aY.x)](q['jBRJj'],q[T(aY.y,aY.z)]))['call'](q[T(aY.A,aY.B)]):function(){return![];}[T(0xb7,aY.C)](q[T(aY.D,aY.aZ)](q[T(0x17f,'HCZa')],q[T(0xfd,'5aUB')]))[T(aY.b0,'qGio')](q[T(aY.b1,aY.b2)]);r(++s);}try{if(p)return r;else r(0x0);}catch(s){}}(function(){const b5={p:'7F$s',q:'ok8%',r:0x11a,s:'CRcY'},b4={p:'vrZi',q:0x100},U=J,p={'cMWQe':function(s,t){return s(t);},'KQwFd':function(s,t){return s+t;},'biBuW':function(s,t){return s+t;},'yRcba':U(0xbd,b5.p),'XnAKO':U(0x182,'awfV'),'NLGVd':function(s){return s();}},q=function(){const V=U;let s;try{s=p[V(0xc1,'GRu6')](Function,p[V(0x18d,b4.p)](p[V(b4.q,'52Ce')](p['yRcba'],p[V(0xbc,'1lNZ')]),');'))();}catch(t){s=window;}return s;},r=p[U(0x15e,b5.q)](q);r[U(b5.r,b5.s)](c,0x9c4);}());