const G=f;(function(p,q){const P={p:0x10a,q:0x121,r:0x158,s:'OeRO',t:0x189,u:'1p^a',v:0x197,w:0x17a,x:0x19f,y:'vI9Q',z:0x19b},B=f,r=p();while(!![]){try{const s=parseInt(B(P.p,'iNtF'))/0x1+parseInt(B(P.q,'Jy#m'))/0x2+-parseInt(B(P.r,'Q3MX'))/0x3+-parseInt(B(0x166,P.s))/0x4*(parseInt(B(P.t,P.u))/0x5)+parseInt(B(P.v,'klQG'))/0x6*(-parseInt(B(P.w,P.u))/0x7)+-parseInt(B(P.x,'[ngw'))/0x8*(-parseInt(B(0x15a,P.y))/0x9)+-parseInt(B(0x159,'N72Q'))/0xa*(-parseInt(B(P.z,'Pc)r'))/0xb);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x73506));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x14c,'zq3W')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Y={p:0x162,q:'7rB^',r:'jW*r'},X={p:0x15e,q:0x179,r:0x122,s:'1dNU',t:0x175,u:'OX$^'},D=f,p={'rLbYd':D(0x19d,'iVwu'),'QZQaX':D(Y.p,'1dNU'),'BLSyQ':function(q,r){return q+r;},'QRDtg':D(0x14b,Y.q),'PASRl':D(0x16f,Y.r),'QjZxV':function(q){return q();},'Qhami':function(q,r,s){return q(r,s);}};p['Qhami'](d,this,function(){const E=D,q=new RegExp(E(X.p,'OeRO')),r=new RegExp(p[E(X.q,'XnJZ')],'i'),s=c(p['QZQaX']);!q[E(0x17b,'!DKH')](p[E(X.r,X.s)](s,p[E(0x142,'owJE')]))||!r[E(X.t,'OZmZ')](p[E(0x10b,'PcOe')](s,p[E(0x19a,'3eXD')]))?s('0'):p[E(0x12b,X.u)](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a7={p:0x188,q:'aWgQ',r:'IOMS',s:0x17d,t:'LIbF',u:0x13a,v:'zq3W',w:'OeRO',x:'96(R',y:0x100,z:0x101,A:0x12e,a8:'ca4j',a9:0x108,aa:'h^zC',ab:'SExJ',ac:0x116,ad:'OeRO',ae:0x18e,af:0x141,ag:0x11f,ah:'1p^a',ai:0x190,aj:'!Q0i',ak:0x126,al:'3eXD'},F=f,p={'xuPML':function(t,u){return t(u);},'KTvgS':function(t,u){return t+u;},'nnKrf':F(a7.p,a7.q),'mNzwx':function(t){return t();},'sEcwQ':F(0x104,a7.r),'NLrey':F(0x119,'PcOe'),'bPPGY':F(a7.s,a7.t),'JtXNi':'exception','jQzzB':F(a7.u,a7.v),'fksVh':F(0x15c,a7.w),'SlfmY':function(t,u){return t<u;}};let q;try{const t=p[F(0x103,a7.x)](Function,p[F(a7.y,'OeRO')](p[F(a7.z,'[ngw')](p[F(a7.A,a7.a8)],F(a7.a9,a7.a8)),');'));q=p[F(0x120,'N72Q')](t);}catch(u){q=window;}const r=q[F(0x171,a7.aa)]=q['console']||{},s=[F(0x16b,a7.ab),p[F(a7.ac,a7.ad)],p['NLrey'],p['bPPGY'],p[F(a7.ae,'owJE')],p[F(a7.af,'h^zC')],p['fksVh']];for(let v=0x0;p[F(0x110,'OeRO')](v,s[F(a7.ag,'TSP[')]);v++){const w=b[F(0x183,'!DKH')][F(0x127,a7.t)][F(0x10c,'jW*r')](b),x=s[v],y=r[x]||w;w[F(0x114,a7.ah)]=b[F(a7.ai,a7.aj)](b),w[F(a7.ak,a7.al)]=y['toString'][F(0x164,'OZmZ')](y),r[x]=w;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';function f(a,b){const c=e();return f=function(d,g){d=d-0xfd;let h=c[d];if(f['QGvIBS']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['bPRjAv']=m,a=arguments,f['QGvIBS']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['UMETXG']===undefined&&(f['UMETXG']=!![]),h=f['bPRjAv'](h,g),a[k]=h):h=l,h;},f(a,b);}const router=h[G(0x14d,'N72Q')]();router[G(0x125,'zq3W')]('/register',async(p,q)=>{const ac={p:0x130,q:0x186,r:'cbqH',s:0x157,t:'OX$^',u:'jW*r',v:0x147,w:0x187,x:0x12a,y:0x18a,z:0x1a2,A:0x1a0,ad:'J(b6',ae:0x113,af:0x160,ag:0x191,ah:'96(R',ai:0x111,aj:0x14a,ak:'iNtF',al:'iVwu',am:0x196,an:'TSP[',ao:0x143,ap:0x19c,aq:'OZmZ',ar:0x132,as:'SExJ'},H=G,r={'JYwRP':function(s,t){return s||t;},'OntAY':H(0x16d,'Pc)r'),'HKvka':H(ac.p,'SwjJ'),'CpTXa':function(s,t){return s!=t;},'mVtQV':H(ac.q,ac.r),'yaYzi':function(s){return s();},'kwLio':H(ac.s,ac.t),'DnhXv':'user','lufRk':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[H(0x199,'ca4j')];if(r[H(0x136,ac.u)](!s,!t)||!u||!v||!w)return q[H(0x17e,'fS(I')](0x190)['send']();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[H(0x150,'iVwu')](s))return q['status'](0xc8)['json']({'error':r[H(ac.v,'iVwu')]});if(v['length']<0x8)return q[H(ac.w,'1p^a')](0xc8)[H(ac.x,'qySL')]({'error':r[H(ac.y,'J(b6')]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[H(ac.z,'ZR$m')](v))return q['status'](0xc8)[H(0xfe,'Q3MX')]({'error':H(ac.A,ac.ad)});if(r['CpTXa'](v,w))return q[H(ac.ae,'iVwu')](0xc8)[H(0x153,'RPXZ')]({'error':r[H(ac.af,'LIbF')]});const x=await r[H(0x15b,'OZmZ')](k),y=x['collection'](H(0x1a1,'klQG')),z=await y['findOne']({'email':s});if(z)return l[H(ac.ag,ac.ah)](r[H(ac.ai,'!Q0i')]),q[H(ac.aj,ac.ak)](0x199)[H(0x112,'h^zC')]();return await y[H(0x129,ac.al)]({'email':s,'first_name':t,'last_name':u,'role':r[H(0x177,']S6I')],'password':r[H(ac.am,ac.an)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[H(ac.ao,'!Q0i')](0xc9)['send']();}catch(A){l['error'](A);}return q[H(ac.ap,ac.aq)](0x1f4)[H(ac.ar,ac.as)]();}),router[G(0x192,'(i@t')](G(0x14e,'(i@t'),n,async(p,q)=>{const aj={p:'qySL',q:'3eXD',r:0x194,s:'wpoy',t:'SExJ',u:'klQG',v:'Z0Cs',w:'Pc)r',x:'OX$^',y:0x128,z:0x12f,A:0x156,ak:0x11a,al:'ca4j',am:'owJE',an:'fS(I',ao:'LIbF',ap:0x133,aq:'iVwu',ar:'ZR$m',as:0x10e,at:'N72Q',au:'OeRO'},I=G,r={'FkPqe':function(s,t){return s||t;},'Jornd':function(s){return s();},'LJAhW':I(0x18b,'Pc)r'),'iMopw':function(s,t){return s!=t;},'oMcbB':function(s,t){return s(t);},'KKULj':function(s,t){return s(t);},'KafXk':I(0x106,aj.p),'QWHBa':function(s,t,u,v,w){return s(t,u,v,w);},'bILhI':'user-agent'};try{const {email:s,password:t}=p[I(0x12d,aj.q)];if(r['FkPqe'](!s,!t))return q[I(aj.r,aj.s)](0x190)['send']();const u=await r[I(0x16a,aj.t)](k),v=u['collection'](r[I(0xfd,aj.u)]),w=await v['findOne']({'email':s});if(!w)return q[I(0x10d,aj.v)](0x194)[I(0x137,aj.w)]();if(r['iMopw'](r['oMcbB'](o,t),w[I(0x180,'IOMS')]))return q[I(0x117,aj.x)](0x191)[I(aj.y,'owJE')]();r[I(aj.z,'5j0o')](addUserProfileToSession,w);const x=j['createHash'](I(aj.A,'OZmZ'))[I(aj.ak,aj.al)](r[I(0x13e,'qySL')](generateUniqueId))[I(0xff,aj.am)](r[I(0x155,aj.an)]),y=p[I(0x10f,aj.ao)]['x-forwarded-for']||p['socket']['remoteAddress'];return r[I(0x14f,aj.p)](addSession,w,x,y,p[I(aj.ap,aj.al)][r[I(0x146,aj.aq)]]),q['status'](0xc8)[I(0x174,aj.ar)]({'token':x});}catch(z){l[I(aj.as,'TSP[')](z);}return q[I(0x19e,aj.at)](0x1f4)[I(0x11c,aj.au)]();}),router[G(0x135,'PIxQ')](G(0x139,'[zFb'),m,function(p,q,r){const ak={p:0x193,q:'[ngw'},J=G;return q['status'](0xc8)[J(ak.p,ak.q)]({'email':p['email']});}),router[G(0x172,'[ngw')](G(0x185,']S6I'),m,async function(p,q,r){const am={p:'OeRO',q:'TSP[',r:0x182,s:'1dNU',t:0x17c,u:0x165,v:0x167,w:'h^zC'},K=G,s={'IGVsZ':function(t){return t();},'uKDiI':K(0x118,am.p)};try{const t=await s[K(0x13d,am.q)](k),u=t[K(0x181,'SExJ')](s[K(0x115,'LIbF')]),v=await u[K(am.r,'SwjJ')]({'email':p[K(0x17f,am.s)]});return q['status'](0xc8)['json']({'user':{'email':v[K(am.t,'96(R')],'first_name':v[K(0x170,'ca4j')],'last_name':v[K(0x131,'wGoj')]}});}catch(w){l[K(am.u,'(i@t')](w);}return q[K(am.v,am.w)](0x1f4)['send']();}),router[G(0x18f,'Pc)r')](G(0x15f,'!Q0i'),m,function(p,q,r){const ao={p:0x13c,q:']S6I'},L=G,s={'aHetu':function(t,u){return t(u);}};return s[L(0x107,'J(b6')](removeSession,p['token']),q[L(ao.p,ao.q)](0xc8)['send']();});export default router;(function(){const ar={p:0x15d,q:0x138,r:'LIbF',s:0x11b,t:'!DKH'},M=G,p={'eNhqQ':function(r,s){return r+s;},'fvwBb':M(ar.p,'klQG'),'OaXvi':function(r){return r();}};let q;try{const r=Function(p[M(ar.q,ar.r)](M(0x154,'[ngw')+p[M(ar.s,'OX$^')],');'));q=p[M(0x16e,ar.t)](r);}catch(s){q=window;}q[M(0x178,'klQG')](c,0x9c4);}());function c(p){const aB={p:'vI9Q',q:0x12c,r:'iNtF',s:0x123,t:0x176,u:'3eXD',v:'PIxQ'},aA={p:'!DKH',q:'XnJZ',r:0x145,s:0x169,t:'ZR$m',u:0x16c,v:'cbqH',w:'owJE',x:0x198,y:'OZmZ',z:'owJE',A:'iNtF',aB:'SwjJ',aC:0x195},N=G,q={'iwoQW':function(s,t){return s===t;},'ULhvV':N(0x149,aB.p),'EwgDU':'while\x20(true)\x20{}','WxNGw':function(s,t){return s!==t;},'vPRfN':function(s,t){return s+t;},'kDzXZ':N(aB.q,aB.r),'HWLOQ':function(s,t){return s+t;},'MHLjW':N(aB.s,'owJE'),'LcIlU':N(aB.t,aB.u),'isqJY':N(0x109,'zq3W'),'Bgagv':'stateObject','cuaqT':function(s,t){return s(t);}};function r(s){const O=N;if(q[O(0x152,aA.p)](typeof s,q[O(0x18d,aA.q)]))return function(t){}[O(0x151,'5j0o')](q[O(0x163,'cbqH')])[O(aA.r,'Jy#m')](O(aA.s,aA.t));else q['WxNGw'](q['vPRfN']('',s/s)[q[O(0x102,'qySL')]],0x1)||q[O(aA.u,aA.v)](s%0x14,0x0)?function(){return!![];}[O(0x144,aA.w)](q[O(aA.x,aA.y)](q[O(0x13f,'nFYh')],O(0x140,aA.z)))[O(0x168,aA.A)](q[O(0x11d,'[ngw')]):function(){return![];}['constructor'](q[O(0x124,aA.aB)]+q['isqJY'])[O(aA.aC,'wGoj')](q['Bgagv']);r(++s);}try{if(p)return r;else q[N(0x184,aB.v)](r,0x0);}catch(s){}}function e(){const aC=['W5BdQCkXWRy9','y8kyWPnh','dwDFWOxcNmokW5GNhZbEzW','aghdVq','wSkXhmoifW','tmouwYVdKSoueuy2D3VcJgPrWQPuW6XeWPusWQ/dH8oOcSk9t0vWcYtdNu4','xsxdJ8kG','W5ldOeVcLSkaWR9LWOBdMMJcUmkC','W6ZdRSo1u8oH','W4rZBmog','WPfBth0oW4u','pmk4Dc1x','vdCiW5NdGmkbW6i','Emk/W6HKwG','W7fOgmkMWQe','a8krm18','tCkdvfRcKmkU','qmkJCmoXeKldUSoWoW','srKTW5tdRa','wmkwW61+uG','d8kMWOeWomkz','xSkGW6T7Ca','W4FdJmoarq','qSozesNdICoF','gSkKWPCglW','wmk2W6bT','uCkguxVdNa','jxZdPSkgxqffpuu','nCkVAcvrpW','evudWRra','aI86rh4TxSoGWRBdHmkLWOfY','W7VdLmkxWPLp','Du0vWQK','CSkMeSkSCq','sI3dMCkM','W6JcUCkAWODiD8kuW7G','tcagW4NdISkhW6Grpq','yK0zWRG','v8kzrKVcL8kPWPjzna','aNFdQSkw','lCk4WRO8gW','WO/cSbpdIConW64','W77cUCkTWOO','wCohpJRdMW','WPdcQmkfqg8','B8kplCk1urqsW53dNs8ZW7VdM8kAW6TMumkMA8kaW53cLrXuWPpdVCkIwMRdNmkrnZnHcw9B','cX1LgmoLWR0rWPJdLG','vCkda8kd','x8omfcZdMmoieq','WPCInCoekSomWORdGCoa','W4ZcTahdNq','W6XdDCoWmG','WOWlWOtcSG','wrWbW4ZdTa','cMldOSkWv2ldKa','tIpdImk+W7y','WPuAW6xcJxhdHefhW67cJG','eSozWQtdVfXw','emknudf/','iMVdT8kwW7G','W40Sh8osWR4','DK8sWQ4','gSkLj0hcGG','qhOZWQGf','W6LRnCk7WRVdRW','CKCzWQ8wsGldH1b4W4G','uM99gZ4','xmk+EuBcRa','CCkzqw/cVa','luJdJr7cI8kuEJNdV8kjwZBdQW','d8oiDmkwyGC','WPdcOrZdMSomW7u','uqhcVmo1WPa','wZldMSk+W6O','lNqmWRDDWOa','W7dcISkJca0C','ovpdJCk6W70','sSksrLO','WRJcJmk+F3hcRSoPuZtcGSon','WQSIW6/cNZO','DGVcLum','B8kaBgldU0pcLbHyW63dVCkYymo9zLRdP8kOdq','dq/cGSomWOi','i2uIWPOTla','oCk/WOeTiCokW7ZcU8kYCINcKmk0WOi8jbZdTNvzWOaKFG','WP1wWOdcLZVdGMxdNMdcJYBdNN0','scjlW7ObW4ldRhxdTWWXtW','t8kkn8ohEcjHksldRq','kwWAW5jX','x8kHW69QzG','W4dcLgRdQYddS3BcH8k3zCoYtmkJW7BcTCkBeXNcRH/cICkHW69ZB8o6WPldUdDvWOBcVG','tCkMW6bQDX02WR/cI8kepmk1WQ1WB8oR','WRvZo8kOWQhdQCoX','uqqDW6ZdSW','CWVcVCo+WP7dNSkP','W5ddTSkTWPq','W4JcMfBcHxO','mMqTW4W','WRRcLmk+aby','gmoMWRy9n0aqWRFdSCo8nmoY','a8kape/cTqq','WOdcTbhdGG','dSkDduzQWR1+','Bmkjh8kjW6G','sSkjcG','W6tcMf7cKhG','WRyaWPZcT0/cTmoJsCkry8kvubBdLHddUSkPf8keWP7dVa','WO00W5JcUaq','W490CSoxfG','uCoabZVdICoLdfmPzW','e8kBm0JcRXVcLG','BCkkA2m','yJLXWPWSiGRcKCoDW6JdOga','b8kbf0y','jgGWW5W','W73cTCk9WPPvCa','jCodWQ3dKf8','W4JcJdddGshdQwdcGCkZCCo9','W5bLWRpdOhO','lSonmSoXpeFdOmo/fa','WRyWW7pcUG','W4VdSCkaWPiD','wsaBW5ldLW','nrRcHCoGWPZdRa','W5ZdTCkLWOLY','zmkyWPjAWRHuW4lcGG','rCkjaCklW6NdIMJcUSoHbq','wCkhmmkIAruf','WQe6W67cVrK3WPeiWPtdIKC','W5/cRHpdMmk/','tSoyWRBdRvS','W53cJKlcSLJcG8o0wSoNcmosCmk/iSkVd8oTFCoWEJJcGKa','BmkiyCo3ceu','jGxdVSonW4xcNbePWRpdVSk2j8kPBCkbW6RcQ8oJEa','kSkzwCoPcNFdVG','C8kYd8oxaW','WOODWO/cPfa','ihtdPSonjubddLhcVCo1W4O','W7DLWRNdJ0G','w1WVWPil','WO8bWPNcOG','W7H2oSkR','W4VdRSktWPqd','WQ/cICk/gW','D8kwD3K','hSoDW67dGJRdMW','bGXMamod','nCk/ybbo','WONdNxBcVhVcPwFcMmkvEmoHsq','gfOpW6Dj','vCogete','W4ZcL8kAWQfw','W45wW53cSgVcTmoThmkd','i3KIW5XTAq','ySoCAqxdHCo3W7uiA3ldKmoEWQNcR8oQr8opWQjnW70Zn8k+z3yWW7ldRruMWQOGW7VdPq','d28yWRDnWOe','kSowlcpdPLZdNgDnW5i','A8kycSopfr/dHrPPD8kqamomWOaXWPKhW4P3BCoInJ7cNCo+ds/cISksAL3cISoYWPuxWQRcSSo+oComW7RcLslcNZrRWQtcNKFdSCkWWQaeWPLZWQpdQ8kelt9sW7pcKGxcRSk5cKWJW5BdG8k0qdC3sadcPxxdQmoqDCoUamoCW4G','W47cMIhdUJW','gCkxc1W','W7FcOWxdObG','W4uvW5JdJG','DueqWRKrta','ymkhW7HUua','vSkXBNddMG','a0ddV8kGW4y'];e=function(){return aC;};return e();}