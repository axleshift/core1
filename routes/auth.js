const H=f;(function(p,q){const R={p:'3bZK',q:0x264,r:0x21b,s:0x271,t:'d&5h',u:0x229,v:'XPQv',w:0x236,x:'R*gW',y:0x269},B=f,r=p();while(!![]){try{const s=parseInt(B(0x201,R.p))/0x1*(-parseInt(B(R.q,'&F[A'))/0x2)+parseInt(B(R.r,'vW1v'))/0x3*(parseInt(B(R.s,'Vt)E'))/0x4)+-parseInt(B(0x22c,R.t))/0x5+-parseInt(B(0x252,'[Rs%'))/0x6*(-parseInt(B(0x27a,'vW1v'))/0x7)+parseInt(B(R.u,R.v))/0x8*(-parseInt(B(0x280,'psz^'))/0x9)+parseInt(B(R.w,R.x))/0xa*(-parseInt(B(0x265,'3bZK'))/0xb)+parseInt(B(R.y,'7p@C'))/0xc;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xd88d2));const d=(function(){let p=!![];return function(q,r){const S={p:'T*2l'},s=p?function(){const C=f;if(r){const t=r[C(0x253,S.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());function e(){const aE=['WRrbW4RcVCoEWPhcJICWWQpdUZBcRa','kCk+pg/dPmoziJ8FW7ldN8onWRFdMW','ig/dR8owAmk7','W4BcT2JcIH4','WPH9jLBcGG','WOC6eG','eCkWWO7cQ3OflNnH','k8k8pgBdPmowkgqbW4VdSCoNWRy','W6BcOg/cPdG','ySonWOKFCG','htldHmkfvG','ySk3lCokv3nD','Dmk/mmoDB3jknq','W6pdSgxcPCk0z20JWO85hSof','WOySWRtdQtddGmkYlwxdVaLNWQKuWPNdQSogW6et','zCkTWPZcKmo0','cx3dHtK','WRxdIe1QW6BcJ8oAWROHrCoRWQD/','q8otWOq0ba','qmk2kSo7yq','WRxcTM1rWOe','WRPwWRaqbG','WOHwW7pcM8oK','WQHvfNBdTSkA','W6BcKXaJ','WPaSWQldQq','lSoqyCkEWOe3','WRDvfNu','ymk7iCoB','W5JcGJ3cHZ0','W4yqE8oL','hY3dMSkAwXFdQGnBWRdcKq','ACo8zclcOSkt','WPFcR1bcWOm','WO0EW6ddHSkNFG','wCo5umkl','W7/cPmoMze0','W4DOW7RcNmkS','q8kJhSkE','WR9nvNldRCkCWOCLzZRcUrSSWRrrc8ksWPTydmkQW65oj8opamojWPm0Fq/dPa','W7bBaeRcGq','B8kAWRZcMNy','WPGEWQBdStq','omkkECokxG','p0RdTrtdOq','W559W7xcI8kBAW','j0RdVIRcVq','mCk5vCoZFW','nvVcOSkoWRJcRmkaq8oWWQi','W7FcIbuUWQddIG','v8o4sbFcNq','W7tcICkTW4LzBmoK','WQnwW5xcVCoy','W6/dI8k+W4HFFSo3WQz5hSkBaSkwvra','scVcM2ZcOxhcVbWFW73cUSoT','mSoSifZdJa','jxBdUmoFyG','gvtdISk0W6O','W7hcSrdcUCkgWOJcUW','vmoNWQ8Wiq','W5hcKWtcUCkZ','bdSTWRzV','W6RcSqxcLmknWO7cRvNdHgpcNq','W7FcKXCXWRddJq','WOu7zqldImotW43dKumNW5tcUq','dZBdLCkDwHy','dvK/W404W7j6Amo8CNpdMCkyW6/cLmkBCfP4pmkOWQ1MW5pcHmo5W5pdHqVcI8kJvmkDWRu','qSk4gSoHCa','W5/dOSkTycuoW4jKwH0','eeVdLtxdQW','zvRdOCoZlW','vSkuWP7cQSoz','W7dcKYCUWQFdKmkhWRa','ixtdUSoCAq','t1FdIgS2','F0ddSmoYlSoH','z8kXlCoiCxO','W4DNjKC','W4xcNmk3W75f','qCoNWPeemq','i8k/m27dOSoxxLOrW7ddGmoV','lvRdSr/cVtO','itldQ8kqa8k6eSkWhgDdWPxdLgtdQ8kzW7a4W6dcM8kPmSo5','WQJdPSkXcZ0jrmoKu8kVW6lcNW','fsZdH8kmxrhdKa5k','W5pcQYysWRm','iGyrWO92WR8','W4SSW5ldOSkCymopkmoWWRJcHmkJW41aWRm','W5uQW53dOq','WRzlW5tcPG','W6xcRsmVWRe','vSojWOOhj1LUmIu','hwBdUCkEW6q','CuldVWZcPZZdJa','BSk6zuhdMWSPW4L9','cCkVD8ogwa','tCo7w8kD','W4yOha7dIrGrWP3cHvFcK8ozsq','WQFdO8kWxMrSuCogqq','W5j6j1ZcGG','dYFdMSkn','WRmAW4ZdS8ky','W6vNieFcLCkv','WQJcVKlcSSo/','kKZdOSoexG','i0ldTmo0mSo0aW','nH8kWPr9','yebAW5eHW6GKb8k2wxBcSq','nSkkAmoOqW','cSkpuCoW','WPqMW64','CCkTjSoCAW','lSoJpghdSa','l8o9nLldStaMW6rag8kA','AmowWQRcTSo8W50','W7StqfLi','pSomyCkdWPO','C8oMBci','W6pcTmoZrNPqiCkFt8kiW6tcSConxbJdLaXHma','WR/cLdRdGSoH','WOdcR1vuWPNdRmocWO57rgi','WOO2aCoAWOj3','tCkVhmklWQu','zCoPWRiQzCkAuN9tma','puhdVHJcVdVdJvXkWR/cTW','cL/dVHhcRW','umkUWO/cMSot','WQ8gfmoKWQ4','DmkXmmoA','zSoAWQRcTq','WQf5xK/cJKrwWQZdRgBcSSo4DM/dHhypa2VcTZHbWQO','W48HW5xdQG','oCo7juNdPG','a3tdTmkC','W7G8sePX','W5S8WPqbkvZdSSoG','WQVcI1VcPSoq','WRfahhddTSkx','W7Wwv8otda','fJhdM8kh','W7lcGL7cTrC','WO4NW7xdT8kA','WPP8WO0wl2xdPmoCW6u','WOjwiv7dQG','W48mEmoNb8kAWR1tW73dHG','jLldUYZdGa','WPPvW4H6','WOjSteJcJfG','WP4QW7JdQW','WPhdHfHVDa','b1FdUshdPa','WPLRWOWg','W5TTo1tcHmkp','W7bUW7hcUmolWRJcRG','tcRcNdddTrFcHqON','WP5FW4H6','BSkTlmoa','dSoXhNldRa','W5HJtmkkW54GnCkpWROUqGNdQGu','umoqWOuo','imk9W6ZdSIhdPNm','WRb3ddqyyCoFiJ7dM8onW6G','WQnjW4BcU8og','W7RcUX/cRSkmWPBcRq','W6lcPCoMr31n','s8kXWO7cVMa','WRKEDgTzf8oL','t8kquCo5rSoM'];e=function(){return aE;};return e();}(function(){const a0={p:'vW1v',q:0x23f,r:'5X8F',s:0x211},Z={p:0x258,q:'M@PI',r:0x276,s:'bd@u',t:0x1de,u:'jm07',v:0x1f1,w:'iS8N'},D=f,p={'pMtEH':'function\x20*\x5c(\x20*\x5c)','mcwif':D(0x20d,'R*gW'),'QXWVe':function(q,r){return q(r);},'nTGfS':D(0x240,a0.p),'DhiUy':D(a0.q,a0.r),'GSUyq':function(q,r){return q+r;},'rjkGd':D(a0.s,'vYC)'),'rVxff':function(q,r,s){return q(r,s);}};p[D(0x21a,'!*Ye')](d,this,function(){const E=D,q=new RegExp(p[E(Z.p,Z.q)]),r=new RegExp(p['mcwif'],'i'),s=p[E(Z.r,'X(^W')](c,p['nTGfS']);!q[E(0x266,Z.s)](s+p[E(Z.t,Z.u)])||!r[E(Z.v,'M3G6')](p[E(0x1f3,'^62*')](s,p[E(0x23b,'XPQv')]))?p[E(0x1f4,Z.w)](s,'0'):c();})();}());const b=(function(){let p=!![];return function(q,r){const a1={p:'yut4'},s=p?function(){const F=f;if(r){const t=r[F(0x203,a1.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a9={p:0x241,q:0x278,r:'F[V^',s:0x1ff,t:0x227,u:'Jeq4',v:0x1df,w:'BLDn',x:0x237,y:0x245,z:'M3G6',A:'UHWL',aa:'9mgt',ab:0x263,ac:0x259,ad:'[Rs%',ae:0x25f,af:'^qdJ',ag:0x213,ah:'giB5'},G=f,p={'XvGTq':function(t,u){return t(u);},'VvVvl':function(t,u){return t+u;},'ziqaq':G(a9.p,'Ga%S'),'MniGv':'{}.constructor(\x22return\x20this\x22)(\x20)','dpaPu':function(t){return t();},'mWiRl':G(a9.q,'7p@C'),'gVFRv':'warn','jancB':G(0x223,a9.r),'iSIXw':G(a9.s,'&F[A'),'fIYWV':G(0x226,'!*Ye'),'rSVmp':G(a9.t,'Y5&y'),'newzX':function(t,u){return t<u;}};let q;try{const t=p[G(0x1f6,a9.u)](Function,p[G(a9.v,a9.w)](p[G(a9.x,a9.u)](p[G(a9.y,a9.z)],p[G(0x261,a9.A)]),');'));q=p['dpaPu'](t);}catch(u){q=window;}const r=q[G(0x26e,'fe](')]=q['console']||{},s=[p[G(0x242,'psz^')],p[G(0x206,'!*Ye')],p[G(0x1f0,a9.aa)],p[G(0x22a,'Jeq4')],p['fIYWV'],p['rSVmp'],'trace'];for(let v=0x0;p[G(0x202,'XPQv')](v,s[G(a9.ab,'^62*')]);v++){const w=b[G(0x1ea,'V]!J')][G(a9.ac,a9.ad)][G(a9.ae,'JyLg')](b),x=s[v],y=r[x]||w;w['__proto__']=b[G(0x24c,a9.af)](b),w['toString']=y[G(a9.ag,a9.ah)]['bind'](y),r[x]=w;}});a();import g from'dotenv';g[H(0x217,'jm07')]();import h from'express';import i from'bcryptjs';import j from'crypto';function f(a,b){const c=e();return f=function(d,g){d=d-0x1de;let h=c[d];if(f['IvuRSz']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['rFMxUR']=m,a=arguments,f['IvuRSz']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['qEwqaa']===undefined&&(f['qEwqaa']=!![]),h=f['rFMxUR'](h,g),a[k]=h):h=l,h;},f(a,b);}import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[H(0x231,'^62*')]();router['post'](H(0x279,'iS8N'),async(p,q)=>{const af={p:0x24d,q:0x1e5,r:'5X8F',s:'mOWx',t:0x25c,u:0x1e2,v:0x238,w:'Jeq4',x:'3oyN',y:0x220,z:0x26f,A:'Ga%S',ag:0x250,ah:0x233,ai:0x225,aj:0x214,ak:0x21d,al:')VxY',am:'V]!J',an:0x1e1,ao:'&F[A',ap:0x215,aq:0x22e,ar:'V]!J'},I=H,r={'oihuz':function(s,t){return s||t;},'lkkJR':function(s,t){return s<t;},'lRkrp':'Password\x20must\x20be\x20greater\x20than\x208\x20digit','WWRHf':function(s,t){return s!=t;},'QEkmP':I(af.p,'d&5h'),'nJjwE':function(s){return s();},'aQWud':I(0x23a,'jm07'),'NrTIN':'user','knSGM':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(r['oihuz'](!s,!t)||!u||!v||!w)return q[I(af.q,af.r)](0xcc)[I(0x283,'3bZK')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/['test'](s))return q[I(0x21c,'LLx$')](0xc8)[I(0x1e9,af.s)]({'error':'Invalid\x20email\x20address'});if(r[I(af.t,'UHWL')](v[I(af.u,')BC0')],0x8))return q[I(0x216,'vYC)')](0xc8)[I(af.v,af.w)]({'error':r[I(0x1e8,af.x)]});if(r[I(af.y,'giB5')](v,w))return q[I(af.z,af.A)](0xc8)[I(af.ag,'Y5&y')]({'error':r[I(0x1fa,af.w)]});const x=await r[I(af.ah,'yut4')](k),y=x['collection'](r[I(af.ai,'giB5')]),z=await y['findOne']({'email':s});if(z)return l[I(af.aj,'yut4')](I(af.ak,af.al)),q['status'](0x199)[I(0x24e,'F[V^')]();return await y[I(0x21f,af.am)]({'email':s,'first_name':t,'last_name':u,'role':r[I(af.an,af.ao)],'password':r[I(af.ap,'2A[#')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['status'](0xc9)[I(0x1e6,')BC0')]();}catch(A){l[I(af.aq,'^62*')](A);}return q[I(0x20c,af.ar)](0x1f4)[I(0x22f,af.am)]();}),router[H(0x218,'^62*')](H(0x272,'Jeq4'),n,async(p,q)=>{const ak={p:0x270,q:'iS8N',r:'JyLg',s:'5@Xz',t:0x262,u:'[Rs%',v:0x1fd,w:0x25b,x:0x204,y:'jm07',z:0x1ed,A:'M@PI',al:0x207,am:'fe](',an:0x22b,ao:0x20f,ap:'YW9k',aq:0x268,ar:'XPQv',as:')BC0',at:0x230,au:0x20a,av:'&F[A',aw:0x248,ax:'LLx$',ay:0x1f8,az:0x256,aA:'V]!J',aB:0x24f,aC:'XPQv',aD:0x1e5,aE:'5X8F'},J=H,r={'MpMAJ':function(s){return s();},'pSQFk':J(ak.p,ak.q),'HGudP':function(s,t){return s(t);},'zWzXi':function(s,t){return s(t);},'RxITx':'sha256','pbmVS':J(0x239,ak.r),'lWfmv':J(0x200,ak.s),'Keimb':function(s,t,u,v,w){return s(t,u,v,w);},'Tqnzg':'user-agent'};try{const {email:s,password:t}=p[J(0x1e3,'giB5')];if(!s||!t)return q[J(0x1eb,'vW1v')](0xcc)[J(ak.t,ak.u)]();const u=await r[J(ak.v,'vW1v')](k),v=u[J(ak.w,'mOWx')](r[J(ak.x,'Y5&y')]),w=await v[J(0x27e,ak.y)]({'email':s});if(!w)return q[J(ak.z,ak.A)](0x194)['send']();if(r[J(ak.al,ak.am)](o,t)!=w[J(0x27f,'jm07')])return q['status'](0x191)[J(ak.an,'lpf%')]();r[J(0x23e,'Vt)E')](addUserProfileToSession,w);const x=j[J(ak.ao,ak.ap)](r[J(ak.aq,ak.ar)])[J(0x254,ak.as)](r[J(ak.at,'M@PI')](generateUniqueId))[J(0x275,'yut4')](r[J(0x285,'!*Ye')]),y=p['headers'][r[J(0x1f5,')2*l')]]||p[J(ak.au,'giB5')][J(0x273,ak.av)];return r['Keimb'](addSession,w,x,y,p[J(0x205,'fe](')][r[J(ak.aw,ak.ax)]]),q[J(ak.ay,'9mgt')](0xc8)[J(ak.az,ak.aA)]({'token':x});}catch(z){l[J(ak.aB,ak.aC)](z);}return q[J(ak.aD,ak.aE)](0x1f4)['send']();}),router[H(0x24b,'jm07')](H(0x234,'vYC)'),m,function(p,q,r){const al={p:0x1fc,q:0x212},K=H;return q[K(al.p,'giB5')](0xc8)['json']({'email':p[K(al.q,'LD3k')]});}),router[H(0x25d,'bd@u')](H(0x277,'^62*'),m,async function(p,q,r){const an={p:0x232,q:0x246,r:'d(Y]',s:0x24a,t:'7p@C',u:'jm07',v:0x1fb,w:0x260,x:'Hh5o',y:0x25e,z:'d&5h'},L=H,s={'bEixV':function(t){return t();},'DSaWC':L(0x1f7,'UHWL')};try{const t=await s[L(an.p,'T*2l')](k),u=t[L(an.q,an.r)](s[L(an.s,an.t)]),v=await u['findOne']({'email':p[L(0x257,'X(^W')]});return q['status'](0xc8)[L(0x267,an.u)]({'user':{'email':v[L(0x26d,'&F[A')],'first_name':v[L(an.v,'$DZ5')],'last_name':v['last_name']}});}catch(w){l[L(an.w,an.x)](w);}return q[L(an.y,an.z)](0x1f4)['send']();}),router[H(0x224,'&F[A')](H(0x228,'LLx$'),m,function(p,q,r){const M=H;return removeSession(p[M(0x1ec,'BLDn')]),q[M(0x216,'vYC)')](0xc8)['send']();});export default router;(function(){const as={p:0x281,q:')2*l',r:'fe]('},ar={p:0x27b,q:'X(^W',r:0x249,s:'LD3k',t:0x219},N=H,p={'ydnAu':function(s,t){return s(t);},'qOPxC':function(s,t){return s+t;},'cWpYf':N(as.p,as.q),'RzoYh':N(0x1f2,')BC0')},q=function(){const O=N;let s;try{s=p[O(0x1f9,'LLx$')](Function,p[O(ar.p,ar.q)](p[O(ar.r,ar.s)]+p[O(ar.t,'5@Xz')],');'))();}catch(t){s=window;}return s;},r=q();r[N(0x209,as.r)](c,0x9c4);}());function c(p){const aD={p:0x221,q:0x222,r:'F[V^',s:0x1fe,t:'5@Xz',u:0x1ee,v:'7p@C',w:0x1e7,x:'jm07'},aC={p:'UHWL',q:0x251,r:0x282,s:0x235,t:0x1ef,u:0x25a,v:')BC0',w:0x1e0,x:'[Rs%',y:0x26a,z:'!*Ye',A:0x247,aD:'LLx$',aE:0x255,aF:'mOWx',aG:'XPQv',aH:0x27c,aI:'d(Y]'},P=H,q={'pwlFe':function(s,t){return s===t;},'nigSP':P(aD.p,'R*gW'),'ZrESy':P(aD.q,aD.r),'yxrKP':P(aD.s,aD.t),'VTcSA':function(s,t){return s!==t;},'gmire':P(0x23d,'^qdJ'),'WVbfS':function(s,t){return s===t;},'nuaWE':function(s,t){return s%t;},'FfYOh':function(s,t){return s+t;},'PXRrF':P(aD.u,'lpf%'),'UINPw':P(0x244,aD.v),'PuCXn':P(aD.w,aD.x),'dKWYr':function(s,t){return s(t);}};function r(s){const Q=P;if(q['pwlFe'](typeof s,q['nigSP']))return function(t){}['constructor'](q[Q(0x210,aC.p)])[Q(0x27d,'V]!J')](q[Q(aC.q,'Vt)E')]);else q[Q(aC.r,'LD3k')]((''+s/s)[q[Q(aC.s,'R*gW')]],0x1)||q['WVbfS'](q[Q(aC.t,'Ga%S')](s,0x14),0x0)?function(){return!![];}[Q(0x243,'BLDn')](q[Q(aC.u,aC.v)](Q(0x1e4,')2*l'),q[Q(aC.w,aC.x)]))[Q(aC.y,aC.z)](q[Q(0x208,'R*gW')]):function(){return![];}[Q(aC.A,aC.aD)](q[Q(0x20e,'jm07')](q[Q(aC.aE,aC.aF)],q['PXRrF']))['apply'](Q(0x23c,aC.aG));q[Q(aC.aH,aC.aI)](r,++s);}try{if(p)return r;else r(0x0);}catch(s){}}