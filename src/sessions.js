(function(j,k){const G={j:0x161,k:'3)(8',l:0x1b3,m:0x1bb,n:'k!#J',o:0x16d,p:0x166,q:'4EEn',r:0x1b5,s:'ShTp',H:'fDSx'},t=f,l=j();while(!![]){try{const m=parseInt(t(0x159,'^qHS'))/0x1+-parseInt(t(0x1a7,'2D4O'))/0x2*(-parseInt(t(G.j,G.k))/0x3)+parseInt(t(G.l,'Y)3b'))/0x4*(parseInt(t(G.m,G.n))/0x5)+parseInt(t(0x195,'9!mI'))/0x6*(-parseInt(t(G.o,'O*Z4'))/0x7)+-parseInt(t(G.p,G.q))/0x8*(parseInt(t(0x1b6,'9!mI'))/0x9)+parseInt(t(G.r,G.s))/0xa+-parseInt(t(0x17f,G.H))/0xb;if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0xe95e6));const d=(function(){let j=!![];return function(k,l){const m=j?function(){const u=f;if(l){const n=l[u(0x19b,'Y)3b')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const P={j:0x169,k:'fzmn'},O={j:'(c&9',k:0x15c,l:0x173,m:'fDSx',n:0x1a9,o:'xS(@',p:'8LGB'},v=f,j={'WaXjQ':function(k,l){return k+l;},'vPtfL':v(P.j,P.k),'iNlrd':function(k,l){return k(l);},'jSQjc':function(k,l,m){return k(l,m);}};j['jSQjc'](d,this,function(){const w=v,k=new RegExp(w(0x180,O.j)),l=new RegExp(w(O.k,'5eu2'),'i'),m=c('init');!k[w(O.l,'P8bY')](j[w(0x15b,O.m)](m,j[w(O.n,O.o)]))||!l[w(0x17b,'ml2V')](j[w(0x19c,O.p)](m,'input'))?j['iNlrd'](m,'0'):c();})();}());const b=(function(){const Q={j:0x186,k:'Tm9O'};let j=!![];return function(k,l){const m=j?function(){const x=f;if(l){const n=l[x(Q.j,Q.k)](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const W={j:0x193,k:0x170,l:'k!#J',m:0x18d,n:'K5k$',o:'5eu2',p:0x19a,q:'m&ZE',r:'K5k$',s:0x15e,X:'pg0p',Y:0x19f,Z:'Tm9O',a0:'ml2V',a1:'ICpC',a2:'8LGB',a3:0x164,a4:'%$nQ',a5:0x179,a6:'&uXS'},y=f,j={'QloFi':function(n,o){return n+o;},'GCrjd':y(W.j,'WgNU'),'Vbsie':y(W.k,W.l),'xabUo':y(W.m,W.n),'yQdjZ':'trace','BbKoO':function(n,o){return n<o;}};let k;try{const n=Function(j[y(0x188,W.o)](j[y(W.p,'%$nQ')](j[y(0x191,W.q)],y(0x18f,W.r)),');'));k=n();}catch(o){k=window;}const l=k[y(0x16f,'q0aw')]=k['console']||{},m=[y(W.s,'wGh3'),y(0x1a8,'q0aw'),y(0x1bf,'9!mI'),j[y(0x1aa,W.X)],'exception',j[y(W.Y,'pg0p')],j[y(0x197,W.Z)]];for(let p=0x0;j[y(0x1a3,'URZ]')](p,m[y(0x1bc,W.a0)]);p++){const q=b[y(0x176,'Q^R*')]['prototype'][y(0x165,W.a1)](b),r=m[p],s=l[r]||q;q[y(0x18e,W.a2)]=b[y(W.a3,W.a4)](b),q[y(W.a5,'%$nQ')]=s[y(0x1af,W.a6)][y(0x190,'9!mI')](s),l[r]=q;}});function e(){const aj=['W74/A8kGWOe','WRJdSSkrDmo1','j8oXWPZdNMu','zmo3hw/cIq','qx7cHGCIBCkHW5K','x1XBy8ol','uH4lW6iFAKldQHC','ueaxBmobWPqdW5q3waBdSrxcRXPIzmoaWOPmW6ldKLuKhCknp23cLfK/W6q','W50IWPqn','kMNcHrJdTW','WPa6WOddHuW','WRNcTCkrd8kAW6RdOHdcKSkucsnqW5NdRmkLWQxcVCoZ','W5OaWP0VW4e','WO19W4jqWPpdMSo9afPNWO/dUCk9','FCkpW4RdVW','s0RcKr4r','xNRcHGauBmkUW4FcMW','ASk6W7dcTW','d2m4k08','iSoeWOBdONu','wIaJW7OH','W7FdU0pcH8kvBmogWQJdOsVdPdpdPsy','W7tdNCkJaci','W7P2rmkKWPq','WRlcLXldUqm','WQJcPqm','WQqNlvyG','WQvvWPBdJMe','W6W8wNtcLvJdKtRcSmkIDs3cGW','r8ocg2Wvm8krW7lcLb4ngWG','FCkbW4RdV09nW5/dVHZdQq','W6C/WOJdLeHEWQ0','ACoxxCoJ','cvbFhxO','W5r1vCkyWP4','WRdcVqRdPqrEW4q','WQeGpCotfa','xb7dG0BcOYtcGcddRSohuq/dTW','WOiBWPCYpwbstSo7ACkKlKK','ydWUuuVdJmofW5a','C8oFhq','WRpcPHBdRJK','b8kowZfdzq','D8oLWRddM0jeWOO','W51gWOnGW5y','WRybW6pdLSk8WRlcHMzrW6hcR0LsWOS','WO56W45BWP/dLSo0Fh5kWOBdI8k2mW','WPWyA8kCW60','WQOQfCoabq','mvhdRfbv','WRlcSqBdTa','WPDznNBcT8kHCqtdUfzWW4Xs','DmoqW5xdOSkBW4m','CrShvfi','W5ebAgiq','W5yLWPWg','pKFdK1jQWONdJ8kGWRSX','lK3dJe1MWOxdLCk6','k8oQFCokWQ4pW6JcS8koWPtcH8kqzau','WRydbL0G','W7NdOgRcSmo4kCkjWQe','ctP+W604W78IWPyEW6icWRVcMq','W6zaWQtcJCo3','cKNdP1rE','W7n4wmonW4JdHhnaW7hcHIJcQCkTW7hcVMhcGh3cSsHmW5ZcR8o1W5aLWRuqsCknEmknW5RcTW','Dsmnsua','FJqu','W7ilsfC5tSoP','WQaCWRFdG0S','pSoLWQFdSqFdGCkhWOtdJ8kiW7ldTMG','W6tcHILwWRC','W67cSZr7WQddKa','pgy5cq','WPZdRmklqG','W6zjiIhdGaZcSG','AmkVW6FcQK0','ctldP8kkxq','WPmfbmocaa','WOiieCoEhdZcM8k2WPXpWPVdISolWPJdOIZdICkwWQS','W4LwW49/yrWgFCohA8kB','W63dM8kRjdu','W5dcHmkarSonuhSx','WQaRa8k/','FCozqCo+ECoiFa','W4aFCIVdTq','lmoFW4FdINLlW77dUa','W4LhW514BtWkza','pXxdUhS','nmoCWP/dOMKpW5JdGmoMWQH8WRLYWQZcPq','E8o1WRJdQwLoWQy','cLG9W7LxxLtcPKrcW4m','W5yLWOKmW5xcM8kki3O','WRTGmrBdLmkm','kMaegvtdHmoEWRC','lmkXsJbj','BmoqW4JdSq','WRyaWRZdGKX0WQjSuIxdRW','WOfEWRpdHwewya','WRJdLupcPSoHhSkD','zrhcHGC2W5NcJCkqWO0+W4Dsqa','W6XTtr7cNSkdWQBcN3FdLwK3WOVdQmkiW4G','WOBdJmkWsCo9','WRa8k1C5','BSkYW7NcQvRcK8ohWOtdRCkL','WOBdKmkdAG','AxNdUwTbWOhdGq','u2VcHrGY','W6NdQNFcSmoLnmksWRfcWPtdMq'];e=function(){return aj;};return e();}a();import g from'fs';import{ObjectId}from'mongodb';import h from'../models/db.js';import i from'../src/logger.js';export const addSession=async(j,k,l,m)=>{const Y={j:'fDSx',k:0x157,l:'@[7)',m:0x177,n:'qtP!',o:'NDW('},z=f,n={'GWrov':function(o){return o();},'cRLcu':z(0x1c1,Y.j)};try{const o=await n['GWrov'](h);await o['collection'](n[z(Y.k,Y.l)])[z(Y.m,'9!mI')]({'user_id':j['_id'],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[z(0x1a1,Y.n)]()});}catch(p){i[z(0x1b7,Y.o)](p);}};export const getUser=async j=>{const a0={j:0x160,k:'2D4O',l:'fDSx',m:'3)(8',n:0x181,o:0x1a6,p:'R@n1',q:'9!mI',r:0x1b0,s:'eT@V',a1:0x182,a2:0x16e,a3:0x1b1},A=f,k={'lySnZ':function(l){return l();},'dyQVc':A(0x172,'p7zC'),'eKgFf':A(a0.j,a0.k)};try{const l=await k[A(0x1b9,a0.l)](h),m=await l[A(0x183,a0.m)](k[A(a0.n,'O*Z4')])[A(0x15f,'!Rxl')]({'token':j});if(!m)return null;const n=await l[A(a0.o,a0.p)](k[A(0x194,a0.q)])[A(0x17d,'URZ]')]({'_id':m['user_id']});return{'_id':n[A(a0.r,a0.s)],'email':n[A(a0.a1,'@[7)')],'first_name':n['first_name'],'last_name':n[A(0x198,'Tm9O')],'role':n[A(a0.a2,'iL1h')]};}catch(o){i[A(a0.a3,'TApK')](o);}return null;};export const removeSession=async j=>{const a1={j:0x1a0,k:'TApK'},B=f,k={'dCvxH':B(0x18c,'Tm9O')};try{const l=await h();await l[B(0x1c0,'fDSx')](k[B(a1.j,a1.k)])['updateOne']({'token':j},{'$set':{'active':![],'last_accessed':Date['now']()}});}catch(m){i['error'](m);}};export const isActiveToken=async j=>{const a3={j:'G7d[',k:'TApK',l:'7cUO',m:0x167,n:'3)(8'},C=f,k={'QMXxz':function(l){return l();}};try{const l=await k[C(0x1ac,'fzmn')](h),m=await l['collection'](C(0x158,a3.j))[C(0x1ab,a3.k)]({'token':j});return m[C(0x178,a3.l)];}catch(n){i[C(a3.m,a3.n)](n);}return![];};function f(a,b){const c=e();return f=function(d,g){d=d-0x157;let h=c[d];if(f['rNcuOc']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['qAgOIy']=m,a=arguments,f['rNcuOc']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['rILepu']===undefined&&(f['rILepu']=!![]),h=f['qAgOIy'](h,g),a[k]=h):h=l,h;},f(a,b);}function c(j){const af={j:'Y)3b',k:0x199,l:'3)(8',m:0x16b,n:0x162},ae={j:'2D4O',k:0x192,l:'%bAd',m:0x1a2,n:'@[7)',o:0x1be,p:'!Rxl',q:'&uXS',r:'Wknt',s:'%bAd',af:0x1ba,ag:'G7d[',ah:0x1b8,ai:0x15d,aj:'eT@V'},D=f,k={'YGTEn':function(m,n){return m===n;},'XKchd':D(0x1b2,'sJEk'),'EURtt':D(0x174,af.j),'JLNnQ':'counter','ZWLKs':function(m,n){return m!==n;},'qvghu':function(m,n){return m+n;},'EcNQf':function(m,n){return m/n;},'eHzqk':'length','XvjIs':function(m,n){return m===n;},'SJFJF':function(m,n){return m%n;},'ZGpkk':D(af.k,af.l),'PxOgn':D(0x184,'O*Z4'),'HAdoT':D(af.m,'p7zC'),'kViDx':function(m,n){return m(n);}};function l(m){const E=D;if(k[E(0x168,'C@Bq')](typeof m,k[E(0x17a,'sJEk')]))return function(n){}[E(0x17c,ae.j)](k[E(ae.k,ae.j)])[E(0x15a,'ShTp')](k[E(0x19e,ae.l)]);else k['ZWLKs'](k[E(ae.m,ae.n)]('',k[E(ae.o,ae.p)](m,m))[k[E(0x1bd,ae.q)]],0x1)||k[E(0x1b4,ae.r)](k[E(0x16c,ae.s)](m,0x14),0x0)?function(){return!![];}['constructor'](k['qvghu'](E(ae.af,'TApK'),k[E(0x189,'O*Z4')]))[E(0x196,'R@n1')](E(0x163,'59Hi')):function(){return![];}[E(0x187,ae.ag)](k['PxOgn']+k[E(ae.ah,'fzmn')])[E(ae.ai,'&uXS')](k[E(0x18b,ae.aj)]);l(++m);}try{if(j)return l;else k[D(af.n,'59Hi')](l,0x0);}catch(m){}}(function(){const ai={j:0x16a,k:'fzmn',l:'Y)3b'},F=f,j={'KBoCh':function(l,m){return l(m);},'agwms':function(l,m){return l+m;},'dEjPi':F(ai.j,ai.k)};let k;try{const l=j['KBoCh'](Function,j['agwms'](j[F(0x18a,ai.l)]+'{}.constructor(\x22return\x20this\x22)(\x20)',');'));k=l();}catch(m){k=window;}k['setInterval'](c,0x9c4);}());