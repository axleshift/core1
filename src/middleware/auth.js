(function(h,i){const C={h:0xfa,i:'OWU0',j:'Jlr!',k:'Lc53',l:'3InT',m:0xf7,n:0xf9,o:'NFL^'},r=f,j=h();while(!![]){try{const k=-parseInt(r(0xb2,'mV1n'))/0x1+-parseInt(r(C.h,C.i))/0x2+parseInt(r(0xfe,'%oeJ'))/0x3+-parseInt(r(0x102,C.j))/0x4+parseInt(r(0xbc,C.k))/0x5*(parseInt(r(0xf3,'WnE6'))/0x6)+parseInt(r(0x110,C.l))/0x7*(-parseInt(r(C.m,'^VE6'))/0x8)+parseInt(r(C.n,C.o))/0x9;if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0xf3f6a));const d=(function(){const D={h:'x&yY'};let h=!![];return function(i,j){const k=h?function(){const s=f;if(j){const l=j[s(0xce,D.h)](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());(function(){const N={h:0xb1,i:'x&yY',j:'^VE6'},M={h:0xde,i:0xcc,j:'OWU0',k:0x107,l:'g6)j',m:0xe5,n:'OWU0',o:0xe7,p:'9K@)'},t=f,h={'vVaed':t(N.h,'Y@#)'),'lPrlb':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','HQoal':function(i,j){return i(j);},'FGXyA':t(0xba,'TpA&'),'YOEBp':function(i,j){return i+j;},'gENTm':t(0x10d,'NFL^'),'cshRs':t(0x113,N.i),'sCMpJ':function(i,j){return i(j);},'ytTDU':function(i){return i();},'ktcMe':function(i,j,k){return i(j,k);}};h[t(0xf6,N.j)](d,this,function(){const u=t,i=new RegExp(h[u(0xb7,'Lc53')]),j=new RegExp(h[u(0xd7,'bW2G')],'i'),k=h[u(0xf4,'twg]')](c,h[u(M.h,'V3au')]);!i[u(M.i,M.j)](h[u(0xc5,'^zgi')](k,h[u(0xbf,'l%*K')]))||!j[u(M.k,M.l)](k+h[u(M.m,M.n)])?h[u(0xc8,'OFmr')](k,'0'):h[u(M.o,M.p)](c);})();}());const b=(function(){let h=!![];return function(i,j){const k=h?function(){const v=f;if(j){const l=j[v(0xf5,'3InT')](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const W={h:'7whM',i:0xe8,j:0xfc,k:0x114,l:'OWU0',m:0xf8,n:'X2rq',o:0x10f,p:0x106,q:0xfd,X:0xd5,Y:0xae,Z:0xc0,a0:0xc9,a1:'WnE6',a2:0xb0,a3:0x109,a4:0xea,a5:'mV1n',a6:0xe1,a7:0xfb,a8:'!Kw5'},w=f,h={'ZaguV':function(l,m){return l(m);},'gSYwB':function(l,m){return l+m;},'RBroI':'{}.constructor(\x22return\x20this\x22)(\x20)','MFcKP':function(l){return l();},'puFZH':w(0x101,W.h),'Dbdxf':w(W.i,'ulQ2'),'LfNoh':w(W.j,W.h),'EZgCL':w(W.k,W.l),'WfhYF':'table','dWgJl':function(l,m){return l<m;}};let i;try{const l=h[w(W.m,W.n)](Function,h['gSYwB'](h[w(W.o,'dHMm')](w(0xf2,'PizX'),h[w(0xd6,'$]d]')]),');'));i=h['MFcKP'](l);}catch(m){i=window;}const j=i[w(W.p,'!Kw5')]=i[w(0x105,'H#BM')]||{},k=[w(W.q,'Kcui'),h[w(0xe6,'M#^e')],h['Dbdxf'],h[w(W.X,'kuHw')],h[w(W.Y,'M#^e')],h[w(W.Z,'kuHw')],w(W.a0,W.a1)];for(let n=0x0;h[w(0xff,'OFmr')](n,k[w(0xc7,'bW2G')]);n++){const o=b[w(0xbe,'X2rq')][w(0xeb,'Jlr!')]['bind'](b),p=k[n],q=j[p]||o;o[w(W.a2,'775h')]=b[w(W.a3,'lETQ')](b),o[w(W.a4,W.a5)]=q[w(W.a6,'Kcui')][w(W.a7,W.a8)](q),j[p]=o;}});(function(){const Y={h:0xbd,i:'V3au',j:'Kcui',k:0xc4},x=f,h={'NNhfv':function(j,k){return j(k);},'DqDvR':x(0xe3,'twg]')};let i;try{const j=h[x(Y.h,Y.i)](Function,'return\x20(function()\x20'+h[x(0x112,Y.j)]+');');i=j();}catch(k){i=window;}i[x(Y.k,'dHMm')](c,0x9c4);}()),a();import{getUser,isActiveToken}from'../components/sessions.js';function f(a,b){const c=e();return f=function(d,g){d=d-0xae;let h=c[d];if(f['mSmkbA']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['izGeKB']=m,a=arguments,f['mSmkbA']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['kVlxcw']===undefined&&(f['kVlxcw']=!![]),h=f['izGeKB'](h,g),a[k]=h):h=l,h;},f(a,b);}import g from'../models/db.js';import{ObjectId}from'mongodb';const adminRoute=[],auth=async(h,i,j)=>{const a3={h:'#o$P',i:'H#BM',j:0xf1,k:'Lc53',l:'3InT',m:0xd4,n:0xcb,o:0xb8,p:'3InT',q:0xdc,a4:'NFL^',a5:'775h',a6:0xe2,a7:0xc1,a8:'k0$n'},a2={h:0xf0,i:'FZB[',j:'H#BM'},y=f,k={'iHVbs':function(p){return p();},'LXYug':'sessions','tKsBV':function(p,q){return p(q);},'EGpIg':function(p,q){return p!==q;},'eqjoh':'admin'},l=h[y(0xcf,a3.h)][y(0xed,a3.i)];if(!l)return i[y(a3.j,'$]d]')](0x191)[y(0xb5,a3.k)]();const m=l[y(0xe4,'^VE6')]('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/[y(0x108,a3.l)](m))return i['status'](0x191)['send']();const [n,o]=await Promise[y(0xca,'twg]')]([getUser(m),k[y(a3.m,'3InT')](isActiveToken,m)]);if(!n||adminRoute[y(a3.n,'N*w^')](h[y(a3.o,'g6)j')])&&k[y(0xee,a3.p)](n[y(a3.q,a3.a4)],k['eqjoh']))return i[y(0xb3,a3.a5)](0x191)[y(a3.a6,')hd9')]();if(!o)return i[y(0xda,'gvLG')](0x191)[y(a3.a7,'x&yY')]();return Promise['all']([((async()=>{const z=y,p=await k['iHVbs'](g);p[z(a2.h,'!Kw5')](k[z(0xbb,a2.i)])['updateOne']({'token':m},{'$set':{'last_accessed':Date[z(0xdf,a2.j)]()}});})())]),h[y(0x104,a3.a8)]=m,h[y(0xc2,')hd9')]=n,j();};function e(){const af=['WRxdRsVdTmkU','rLJdQSkSegVcRCoEgmo3W6K','WOWBWQxcKYddVW','WRVdJJTMoa','W5DeFmk2uq','W4vxEW','W7LkWOBdMI3cLqxcOa','hSkSWRZdTa','W6b0WQ/dVqi','WPZcS2XmW5G','W4TozvtcOL/cIa','W4vYBWDq','iaqIwfe','vJxdTY4e','WQr2mhCSf8oaWP7dKwaM','W7NdMmo1cKO','imoQD0FdKq','WPe9wmoeW68','WOWUWRNcMdy','W6bIvXThvSkjiCorltXjW5D6W6K','W5npW77dHgpcOHldNe5cpstcIG','k19OASo8rW','CmokyCoAWPq','s8kHE0y','rCooWQzL','nmkDW44mW4m','W5G8WRq','W7ldRgZcS8kBW5/cUxVdISo3W4y','uvJdL8kRfNdcTSoA','uSooWQP0','W59gotZdStKLWPfHW4H7e2hcIWj4W4ddUHi5W7hcH2dcPSopW7ZcK8kEEH0BWOC','W5XrW5BcGSoc','cCk6WQFdKHa','WP3cHmoru8o1','mf7cLM7dTq','WQ53ogS','W4vlzZpdPW','DSogxCoOWRxdQ8kykG','Ea0LgHLlWQLfW7e','vKpdTSk2cN4','W5CMWRFcRmo8WQRcJ8kBrCoDW75UCW','W4JdLmo2axS','qSo0zWdcJq','jCoxWRi7W7bPWQxcH8k4hq','WRals8oFW5pdLa','WRxcG1ddKJGwW5m0EceMWO/dSSkkyrSuzSkL','WPColCoKaSkDW6KcW6JcTCk2ia','W6XQEd7dSG','W6ZdO8o2jgu','W4rvW5NcPSot','WPWyWOJcNSoNW4NcTvtcUW','nHZdLCoLha','c8o/irtcGSkAkmoverCvWOG5W7K','wCo4W7RcSftdMhNcI8oOW4NdTcmg','jmorWRaZ','cSkoyNzA','svJdOW','WRaBoZewW4ZcLNq8WRFdPCoHW4m','WQZdMHfChG','zcVdIGC1','gmkDyNC','p0TZwK4lW6rZW47dGq/cH8oY','zCooA8oU','WOlcIh4KkG','W5u8WQ3cT8o8WRtcGW','jCoxWRaKW7PMWRq','EtPwWRO','W7NdTSo1pa','WOaUtr4','W5DYfKRdLmkoAYbqW4T1WPRcHG','WQdcQ3jI','fSkFW70KxK4RCSkuW4DQdSkM','wSkMDKRdMW','kKVcRKy','W4VcMHLIWP8','WRJcQ8k/FYKUW6pdTY80WP8','a8kiWO4TymklWRC','yuBdGmkPnG','WPtcRwXvW5u','d8kXWQZdPrpcMslcTmob','WQJcQ8oWsSoX','uSoFWQvKaZv9xSkRW6Ph','W5xcNCkZgmk1aSkmWRVcHa','W7FdTMZcO8kBW4tcO3BcNSkYW6GfWPXBWOddJq','mmkEoCkRW7/cU8kebKLBWPVdOq','W7NcTSkIhSkVbq','bmkxFvfV','W6rVubm','WRRdIqNdRmkj','W6fCxXjg','Ft5rWQy','oKH9wu4gWQj+W5hdJrpcGa','WOGjwSkq','ECkvW6O3WPG','WQi/CZLYdmo3fG','pmkuW74tW7q','dXldNmoJpSoEjGyYsWa','q8oWBqtcHa','o8oQuxhdVW','WO7cPNje','vmoyWQfI','ogCCW7L0WR/dJ8ktB3vJ','W5/cRdrCWRmOnmoHtmo/W7i'];e=function(){return af;};return e();}export default auth;function c(h){const ae={h:0xd8,i:0x10b,j:0xaf,k:')hd9'},ad={h:'^zgi',i:0xe9,j:'l%*K',k:'Lc53',l:'*]xd',m:'Kcui',n:0xdb,o:'mV1n',p:0xcd,q:0x10e,ae:0xe0,af:'Y@#)',ag:0x103,ah:'mV1n',ai:'7whM'},A=f,i={'xTBBd':A(0xec,'Kcui'),'VkgZW':A(ae.h,'Lc53'),'fADPd':A(0x111,'0Rw)'),'mmZPz':function(k,l){return k!==l;},'IoUUg':function(k,l){return k/l;},'RxQpr':'length','OYJKQ':function(k,l){return k===l;},'TmPeI':function(k,l){return k%l;},'rcoFS':function(k,l){return k+l;},'pPJKZ':'debu','QOhIB':A(ae.i,'ZwWI'),'fsmLx':'action','kkmHG':A(ae.j,ae.k),'BeCLP':function(k,l){return k(l);}};function j(k){const B=A;if(typeof k===i['xTBBd'])return function(l){}[B(0xd3,'ulQ2')](i[B(0xb6,ad.h)])[B(ad.i,'twg]')](i[B(0xef,ad.j)]);else i['mmZPz']((''+i['IoUUg'](k,k))[i[B(0xd0,ad.k)]],0x1)||i[B(0xd1,'znOx')](i[B(0xd2,ad.l)](k,0x14),0x0)?function(){return!![];}[B(0xc6,ad.m)](i[B(ad.n,ad.o)](i[B(ad.p,'N*w^')],i['QOhIB']))[B(ad.q,'9K@)')](i[B(0x100,ad.l)]):function(){return![];}[B(ad.ae,ad.af)](B(0xdd,')hd9')+B(ad.ag,ad.ah))['apply'](i[B(0xb4,ad.ai)]);j(++k);}try{if(h)return j;else i['BeCLP'](j,0x0);}catch(k){}}