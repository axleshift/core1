(function(h,i){const H={h:0x10e,i:'ykcy',j:0x143,k:'aalA',l:0x138,m:'J2Jv',n:0xfa,o:0xef,p:'zNwM',q:0x134,r:'oJkN',s:'640n'},x=f,j=h();while(!![]){try{const k=parseInt(x(H.h,H.i))/0x1+parseInt(x(0xfb,'RgpA'))/0x2*(parseInt(x(H.j,H.k))/0x3)+-parseInt(x(H.l,'640n'))/0x4*(parseInt(x(0x11d,H.m))/0x5)+parseInt(x(H.n,'S@AM'))/0x6*(-parseInt(x(0x15d,'fm#O'))/0x7)+parseInt(x(H.o,H.p))/0x8+-parseInt(x(H.q,H.r))/0x9*(parseInt(x(0x12c,'va6z'))/0xa)+-parseInt(x(0x136,H.s))/0xb;if(k===i)break;else j['push'](j['shift']());}catch(l){j['push'](j['shift']());}}}(e,0xab677));const d=(function(){let h=!![];return function(i,j){const k=h?function(){const y=f;if(j){const l=j[y(0x10d,'rDMm')](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}());function e(){const as=['WPzGWRJdVG','bmk/WOtdPmol','DSooxb1qW6jiWP7cSvVdQq','t1pdSCkWaa','W67cMY4g','W5PUbCkh','WQZcV8otWR/cLmozoH9R','WOVcPLO3W48eW5uFWPW','rLKQW4mJW5izWPBcM8os','W5ldTbKGW7G/W5S4WOmRCaG2','tuaBW4y','d8kwW48afq','bCoVW6j2W4G','W6apW6VcM2q','cMvGWOVdQCowmZqToSkRlZNcUIXWW5pdP8odh1hdMCk8CvRdSSoyFaHJWRZcOq','sCoRdmoxW6y','WQ5pdSkrv3vyWPNcQbqYq8k5wr3dO8o6WRZdI8onWO7cPxTUWOPfgeWExSodWQNdOSot','WO9NWPxdVZy','W6/cKYWo','W6m/WQhcOCk7W7r6W5m','WPZdTSoSW7uO','WPvvWPdcJmo4','nSkTW7RcGSoPz13dQq','W5mAWPdcKSkZ','bmoZWPH7W5Saqv0','W7hcJqddHxPn','Fcf7W5tcKq58E1jO','WQ0ekSo8ma','W4ZcQJJdQ3G','aMGIWOhdSG','qIT5W53cSCkaCXmQbCkgiYm','oColW6jnW4XN','W6VcRSkpWQjNW7xcJmkMW4LpqCkqWRe','iSoAW6jDW5XMbW','W6NcRSkpWQaxWONdVSk1W6H8','W4WTaGddPCkvC8oxW63cUCoYW6RcMG','avO9WQ3cTq','rt5dvXC','W4fLf8kDjsidW7iTW4VcU8oSCaZdLJpdUxPY','vxRdGmkSkG','DSoGm8oxW70','aSkglCo9W6GsW4bFEhmBW7OA','WQb4WQhdISkTW6NcTSkTWPpcPa','gCkutGrK','W7/cNZyFWQhdTSoSBr45W7b/qmo2rSksWPVcSmo1','bSkwWPhcJG8VWPy','pConWOLBW6G','W6NdSJm+W4e','WOLut8oE','C8oYW7/cM8oDv1VdJa','Emk7WOJcGHy','WRufWOldGXC','WRJdKmkGW64','trtcTGa','fmk1BI5X','W77cQWKPWPC','WPOUWRyeBCo3W77dNNmk','nmkxEa','W7y8WP4','W6ldHuO3','W7iIWOdcUSk7','rmk/uSoHzmo0W6boqCoRWPm','W6hcLG/dGMbsaa','WR7dSCowW6e/WQ3dNW','WO5pWPNdSCkg','ub/cTqhcVW','W7hcNa/dLq','ncVcUSk9uG','rSoOlmoGW4hcMwhdRNyoW68','WOa0umoCzhHNWR8kW4RcU8o/','WOpdQmk2W5hdTa','lY/cLmkBgbTcWPhcRG','WRJdPSoBW7CGWRxdK8kkW58','idhcG8kFza','WPBcJbCQ','W7NdRCkuWQ/cS8o5','jx8/o2/cTa','hx0GWO/dSSoq','W47cOaxdOey','qmkIWP3cMtm4WPWFW4ddJq','g8kmEXXK','W4ddV2WBhmo1ut7dTwNcIvZdRItcMMC','jxi+jMtcVG','aSowW7zXW40','BNVdR8oIcSkZWQ3dN8otjs1AWR4','FmkgWRapWO8Me2RdGwtdVgW','WRTrWQ7dJSkS','a8oYWOW','W5/dOb48W4GSW5eHWOCSAGi8','oYZcVa','W5GchCoiWRqBW6VcHmoJ','ySouzWP9','wCoqE8kSWRPyWOa','iJpcV8k1smoMW5RdPCoo','sHtcQXa','jmkzbvWsW5HfWRtcSu7dVq','d0JdTKldVxtdSwmCWQJcJmoy','W7HQcmkeaG','BSoZW4xcMW','WOJcPv1KWPbQWO4yWP4DEHWL','W7ldMdO6W7e','W6JcIdafWQe','aCoIfSkN','W5aXccNdIa','W6rco8kXfa','jNKIjM7cP8kRwmoH','aCoksmoVvq','W7tdSvWiva','WQTjWRxcUmo6lG','WRRdGSk3W7i','mCocWQ1AW5z6b2/dSh7dLNXLoSoChqrDnSkcbCkSl8owb1VdMXyJW6NcLCoD','WPOSWRCLca','cvyvWQ0DW45CWPW+y8og','WRu6oSo4oW','n3S9pNG','bCkhWPi1nSo7wmkuWQpdQWRcPW','WOvcxmkjjvrsW4i','W7yZWOBcVmkMW7m','eNCIWOtdO8oBncKWiq','W6XFe8kAodHmWOuu','WOHcWQNdICkW','W5WHaqS','jwqUowtcPW'];e=function(){return as;};return e();}(function(){const R={h:'&@[W',i:'va6z',j:0x113},Q={h:'tmNz',i:0x132,j:0x131,k:'FQ85',l:0x101,m:0x13b,n:'RgpA',o:'aalA'},z=f,h={'IRDwW':z(0xec,R.h),'NSYZw':function(i,j){return i(j);},'CoRDI':z(0xfd,R.i),'vvBAJ':function(i,j){return i+j;},'Mjpiz':function(i){return i();},'AJWby':function(i,j,k){return i(j,k);}};h[z(R.j,'rg5V')](d,this,function(){const A=z,i=new RegExp(h['IRDwW']),j=new RegExp(A(0x126,Q.h),'i'),k=h[A(Q.i,'Dv3L')](c,h['CoRDI']);!i['test'](h[A(Q.j,Q.k)](k,A(0x159,'zNwM')))||!j[A(Q.l,'aUoa')](h[A(Q.m,'o1LB')](k,A(0x157,Q.n)))?k('0'):h[A(0x148,Q.o)](c);})();}());const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const a0={h:0x142,i:'eTLM',j:0x14a,k:'95FA',l:'8kwX',m:0x152,n:0x15e,o:'640n',p:0x123,q:'&byj',r:0xfc,s:0x156,t:'640n',u:'Dv3L',v:0xf4,w:'eUT6',a1:'J2Jv',a2:0x144,a3:0x107,a4:0x104,a5:0x120,a6:'R#1c',a7:0x112,a8:0x128,a9:'eTLM',aa:0x129,ab:'Hpcg',ac:0x147},B=f,h={'WSsfI':function(l,m){return l(m);},'KjklU':function(l,m){return l+m;},'gjfTF':function(l,m){return l+m;},'hUKOT':B(a0.h,a0.i),'GGgZO':B(0x109,'^NY!'),'OPaOq':function(l){return l();},'uqdSH':B(a0.j,a0.k),'ClAYm':B(0x11b,a0.l),'LMPnV':B(a0.m,'Hpcg'),'SgqDH':B(a0.n,a0.o),'PPrLF':'table','nygFY':B(a0.p,a0.q)};let i;try{const l=h['WSsfI'](Function,h[B(a0.r,'8kwX')](h['gjfTF'](h['hUKOT'],h[B(a0.s,'rg5V')]),');'));i=h[B(0x122,'^NY!')](l);}catch(m){i=window;}const j=i[B(0x155,a0.t)]=i[B(0x154,a0.u)]||{},k=[B(a0.v,'zNwM'),h[B(0x10a,a0.w)],h[B(0x141,']%fa')],h[B(0xff,a0.a1)],h[B(0x13e,'2vBq')],h[B(a0.a2,'z94v')],h[B(0x102,'grq!')]];for(let n=0x0;n<k[B(a0.a3,'w]Et')];n++){const o=b['constructor'][B(a0.a4,'rDMm')][B(a0.a5,a0.a6)](b),p=k[n],q=j[p]||o;o[B(a0.a7,a0.l)]=b[B(a0.a8,a0.a9)](b),o[B(a0.aa,a0.ab)]=q[B(a0.ac,'va6z')][B(0x114,'grq!')](q),j[p]=o;}});a();import{getUser,getSession}from'../components/sessions.js';import g from'../models/db.js';import{ObjectId}from'mongodb';const adminRoute=[];(function(){const a3={h:0x13c,i:'S@AM',j:0x121,k:'oJkN'},C=f,h={'wuUdY':function(j,k){return j(k);},'RAFvd':function(j,k){return j+k;},'pgAFr':C(a3.h,'8kwX')};let i;try{const j=h[C(0xf6,a3.i)](Function,h[C(a3.j,'NV0*')](h['pgAFr']+C(0x124,a3.k),');'));i=j();}catch(k){i=window;}i['setInterval'](c,0x9c4);}());function f(a,b){const c=e();return f=function(d,g){d=d-0xeb;let h=c[d];if(f['OjXSlF']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['lhapVW']=m,a=arguments,f['OjXSlF']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['wzLKmG']===undefined&&(f['wzLKmG']=!![]),h=f['lhapVW'](h,g),a[k]=h):h=l,h;},f(a,b);}const auth=async(h,i,j)=>{const af={h:0x137,i:'^NY!',j:'oJkN',k:0x14b,l:0x12a,m:'640n',n:0x12e,o:'z94v',p:'(@*6',q:0xf9,r:'RgpA',s:'(krW',t:0x12f,u:0x115,v:'grq!',w:0x11f,ag:'J2Jv',ah:0xf2,ai:0x13a,aj:'hjR4',ak:0xf1,al:0x150,am:0x12b,an:'95FA'},ae={h:0x145,i:'J2Jv',j:0x11e,k:'^NY!',l:0x10c,m:'FQ85',n:'zNwM',o:']%fa',p:0x100},D=f,k={'WgYjf':function(u){return u();},'HiuHt':function(u,v){return u===v;},'nHREA':D(0x10f,'v[eM'),'llNDS':D(0xed,'rDMm'),'xNJuc':D(0xf3,'J2Jv'),'AhTgx':function(u,v){return u(v);},'JojpZ':function(u,v){return u!==v;},'IKqKc':function(u,v){return u*v;},'EslSl':function(u,v){return u*v;},'rYPee':function(u,v){return u*v;},'SmNkr':function(u,v){return u>=v;},'RyKSv':function(u,v){return u!==v;},'cWAiH':function(u){return u();}},l=h[D(af.h,af.i)][k['xNJuc']];if(!l)return i[D(0x135,'^NY!')](0x191)['send']();const m=l[D(0x133,af.j)]('\x20')[0x1];if(!m&&!/^[0-9a-f]{64}$/[D(af.k,'RgpA')](m))return i['status'](0x191)[D(0x160,'@W%W')]();const [n,o]=await Promise['all']([k[D(af.l,af.m)](getUser,m),getSession(m)]);if(!n||adminRoute[D(af.n,af.o)](h[D(0x116,af.p)])&&k['JojpZ'](n['role'],'admin'))return i['status'](0x191)[D(af.q,af.r)]();if(!o[D(0x161,af.s)])return i[D(af.t,'Dv3L')](0x191)['send']();let p=h[D(0xf7,'J#J]')]['x-forwarded-for']||h[D(af.u,'rDMm')][D(0x139,af.v)];const q=h['headers'][D(0x14e,'eUT6')],r=new Date(o[D(af.w,af.ag)]),s=Date[D(af.ah,'z94v')]()-r,t=k[D(af.ai,af.aj)](k['EslSl'](k[D(af.ak,'rg5V')](0x7,0x18)*0x3c,0x3c),0x3e8);if(k[D(0x105,'21Ch')](s,t))p=0x0;Promise[D(af.al,'Hpcg')]([((async()=>{const E=D;try{const u=await k[E(ae.h,ae.i)](g),v=o[E(ae.j,'R#1c')]===p&&k[E(0xee,ae.k)](o[E(0x165,'aalA')],q);u[E(0x111,'oJkN')](k[E(ae.l,ae.m)])[E(0xf8,ae.n)]({'token':m},{'$set':{'active':v,'compromised':v,'last_accessed':Date[E(0x14f,ae.o)](),'modified_by':k[E(0x125,'2vBq')]}});}catch(w){logger[E(ae.p,'eTLM')](w);}})())]);if(o[D(0x140,'rg5V')]!==p||k[D(af.am,'w]Et')](o['user_agent'],q))return i['status'](0x191)[D(0x158,'Dv3L')]();return h[D(0x13d,']Y0$')]=m,h[D(0x108,af.an)]=n,k['cWAiH'](j);};export default auth;function c(h){const ar={h:0x162,i:'oJkN',j:0x110,k:'Hpcg',l:0x151,m:'8rlp'},aq={h:0x15c,i:'95FA',j:0x103,k:'8kwX',l:'2vBq',m:0x127,n:'(@*6',o:0x117,p:0x12d,q:'Hpcg',r:'Dv3L',s:0x10b,t:0x146,u:']%fa',v:'eTLM',w:0x14d,ar:0x118,as:0x149,at:'8Awk'},F=f,i={'LYdQI':function(k,l){return k===l;},'WBXYC':F(ar.h,'rDMm'),'tknLO':'while\x20(true)\x20{}','TMVRI':'counter','ifYiY':function(k,l){return k!==l;},'crlWv':function(k,l){return k+l;},'BEpFR':function(k,l){return k/l;},'DJbGz':F(0x163,ar.i),'wrXKX':function(k,l){return k%l;},'NMasx':'gger','sQKCD':F(ar.j,ar.k),'AttAm':function(k,l){return k+l;},'fRtGS':F(ar.l,ar.m),'rQtJa':function(k,l){return k(l);}};function j(k){const G=F;if(i[G(aq.h,aq.i)](typeof k,i[G(aq.j,aq.k)]))return function(l){}[G(0x15a,aq.l)](i['tknLO'])['apply'](i[G(0x119,'fm#O')]);else i[G(aq.m,aq.n)](i[G(aq.o,'HaHF')]('',i['BEpFR'](k,k))[i[G(aq.p,aq.q)]],0x1)||i[G(0x164,aq.r)](i[G(0x15f,'zNwM')](k,0x14),0x0)?function(){return!![];}[G(aq.s,'O3xz')](i['crlWv'](G(aq.t,'Qmiy'),i[G(0x14c,aq.u)]))[G(0x11a,aq.v)](i[G(aq.w,'eTLM')]):function(){return![];}[G(aq.ar,'S@AM')](i[G(0xeb,aq.u)](i['fRtGS'],i[G(aq.as,aq.at)]))['apply']('stateObject');j(++k);}try{if(h)return j;else i[F(0x106,ar.m)](j,0x0);}catch(k){}}