import{r as s,R as a,j as t}from"./B29SdWEC.js";import{H as r}from"./CIAn0bGm.js";import{R as l}from"./Cri8ushB.js";import{F as i,W as n}from"./CPF8VAmO.js";import{b as o,d as c}from"./Dimq5Wi7.js";import{k as d,d as m}from"./BFKNndIN.js";import{d as p,b as u,c as j,T as h,Q as x,R as f,ak as g,al as b,am as v,an as y,ao as w,ap as N,a as S,U as k,e as F,f as D,g as z,h as $}from"./BYX7WaHQ.js";import"./ucIcx5RQ.js";import"./E8MUDNEF.js";import"./BPg_iBjA.js";import"./Dcib5x9m.js";import"./07vdr7AR.js";import"./4RmQ9_ev.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./BmTZu7tj.js";import"./CxXfFpkk.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./B1ETHe3Q.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./CLdVYh6z.js";import"./DPAjA2jz.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const C=()=>{const{id:C}=d(),O=m(),[R,T]=s.useState(!0),{addToast:A}=o(),P=a.useRef(),[U,E]=s.useState(null),[M,Q]=s.useState(null),[q,B]=s.useState(null),[H,I]=s.useState(!1),[J,L]=s.useState(null);return s.useEffect((()=>{(async()=>{axios.get(`/documents/${C}`).then((e=>E(e.data.documents))).finally((()=>T(!1)))})()}),[]),R?t.jsx("div",{className:"loading-overlay",children:t.jsx(p,{color:"primary",variant:"grow"})}):U?t.jsxs(t.Fragment,{children:[t.jsx(r,{children:t.jsxs("title",{children:[C," - Documents | Axleshift"]})}),t.jsxs(h,{onSubmit:async e=>{e.preventDefault();const s=await P.current.executeAsync();T(!0);const a=new FormData;a.append("exportLicense",M),a.append("certificateOfOrigin",q),a.append("recaptcha_ref",s),axios.post(`/documents/${C}/upload`,a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{E(e.data),A("Documents uploaded successfully!","success")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);A(t,"danger")})).finally((()=>T(!1)))},children:[t.jsx("h2",{children:"Upload Documents"}),t.jsx("span",{className:"text-muted",children:C}),t.jsx(x,{className:"mt-2 mb-3",children:t.jsxs(f,{children:[t.jsxs(g,{stripedColumns:!0,hover:!0,responsive:!0,className:"table-even-width",children:[t.jsx(b,{children:t.jsxs(v,{children:[t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Document Name"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Type"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Upload"})]})}),t.jsx(w,{children:U.map(((s,a)=>t.jsxs(v,{children:[t.jsxs(N,{children:[t.jsx("span",{className:"d-block",children:s.name}),s.file&&t.jsxs(S,{color:"primary",size:"sm",variant:"ghost",onClick:e=>((e,s)=>{if(/bill-of-lading-AX-[0-9]/.test(s))return O(`/documents/${e}/bill-of-lading`);I(!0),axios.post(`/documents/file/${e}`,{file:s}).then((e=>{if(e.data.error)return A(e.data.error);L(e.data)})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);A(t)})).finally((()=>T(!1)))})(C,s.file.file),children:[t.jsx(i,{icon:n,className:"me-1"})," ","Open File"]})]}),t.jsx(N,{children:s.type}),t.jsx(N,{className:"text-capitalize",children:t.jsx("span",{className:"badge bg-"+(["approved","generated"].includes(s.status)?"success":"rejected"===s.status?"danger":"warning"),children:s.status})}),t.jsx(N,{children:s.file&&"rejected"!==s.status?s.file.file:t.jsxs(t.Fragment,{children:[t.jsx(k,{type:"file",accept:".docx,.pdf",onChange:s=>((s,a)=>{const t=s.target.files[0];if(t&&t.size>26214400)return A("File size exceeds 25MB limit. Please upload a smaller file."),void(e.target.value=null);if(t){const e=[...U];e[a]={...e[a],status:"Under Review"},E(e),0===a&&Q(t),1===a&&B(t)}})(s,a)}),s.file&&t.jsx("span",{className:"text-danger text-decoration-line-through",children:s.file.file})]})})]},a)))})]}),t.jsxs("span",{className:"d-block mb-2 small",children:["Please ensure that the documents you upload are accurate and comply with all applicable laws and regulations.",t.jsx("br",{}),"Submitting false or fraudulent documents may result in legal consequences."]}),["pending","rejected"].includes(U.status)&&t.jsxs(t.Fragment,{children:[t.jsx(S,{color:"primary",type:"submit",children:"Submit Documents"}),t.jsx(l,{ref:P,size:"invisible",sitekey:c})]})]})})]}),t.jsxs(F,{alignment:"center",scrollable:!0,fullscreen:"sm",visible:H,onClose:()=>I(!1),"aria-labelledby":"M",children:[t.jsx(D,{children:t.jsx(z,{children:null==J?void 0:J.file})}),t.jsx($,{children:"docx"===(null==J?void 0:J.fileFormat)?t.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${null==J?void 0:J.url}`,style:{width:"100%",height:"400px",border:"none"}}):t.jsx("iframe",{src:null==J?void 0:J.url,style:{width:"100%",height:"400px",border:"none"}})})]})]}):t.jsx(u,{className:"justify-content-center my-5",children:t.jsx(j,{md:6,children:t.jsxs("div",{className:"clearfix",children:[t.jsx("h1",{className:"float-start display-3 me-4 text-danger",children:"OOPS"}),t.jsx("h4",{children:"There was no shipment documents found."}),t.jsx("p",{children:"Double check tracking number for any mistake."})]})})})};export{C as default};
