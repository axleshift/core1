function e(){const b3=['uCk4WP4','WR/dGHBcJsu','tCo2ErlcLfWBWQpcUr16m23dKX5C','p8kVWPtdV0mlW6O','pmkigSkE','ESkyWQXQyW','rhSCFL0uwSoVW4y7W4KNWPi','WQJdLxlcUG','l8k8o33cLmkzWQjJWOXyW48','W4HGW53cMa','xeFdVa','WRTFFCo8vq','AZKcWPrA','W6hcLZRcJCkqgSkNW63dG8kKW4G','yHWHWQzJoJ0','pCkSWPy','WRxdL3RdKCos','omo0WPRdSCoNcCoHtW','WQOoW6O','WQDcsCo2zq','WQ7cPmoMWRa','WRZdRvdcMCoXWOuNib/dQx4qxSoQW5j/xwJdMg3dVSoNpG','h8keWQ5S','f33dGxyy','WOpdT03cSmoZ','tmkJWOHaySkc','WOCNfSoZ','jHioWPGOW5RdLCo+WPDuWQNdQfNcJYvvCmkYBmouWPBdRtWTW5ZcSmo5j8o3CSoiamo7WRtcGuldPq','W6OojCoHyCkBeCodW4iB','arG7WPWA','CGCUWQf5jq','B8kTW7GDvW','WPddSvddMmorWOKUgL7dJq','WRFdLvldU8ow','u8oWf2ddV3iNxwCh','WOz/uIf1nf5neG','WRBcRSo0WQbef2K','n8kxhbFcNLhcTeezzSoVkCk0','W4ZdPmkFcH3dJa','cCo7WQJdKW','smoSErFcIvi','W49yWO/cK2e','C8krWQ5kAW','yCkMWOtcSa','jtH/W6i','W5fkWOlcKq','FSkGWQhcN2m','W7NdLMz9W7DYmMRcJCobFJ/cIG','WQpdKwNdISovga','uCoVc2ddOW','W5pdG8kxia','W41KWO4wDW','W4xdLmklk8oU','W4ThW6FcRmks','W4JdPhVcRSkCW7FdHqCS','xIW/WQDJiJC6qq','WOLUWOldHrnPW6xdTmkBWPi1','CYRcTtihhmkBW7pdP8oy','WRhdG3pcSa','WPRdRuBdNmoxWPGfk1O','WQtdIMpdM8oo','W4mPdHi','W57dNe7cQmk3','WRtdJg/dM8othW','rCoShN4','CSknWQbFAXRdUsaxWQW5WQBdRGPHeSkD','F8oCFJVdSW','CHyHWRe','e8keWR0','mSkmWQz0WOW','WO/dJgW','WRJcOSoNWRDvoNrOrx8','vZaAWRxdOGe','gCo/WQRdMW','DevrWQZcNW','gJu6WOa6','f8oKdConEW','WRbVWOFdKa','WResW7JdVq','hCkWjsBcOMqtWOBdSW','mbexW5hdLWpdGmk7nCkEmW','d8oIWQFdMSktmCofW4bn','W4u/bqre','WPxcK8kqn8o0xCobWRm','sZKUWO1Q','WRlcGtCZWPS','n8kvgZ3cVG','dCkkWRLMWO3dQKJdUa','W5xdLCkCnG','hSopk8opCSk6W4xcPetdV3BcVWvFFq','W5tdLmkyj8o5','wSkeW6i/yIHGy8oYW5jeW6rpWORcNcymWRDOW6tcMmkbymkRqmkMWQ7dR0pdGCkIcWG4WRHrWQdcUhVcRCkZjwZdRG/cM1hdRH7dR0/dIJqLWO7cJmk+C2SWW5WPW6C4CtRdKCkdl8o6tCoZW47dOSkGov3dS03dOCkhWQ/cNCkmgxi','W7vvWQ7cVSk3kYuFpKbD','s8kFWOXjCrtdOIHOWR4ZWRhdTeXMgmknW6tcKtxdPSo9rq','fNWQWPecWOi8','ycFdGG','xmkLWOXvy8kuWQlcIJBcJG','W5jwWOuZzG','W4jDWOif','ndj1W78','W5NdUCkqgIFdKCoW','y8kYWOlcKLK','vrhdLvXP','WRpcKJuXWRq2','BSknWPPikXRdTYKMWQ4','WRtdIa/cTr4','yZngW5eGfvtdTL/cQMVdUdSR','xCoIdCopaCkI','yCkGW4xdMwnVrSoJeSoyqay','W6RcVxu/W7y','k8kadmky','ASkEhH/cG1O','WRRdLMFdKa','WQTYW6RcUa','WO5DWRm5wM5n','j8o2W5pdPcdcRa3cKmoVWOC1ks4','WQ1KW6hcRMW','gColjmoc','WOq/nCopWQe','fL3cTYhdVW','CuXwWPy','amoPWQVdKq','W4HnWOZcI3hcQa','WRxdN2S','mwWyWPDTvrJcOuFcRgK','omkiaSkpma','it5PW6JdOCkbdKLjWPO','FSkmWO1vDa','mSkOWOVdV1G','sSoEjSoZnW','W6hdQgNcS8kVWRNdJq5Pn20uWRKaaaRdSSoSxSoQW5/dUtm','W5tdICkQmmoUv8oFWRu','WQ3cPmo2WQ9eeq','x8o8AJldTG','WPpdTg3dRSo4','xSkoWPPhrG','WQldHgBdMSopbG','WRfzFW','q8kYWP7dIcXUqCoNqmoeuflcVXbvxmk/ic8NW7hdTMFcKmoJtMXEW7NdOSkqlG','W6tcKfFdReBdKHjOcvpdG8krfa','sGOFWR10','CKzlWOy','zsddNuS','WRlcK8oeWOba','gbWk','BuhdRW','lCklbq','dI5aiG','WR1LW7BcS20','ESkMWOVcShhdQ0W','e8kQkZ7cOq','hXfCiX8','mWSnWOiTW5ddG8k6W7HTWOW','DuXoWOFcIq','WRpdIMtdKSofcmkfW6JdNSkh','kSkgaq','y8o8p8oDoq','kgZdQ2K','ymoCceRdUa','z0PlWOBcQbZdSW','ichdL0jdWP5HoH4','E8kSWOtdPG','WOD+uuebxqfVnCoZW5zDxW','BSoQFJW','qqFdUMbA','WPNdSfRdLW','WRnVWPpdLXe','ESkoWO9wFW','W51qWOpcM0VcTuC','uSkDWQ9NWPpdO0pcS0xdKmkf','CLDeWPBcKGe','WQ1cWQldSJq','WRFcPCoZWQS','jCk6WPH5WOS','DfbaWPa','s8k8WQDDuq','A8o1AsNdLSkvWOLMWOm','W6pcLHn/DgSDqttcOG','FmkmWOlcUuu','BmkLW5/dNZK','E8kdWPPFrq','WR1cyCoGu1BcVG5pWPC9','W7hdN2jWW7CSzNBcImoWta','fvqKWRDY','bMC+WOStWQGSW43cI8o3W74','W5pdKSkymmoPtq','WRrLWOFdKa','WRdcHmo9WQLW','W4rlWOKt','A8oskCoioW','mqSfWQGV','rcDSW45aWO05W4tcU8obW4e','dmoZWQRdM8kSk8oj','W7jxWPVcNMJcSKyDWO5NiSkFW7T/W5LDWPicamolW4S','WQT5W7BcTwu','Dmocqu3dKWBdJberFCo6aSkIkG','cfldQY3dOGS9WRhdN8onWOzeCWO7iSkWWOHfjCk9umkrcSk6W77cHJlcKSkpW4ddJq','W4ZcG24PW6qq','pCk1WO/cPN3dV0y','p8ktcmkEk8o8','f8ohjmobASkn','WQLUWOtdKqS','v0xdQK/dOW','g8kJbCoihmkYWRi+','W77dIqhcUX3cKLq','d8oOWRBdKmkr','W4RcHgOV','WRzFE8ojra','s8k7W5hdNZzZ','WQJdHh3cQSojxG','j3tdH0Sj','W7hcUNyTW4C','W4qJcXnz','WP8XdCoOWRzyWRTyzsPZW4ddJmohc8kAhmkaWOG','WQpdGbRcQqdcIqaRfvtdOmkRmY7dL8knWOHUW4i','FSkkW4i4zY58ya','hudcSG','W4LMW5FcMq','yCoHl8ojjW','WRHjCCk1CmkAh8ojW6yg','vmoul8ouD8kdW4RdRLNdOMddQtrBFG','E8oxwWxcRW','WOWKcCoXWR0','mgWsWP0','yCkWWPJdVa','WQVcU8oXWQvvafvNtq','qvZdQLldUSkY','WOn7drv6l2XH','BuzlWOxcKXO','W7pcKr4Hjd4','vmoxoCodBa','drbEW57dMW','WQ7dGhJcV8oismkMq8oT','W4xdPNZcS8kSW7C','WR3cPmo7WRDvf29QxhxdHW','WR5ZFCkfrG','WQO2mSozWQi','WQHLW6VcQhbEW69BwW','W4VdTSkydmox','WRvuyW'];e=function(){return b3;};return e();}const J=f;(function(p,q){const W={p:0x1d6,q:'t484',r:0x233,s:'HR%6',t:0x23f,u:'nNhG',v:'t484',w:0x285,x:'GH11',y:0x1e9,z:'S)l6'},C=f,r=p();while(!![]){try{const s=-parseInt(C(W.p,W.q))/0x1*(-parseInt(C(W.r,W.s))/0x2)+-parseInt(C(W.t,W.u))/0x3*(-parseInt(C(0x206,W.v))/0x4)+parseInt(C(0x21c,'quv]'))/0x5*(-parseInt(C(0x1a9,'Lt8)'))/0x6)+-parseInt(C(0x1b6,'kgaA'))/0x7+parseInt(C(W.w,'t484'))/0x8*(-parseInt(C(0x255,W.x))/0x9)+parseInt(C(W.y,'@**^'))/0xa+-parseInt(C(0x1be,W.z))/0xb*(-parseInt(C(0x256,'vzW6'))/0xc);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xd6fbc));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const D=f;if(r){const t=r[D(0x1d1,'byWa')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a5={p:0x1de,q:0x1e8,r:'WY@C',s:'S)l6',t:'zHpZ',u:'S)l6'},E=f,p={'dUqLw':E(0x1e5,'TJqd'),'nrwJy':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','eHiQB':function(q,r){return q(r);},'afSPe':'init','OwCrS':function(q,r){return q+r;},'KZkHa':'chain','mBVVK':function(q,r){return q+r;},'hrtZc':E(0x1bc,'zHpZ'),'dHJHC':function(q){return q();}};d(this,function(){const F=E,q=new RegExp(p['dUqLw']),r=new RegExp(p['nrwJy'],'i'),s=p[F(a5.p,'ZAa&')](c,p[F(a5.q,a5.r)]);!q['test'](p[F(0x1cd,a5.s)](s,p['KZkHa']))||!r['test'](p[F(0x19e,a5.t)](s,p[F(0x1c2,'P4hC')]))?p[F(0x202,'L7YM')](s,'0'):p[F(0x264,a5.u)](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const G=f;if(r){const t=r[G(0x28a,'WY@C')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ag={p:'PCtu',q:'T@**',r:0x234,s:'RVy!',t:0x20c,u:0x279,v:'rm)x',w:0x239,x:0x25a,y:'T@**',z:0x1d7,A:0x1a8,B:0x1ec,ah:0x266,ai:'CHtq',aj:'L7YM',ak:'@I2R'},af={p:'rm)x',q:0x1df,r:'byWa',s:0x204},H=f,p={'nhqst':function(u,v){return u(v);},'tkNiF':function(u,v){return u+v;},'GbKDf':function(u,v){return u+v;},'AygzT':H(0x1c9,ag.p),'gpZEv':H(0x1b7,ag.q),'VXZFK':function(u){return u();},'rgjET':'log','QbVjy':H(ag.r,ag.s),'UQTFo':H(ag.t,'J[L)')},q=function(){const I=H;let u;try{u=p[I(0x263,af.p)](Function,p[I(0x1a2,'6#Cf')](p[I(af.q,af.r)](p[I(0x268,'Kwij')],p[I(af.s,'0qxI')]),');'))();}catch(v){u=window;}return u;},r=p[H(ag.u,'kgaA')](q),s=r[H(0x1f1,'!09h')]=r[H(0x1e6,ag.v)]||{},t=[p[H(ag.w,'kgaA')],'warn',H(0x19f,'el4t'),H(ag.x,ag.y),p['QbVjy'],p['UQTFo'],H(0x23d,'CHtq')];for(let u=0x0;u<t[H(ag.z,'HR%6')];u++){const v=b[H(ag.A,'P4hC')][H(0x1e0,'uTCV')][H(ag.B,'zss)')](b),w=t[u],x=s[w]||v;v[H(0x21a,'!09h')]=b['bind'](b),v[H(ag.ah,ag.ai)]=x[H(0x1ca,ag.aj)][H(0x258,ag.ak)](x),s[w]=v;}});a();import g from'dotenv';g[J(0x20b,'TJqd')]();import{ObjectId}from'mongodb';import h from'express';(function(){const ak={p:0x1c8,q:'byWa',r:0x26d},aj={p:0x1da,q:0x1a6},K=J,p={'loRrp':function(s,t){return s(t);},'JGEEN':function(s,t){return s+t;},'GuWvl':K(ak.p,ak.q),'Tjotz':K(ak.r,'Yd$E')},q=function(){const L=K;let s;try{s=p['loRrp'](Function,p[L(aj.p,'2#ne')](p['JGEEN'](p['GuWvl'],p[L(aj.q,'Yd$E')]),');'))();}catch(t){s=window;}return s;},r=q();r['setInterval'](c,0x9c4);}());import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x19c;let h=c[d];if(f['QZfitu']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['nhytIC']=m,a=arguments,f['QZfitu']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['KktEZR']===undefined&&(f['KktEZR']=!![]),h=f['nhytIC'](h,g),a[k]=h):h=l,h;},f(a,b);}import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';const router=h['Router']();router[J(0x25b,'HR%6')](J(0x283,'kg0v'),async(p,q)=>{const an={p:0x1b4,q:'J[L)',r:0x1fe,s:'L7YM',t:'WY@C',u:0x1c1,v:'QuYi',w:0x25d,x:'2#ne',y:0x25c,z:'RVy!',A:')##9',B:0x1b1,ao:'aoWX',ap:0x1d5,aq:'x!zG',ar:'G5N&',as:0x1d0,at:'TJqd',au:0x1ad,av:0x24a,aw:'Lt8)',ax:'quv]',ay:0x1c6,az:'*L3X',aA:0x1e1,aB:'0qxI',aC:'B*1Z',aD:0x211,aE:0x247,aF:')##9',aG:'CHtq',aH:0x220,aI:0x21e,aJ:0x1ed,aK:0x276,aL:0x1ac,aM:'CHtq',aN:'HR%6'},M=J,r={'zYFrt':M(an.p,an.q),'GxxCp':function(s,t){return s<t;},'PTLtO':M(an.r,'aoWX'),'NMypV':M(0x23e,an.s),'kPaHK':M(0x240,an.t),'CQePX':function(s){return s();},'lcKKw':'users','jJMAV':M(an.u,an.v)};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[M(0x1f9,'a2V[')];if(!s||!t||!u||!v||!w)return q[M(an.w,'J[L)')](0x190)[M(0x246,an.x)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/['test'](s))return q['status'](0xc8)[M(an.y,an.z)]({'error':r[M(0x221,an.A)]});if(r[M(an.B,an.ao)](v['length'],0x8))return q[M(an.ap,an.aq)](0xc8)[M(0x21d,an.ar)]({'error':r[M(an.as,an.at)]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[M(an.au,'zHpZ')](v))return q[M(an.av,an.aw)](0xc8)[M(0x280,an.ax)]({'error':r[M(an.ay,'QuYi')]});if(v!=w)return q[M(0x1ba,an.az)](0xc8)['json']({'error':r[M(an.aA,'CHtq')]});const x=await r[M(0x269,an.aB)](k),y=x[M(0x1a4,an.aC)](r[M(an.aD,'vzW6')]),z=await y[M(an.aE,'W4(X')]({'email':s});if(z)return l[M(0x1f3,an.aB)](M(0x265,an.aF)),q[M(0x1ac,an.aG)](0x199)[M(an.aH,'t484')]();return await y[M(an.aI,'rJpk')]({'email':s,'first_name':t,'last_name':u,'role':r[M(0x1ef,'!09h')],'password':o(v),'email_verify_at':'','created_at':Date[M(an.aJ,'x!zG')](),'update_at':Date[M(0x227,'a2V[')]()}),q['status'](0xc9)[M(an.aK,'@**^')]();}catch(A){l[M(0x217,'CHtq')](A);}return q[M(an.aL,an.aM)](0x1f4)[M(0x270,an.aN)]();}),router[J(0x1e7,'*L3X')](J(0x252,'kgaA'),n,async(p,q)=>{const ar={p:0x235,q:'t484',r:0x1d8,s:0x26f,t:'!09h',u:'6#Cf',v:0x209,w:0x23a,x:'HR%6',y:0x216,z:'0qxI',A:'vzW6',B:0x1fb,as:'G5N&',at:0x267,au:'el4t',av:0x207,aw:'WY@C',ax:0x1b8,ay:'QuYi',az:'RVy!',aA:'CHtq'},N=J,r={'KyPhx':function(s,t){return s||t;},'aYssQ':function(s){return s();},'DTskR':N(ar.p,ar.q),'yoFeB':function(s,t){return s!=t;},'zJiat':N(ar.r,'B*1Z'),'snriz':'hex','XGQnO':'x-forwarded-for'};try{const {email:s,password:t}=p[N(0x20f,'2#ne')];if(r[N(ar.s,ar.t)](!s,!t))return q[N(0x24e,'S)l6')](0x190)[N(0x1af,'GH11')]();const u=await r[N(0x26a,ar.u)](k),v=await u['collection'](r[N(0x1a7,'6#Cf')])['findOne']({'email':s});if(!v)return q[N(ar.v,'W4(X')](0x194)['send']();if(r[N(0x1f6,'P4hC')](o(t),v[N(ar.w,'a2V[')]))return q[N(0x19d,ar.x)](0x191)[N(0x226,'!09h')]();const w=j['createHash'](r[N(ar.y,'GH11')])['update'](r[N(0x225,'Kwij')](generateUniqueId))[N(0x222,ar.z)](r[N(0x1b5,'uTCV')]),x=p[N(0x278,ar.A)][r[N(ar.B,ar.as)]]||p[N(ar.at,ar.au)][N(0x208,'kgaA')];return addSession(v,w,x,p[N(ar.av,'el4t')][N(0x24b,ar.aw)]),q[N(ar.ax,ar.ay)](0xc8)['json']({'token':w});}catch(y){l[N(0x1c0,ar.az)](y);}return q['status'](0x1f4)[N(0x215,ar.aA)]();}),router[J(0x286,'Kwij')](J(0x1b9,'vzW6'),m,async function(p,q,r){const ay={p:0x1a1,q:'HR%6',r:0x224,s:'WY@C',t:0x281,u:'CHtq',v:0x23c,w:'@I2R',x:0x1c4,y:0x1fd,z:0x28b,A:'J[L)',B:0x1c7,az:'rJpk',aA:0x1ae,aB:'vzW6',aC:'kg0v',aD:0x1c3,aE:0x253,aF:0x22b},O=J,s={'PCsFb':function(z,A){return z!==A;},'exbDe':function(z){return z();},'nOhmQ':function(z,A){return z*A;},'avqwX':function(z,A){return z>A;},'NTHEp':function(z,A){return z-A;},'ZBgyC':function(z,A,B){return z(A,B);}},{_id:t,email_verify_at:u,...v}=p[O(ay.p,ay.q)];v[O(ay.r,ay.s)]=s[O(ay.t,'IU#c')](u,'');if(p[O(0x23b,ay.u)][O(ay.v,ay.w)]!=='')return q[O(ay.x,'G5N&')](0xc8)[O(ay.y,'byWa')](v);const w=await s[O(0x244,'GH11')](k),x=await w['collection']('otp'),y=await x[O(ay.z,ay.A)]({'token':p[O(ay.B,'t484')],'verified':![]});if(y){const z=new Date(y[O(0x203,ay.az)]),A=s[O(ay.aA,'el4t')](s[O(0x1a5,ay.aB)](0xa,0x3c),0x3e8);if(!s['avqwX'](s[O(0x287,ay.aC)](Date['now'](),z),A))return q[O(ay.aD,'Yd$E')](0xc8)[O(ay.aE,'0qxI')]({'otp':!![]});}return s[O(0x249,'kg0v')](sendOTPEmail,p,x),q[O(ay.aF,'$zB$')](0xc8)[O(0x210,'J[L)')]({'otp':!![]});});const sendOTPEmail=(p,q)=>{const aC={p:0x1c5,q:'byWa',r:0x26b,s:'0qxI',t:0x1f2,u:0x231,v:0x274,w:'x!zG',x:0x27c,y:'HR%6',z:0x1f5,A:0x245,B:0x238,aD:'Lt8)',aE:0x24f},P=J,r={'ekCLk':function(t,u){return t+u;},'ikLRe':function(t,u){return t*u;},'aNTPF':function(t,u,v){return t(u,v);},'rgcvZ':P(0x1f8,'rJpk')},s=Math['floor'](r[P(aC.p,'quv]')](0x186a0,r[P(0x259,aC.q)](Math[P(aC.r,aC.s)](),0xdbba0)));Promise[P(aC.t,'rm)x')]([q['insertOne']({'user_id':p[P(aC.u,'nNhG')][P(aC.v,aC.w)],'token':p[P(aC.x,aC.y)],'code':s,'verified':![],'expired':![],'created_at':Date[P(aC.z,'nNhG')](),'updated_at':Date['now']()}),r[P(0x218,'zss)')](send,{'to':p[P(aC.A,'GH11')][P(0x24c,'PCtu')],'subject':r[P(aC.B,aC.aD)],'text':P(aC.aE,'Yd$E')+s+',\x20valid\x20for\x2010\x20minutes\x20only.'},p['user'][P(0x261,'2#ne')])]);};router[J(0x284,'eIcO')](J(0x1d9,'@I2R'),m,async function(p,q,r){const aE={p:'a2V[',q:0x201,r:'rJpk',s:0x22a,t:'uTCV',u:0x1ba,v:'*L3X'},Q=J,s={'XQRlq':function(t,u){return t(u);}};try{const t=await s[Q(0x1a0,aE.p)](getUser,p[Q(0x21f,'0qxI')]);return q[Q(aE.q,'!09h')](0xc8)[Q(0x288,aE.r)]({'user':{'email':t[Q(0x1bd,'x!zG')],'first_name':t[Q(aE.s,'el4t')],'last_name':t[Q(0x219,')##9')]}});}catch(u){l[Q(0x277,aE.t)](u);}return q[Q(aE.u,aE.v)](0x1f4)[Q(0x246,'2#ne')]();}),router[J(0x1f7,'el4t')](J(0x1bf,'PCtu'),m,function(p,q,r){const aG={p:'y6sG',q:0x20e,r:'vzW6'},R=J,s={'GWRSk':function(t,u){return t(u);}};return s[R(0x1aa,aG.p)](removeSession,p['token']),q['status'](0xc8)[R(aG.q,aG.r)]();}),router['post'](J(0x1cf,'@I2R'),[m,n],async function(p,q,r){const aK={p:0x248,q:0x1b3,r:'RVy!',s:0x260,t:'*L3X',u:'ZAa&',v:0x27f,w:'T@**',x:0x1a3,y:0x25e,z:'G5N&',A:0x19d,B:0x1ea,aL:'G5N&'},S=J,s={'qqhFM':function(t){return t();},'MjSfM':function(t,u){return t*u;},'hoQpm':function(t,u){return t-u;}};try{const t=await s[S(aK.p,'vzW6')](k),u=await t['collection'](S(0x27e,'kgaA')),v=await u[S(aK.q,aK.r)]({'token':p[S(aK.s,aK.t)],'verified':![],'expired':![]});if(v){const w=new Date(v[S(0x1ce,aK.u)]),x=s[S(aK.v,'S)l6')](0xa*0x3c,0x3e8);s[S(0x20d,'WY@C')](Date[S(0x1cb,aK.w)](),w)>x&&(await u[S(aK.x,'Kwij')]({'_id':new ObjectId(v['_id'])},{'$set':{'verified':![],'expired':!![],'updated_at':Date[S(aK.y,aK.z)]()}}),sendOTPEmail(p,u));}}catch(y){l[S(0x262,'WY@C')](y);}return q[S(aK.A,'HR%6')](0x1f4)[S(aK.B,aK.aL)]();}),router[J(0x230,'zHpZ')](J(0x19c,'a2V['),[m,n],async function(p,q,r){const aP={p:0x21b,q:0x1d2,r:'y6sG',s:'P4hC',t:'RVy!',u:0x27d,v:'0qxI',w:0x243,x:'6#Cf',y:0x237,z:'!09h',A:0x1e2,B:0x271,aQ:'kg0v',aR:0x272,aS:0x1e4,aT:'zss)',aU:0x1d3,aV:'eIcO',aW:0x250,aX:'QuYi',aY:0x275,aZ:'IU#c',b0:'uTCV',b1:0x1db,b2:'IU#c',b3:0x1e3,b4:'6#Cf',b5:0x273,b6:'aoWX',b7:'P4hC',b8:0x254},T=J,s={'WqRNL':T(0x242,'kg0v'),'JJaXf':function(t,u){return t*u;},'GBOci':function(t,u){return t>u;},'UbEqz':function(t,u){return t-u;},'lXQDa':T(0x27b,'aoWX'),'ngxQW':function(t,u){return t!==u;},'UJzbg':T(aP.p,'zHpZ')};try{const t=p[T(aP.q,aP.r)][T(0x26c,aP.s)];if(!t)return q['status'](0x190)[T(0x22c,aP.t)]();const u=await k(),v=await u[T(aP.u,aP.v)](s['WqRNL']),w=await v[T(0x282,'HR%6')]({'token':p['token'],'verified':![],'expired':![]});if(w){const x=new Date(w[T(aP.w,aP.x)]),y=s[T(aP.y,aP.z)](s['JJaXf'](0xa,0x3c),0x3e8);if(s['GBOci'](s[T(0x1fa,'quv]')](Date[T(aP.A,'ZAa&')](),x),y))return q[T(0x1b8,'QuYi')](0xc8)[T(aP.B,aP.aQ)]({'error':s[T(aP.aR,'el4t')]});}if(s[T(aP.aS,'PCtu')](w[T(0x1cc,aP.aT)],parseInt(t['replace'](/[^0-9]/g,''))))return q['status'](0xc8)[T(aP.aU,aP.aV)]({'error':s[T(aP.aW,aP.aX)]});return await Promise[T(aP.aY,'*L3X')]([v[T(0x1d4,'el4t')]({'_id':new ObjectId(w['_id'])},{'$set':{'verified':!![],'updated_at':Date['now']()}}),u[T(0x205,aP.aZ)](T(0x257,aP.b0))[T(aP.b1,'G5N&')]({'_id':new ObjectId(p[T(0x223,aP.b2)][T(0x229,aP.v)])},{'$set':{'email_verify_at':Date[T(aP.b3,aP.b4)](),'updated_at':Date[T(aP.b5,aP.b6)]()}})]),q[T(0x213,'0qxI')](0xc8)[T(0x1af,'GH11')]();}catch(z){l[T(0x1ee,aP.b7)](z);}return q[T(0x1fc,aP.x)](0x1f4)[T(aP.b8,aP.b0)]();});export default router;function c(p){const b2={p:0x1bb,q:0x251,r:'*L3X',s:0x1ab},b1={p:0x289,q:'zHpZ',r:0x1dd,s:'el4t',t:0x27a,u:'@**^',v:0x228,w:'HR%6',x:0x22e,y:'aoWX',z:0x20a,A:'RVy!',B:0x1b0,b2:0x22f,b3:0x214,b4:'IU#c'},U=J,q={'sogsn':function(s,t){return s===t;},'deDle':'string','HojZY':function(s,t){return s+t;},'EtkKT':function(s,t){return s/t;},'dHxVL':U(b2.p,'@I2R'),'bZret':function(s,t){return s%t;},'Oglav':function(s,t){return s+t;},'uftNx':'debu','lFGke':U(b2.q,b2.r),'EDEsO':function(s,t){return s+t;},'Oxuuh':U(b2.s,'6Us0'),'wkFwE':function(s,t){return s(t);},'RyBvD':function(s,t){return s(t);}};function r(s){const V=U;if(q[V(b1.p,b1.q)](typeof s,q['deDle']))return function(t){}[V(b1.r,b1.s)]('while\x20(true)\x20{}')['apply'](V(0x241,'6Us0'));else q['HojZY']('',q['EtkKT'](s,s))[q['dHxVL']]!==0x1||q[V(b1.t,b1.u)](s,0x14)===0x0?function(){return!![];}[V(0x25f,'y6sG')](q[V(b1.v,'a2V[')](q[V(0x22d,b1.w)],q[V(b1.x,b1.y)]))[V(b1.z,b1.A)](V(0x1dc,')##9')):function(){return![];}['constructor'](q[V(b1.B,'S)l6')](q['uftNx'],q[V(b1.b2,'@I2R')]))[V(b1.b3,b1.b4)](q['Oxuuh']);q[V(0x200,b1.y)](r,++s);}try{if(p)return r;else q['RyBvD'](r,0x0);}catch(s){}}