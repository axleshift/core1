const I=f;(function(p,q){const Q={p:'b[[z',q:0x176,r:'t%tH',s:0x103,t:'ElIn',u:0x121,v:0x126,w:'x99!',x:0x117,y:0x16d,z:'S7vb',A:0x110},B=f,r=p();while(!![]){try{const s=-parseInt(B(0x134,'9Ul('))/0x1+parseInt(B(0x14a,Q.p))/0x2*(-parseInt(B(0x178,'dC$m'))/0x3)+parseInt(B(Q.q,Q.r))/0x4+parseInt(B(Q.s,Q.t))/0x5*(parseInt(B(Q.u,'&WKl'))/0x6)+-parseInt(B(Q.v,Q.w))/0x7*(-parseInt(B(Q.x,'[T@]'))/0x8)+parseInt(B(Q.y,Q.z))/0x9+-parseInt(B(Q.A,'Z#WE'))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xe350c));const d=(function(){let p=!![];return function(q,r){const R={p:0x132},s=p?function(){const C=f;if(r){const t=r[C(R.p,'znO7')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:0x184,q:'znO7',r:0x17e,s:'S7vb'},a0={p:0x185,q:'87GT',r:'VSK!',s:0x139,t:'FYX)'},D=f,p={'eytYH':'function\x20*\x5c(\x20*\x5c)','BwCqw':D(a1.p,a1.q),'QiqCv':function(q,r){return q(r);},'jSrCk':'init','EXvNL':function(q,r){return q+r;},'cgYXr':D(a1.r,a1.s),'FWPuD':function(q,r){return q+r;},'IDyFv':D(0xf6,'aJSg'),'HNgsE':function(q){return q();},'vRwVA':function(q,r,s){return q(r,s);}};p['vRwVA'](d,this,function(){const E=D,q=new RegExp(p[E(a0.p,a0.q)]),r=new RegExp(p['BwCqw'],'i'),s=p[E(0x155,a0.r)](c,p['jSrCk']);!q[E(0x179,'kTxd')](p['EXvNL'](s,p[E(0x118,'aJSg')]))||!r['test'](p['FWPuD'](s,p[E(a0.s,'!YSt')]))?s('0'):p[E(0x13f,a0.t)](c);})();}());const b=(function(){const a2={p:0x15c};let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(a2.p,'FYX)')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aa={p:'Y!*1',q:0x127,r:0x100,s:0x18c,t:0x12b,u:0x17f,v:0x15d,w:0x15e,x:'ElIn',y:0x116,z:'b[[z',A:0x160,ab:'znO7',ac:'dC$m',ad:0x17d,ae:'[T@]',af:0x10f},a9={p:0x122,q:0x13d},G=f,p={'mtIvo':function(u,v){return u(v);},'Lwcaq':function(u,v){return u+v;},'tmZim':G(0x140,'KL$y'),'EHbLs':G(0xf7,'A8XX'),'qQIyY':G(0x123,'MLF9'),'XGjxA':G(0x168,'0qqQ'),'MxjTY':'info','dYFMu':G(0xee,'KL$y'),'IcHQG':G(0x170,aa.p),'jrjRC':G(aa.q,'!YSt'),'eBcfE':G(aa.r,'ArP]'),'oAhJA':function(u,v){return u<v;}},q=function(){const H=G;let u;try{u=p[H(a9.p,'aJSg')](Function,p[H(0x158,'w2cK')](p[H(a9.q,'KL$y')]+p['EHbLs'],');'))();}catch(v){u=window;}return u;},r=q(),s=r[G(aa.s,'b1E6')]=r[G(aa.t,'MV!*')]||{},t=[p['qQIyY'],p[G(aa.u,'74A]')],p[G(aa.v,'VSK!')],p['dYFMu'],p[G(aa.w,aa.x)],p[G(aa.y,'ElIn')],p[G(0x133,aa.z)]];for(let u=0x0;p[G(aa.A,aa.ab)](u,t['length']);u++){const v=b[G(0x129,aa.ac)][G(0x188,'&WKl')][G(aa.ad,aa.ae)](b),w=t[u],x=s[w]||v;v['__proto__']=b[G(aa.af,aa.p)](b),v['toString']=x['toString'][G(0x104,'p^wF')](x),s[w]=v;}});a();import g from'dotenv';g['config']();import h from'express';function f(a,b){const c=e();return f=function(d,g){d=d-0xea;let h=c[d];if(f['NEKqVV']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['lOcXMH']=m,a=arguments,f['NEKqVV']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['mxkZBX']===undefined&&(f['mxkZBX']=!![]),h=f['lOcXMH'](h,g),a[k]=h):h=l,h;},f(a,b);}function e(){const aF=['W5VdG8kwW67cMG','WORdOf3dPmkj','W4NcRmoHWQZcLW','W7qyW7zqWOhcLae','Crujvmkx','j8kwWPDGaSoM','p8k5WORdO8osia','WOzyW4mFfti','WRxcQaPifW','WPBdSuBdS8kM','W67dLsFdLxK','dSkgWOnhBW','WQ9hzCorW7e','CmkTDsGZ','cCovWPPf','W4pdH8oWpSkg','W4VcMCo8WOZcPq','aSkIlM/cPmo0WQeNmIa','W6ZcOSk4FrO','W4JdPSktW5RcOtdcMsu','W5dcU8kaya','n8kwWOfLe8o3W44','WPCWsmoppCoD','W6HCoCoyDW','qwJdIZNdVG','xmomW4iClu9TWOKfW6RcMGra','imogWQvs','W5uFWQC2','qSkaBbS0WO1ek3O','W701WOqYW6W','WOmAr8oo','W5xdNSoWi8kpW5TiW77dI8oyla','fSoIBSkZuG','W4VdPCo8eCkl','hc/cRxNcJCkZfJOFW6ZdMSoElW','ECkaW7ieDSozCwFcIIW+eW','rCksCSozWPm8e0JdVCk7rSkAWQq','WO8WvCoC','W5qJq8oAimottq','cCoeWPvvWOXa','WQHdavKS','W5XfWRSq','cmkCWPbbCW','WR53W7xdMmkk','iL7cN3BcUhKo','W5ldHqRdTK0','W7FdLYNdQKbK','kmkKWOZdSSoujW','WPWTuCkWWPbcCuZcLuGjW4tcTJC2fGXzvwiGxmk2u8oXWPaTW5bZrWFcH8kwW4i','W6z4WO5gjW','WQFcVq5TacpdPGxcV03cNa','WPVdTSodW4u','cZWNWPPMW4ddUSoZkq','F3ddV8o4WR9lW7aGoZe','W5SGWO06W78','ucJcKXxdS3buaGldK8opWQe','e8oMzCkUx8kJkG','WPBcQmoaW5Gqx8oSjSoZBHhcHCkvAmkQ','bmkyWOD4emo9W45DWP3cUHddQMhcKqGEwCoHEr4XvM/dKCk2WPexyw0XW77cMKSjtCk6fq','WPvvW7hdHa','W4VdOSkoW40','Ew3dOCo7WQG','W74aW5xcLtVdRsO','WQLNzmoIW7S','smoprmk0WRtdHmoKbSoZW5bd','aImeWOf6','kCk1WOddQCovmCkkp8kvgmo0W7i7','gmkrWP9m','eZTJW7W','WOKvw8oxWQm','WOv1FvqtjCoGWOz1W51SW5SEWPRcJ31lWQPlWPfgFYBcMXieoM1EeK0I','gY7cQ3JcH8kZfXysW4JdN8odoq','gMhcIepcRcPHod7dKCoQWPNdPmoZW43cUuLMc19bWODRWQfbWQFdVmkVfbr/Fa','a3pdGLK','tColt8kPWQi','W48jW5T1','m8k1WOZdOSoejSk4','W7S0W7zEWPy','WOGHr8oCpmog','BSoDW4pcSWy','cMnBwKiH','W43cQCkDya','WPtcG1FcVa7dK8oTW7tdUwyDW5C','W4jed8of','W4iuWQpdVKxdLaajFCoOWOifWQq','WOXbW64eeW','W7dcOCkBtGK','mCkSmxdcTSo4WQCQFsRcP8kTWONdM8kDt8kmxMJdKqtdJSoK','WRZcVqi','WRtcUehcICkeWO0','W4tcUSkDqJy','kmkJnglcRCo+WRfUocpcQCkHWPBdM8ksrmkCdgddGWm','WPXzW6VdGSkm','WOXiW6JdS8kA','rCkryrO','W5/cSSkEWODxhmk8zmocFdBdI8khqG','m8kIn3FcPmoL','hYSQWPS','v8ksyXGN','e8ollSkv','vY/cLHldSxqMgcFdImoEWQddHa','W43dHaxdLN0','WO8yW6bbEmk0WRVcNbzEWO03','WOmCCSo6WQu','F3ddVCoNWQ5AW7eQidaq','W6efW7LaWRVcIq','W5m+W7z2','cdOPWPP8W4C','W40CW4XOmG','WPuitSoqWQq','sc9bW57cVG','W4xdPGJdTh0','sN98WOHQW5ddTmobaa','WO0pySouWRG','WOyrW5u','W6uzW7fyWQVdMKW+caC8W4tcKCotWQO','W7mZW4D2W7q','W4mAWPC+mqxcHsTH','fx3dHeZcPG','W5WdWQyRW6RcRColrSksW7HL','eSoljmkFW5f5vx/dQSkzwG','WRpcPNNcVmk2','n8kwWPP4cmo+W5K','mCkzWP97xG','E8keW75AjCkiu13cKq','W41yWRqapCoZ','eG4fuSkpW4q','eSkOlgC','hmoQWObfWQm','WQf2FCo3W4K','WQaMWR7cQ8ks','WQDxWOldGMBcR2ZdG1ProZ7cGG','tv7dG8ovWR0','W4ldHb3dQ0W','WRybWRpcQq','bmost8kGWQNdHCoLamo1','kfJdN2BcTq','g8kBWOjC','fSo3p8kDW68','zHj/W4tcQW','AhldICo9WRC','W4qVW7v3W5xcUa','WPZcLH1xkW','BNRdP8oHWQHgWQrHmIOmW6NdVmoDWRhdGg9lWPe','W7WwW5VcNW','WQX0WOL6hq','qSkvBHCO','oSoAWRLi','pCk8WPPHpW','WQXmymoHW7y','n8kXWP7dSSo+oSkQnSku','kCoAWQzqi8kpuhBcSGC','W65cc8o/qLPpjCkAba','W7CZWO7cH8k2C8kv','ENBdVCoWWPvgW6e','melcPhhcVq','e2rvqa','p0zpDKy','gmoGWPnrWRO','W5CCW7LDWQldMG0UwHm1WP/dLmojWRnRW5RcMSkoW6RdKmoFWPS','cNjusG','WRrJFSoV','WQr7bL4t'];e=function(){return aF;};return e();}import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[I(0x111,'hWP$')]();router[I(0x144,'g5h!')](I(0x138,'$N5z'),async(p,q)=>{const af={p:0x108,q:'hWP$',r:'ElIn',s:'K!9M',t:0x187,u:'Z#WE',v:0x114,w:0x113,x:'Y!*1',y:0x13e,z:'LCms',A:0x152,ag:'znO7',ah:0x101,ai:'74A]',aj:0x171,ak:0x16a,al:'kTxd',am:0x16e,an:'g5h!',ao:0x15b,ap:'x99!',aq:'hWP$',ar:0x136,as:'ElIn',at:0x18a,au:0x12e,av:'[T@]',aw:0xf0,ax:'S7vb',ay:0x11c,az:'&WKl'},J=I,r={'pjlfc':function(s,t){return s||t;},'zitbG':J(0x10c,'hWP$'),'BYLjr':function(s,t){return s<t;},'lJmzF':J(0xeb,'MV!*'),'ktVrA':J(af.p,af.q),'eGLcL':function(s){return s();},'ZmnSC':J(0x181,af.r),'dLEba':J(0x150,af.s),'kAtwp':J(af.t,af.u),'iaiyK':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(af.v,'dC$m')];if(r[J(af.w,af.x)](!s,!t)||!u||!v||!w)return q[J(af.y,'FzwU')](0xcc)[J(0xed,af.z)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(af.A,af.ag)](s))return q[J(af.ah,'jQ#]')](0xc8)['json']({'error':r[J(0x10d,af.ai)]});if(r[J(af.aj,'m]eV')](v[J(af.ak,af.al)],0x8))return q['status'](0xc8)[J(af.am,af.an)]({'error':r[J(0x146,'znO7')]});if(v!=w)return q[J(af.ao,af.ap)](0xc8)[J(0x14d,'jQ#]')]({'error':r[J(0x16c,'t%tH')]});const x=await r['eGLcL'](k),y=x[J(0x165,af.aq)](r[J(0x12c,'S7vb')]),z=await y[J(0x157,'K!9M')]({'email':s});if(z)return l[J(af.ar,af.as)](r[J(af.at,'m]eV')]),q[J(af.au,af.av)](0x199)['send']();return await y['insertOne']({'email':s,'first_name':t,'last_name':u,'role':r['kAtwp'],'password':r[J(af.aw,af.ag)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['status'](0xc9)[J(0xec,af.ai)]();}catch(A){l[J(0x15f,af.ax)](A);}return q[J(af.ay,af.az)](0x1f4)[J(0x151,'jQ#]')]();}),router[I(0x13a,'S7vb')](I(0x12f,'w2cK'),n,async(p,q)=>{const am={p:0xfa,q:'!YSt',r:0x13c,s:0x189,t:0x180,u:'xVDQ',v:'hWP$',w:0x14c,x:0x183,y:'B(]y',z:0x149,A:'Br[O',an:0x135,ao:0x15a,ap:0xef,aq:'9Ul(',ar:'Z#WE',as:0x159,at:'MV!*',au:0xf3,av:'4BDL',aw:0x10a,ax:'0qqQ',ay:0x11d,az:0xf4,aA:'S7vb'},K=I,r={'OMNvl':function(s,t){return s||t;},'QAPAg':function(s){return s();},'WUzVw':K(0x11e,'aJSg'),'tuUcJ':function(s,t){return s!=t;},'tpNtZ':function(s,t){return s(t);},'ZNqPZ':function(s,t){return s(t);},'NtLDU':function(s,t,u,v,w){return s(t,u,v,w);},'fZtdZ':'user-agent'};try{const {email:s,password:t}=p[K(am.p,am.q)];if(r[K(am.r,'Sd5[')](!s,!t))return q['status'](0xcc)[K(0x162,'4BDL')]();const u=await r['QAPAg'](k),v=u[K(am.s,'KL$y')](r[K(0x161,'Y!*1')]),w=await v[K(am.t,am.u)]({'email':s});if(!w)return q['status'](0x194)[K(0x130,am.v)]();if(r[K(am.w,'xVDQ')](r['tpNtZ'](o,t),w[K(0x167,'LCms')]))return q[K(am.x,am.y)](0x191)[K(0x137,'b[[z')]();r['ZNqPZ'](addUserProfileToSession,w);const x=j[K(am.z,'bj8q')]('sha256')[K(0x182,am.A)](r[K(am.an,'KL$y')](generateUniqueId))[K(am.ao,am.y)](K(0x109,'FYX)')),y=p[K(am.ap,am.aq)][K(0xea,am.ar)]||p[K(am.as,am.at)][K(am.au,'B(]y')];return r['NtLDU'](addSession,w,x,y,p[K(0xfd,am.y)][r[K(0x131,am.av)]]),q[K(am.aw,'H$Yx')](0xc8)[K(0x102,am.ax)]({'token':x});}catch(z){l[K(am.ay,'GAmM')](z);}return q['status'](0x1f4)[K(am.az,am.aA)]();}),router['post'](I(0x17a,'kTxd'),m,function(p,q,r){const an={p:'K!9M',q:'Y!*1'},L=I;return q[L(0x11a,an.p)](0xc8)[L(0x141,'9Ul(')]({'email':p[L(0x143,an.q)]});}),router[I(0xf5,'xzgg')](I(0x142,'87GT'),m,async function(p,q,r){const ap={p:0x156,q:'B3p4',r:0x14e,s:'jQ#]',t:0x148,u:'g5h!',v:'dC$m',w:0x163,x:'Ch92',y:0x17b,z:'4BDL',A:0x147,aq:'Nb3E'},M=I,s={'FQuXq':function(t){return t();},'gSuqJ':M(ap.p,ap.q)};try{const t=await s[M(ap.r,ap.s)](k),u=t[M(ap.t,ap.u)](s[M(0x13b,ap.v)]),v=await u[M(0x14b,'KL$y')]({'email':p[M(ap.w,ap.x)]});return q[M(ap.y,ap.z)](0xc8)[M(0x16f,'m]eV')]({'user':{'email':v['email'],'first_name':v['first_name'],'last_name':v[M(ap.A,'B(]y')]}});}catch(w){l[M(0x107,ap.aq)](w);}return q[M(0xff,'kTxd')](0x1f4)['send']();}),router['post']('/logout',m,function(p,q,r){const s={'sriNq':function(t,u){return t(u);}};return s['sriNq'](removeSession,p['token']),q['status'](0xc8)['send']();}),(function(){const av={p:0xf9,q:'!YSt',r:'A8XX',s:0x153,t:'LCms',u:0x10b,v:0x10e,w:0x186},N=I,p={'VKRnP':function(r,s){return r(s);},'ZsUio':function(r,s){return r+s;},'cDvGL':'return\x20(function()\x20','QitcM':N(av.p,av.q),'jxwSQ':function(r){return r();}};let q;try{const r=p[N(0x17c,av.r)](Function,p[N(av.s,av.r)](p[N(0x154,av.t)],p[N(av.u,'Nb3E')])+');');q=p[N(av.v,'74A]')](r);}catch(s){q=window;}q[N(av.w,'FYX)')](c,0x9c4);}());export default router;function c(p){const aE={p:0x169,q:0x11b,r:'FzwU',s:0x173,t:0xfe,u:'K!9M'},aD={p:'x99!',q:0x124,r:'K!9M',s:0x11f,t:0x166,u:0x14f,v:0x16b,w:0x164,x:'&WKl',y:0x128,z:0x120,A:'ElIn',aE:0x112,aF:'&WKl',aG:'aJSg',aH:'H$Yx',aI:0xf1,aJ:0x175,aK:'$N5z',aL:0x125,aM:'FzwU',aN:0x145},O=I,q={'ymLos':function(s,t){return s===t;},'KxJsw':O(aE.p,'MV!*'),'bPgpC':function(s,t){return s+t;},'elWFA':function(s,t){return s/t;},'wFxRA':'length','fkenb':O(0xfc,'GAmM'),'tjYAG':'action','mOmFa':O(aE.q,aE.r),'DhSuT':O(aE.s,'Ch92'),'iEnjX':function(s,t){return s(t);}};function r(s){const P=O;if(q[P(0x106,aD.p)](typeof s,'string'))return function(t){}[P(0x119,'KL$y')](P(aD.q,aD.r))[P(aD.s,'Sd5[')](q[P(aD.t,'0qqQ')]);else q[P(aD.u,'4BDL')]('',q[P(aD.v,'bj8q')](s,s))[q[P(aD.w,'B3p4')]]!==0x1||q[P(0xf2,aD.x)](s%0x14,0x0)?function(){return!![];}[P(aD.y,'m]eV')](q[P(aD.z,aD.A)](P(aD.aE,aD.aF),q[P(0x174,'b1E6')]))[P(0x172,aD.aG)](q[P(0x12a,aD.aH)]):function(){return![];}[P(aD.aI,'$N5z')](q['bPgpC'](q[P(aD.aJ,'Ch92')],q[P(0xfb,aD.aK)]))['apply'](q[P(aD.aL,aD.aM)]);q[P(aD.aN,'MV!*')](r,++s);}try{if(p)return r;else q[O(aE.t,aE.u)](r,0x0);}catch(s){}}