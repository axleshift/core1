import{j as s,R as e,r as a}from"./B29SdWEC.js";import{r as n,u as o,a as i,V as c,b as t,c as l}from"./D9DjP_Z5.js";import{a as r,d as m,i as d,j as x}from"./BFKNndIN.js";import{j,k as p,l as h,m as u,c as f,n as b,o as v,p as y,q as N,r as g,s as k,u as w,t as _,C,v as S,w as A,i as E,x as z,d as L,g as M,y as T,z as $,A as B,B as F,D as I,E as P,F as D,G as O,H as R,I as Y,J as q,K as H,L as U,M as W,N as V,O as G,e as J,f as K,h as Z}from"./BO3pT5LR.js";import{a as Q,u as X}from"./BmTZu7tj.js";import{F as ss,f as es,a as as,b as ns,c as os,d as is,e as cs,g as ts,h as ls,i as rs,j as ms,k as ds,l as xs,m as js,n as ps,o as hs,p as us,q as fs,r as bs,s as vs,t as ys,u as Ns}from"./CW_edERI.js";import{p as gs}from"./2aPQtUzY.js";import{A as ks}from"./BHku9RII.js";import{N as ws}from"./D0A342eN.js";import{P as _s}from"./E8MUDNEF.js";import{S as Cs}from"./B27SqzMp.js";import"./ucIcx5RQ.js";import"./BIw_sdFo.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./DShVK1TZ.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./DPAjA2jz.js";import"./OBe_9qlD.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./CxXfFpkk.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";import"./BK_AWGJv.js";import"./vI--IC3q.js";const Ss=[{component:j,name:"Dashboard",to:"/dashboard",role_exclude:[],icon:s.jsx(ss,{icon:es,className:"nav-icon"})},{component:p,name:"Services",role_exclude:[]},{component:j,name:"Book Now",to:"/book-now",role_exclude:["staff","admin"],icon:s.jsx(ss,{icon:as,className:"nav-icon"})},{component:j,name:"Track",to:"/track",role_exclude:[],icon:s.jsx(ss,{icon:ns,className:"nav-icon"})},{component:p,name:"Security",role_exclude:["staff"]},{component:j,name:"Management",to:"/security/management",role_exclude:["user","staff"],icon:s.jsx(ss,{icon:os,className:"nav-icon"})},{component:j,name:"Account Logs",to:"/security/account-logs",role_exclude:["staff"],icon:s.jsx(ss,{icon:is,className:"nav-icon"})},{component:j,name:"Access Token",to:"/security/access-token",role_exclude:["staff","user"],icon:s.jsx(ss,{icon:cs,className:"nav-icon"})},{component:j,name:"Sessions",to:"/security/sessions",role_exclude:[],icon:s.jsx(ss,{icon:ts,className:"nav-icon"})},{component:p,name:"Payments",role_exclude:[]},{component:j,name:"Invoices",to:"/invoices",role_exclude:[],icon:s.jsx(ss,{icon:ls,className:"nav-icon"})},{component:p,name:"Support",role_exclude:[]},{component:j,name:"Customer Service",to:"/customer",role_exclude:[],icon:s.jsx(ss,{icon:rs,className:"nav-icon"})},{component:p,name:"Policies",role_exclude:["staff"]},{component:j,name:"Terms of Service",to:"/terms-of-service",role_exclude:["staff"],icon:s.jsx(ss,{icon:ms,className:"nav-icon"})},{component:j,name:"Privacy Policy",to:"/privacy-policy",role_exclude:["staff"],icon:s.jsx(ss,{icon:ms,className:"nav-icon"})},{component:p,name:"System",role_exclude:["staff"]},{component:j,name:"Network Status",to:"https://stats.uptimerobot.com/5l58Mua0Wi",role_exclude:["staff"],icon:s.jsx(ss,{icon:ds,className:"nav-icon"})}],As=e.memo((()=>{const e=r().pathname,o=m(),i=(s=>{const e=[];return s.split("/").reduce(((s,a,o,i)=>{const c=`${s}/${a}`,t=((s,e)=>{const a=e.find((e=>e.path===s));return!!a&&a.name})(c,n);return t&&e.push({pathname:c,name:t,active:o+1===i.length}),c})),e})(e);return s.jsxs(h,{className:"my-0",children:[s.jsx(u,{onClick:()=>o("/dashboard"),children:"Home"}),i.map(((s,e)=>"/dashboard"!==s.pathname&&a.createElement(u,{...s.active?{active:!0}:{onClick:()=>o(s.pathname)},key:e,style:{cursor:s.active?"default":"pointer"}},s.name)))]})})),Es=e.memo((()=>s.jsx("div",{className:"px-4",children:s.jsx(a.Suspense,{fallback:s.jsx("div",{className:"loading-overlay",children:s.jsx(f,{color:"primary",variant:"grow"})}),children:s.jsx(d,{children:n.map(((e,a)=>!e.external&&s.jsx(x,{path:e.path,exact:e.exact,name:e.name,element:s.jsx(e.element,{})},a)))})})}))),zs=e.memo((()=>s.jsxs(b,{className:"px-4",children:[s.jsxs("div",{children:["Axleshift Core 1 Â© ",(new Date).getFullYear()]}),s.jsx("div",{className:"ms-auto"})]}))),Ls=()=>{const{notifs:e}=o(),{user:n}=i(),[c,t]=a.useState(!1);a.useEffect((()=>{t(e.some((s=>!s.is_read)))}),[e]);return s.jsxs(v,{variant:"nav-item",className:"my-auto",children:[s.jsx(y,{placement:"bottom-end",className:"py-0 pe-0",caret:!1,children:s.jsx(ss,{icon:xs})}),s.jsx(N,{className:"p-0",placement:"bottom-end",style:{width:"350px",maxHeight:"500px",overflowY:"auto"},children:s.jsxs(g,{children:[s.jsxs(k,{className:"bg-body-secondary d-flex justify-content-between align-items-center",children:[s.jsx(ss,{icon:xs}),s.jsx("small",{onClick:async()=>{try{await axios.post("/notifications"),t(!1)}catch(s){}},disabled:c,style:{cursor:c?"pointer":"not-allowed"},children:"Mark all as read"})]}),e&&e.map((e=>s.jsxs(k,{disabled:e.is_read,children:[s.jsx("h6",{className:"mb-1",children:e.event.title}),s.jsx("p",{className:"mb-1",children:e.event.message}),s.jsx("small",{className:"text-muted",children:gs(e.time)})]},e._id))),0===e.length&&s.jsxs(k,{className:"py-3 my-3",disabled:!0,children:["You have no Notification yet. ",s.jsx("br",{})," Come back later."]})]})})]})},Ms=()=>{const e=a.useRef(),{user:n}=i(),{colorMode:o,setColorMode:c}=w("theme"),t=Q(),l=X((s=>s.sidebarShow)),r=m();a.useEffect((()=>{document.addEventListener("scroll",(()=>{e.current&&e.current.classList.toggle("shadow-sm",document.documentElement.scrollTop>0)}))}),[]);const[d,x]=a.useState(!1);return s.jsxs(_,{position:"sticky",className:"mb-4 p-0",ref:e,children:[s.jsxs(C,{className:"border-bottom px-4",fluid:!0,children:[s.jsx(S,{onClick:()=>t({type:"set",sidebarShow:!l}),style:{marginInlineStart:"-14px"},children:s.jsx(ss,{icon:js})}),s.jsxs(A,{children:[["user","super_admin"].includes(n.role)&&s.jsx(j,{children:s.jsx(E,{onClick:s=>r("/book-now"),children:s.jsx(ss,{icon:as})})}),s.jsx(j,{children:s.jsx(E,{onClick:s=>r("/schedules"),children:s.jsx(ss,{icon:ps})})})]}),s.jsxs(A,{className:"ms-auto px-2",children:[s.jsx(ks,{className:"mx-auto d-none d-md-flex me-2"}),s.jsx("div",{onClick:s=>x(!0),className:"d-block d-md-none me-2",children:s.jsx(ss,{icon:hs})}),s.jsx(Ls,{})]}),s.jsxs(A,{children:[s.jsxs(v,{variant:"nav-item",placement:"bottom-end",children:[s.jsx(y,{caret:!1,children:"dark"===o?s.jsx(ss,{icon:us}):"auto"===o?s.jsx(ss,{icon:fs}):s.jsx(ss,{icon:bs})}),s.jsxs(N,{children:[s.jsxs(z,{active:"light"===o,className:"d-flex align-items-center",as:"button",type:"button",onClick:()=>c("light"),children:[s.jsx(ss,{className:"me-2",icon:bs})," Light"]}),s.jsxs(z,{active:"dark"===o,className:"d-flex align-items-center",as:"button",type:"button",onClick:()=>c("dark"),children:[s.jsx(ss,{className:"me-2",icon:us,size:"lg"})," Dark"]}),s.jsxs(z,{active:"auto"===o,className:"d-flex align-items-center",as:"button",type:"button",onClick:()=>c("auto"),children:[s.jsx(ss,{className:"me-2",icon:fs})," Auto"]})]})]}),s.jsx(Ts,{})]})]}),s.jsx(C,{className:"px-4",fluid:!0,children:s.jsx(As,{})}),s.jsx(L,{alignment:"top",scrollable:!0,visible:d,onClose:()=>x(!1),children:s.jsx(M,{children:s.jsx(ks,{className:"mx-auto me-2"})})})]})},Ts=()=>{const e=m(),{user:a}=i(),n=s=>s?s.charAt(0).toUpperCase():"";return s.jsxs(v,{variant:"nav-item",children:[s.jsx(y,{placement:"bottom-end",className:"py-0 pe-0",caret:!1,children:a.avatar?s.jsx(T,{crossOrigin:"Anonymous",src:`${c}/u/${a.avatar}.png`,className:"rounded-5",fluid:!0,width:"40px",height:"40px",loading:"lazy"}):s.jsx("div",{className:"rounded-pill bg-primary d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px",color:"white"},children:n(a.first_name)})}),s.jsxs(N,{className:"pt-0",placement:"bottom-end",children:[s.jsxs($,{className:"bg-body-secondary fw-semibold",children:[a.avatar?s.jsx(T,{crossOrigin:"Anonymous",src:`${c}/u/${a.avatar}.png`,className:"rounded mb-2",fluid:!0,width:"70px",height:"70px",loading:"lazy"}):s.jsx("div",{className:"rounded-pill bg-primary d-flex align-items-center justify-content-center mb-2 fs-4",style:{width:"70px",height:"70px",color:"white"},children:n(a.first_name)}),s.jsxs("span",{className:"d-block text-truncate",style:{maxWidth:"250px"},children:[a.first_name," ",a.last_name]}),s.jsx("span",{className:"d-block text-truncate",style:{maxWidth:"250px"},children:a.email})]}),s.jsxs(z,{onClick:()=>e("/account"),children:[s.jsx(ss,{icon:vs,className:"me-2"}),"Account"]}),s.jsxs(z,{onClick:()=>e("/account/security"),children:[s.jsx(ss,{icon:ys,className:"me-2"}),"Security"]}),s.jsx(B,{}),s.jsxs(z,{onClick:()=>e("/logout"),children:[s.jsx(ss,{icon:Ns,className:"me-2"}),"Logout"]})]})]})},$s=({items:e})=>{const{user:a}=i(),n=(e,a,n,o=!1)=>s.jsxs(s.Fragment,{children:[a||o&&s.jsx("span",{className:"nav-icon",children:s.jsx("span",{className:"nav-icon-bullet"})}),e&&e,n&&s.jsx(P,{color:n.color,className:"ms-auto",children:n.text})]}),o=(e,a,o=!1)=>{const{component:i,name:c,badge:t,icon:l,...r}=e,m=i;return s.jsx(m,{as:"div",children:r.to||r.href?s.jsx(I,{...r.to&&{as:ws},...r,children:n(c,l,t,o)}):n(c,l,t,o)},a)},c=(e,a)=>{var i;const{component:t,name:l,icon:r,items:m,to:d,...x}=e,j=t;return s.jsx(j,{compact:!0,as:"div",toggler:n(l,r),...x,children:null==(i=e.items)?void 0:i.map(((s,e)=>s.items?c(s,e):o(s,e,!0)))},a)};return s.jsx(F,{as:Cs,children:e&&e.filter((s=>Array.isArray(s.role_exclude)&&!s.role_exclude.includes(a.role))).map(((s,e)=>s.items?c(s,e):o(s,e)))})};$s.propTypes={items:_s.arrayOf(_s.any).isRequired};const Bs=e.memo((()=>{const e=Q(),a=X((s=>s.sidebarUnfoldable)),n=X((s=>s.sidebarShow));return s.jsxs(D,{colorScheme:"dark",className:"border-end",position:"fixed",unfoldable:a,visible:n,onVisibleChange:s=>{e({type:"set",sidebarShow:s})},children:[s.jsxs(O,{children:[s.jsxs(R,{to:"/",children:[s.jsx(T,{fluid:!0,src:"/images/logo.png",className:"sidebar-brand-full",height:30,loading:"lazy"}),s.jsx(T,{src:"/images/favicon.png",className:"sidebar-brand-narrow",height:30,loading:"lazy"})]}),s.jsx(Y,{className:"d-lg-none",dark:!0,onClick:()=>e({type:"set",sidebarShow:!1})})]}),s.jsx($s,{items:Ss}),s.jsx(q,{className:"d-none d-lg-flex",children:s.jsx(H,{onClick:()=>e({type:"set",sidebarUnfoldable:!a})})})]})})),Fs=()=>{const{toasts:e,addToast:n}=t(),{modal:i,addModal:c}=l(),{addNotif:r}=o(),[m,d]=a.useState({}),x=s=>{d((e=>({...e,[s]:!1})))};return a.useEffect((()=>{(async()=>{try{(await axios.get("/notifications")).data.forEach((s=>r(s)))}catch(s){}})()}),[]),s.jsxs("div",{children:[s.jsx(Bs,{}),s.jsxs("div",{className:"wrapper d-flex flex-column min-vh-100",children:[s.jsx(Ms,{}),s.jsx("div",{className:"body flex-grow-1",children:s.jsx(Es,{})}),s.jsx(zs,{})]}),s.jsx(U,{className:"position-fixed top-0 end-0 p-3",children:e.map((e=>s.jsxs(W,{autohide:!0,visible:!0,children:[s.jsxs(V,{closeButton:!0,children:[s.jsx(T,{className:"rounded me-2",src:"/favicon.ico",width:"20",loading:"lazy"}),s.jsx("div",{className:"fw-bold me-auto",children:e.header}),s.jsx("small",{children:gs(e.id)})]}),s.jsx(G,{children:e.message})]},e.id)))}),s.jsx("div",{className:"position-fixed top-50 start-50 translate-middle p-3",style:{zIndex:1050},children:i.map((e=>s.jsx("div",{children:s.jsxs(L,{alignment:"center",scrollable:!0,visible:m[e.id]||!0,onClose:()=>x(e.id),"aria-labelledby":e.id,children:[s.jsx(J,{children:s.jsx(K,{id:e.id,children:e.header})}),s.jsx(M,{children:e.body}),s.jsx(Z,{children:s.jsx(E,{color:"primary",onClick:s=>x(e.id),children:e.primaryButton[0].title})})]})},e.id)))})]})};export{Fs as default};
