const I=f;(function(p,q){const Q={p:0x22c,q:'0gJN',r:'@!I1',s:0x21c,t:'4sW#',u:0x1c4,v:'RFS4',w:0x20a,x:'%W3$'},B=f,r=p();while(!![]){try{const s=-parseInt(B(Q.p,Q.q))/0x1+-parseInt(B(0x252,Q.r))/0x2+parseInt(B(Q.s,Q.t))/0x3*(parseInt(B(Q.u,'0F)e'))/0x4)+parseInt(B(0x1e7,Q.v))/0x5+parseInt(B(0x1cd,'0gJN'))/0x6*(parseInt(B(0x257,'@l*e'))/0x7)+-parseInt(B(0x1e0,'i6!x'))/0x8+parseInt(B(Q.w,Q.x))/0x9;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xa2492));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Z={p:0x1e9,q:0x235,r:'h6Am'},Y={p:'C9Cw',q:0x245,r:'W8H@',s:0x241,t:'fivT',u:'XsoU',v:'mIz*',w:0x1e1,x:'YTw*',y:0x239},C=f,p={'jFhum':'function\x20*\x5c(\x20*\x5c)','DyRzK':C(Z.p,'gLwL'),'iNhPj':function(q,r){return q(r);},'jeRDq':C(Z.q,Z.r),'WGBGn':function(q,r){return q+r;},'PdKxe':C(0x20e,'p!T1'),'xKKqu':function(q,r){return q+r;},'szqNR':C(0x23e,'ni43')};d(this,function(){const D=C,q=new RegExp(p['jFhum']),r=new RegExp(p[D(0x201,Y.p)],'i'),s=p[D(Y.q,Y.r)](c,p['jeRDq']);!q[D(Y.s,Y.t)](p[D(0x24f,'%3L&')](s,p[D(0x1c8,Y.u)]))||!r[D(0x1f1,'PAt[')](p[D(0x20b,Y.v)](s,p[D(Y.w,Y.x)]))?p[D(Y.y,'p!T1')](s,'0'):c();})();}());const b=(function(){let p=!![];return function(q,r){const a0={p:'*jtQ'},s=p?function(){const E=f;if(r){const t=r[E(0x21a,a0.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a8={p:0x206,q:0x1e4,r:'co#e',s:0x244,t:'qKdN',u:0x1dc,v:0x1d8,w:0x205,x:'@!I1',y:0x1fd,z:'cmex',A:'6VkO',a9:0x1f9,aa:'!GYv',ab:0x251,ac:'W8H@',ad:0x1c7,ae:'w^k9',af:0x228,ag:'i6!x',ah:'oUGw',ai:0x25a,aj:'4sW#'},a7={p:'uIrO',q:'g*u0'},F=f,p={'ZGhhN':function(u,v){return u(v);},'eACxp':function(u,v){return u+v;},'VmLfN':'log','hbhCZ':F(a8.p,'fAjs'),'hxxUP':'info','jiAvy':F(a8.q,a8.r),'iNuur':F(0x1dd,'Fa#I'),'iKJFQ':F(a8.s,a8.t),'EjwwV':F(a8.u,'*jtQ'),'WHBap':function(u,v){return u<v;}},q=function(){const G=F;let u;try{u=p['ZGhhN'](Function,p[G(0x1ea,a7.p)]('return\x20(function()\x20',G(0x218,a7.q))+');')();}catch(v){u=window;}return u;},r=q(),s=r[F(a8.v,'@l*e')]=r[F(a8.w,a8.x)]||{},t=[p['VmLfN'],p[F(a8.y,a8.z)],p[F(0x234,a8.A)],p[F(a8.a9,a8.aa)],p[F(0x24b,'*jtQ')],p[F(a8.ab,'205z')],p['EjwwV']];for(let u=0x0;p['WHBap'](u,t[F(0x21f,a8.ac)]);u++){const v=b[F(a8.ad,a8.ae)][F(a8.af,a8.ag)]['bind'](b),w=t[u],x=s[w]||v;v['__proto__']=b['bind'](b),v[F(0x22e,a8.ah)]=x[F(a8.ai,a8.aj)]['bind'](x),s[w]=v;}});(function(){const ab={p:'co#e',q:0x222,r:'OY$X',s:0x214,t:'GFDY'},H=f,p={'PMESS':function(r,s){return r(s);},'cJWwz':function(r,s){return r+s;},'ZNlSs':'{}.constructor(\x22return\x20this\x22)(\x20)'};let q;try{const r=p[H(0x200,ab.p)](Function,p[H(ab.q,ab.r)](H(0x236,'PAt['),p[H(ab.s,ab.t)])+');');q=r();}catch(s){q=window;}q['setInterval'](c,0x9c4);}()),a();import g from'dotenv';function f(a,b){const c=e();return f=function(d,g){d=d-0x1c4;let h=c[d];if(f['khQHUy']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['zLrTsQ']=m,a=arguments,f['khQHUy']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['VEKcpa']===undefined&&(f['VEKcpa']=!![]),h=f['zLrTsQ'](h,g),a[k]=h):h=l,h;},f(a,b);}g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';function e(){const aE=['W5aksSoOfa','W5BcVCo2bmok','W5JdJhmyWOBdPW','smkNm13dOW','DNNdTmoelxe','WR8BWQGvW68','iX98bW','W4Cto8o3bq','WQJcT8kdW5FcG0nfW7rHW6hdTCkCW4q','WR7dPwJdJa','WOigWRNcGCkEva','ibvwW7bg','W6ZcGCorfCodWOxdUCkukq','W7dcKWpdRmkLWRiz','WQvxWPtdJCo2','yKu6rL3cUXWHA0r0CCk/','W47cLc/cHvPHWOa0','WPGCWQVcKmkzu8oMc8oc','EgpdLdxdHmoqWRlcQbS','W6tdISo4W7m','W5tcS2hdOYFcOa','w0faWRVdRmoDBCobWQKWcW','WOP/lLiL','CmkeW4RdJNu','WPXOWO3dMmoyWOhdRrBcTarWWOSdj0C','W7ngbCkS','r2ZdO8kB','WP0YW5JdHNVcTL5uBmkAfSojWQe','W4eZW6G+WOddSSoRW6Db','W5BcKSotjSoi','r3RdKLNdHHy','xYNcSmkfBmkJ','WPuxWRRcGa','kxf6s8ktmCoPurPDC8k/BCoLW58','tmoCWRxdJajJ','od1mC8kr','WQlcIWxdSCk0','W5ZcKHlcLwDMWOS','WQtcLHNdRCkPWPCz','WPHLWORdKa','W5XIWO/cKq','xNRdOSkr','W4VcGCoIeSoD','W4GQW7GVWQ/dQmoJW6vk','B8ojWOpdSIy','W6DedSk6','WOa0W53cQ2xcNdCQvw5bWQZdSG','WPH6WPxdUSoV','W5ZcKSoVhq','AqhdRKRcLmoVW40/qCowxYWv','FCkgjmkspG','WRqFlIuyFIZcJCo/d8kU','WRLVWPhdGmoyW5m','kSk5EshdQSoAW67dONtcKMxcHG','W7uXF8oI','bdFdU3iBWOPzvCoujgiiWQlcGSkVW7SjWPfizsOnCSkGW4dcG2OeDM3cICourXG','uuJdJSkhW4O','WPOvWQyMW7G','W6HxFSoDtG','eCo/xCk7','BHtdP0tcLmoV','eetdLbzY','rI7cRCkc','W5/dNwey','tCkObCobW4m','tmkrbCkxka','lWdcKqZdIq','vLBdM8ksumkqWReeW5ldQuroraOYW7uAW4u8u1a','W4fRWPNdQq','Cmkrn8kzkvSt','W50Wemkdyv0','W5unyCohfW','iHnSctW','WQqeisijqZVcHmoUa8kO','BSkyW47dHq','ot50z8k7','b8o3uSk2eG','WPhdTdlcO2VdO8kKWP3cP21+WOe','smk5e8kUhW','qxtdH8okeW','ASksd3NdR8kz','W6RdTSoxWPBdGqy','n8kbjCkypG','W7RdRCoyWPhdMXKy','wZZcSmkc','W4H9v8opD2ZdJCkUWR9q','mCkDfwZdUmk4W74','WOZcTSosiSod','r28YW5GNd8kWWPPjW5aTWRih','W6Cjw8o9ua','W5Cbwa','xCocB8kK','tCopymkPka','ug0cWQKAW7JdQeWbWOJdVa','WR3dHu7cTa','f8oRWROmWQHIc8oTWReKnCk0dq','FfFdMmkDsmkCWQC','WPNdP23dNaCQW71cyvfwd8ouW5FcISkiaH5ZWRRdJc/cPq','WOBdHgddPHG','WQVdKLlcVYO','WQ9OafHTn8kav8oMnW','y8kfe3hdQq','gCoNhCk8eCo/W5rMW6VcUgrjaYmpmCkgW7fBuSkEWRnsle7cTCoVF8kraqBdSW','kmkuWRLeWPZdSexdH8kIih/dMIm','W57cG8oZhCob','zWFcSSkp','WOpdGKZdGHfpWQOXW4ldQ2q','jc95vSks','WO/cP8oNmmol','W6XgbCkVW7nj','smooC8kZmHRcVSo0oCo1','stdcO8kfBG','CcJcLSkmWRm','W7vqdSk6W7q','DWFcO8ko','zCogWOldSt8','W5pdJmoUW7ldLmkKaCovWOiPyKxcKbpcVKddP0ldPSoQfCo/W7iIWQ/dJJ3dS2qHxeZcNmkCW6rgxa','WRtcJrBdQSkZWOG','W4f2WOxdQt3dNxWJuq','DmkeW5ldNW','WQBcMGpdT8kPWPu','gmopASkmpW','WPK0W5pdGxBcSJ9AvCkkjCoC','WP42bCkyoZZdO8kMWOnzdbi','WRFcNmoNbSoyWP/dO8kw','rmouBSkU','uSksaCkehG','WQqxfcue','zJ3cIZhdQSohWRy','r33dRmklW4/dRa','W4n3sSo7uW','smk1W6np','W5NdNwyzWOhdUNVdI0tcL8kNCIOxxmklbmoAW6i','WR0dlZG','W4baW6JcLSkQrCoznSoQ','r8oPACkqla','W6ZdSCotWPddHW','W5P0WOtcHW','eSo1qmkR','k2JdHI1oW5m','CmokW74hW58','sCk+W6TFW7SPqa','eJbUWOn0vCo8WRThW5C','W5pcONpdOW','W5jRWOBdStFdINe6w3i','z8khexldOG','W7FdJmo/W63dHG','W6LTa8kyW60','WRiwuSo7WRmvW5FdJCosWOddIcXy','WOtdGuZcVW4','W4JdNmo3W5FdPa','sWxdSfBcL8oLW74/bCoavtOvn1ZdOSozWRf7WQW0WQHV'];e=function(){return aE;};return e();}import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h[I(0x1e6,'YTw*')]();router[I(0x229,'6(Mf')](I(0x256,'oUGw'),async(p,q)=>{const ah={p:0x1f5,q:'XrwU',r:0x249,s:0x223,t:'GFDY',u:0x23b,v:0x253,w:'GFDY',x:0x1f2,y:'0gJN',z:0x21b,A:'OY$X',ai:'C9Cw',aj:0x1f0,ak:'0F)e',al:0x1d0,am:')h5z',an:'6(Mf',ao:0x225,ap:'Ft3M',aq:'i6!x',ar:'oUGw',as:0x1c6,at:'fivT',au:0x1ed,av:'oM)R',aw:'[zIF',ax:'p!T1',ay:0x233},J=I,r={'JIDjB':function(s,t){return s||t;},'fQuZL':J(ah.p,ah.q),'jckjn':function(s,t){return s<t;},'WOoSR':function(s,t){return s!=t;},'ZnVIH':J(ah.r,'XJx*'),'qcczV':function(s){return s();},'aMZVa':J(ah.s,'W8H@'),'OEfPi':J(0x213,ah.t),'giioG':J(ah.u,'0gJN'),'rfUoU':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[J(ah.v,ah.w)];if(r[J(ah.x,']@!G')](!s,!t)||!u||!v||!w)return q['status'](0xcc)[J(0x1da,ah.y)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[J(ah.z,ah.A)](s))return q[J(0x24e,ah.ai)](0xc8)[J(ah.aj,'fAjs')]({'error':r[J(0x1f4,ah.ak)]});if(r['jckjn'](v['length'],0x8))return q[J(0x24c,'PAt[')](0xc8)[J(0x1db,'uIrO')]({'error':J(0x226,'qKdN')});if(r['WOoSR'](v,w))return q[J(ah.al,ah.am)](0xc8)[J(0x1fc,ah.an)]({'error':r[J(ah.ao,'[zIF')]});const x=await r[J(0x1fa,ah.ap)](k),y=x[J(0x242,ah.aq)](r['aMZVa']),z=await y['findOne']({'email':s});if(z)return l[J(0x1d6,'@l*e')](r[J(0x209,ah.ar)]),q[J(ah.as,ah.at)](0x199)[J(ah.au,'g*u0')]();return await y[J(0x25b,ah.av)]({'email':s,'first_name':t,'last_name':u,'role':r['giioG'],'password':r['rfUoU'](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[J(0x1d4,ah.aw)](0xc9)[J(0x20d,ah.ax)]();}catch(A){l['error'](A);}return q[J(ah.ay,'uIrO')](0x1f4)['send']();}),router[I(0x23c,'g*u0')]('/login',n,async(p,q)=>{const ao={p:0x21d,q:'205z',r:0x1d3,s:0x24a,t:'!GYv',u:0x254,v:0x247,w:0x1d7,x:'4sW#',y:0x1de,z:'[zIF',A:'6VkO',ap:'@!I1',aq:0x1d9,ar:'YTw*',as:0x207,at:0x248,au:0x1ee,av:'XJx*',aw:'*jtQ',ax:'XJx*',ay:0x216,az:'XsoU',aA:0x24e,aB:'p!T1',aC:0x1cb,aD:'W8H@'},K=I,r={'onjYz':function(s,t){return s||t;},'iaPWp':function(s){return s();},'JaloV':K(ao.p,'cmex'),'PaWJQ':function(s,t){return s!=t;},'CXLsM':function(s,t){return s(t);},'Foutc':function(s,t){return s(t);},'KqjVG':K(0x1f8,ao.q),'rILty':K(ao.r,'cmex'),'zUYSA':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p['body'];if(r[K(ao.s,ao.t)](!s,!t))return q[K(ao.u,'oM)R')](0xcc)['send']();const u=await r[K(0x1d5,'cmex')](k),v=u['collection'](r[K(ao.v,'Li%v')]),w=await v[K(ao.w,ao.x)]({'email':s});if(!w)return q['status'](0x194)[K(0x1cc,'uIrO')]();if(r[K(ao.y,ao.z)](r[K(0x1ec,ao.A)](o,t),w['password']))return q[K(0x203,ao.ap)](0x191)[K(ao.aq,ao.ar)]();r['Foutc'](addUserProfileToSession,w);const x=j[K(ao.as,'6VkO')](r[K(ao.at,'qKdN')])[K(ao.au,ao.av)](r[K(0x1cf,ao.aw)](generateUniqueId))['digest'](K(0x20c,ao.t)),y=p[K(0x1f7,'co#e')][r[K(0x1eb,'%3L&')]]||p['socket'][K(0x1e3,ao.ax)];return r[K(0x22b,'g*u0')](addSession,w,x,y,p[K(0x23f,'h6Am')][K(ao.ay,ao.az)]),q[K(ao.aA,'C9Cw')](0xc8)[K(0x22f,ao.aB)]({'token':x});}catch(z){l[K(0x215,'Li%v')](z);}return q[K(0x23d,'gLwL')](0x1f4)[K(ao.aC,ao.aD)]();}),router['post']('/verify',m,function(p,q,r){const ap={p:'mIz*'},L=I;return q['status'](0xc8)[L(0x1e8,ap.p)]({'email':p['email']});}),router[I(0x1f6,'i6!x')](I(0x204,'co#e'),m,async function(p,q,r){const ar={p:'gLwL',q:'oM)R',r:0x237,s:'fAjs',t:0x1ce,u:0x217,v:'j(IE'},M=I,s={'HXsOI':function(t){return t();},'BpIxc':M(0x23a,'@!I1')};try{const t=await s[M(0x1ef,ar.p)](k),u=t[M(0x240,'%W3$')](s['BpIxc']),v=await u['findOne']({'email':p[M(0x1fe,'g*u0')]});return q[M(0x254,ar.q)](0xc8)[M(ar.r,'*6nK')]({'user':{'email':v[M(0x221,ar.s)],'first_name':v[M(0x220,'p!T1')],'last_name':v[M(ar.t,'Fa#I')]}});}catch(w){l[M(ar.u,ar.v)](w);}return q['status'](0x1f4)['send']();}),router[I(0x250,'Ft3M')](I(0x232,'0F)e'),m,function(p,q,r){const at={p:0x258,q:'6(Mf',r:0x227,s:'Li%v'},N=I,s={'NWpyK':function(t,u){return t(u);}};return s[N(at.p,'YTw*')](removeSession,p[N(0x1c9,at.q)]),q[N(at.r,'@l*e')](0xc8)[N(0x210,at.s)]();});export default router;function c(p){const aD={p:0x202,q:0x22a,r:'@l*e',s:'OY$X',t:'*6nK'},aC={p:'j(IE',q:0x1d1,r:'YTw*',s:0x212,t:'XrwU',u:0x1f3,v:'co#e',w:0x1e5,x:'*6nK',y:0x1d2,z:'oM)R',A:0x1c5,aD:'*jtQ',aE:'oUGw',aF:0x230,aG:'co#e',aH:0x231,aI:'*6nK',aJ:'j(IE',aK:0x255},O=I,q={'NPRCx':function(s,t){return s===t;},'TeSjd':function(s,t){return s/t;},'Tahsc':O(aD.p,'j(IE'),'rydcM':function(s,t){return s%t;},'LTSBa':O(aD.q,aD.r),'JfWyR':function(s,t){return s+t;},'sgTsh':O(0x224,aD.s),'NmplB':O(0x1fb,aD.t),'IAdje':function(s,t){return s(t);}};function r(s){const P=O;if(q[P(0x24d,aC.p)](typeof s,P(aC.q,'fAjs')))return function(t){}['constructor'](P(0x1ca,aC.r))['apply'](P(aC.s,aC.t));else(''+q[P(aC.u,aC.v)](s,s))[q['Tahsc']]!==0x1||q['rydcM'](s,0x14)===0x0?function(){return!![];}[P(aC.w,aC.x)](P(aC.y,aC.z)+P(aC.A,'qKdN'))[P(0x1e2,aC.aD)](q[P(0x21e,aC.aE)]):function(){return![];}['constructor'](q[P(aC.aF,aC.aG)](q[P(aC.aH,aC.aI)],P(0x1df,'W8H@')))[P(0x243,aC.aJ)](q['NmplB']);q[P(aC.aK,'p4eT')](r,++s);}try{if(p)return r;else r(0x0);}catch(s){}}