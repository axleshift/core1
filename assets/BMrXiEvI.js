import{r as s,j as e}from"./Oq9P1Wj_.js";import{F as r,D as t}from"./Bi-OQx1y.js";import{d as i}from"./DjfX1Nw2.js";import{c as o,o as a,q as n,a as m,b as l}from"./Bj7zDxPh.js";import{V as d}from"./CmJA4lJM.js";import{P as p,i as j}from"./DSJEh7cs.js";import{p as c}from"./B51y9YVM.js";import{k as u}from"./Ce_fjdqS.js";import{P as f,Q as h,w as x,aa as g,p as y}from"./C7J1C3Pw.js";import"./deeEeel3.js";import"./NdsU5MZw.js";import"./CuOrfwh9.js";import"./CFK1l90-.js";import"./CewSaW8v.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./BKB6Vojr.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./BYNIthp4.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";const v=()=>{const v=p(),[w,b]=s.useState([]),[N,$]=s.useState(""),D=s.useRef(null),[z,O]=s.useState(1),S=o(i,"messages"),k=j()?u().id:v.ref;s.useEffect((()=>{const s=a(n(S,m("timestamp")),(s=>{const e=s.docs.map((s=>({id:s.id,...s.data()}))).filter((s=>s.ref===k));b(e)}));return()=>s()}),[]),s.useEffect((()=>{D.current&&D.current.scrollIntoView({behavior:"smooth"})}),[w]);const A=async()=>{""!==N.trim()&&(await l(S,{text:N,sender:v.role,timestamp:Date.now(),ref:k}),$(""),O(1))};return e.jsx("div",{className:"row d-flex justify-content-center mx-0 mb-4",children:e.jsxs(f,{style:{height:"78vh",overflow:"hidden",padding:"0px"},children:[e.jsxs(h,{style:{position:"relative",height:"100vh",overflow:"auto"},children:[w.map(((s,r)=>{return e.jsxs("div",{className:"d-flex flex-row "+(s.sender===("user"===v.role?"admin":"user")?"justify-content-start":"justify-content-end"),children:[s.sender===("admin"===v.role?"user":"admin")&&e.jsx(x,{crossOrigin:"Anonymous",className:"rounded-5 me-2",src:"admin"===v.role?`${d}/u/${v.ref}.png`:"/images/default-avatar.jpg",style:{width:"45px",height:"100%"},loading:"lazy"}),e.jsxs("div",{children:[e.jsx("p",{className:"small p-2 mb-1 rounded "+(s.sender!==("user"===v.role?"user":"admin")?"bg-primary text-white me-3":"bg-body-tertiary ms-3"),children:(t=s.text,t.split("\n").map(((s,r)=>e.jsxs("span",{children:[s,r<t.split("\n").length-1&&e.jsx("br",{})]},r))))}),e.jsx("p",{className:"small ms-3 mb-3 text-muted "+(s.sender===("user"===v.role?"user":"admin")?"me-3":""),children:c(s.timestamp)})]}),s.sender===("user"===v.role?"user":"admin")&&e.jsx(x,{crossOrigin:"Anonymous",className:"rounded-5 ms-2",src:`${d}/u/${v.ref}.png`,style:{width:"45px",height:"100%"},loading:"lazy"})]},r);var t})),e.jsx("div",{ref:D})]}),e.jsxs("div",{className:"card-footer text-muted d-flex justify-content-start align-items-center p-3 gap-2",children:[e.jsx("div",{children:e.jsx(x,{crossOrigin:"Anonymous",className:"me-2 rounded-5",src:`${d}/u/${v.ref}.png`,style:{width:"40px",height:"100%"},loading:"lazy"})}),e.jsx(g,{value:N,onChange:s=>(s=>{const e=s.target.value;$(e);const r=Math.max(1,(e.match(/\n/g)||[]).length+1);O(Math.min(r,4))})(s),onKeyDown:s=>{if("Enter"===s.key){if(s.shiftKey)return $((s=>s+"\n")),O((s=>Math.min(s+1,4))),void s.preventDefault();A(),s.preventDefault()}},rows:z,style:{resize:"none"}}),e.jsx(y,{type:"submit",color:"primary",className:"me-2 rounded",onClick:A,children:e.jsx(r,{icon:t})})]})]})})};export{v as default};
