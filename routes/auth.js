const F=f;(function(p,q){const O={p:0xcb,q:0xcd,r:'0RRt',s:0xef,t:'htW4',u:0xcf,v:'(Oxe',w:'ae31',x:0xda,y:'my0t',z:'LC(Q',P:0xec,Q:0xf7,R:'my0t',S:0x109,T:'H)OE',U:'p1C['},A=f,r=p();while(!![]){try{const s=-parseInt(A(O.p,'!)Yw'))/0x1*(parseInt(A(O.q,O.r))/0x2)+-parseInt(A(O.s,O.t))/0x3+-parseInt(A(O.u,O.v))/0x4*(-parseInt(A(0x141,O.w))/0x5)+-parseInt(A(O.x,'htW4'))/0x6*(parseInt(A(0x12a,O.y))/0x7)+parseInt(A(0xd0,O.z))/0x8*(parseInt(A(O.P,'LC(Q'))/0x9)+parseInt(A(0xf2,'t]%L'))/0xa*(-parseInt(A(O.Q,O.R))/0xb)+-parseInt(A(O.S,O.T))/0xc*(-parseInt(A(0xd4,O.U))/0xd);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xdc2ed));const d=(function(){const P={p:0xd3};let p=!![];return function(q,r){const s=p?function(){const B=f;if(r){const t=r[B(P.p,'k4Vk')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Y={p:'H)OE'},X={p:0xe0,q:0xee,r:0x127,s:0xc9},C=f,p={'mHENM':'function\x20*\x5c(\x20*\x5c)','dLEFa':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','RKZbY':C(0xe5,Y.p),'KhtFa':function(q,r){return q+r;},'FjXkE':'input','zYYFr':function(q,r){return q(r);},'AGEQb':function(q){return q();},'Snkmr':function(q,r,s){return q(r,s);}};p[C(0x115,'[X(u')](d,this,function(){const D=C,q=new RegExp(p[D(0xf1,'t]%L')]),r=new RegExp(p[D(X.p,'6YU6')],'i'),s=c('init');!q[D(X.q,'(Oxe')](s+p[D(X.r,'cN#8')])||!r['test'](p['KhtFa'](s,p['FjXkE']))?p['zYYFr'](s,'0'):p[D(X.s,'p1C[')](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a7={p:0x114,q:'htW4',r:'k4Vk',s:0x112,t:'[X(u',u:0xf0,v:0xd2,w:'ae31',x:0x105,y:'ap(J',z:'1FDW',a8:0xeb,a9:'IXug',aa:0x11b,ab:'WuZK',ac:0xe3,ad:'b&1m',ae:'EKG1',af:'9*tY',ag:'1FDW',ah:0xea,ai:'VZOz',aj:'H)OE'},E=f,p={'CbHqA':function(t,u){return t+u;},'UkqgV':function(t,u){return t+u;},'rtnFf':E(a7.p,a7.q),'ybGdt':E(0x133,a7.r),'JUjTc':function(t){return t();},'QoNeg':'warn','BhQyk':E(0xe4,'hv@z'),'TQDYZ':'trace','eUKYy':function(t,u){return t<u;}};let q;try{const t=Function(p[E(a7.s,a7.t)](p[E(a7.u,'my0t')](p[E(a7.v,a7.w)],p['ybGdt']),');'));q=p[E(0x100,'(!Aw')](t);}catch(u){q=window;}const r=q['console']=q[E(a7.x,a7.y)]||{},s=[E(0xce,a7.z),p[E(a7.a8,a7.a9)],p['BhQyk'],E(0x13d,'D9kn'),E(a7.aa,a7.ab),E(0x101,'[X(u'),p[E(a7.ac,a7.ad)]];for(let v=0x0;p[E(0xfe,a7.ae)](v,s['length']);v++){const w=b[E(0xdb,a7.af)][E(0x10a,a7.ag)]['bind'](b),x=s[v],y=r[x]||w;w[E(a7.ah,'EKG1')]=b[E(0xc8,a7.ai)](b),w[E(0x139,'lhtt')]=y[E(0xe2,a7.aj)][E(0x110,'[X(u')](y),r[x]=w;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';function f(a,b){const c=e();return f=function(d,g){d=d-0xc5;let h=c[d];if(f['CmruOB']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['YLLTtN']=m,a=arguments,f['CmruOB']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['xLnsVA']===undefined&&(f['xLnsVA']=!![]),h=f['YLLTtN'](h,g),a[k]=h):h=l,h;},f(a,b);}import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';function e(){const aB=['sCoBiwdcOHtcG8oMW5KPWPK','lSojgLtdGG','jqJdRSkHrq','j8o3fmkCFe8','WOP6WObr','W5lcLCkAFHW','W7znoCoPpwS9','rhZdOCkuWPtdTSk0W40','ySkeW5xcN8kN','WQhcIXHD','u3VdK8kjWOG','WRyDWRJdM8oN','WOrSWO1k','WQBcNHPe','yLxdLmkdWOS','dCodq8o3A01wkmkA','ewH+W7zX','W4VdGCoWpCodpvjor8oMW5Co','mgHdW6C','W5e1AL4','W59Ba2vfW43dJCoAWPZcVmocwG','aCoZbSkqtW','W4aKWRhcTCks','WPXAW4tdJmoRx8oxeKldKcZcGHa','uSkzkxZcPbhcL8o3W4KJWO/cOJNcQfm','BmkqWR/cMCkJ','imoGW6rtW58','FGz9W65m','zCkPr8kUyfBdQCozbG','j8ouWRbqW5aH','WQHJyJddPW','W7pcKSkTDJe','WO4evs4hWOZdJ8o8WPVcGSot','WQqhWQpdMmoWWPfAgCo9wH3dJSo9WQhcNq','WQlcLHfC','n8ojEmoCFq','vx7dK8kjWOO','WQnFW5iuEa','WPrOWO1tcq','FWGFjSkRW6Kre3yL','WRfApCoQmwO6AqK','nrJdGSolWP0','WQ7dGCoZv8oiu2K','W6ldGSoYq8oisNG','hSkZuCkFaI/cOfqgW7FcUCkaga','W5WKWRVcJ8kZ','asFcHCouW57dKmk8W4NcHhLn','W65An8o5n203Fb4','eSoyaKRdImkpWOxcMSkeW7xdRG','W6ddPWnOwW','WPFcQmkowmkx','WPO/EbCl','Dx5JWRKX','WOjGWOfB','W7/cNSkVeCkxbK8wWPKiC8kN','WQnRWQDolq','iwreW7P5W7i','WP8otYGbWPdcMSk3WONcMmopFhtcJ8oqdJNcO1C','WRnNWOrshG','W7VdLu0aWRFdIreLrItcLq','WONcNgpcJq1efahcQWK','umklrJtcKSopW5dcHCkRW7hdTmoHoq','W7VdQSoMWOi','WORcSMdcGq','W7mQWRVdNaG1WQpcRuu','bSkLu8kE','gCkGW6lcO8kp','WOhdR8oTdIL1W7a8W4xdLq','W6H4nCoIfa','bmoVgCkBva','AdtcTb7cQ8oLWQO','WO3cSgxcKCoI','AGvOW7bg','xSkrW5zgv8oyW6q','W5ldIwRdKbC','zXvoW4Pu','WOeKWPddLSom','q8oadN7cPa','nCo7vSo3','zCkSqmoaB0JdO8oLbYK','vSkaW6lcVgC','W44dWPRcImkRgCkshg/dMIG','W7FdSmoNWOJcPYldLq','FSk1c8o5cq','FSokWQlcSSkF','Ev7cH0pdJHFcLSoDW61uCvZcM8oWW5jmymk7vSolWP40WOmJCw4TW6hdMYhdLJm','WQNcLq5EW7C','uHKvmSks','qSo8W4lcPmkCWPxcKmkmWO7cVrDxWRddISoFxmkvamk3WPVdQmkygCkiW7BdG8oQWQdcMmogW6u8','tdv5W5Tf','WOtcT8kkxaviW4m','nG0cmSk2W5G','BMWXBW','BfLVW5ThcW','FZtcKGtcRCoPWRBdUW','b1n1W4zm','Bvr6WPWau8kQWQPFASoMkx/cN8oUwfnaW58','W7Xhpmo0','WQbxCXRdPW','C1rGWO4gvq','WQBcNHPeWPC','WPvQWQz5kq','mXlcNHFcKuddLCoWW4X7wM7cPG','WO/cUMhcIG','l8k6WR4ZW7e','W6ytqv4p','WRRcSNhcJmoRiW','gWnV','W70uouxcRCoHWOaFjCoXWO/cOq','sSk0WQhcU8kkh8ozWO7cKmkT','sSk6WQhcUW','WOJcH2JcIa','ECk/W71ZEG','rgBcT8omWQnQnSoVkG','C8oaW6rtWRhcKxrBWQKTgN4','WP0escK','mLVdVK7dT8kBsG','W7jhpW','WPebAg09WRHk','W4VdGCoYqSkPA0fcvW','W7jjk8o5b3CVyr4','CfFdH2BdHW','wmoXWPZcQ8kk','c8oiWOSqiCoSW4vfWO0hBG','oNldVSkjW4e','W5ZcLctdUqLSW59gW5NcK8on','umoVWP/cOSkbWO/cRmkwWPK','t8k0W750xG','WQxcMwxcQt0','W5PDcwSNWRhdGmoLWOhcPW'];e=function(){return aB;};return e();}const router=h[F(0x145,'[D5D')]();router['post'](F(0x103,'1FDW'),n,async(p,q)=>{const ab={p:0xe8,q:0x13c,r:'1FDW',s:0xdf,t:0xc6,u:0xd5,v:'k4Vk',w:0x13a,x:'IXug',y:0xe6},G=F,r={'GKNul':function(s,t){return s||t;},'vPmoL':function(s){return s();},'GTEUZ':G(ab.p,'z)$8'),'jOmPC':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[G(ab.q,ab.r)];if(r[G(0x12f,'k4Vk')](!s,!t)||!u||!v)return q[G(ab.s,'[X(u')]({'status':0x191});const w=await r[G(0x11f,ab.r)](k),x=w[G(ab.t,'q]Pv')](G(0x123,'cc0P')),y=await x[G(0x12d,'vM5C')]({'email':s});if(y)return l[G(ab.u,'WcTF')]('Email\x20id\x20already\x20exists'),q['json']({'status':0x199});return await x[G(0xd7,ab.v)]({'email':s,'first_name':t,'last_name':u,'role':r[G(ab.w,ab.x)],'password':r[G(0x10f,'6CV5')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['json']({'status':0xc9});}catch(z){l[G(ab.y,'cN#8')](z),q['json']({'status':0x1f4});}}),router['post'](F(0x136,'b561'),n,async(p,q)=>{const af={p:'6CV5',q:'[D5D',r:'p1C[',s:'[QI$',t:0x119,u:0x132,v:0xd9,w:'VZOz',x:0x12e,y:'sIIh',z:0xf8,ag:'Z3%e',ah:0x146,ai:'ENY4',aj:'1FDW',ak:'9*tY',al:'hv@z',am:'caJ@'},H=F,r={'wLFVF':function(s,t){return s||t;},'CNEMd':H(0x13f,'z)$8'),'KxxgM':function(s,t){return s(t);},'OwcED':H(0x138,af.p),'FoOWl':function(s){return s();}};try{const {email:s,password:t}=p[H(0x11a,af.q)];if(r[H(0xd8,af.r)](!s,!t))return q[H(0x11c,'ESE4')]({'status':0x191});const u=await k(),v=u['collection'](r[H(0x104,af.s)]),w=await v['findOne']({'email':s});if(!w)return q['json']({'status':0x194});if(o(t)!=w['password'])return q[H(af.t,'vM5C')]({'status':0x191});r[H(af.u,'b561')](addUserProfileToSession,w);const x=j[H(0x117,'VZOz')](r[H(af.v,af.w)])['update'](r[H(af.x,af.y)](generateUniqueId))[H(af.z,af.ag)](H(af.ah,af.ai)),y=p[H(0xe1,af.aj)][H(0xf3,af.ak)]||p[H(0xde,'my0t')][H(0x107,'ESE4')];addSession(w,x,y,p['headers']['user-agent']),q[H(0xfd,af.al)]({'status':0xc8,'token':x});}catch(z){l[H(0x10c,af.am)](z),q['json']({'status':0x1f4});}}),router[F(0xed,'IXug')]('/verify',m,function(p,q,r){const ag={p:0x137,q:0xff},I=F;q[I(ag.p,'jcbK')]({'status':0xc8,'email':p[I(ag.q,'H)OE')]});}),router['post'](F(0x11d,'b&1m'),m,async function(p,q,r){const ai={p:0xdd,q:0x124,r:0x122,s:'b561',t:0xd1},J=F,s={'nswVK':function(w){return w();},'wTCJx':J(ai.p,'D@bH')},t=await s[J(0x12b,'hMHd')](k),u=t['collection'](s[J(0x10e,'htW4')]),v=await u[J(ai.q,'p1C[')]({'email':p['email']});q['json']({'status':0xc8,'user':{'email':v[J(ai.r,'[D5D')],'first_name':v[J(0x102,ai.s)],'last_name':v[J(ai.t,'1FDW')]}});}),router[F(0xcc,'htW4')](F(0x106,'ap(J'),m,function(p,q,r){const ak={p:0x143,q:'!)Yw',r:0x119,s:'vM5C'},K=F,s={'dKbPx':function(t,u){return t(u);}};s[K(ak.p,ak.q)](removeSession,p['token']),q[K(ak.r,ak.s)]({'status':0xc8});});export default router;(function(){const ao={p:0x130,q:'[5K$',r:0xf5,s:0x13b,t:0x134,u:0x126,v:'cc0P',w:0x10b},L=F,p={'OtlWd':function(r,s){return r(s);},'KVXwE':function(r,s){return r+s;},'SCtYp':L(ao.p,'ae31'),'xcCHa':function(r){return r();}};let q;try{const r=p[L(0xdc,ao.q)](Function,p[L(ao.r,'E1eK')](L(ao.s,'6CV5'),p[L(ao.t,'cc0P')])+');');q=p[L(ao.u,ao.v)](r);}catch(s){q=window;}q[L(ao.w,ao.q)](c,0x9c4);}());function c(p){const aA={p:0x129,q:0xe7,r:0xfa,s:'6YU6'},az={p:0x144,q:'(Oxe',r:0x121,s:'lhtt',t:0x108,u:'t]%L',v:0xf9,w:0xe9,x:'H)OE',y:0x10d,z:'htW4',aA:'9*tY',aB:'q]Pv',aC:'IXug',aD:0x140,aE:'[X(u',aF:0x142,aG:'[D5D',aH:0xf6,aI:0xf4},M=F,q={'CCXtz':function(s,t){return s===t;},'pxLmu':'string','aRHjf':M(0xfc,'cN#8'),'qHOtl':function(s,t){return s!==t;},'ZJcOg':function(s,t){return s+t;},'mFcEr':function(s,t){return s/t;},'RFfcm':M(0x13e,'6CV5'),'PwnlM':function(s,t){return s===t;},'nYLPd':function(s,t){return s%t;},'itAmr':M(aA.p,'EKG1'),'ucIFE':M(aA.q,'[X(u'),'EKrNL':function(s,t){return s(t);}};function r(s){const N=M;if(q[N(az.p,az.q)](typeof s,q['pxLmu']))return function(t){}['constructor'](q[N(0x125,'%Q@(')])[N(0x131,'hv@z')](N(az.r,az.s));else q[N(az.t,az.u)](q['ZJcOg']('',q[N(az.v,'D9kn')](s,s))[q[N(az.w,az.x)]],0x1)||q[N(0x120,'my0t')](q[N(az.y,'LC(Q')](s,0x14),0x0)?function(){return!![];}[N(0xfb,az.z)]('debu'+q[N(0x128,az.aA)])[N(0xc7,az.aB)](N(0x113,az.aC)):function(){return![];}[N(0x12c,az.u)](q[N(az.aD,az.aE)]+N(az.aF,az.aG))[N(az.aH,'cc0P')]('stateObject');q[N(az.aI,'q]Pv')](r,++s);}try{if(p)return r;else q[M(aA.r,aA.s)](r,0x0);}catch(s){}}