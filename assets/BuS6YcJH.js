import{R as e,r as s,j as r}from"./Oq9P1Wj_.js";import{F as a,H as t}from"./IXMtX5d7.js";import{Q as i}from"./Cl7qhzEd.js";import o from"./D9496bDv.js";import{R as n}from"./eGqyD3ZN.js";import{a as c,b as l,e as d}from"./DHDaIMNL.js";import{S as m}from"./DgAvnhY3.js";import{d as p,k as j}from"./Ce_fjdqS.js";import{c as u,a as h,b as f,d as x,e as y,g as v,h as b,i as g,Y as S}from"./zusKMQ8X.js";import"./deeEeel3.js";import"./NdsU5MZw.js";import"./BXWkExu4.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./CewSaW8v.js";import"./B0pL_gbQ.js";import"./DhxmCZ7v.js";import"./fHQ1LRrH.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./b9dqFv80.js";import"./VSWDZ_lP.js";import"./B2NO97j6.js";import"./BIq-TSdk.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";const w=()=>{const w={isImport:!1,isResidentialAddress:!1,containsDangerGoods:!1,containsDocuments:!1,from:[{name:"",company:"",country:"",countryCode:"",city:"",zipCode:"",address:"",address2:"",address3:"",phone:"",email:"",taxId:""}],to:[{name:"",company:"",country:"",countryCode:"",city:"",zipCode:"",address:"",address2:"",address3:"",phone:"",email:"",employerId:""}],type:"private",items:[]},{user:C}=c(),N=e.useRef(),{addToast:k}=l(),[_,R]=s.useState(w),[A,D]=s.useState(w);s.useState("");const[E,F]=s.useState(""),[T,$]=s.useState(!0),[z,B]=s.useState(!0),[I,L]=s.useState(!1),[O,Y]=s.useState(!1),Q=s.useRef(null),q=p(),{id:G}=j();return s.useEffect((()=>{(async()=>{axios.get(`/freight/${G}`).then((e=>{R({...e.data,internal:!0}),D({...e.data,internal:!0})})).catch((e=>{L(!0)})).finally((()=>$(!1)))})()}),[]),T?r.jsx("div",{className:"loading-overlay",children:r.jsx(u,{color:"primary",variant:"grow"})}):I?r.jsx(h,{className:"justify-content-center my-5",children:r.jsx(f,{md:6,children:r.jsxs("div",{className:"clearfix",children:[r.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),r.jsx("h4",{children:"There was no shipment found."}),r.jsx("p",{children:"Double check tracking number for any mistake."})]})})}):r.jsxs("div",{children:[O&&r.jsxs(x,{visible:!0,onClose:()=>Y(!1),alignment:"center",scrollable:!0,children:[r.jsx(y,{closeButton:!0}),r.jsx(v,{children:r.jsx("div",{className:"d-flex justify-content-center align-items-center",children:r.jsx("div",{ref:Q,className:"d-inline-block",children:r.jsx(i,{value:G})})})}),r.jsx(b,{className:"d-flex justify-content-center align-items-center",children:r.jsx(g,{color:"primary",onClick:()=>{Y(!1),o(Q.current,{useCORS:!0}).then((e=>{const s=e.toDataURL("image/png"),r=document.createElement("a");r.href=s,r.download="qrcode.png",document.body.appendChild(r),r.click(),document.body.removeChild(r)}))},children:"Download"})})]}),r.jsx(n,{ref:N,size:"invisible",sitekey:d}),r.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4",children:[r.jsxs("span",{className:"d-block",children:[r.jsx("span",{className:"text-primary fw-bold small",children:"Tracking Number:"}),r.jsx("br",{}),G]}),r.jsxs(S,{className:"mb-2 mb-sm-0",children:[r.jsx(g,{color:"primary",className:"me-2 rounded",onClick:e=>Y(!0),children:r.jsx(a,{icon:t})}),"cancelled"!==E&&"received"!==E&&r.jsxs(r.Fragment,{children:["to_pay"===E&&"user"===C.role&&r.jsx(g,{color:"primary",className:"me-2 rounded",onClick:async()=>{const e=await N.current.executeAsync();$(!0),axios.post("/invoices",{id:G,recaptcha_ref:e}).then((e=>window.location.href=e.data.r_url)).catch((e=>{var s,r;const a=(null==(r=null==(s=e.response)?void 0:s.data)?void 0:r.error)||"Server is offline or restarting please wait";k(a)})).finally((()=>$(!1)))},children:"Book shipment"}),r.jsx(g,{color:"primary",className:"me-2 rounded",onClick:async()=>{if(z)return B(!1);const e=await N.current.executeAsync();$(!0);const s={...A,recaptcha_ref:e};axios.post(`/freight/update/${G}`,s).then((e=>k("Your changes has been saved."))).catch((e=>{var s,r;const a=(null==(r=null==(s=e.response)?void 0:s.data)?void 0:r.error)||"Server is offline or restarting please wait";k(a,"Submit failed!"),D(_)})).finally((()=>{$(!1),B(!0)}))},disabled:["to_receive","received"].includes(E),children:z?"Edit":"Save"}),r.jsx(g,{color:z?"danger":"warn",className:"me-2 rounded",onClick:async()=>{if(!z)return B(!0),void D(_);const e=await N.current.executeAsync();$(!0),axios.post(`/freight/cancel/${G}`,{recaptcha_ref:e}).then((e=>{k("Shipment has been cancelled."),q("/dashboard")})).catch((e=>{var s,r;const a=(null==(r=null==(s=e.response)?void 0:s.data)?void 0:r.error)||"Server is offline or restarting please wait";k(a,"Submit failed!"),D(_)})).finally((()=>$(!1)))},disabled:["to_receive","received"].includes(E),children:"Cancel"})]})]})]}),r.jsx(m,{data:{form:_,setForm:R,loading:T,setLoading:$}})]})};export{w as default};
