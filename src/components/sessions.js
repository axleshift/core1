function e(){const ah=['ESo/qW','w8onaSkPWP1XW5RdJa','m1vNWQbwW4FdHCkLW68F','uY3cNmk6W7q','W6aintiQW67cQq','cCkFbSkc','WRWHW5rwW7a','gs7cMa','yGKZW7OeWPlcGCkkW4WYWQTNW4y','W6JdU2RdOCkQW5ldTa','h1ddMmoQWPKwW5O','eSoQW7ykW4G','dmkrdCku','W57dGca','ceC/mdC','W53dTJ5tW7C','C3lcNCo7WQ/dSCk7WOu','vI9cWO5E','WR46WOvUWPZdHr4LBa','WRbTWRLOWPldTK8UW7XL','W4PDW6tcJgG','W6BcJglcHa0','W7ddMCkwAG','W4P/W6tcNv8','dgxcM07dMSora8k2cMraW7ZcTG','W4RcRMlcOG','WRKVWPv6WPRdJNfJB8onW6aXW6NcG8oeWO9tWR9W','W4pdIIrlW7FdQ8kPCG','WRRdLMHhlG','c8kaamkvWRHCW7RdGmk1','nqJcHSoZWQW','WQJdGwveaa','DCkdwtZcVW','W7vxW7iv','bW3dNSkFW5S','W5CAFSoIaCkbFCo5Da','cmkdbmojaLq','WQqhWPnrW50','W63cM0JcGby','W7xdQmkmW7dcUmk5','c8kvaSkzWQr3W6xdISkPmIRcOmoUxCkG','iCkCfmozWRuByXu','WQdcNCotu8kB','WPC8gJtdNW','yGOZWQn+W7hdQCkMW5i','gSkfa8otbfxcGZq','fgOHcGO','WRhdSvL6kq','cdFcL8ohWPm','CNldISksW4VcMSolWO5IW7xdIeqT','W6SKySo8','W6qQAq','CdtdTcO','wYddUYRcIa','WRuvWODS','WRtcNSogtCkr','D8kCxd7cSGBcGG','WRjHWO0PWO1Qf1G','W6FdSwRdTCkXW5y','WRyHnXFdKaBdV2n2CePTWQJcVXS','F0pcQSo8WOjpgCokW7lcTSo7hti','jSkGuSkkWP0','WQeBWPTXW4/cGvfJimkdW74','Amo0kmonWQdcLSovWPPpWPG','zgldMSkeWO1CW7/cN8kSaai','W7m4imoZaCkByCoswCoFWQldRHa7z8kNW77dVclcMmkeifxdV8khrmoJc8k7W73cLgu','tb3cRmkTW4fLW7RdRtBdVG','h1ddMSo1WPmzW4VcSSk5qW','b8kYf8k3WPO','CSkArZtcIq3cLq','jHVdRG','jSkHe3nL','W5pdMSkHpWW','rq7cJSkVW4aIW7BcKCkXBca','mXhcLCo2WRC','eSk/eCoFW7G6','D8kCrtZcOWdcHmkEjGu','wXJcNSoQbrVcPSoLWQtdPCoVba','WOK4WRhdImoatmkUWQKoz0O','WO4ljsKs','WQtdU8oztcW','W6DhW68cDmkyWQHyW5NcIK/dUblcPwO0','lZBcLSohW4LQWPBdVCkTnaVcVmoVWRugW7JcO8kMW4u','W7L+A07dUxFcVvHgyG','k8kie8osW7y','W79/W5C/W5NcKMGJFSoRW4qXW5y','WRyLWQ9HW5O','AYfiWODF','ymkssZZcOW','bCkJamoE','jCkZECkzWPJcOSoWWRTO','CCoaba','WRa3W49SWOFdJIi/E8onW60MW7lcMmkdW4mjW7mKetOaWPudexbHWPfGW5NdVwi','zmogBMxdRG','W490W7RcJ1/cQq','WQpdVhXygW','xHBcMSoObrxdPCoRWONdUCoeodW','mmk5fCo1bq','WRzWWQDRWOu','fSk6mhXdWOu9','dtRcVmoIW6W','hSo8W51RW4y','W6ldGqnTW48','FZBcPCo/W50ZW64','WP46W7DqW7e','ydldTIS','W5ZcSWeGtSkImCkSW6ZdVmoKjSo0','l8kIjmoojW','WRP2nSkMwCodiSoGz8oPWOZdTZa'];e=function(){return ah;};return e();}(function(i,j){const F={i:0x15f,j:0x159,k:'zJR%',l:0x17d,m:0x189,n:'YXkW',o:0x155,p:'Spj7',q:0x124,G:0x148,H:'j4#Q'},r=f,k=i();while(!![]){try{const l=-parseInt(r(F.i,'2OBF'))/0x1*(-parseInt(r(0x138,'@)0l'))/0x2)+parseInt(r(F.j,F.k))/0x3*(parseInt(r(F.l,'2[2)'))/0x4)+-parseInt(r(F.m,F.n))/0x5*(parseInt(r(F.o,F.p))/0x6)+parseInt(r(F.q,'HeHB'))/0x7+-parseInt(r(F.G,F.H))/0x8+-parseInt(r(0x161,'BUrd'))/0x9+parseInt(r(0x181,'@)0l'))/0xa;if(l===j)break;else k['push'](k['shift']());}catch(m){k['push'](k['shift']());}}}(e,0x77f23));const d=(function(){const G={i:0x136};let i=!![];return function(j,k){const l=i?function(){const s=f;if(k){const m=k[s(G.i,'St9%')](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}());(function(){const P={i:0x15d,j:'Ck#m'},O={i:0x174,j:'Ck#m',k:0x18e,l:'zJoN',m:0x12d,n:'45j5',o:0x13a,p:'HeHB'},t=f,i={'GvBom':t(P.i,'45j5'),'iLpdC':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','riFvP':function(j,k){return j(k);},'XGsRM':'init','nDXLm':function(j,k){return j+k;},'uvTPG':'chain','iJtGR':t(0x123,P.j),'bpPUd':function(j){return j();},'LQwLh':function(j,k,l){return j(k,l);}};i[t(0x15c,'$C8U')](d,this,function(){const u=t,j=new RegExp(i[u(O.i,'w0(o')]),k=new RegExp(i[u(0x18d,O.j)],'i'),l=i['riFvP'](c,i[u(O.k,O.l)]);!j[u(O.m,O.n)](i[u(O.o,'a8Tb')](l,i['uvTPG']))||!k[u(0x125,'zJoN')](l+i[u(0x150,'XjY3')])?i[u(0x187,'a8Tb')](l,'0'):i[u(0x141,O.p)](c);})();}());const b=(function(){let i=!![];return function(j,k){const l=i?function(){if(k){const m=k['apply'](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),a=b(this,function(){const Y={i:0x15e,j:'HcpT',k:0x142,l:'XjY3',m:0x164,n:'mTkZ',o:0x18a,p:'8oUt',q:0x183,Z:0x13f,a0:'ihin',a1:0x188,a2:'0tZB',a3:0x13c,a4:'YXkW',a5:0x12f,a6:'MlJK',a7:'h480',a8:0x145},X={i:0x17c,j:'USMh',k:0x177,l:'sdht',m:0x168,n:'BUrd'},v=f,i={'iXhXN':function(n,o){return n(o);},'yYBdA':function(n,o){return n+o;},'FBTnJ':v(Y.i,Y.j),'eybbP':function(n){return n();},'cEeIe':v(Y.k,'[)f&'),'APIRE':'info','JduOY':v(0x129,Y.l),'mYiki':v(Y.m,Y.n),'Npkei':'trace'},j=function(){const w=v;let n;try{n=i['iXhXN'](Function,i[w(X.i,X.j)](i[w(X.k,X.l)],w(X.m,X.n))+');')();}catch(o){n=window;}return n;},k=i[v(Y.o,Y.p)](j),l=k[v(0x182,'@z9r')]=k[v(Y.q,'Spj7')]||{},m=[v(Y.Z,Y.a0),i['cEeIe'],i[v(0x169,'T)z2')],'error',i['JduOY'],i[v(Y.a1,Y.a2)],i[v(Y.a3,Y.a4)]];for(let n=0x0;n<m[v(0x146,'@z9r')];n++){const o=b['constructor']['prototype']['bind'](b),p=m[n],q=l[p]||o;o[v(Y.a5,'ihin')]=b[v(0x140,Y.a6)](b),o[v(0x135,Y.a7)]=q[v(Y.a8,']iA8')][v(0x185,Y.l)](q),l[p]=o;}});a(),(function(){const a1={i:0x14d,j:'ihin'},a0={i:0x16b,j:0x126},x=f,i={'JzMIc':function(l,m){return l+m;},'eKhdb':x(a1.i,a1.j)},j=function(){const y=x;let l;try{l=Function(i[y(a0.i,'WZH4')](i[y(0x170,'DS5c')](y(a0.j,'BUrd'),i['eKhdb']),');'))();}catch(m){l=window;}return l;},k=j();k['setInterval'](c,0x9c4);}());import{ObjectId}from'mongodb';function f(a,b){const c=e();return f=function(d,g){d=d-0x122;let h=c[d];if(f['bcAfyS']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['ZUBNzx']=m,a=arguments,f['bcAfyS']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['QzJwwA']===undefined&&(f['QzJwwA']=!![]),h=f['ZUBNzx'](h,g),a[k]=h):h=l,h;},f(a,b);}import g from'../models/db.js';import h from'./logger.js';export const addSession=async(i,j,k,l)=>{const a3={i:'2mNO',j:0x167,k:']Kqc'},z=f,m={'vcOrq':function(n){return n();}};try{const n=await m[z(0x149,'VUcB')](g);n[z(0x18c,a3.i)]('sessions')['insertOne']({'user_id':i[z(0x180,'YXkW')],'token':j,'active':!![],'ip_address':k,'user_agent':l,'compromised':![],'last_accessed':Date[z(a3.j,a3.k)]()});}catch(o){h['error'](o);}};export const getUser=async i=>{const a4={i:0x127,j:'St9%',k:0x17b,l:0x17f,m:'w0(o',n:0x16e,o:'2mNO'},A=f,j={'JNqyk':A(a4.i,'0tZB'),'akBXf':A(0x143,a4.j)};try{const k=await g(),l=await k[A(a4.k,'@)0l')](j[A(0x160,'esxQ')])['findOne']({'token':i});if(!l)return null;const m=await k['collection'](j['akBXf'])[A(0x151,'mTkZ')]({'_id':l['user_id']});return{'_id':m[A(0x179,'T)z2')],'email':m[A(a4.l,a4.m)],'first_name':m[A(0x14e,'USMh')],'last_name':m['last_name'],'role':m[A(0x175,'MlJK')],'email_verify_at':m[A(0x134,'XjY3')]};}catch(n){h[A(a4.n,a4.o)](n);}return null;};export const removeSession=async i=>{const a5={i:0x139,j:0x157,k:0x18b,l:'BUrd',m:0x152,n:'j4#Q'},B=f,j={'sOzQV':B(a5.i,'sdht'),'AGTUx':B(a5.j,'esxQ')};try{const k=await g();await k[B(0x158,'mTkZ')](j[B(0x12a,'YXkW')])[B(a5.k,a5.l)]({'token':i},{'$set':{'active':![],'last_accessed':Date[B(a5.m,a5.n)](),'modified_by':j[B(0x12b,'WZH4')]}});}catch(l){h['error'](l);}};export const getSession=async i=>{const a6={i:0x15b,j:'2[2)',k:'oV5x',l:'VUcB',m:0x186,n:'ZGlc'},C=f,j={'VuDOj':'sessions'};try{const k=await g(),l=await k[C(0x14f,'Spj7')](j[C(a6.i,a6.j)])[C(0x16f,a6.k)]({'token':i});if(l[C(0x133,'fwux')])k['collection'](j[C(0x137,'2OBF')])[C(0x166,a6.l)]({'token':i},{'$set':{'last_accessed':Date[C(a6.m,'0tZB')]()}});return l;}catch(m){h[C(0x154,a6.n)](m);}return null;};function c(i){const ag={i:'mTkZ',j:'Ck#m',k:'esxQ',l:0x17e,m:0x130,n:'sdht',o:0x184},af={i:'2OBF',j:0x163,k:'sdht',l:'0tZB',m:'j4#Q',n:0x15a,o:'OQkB',p:0x132,q:0x162,ag:'[)f&',ah:0x156,ai:'WZH4',aj:0x122,ak:'3er0',al:'[)f&',am:0x184},D=f,j={'lcsqB':'string','BkDui':D(0x144,ag.i),'XwhkQ':function(l,m){return l+m;},'YYeUh':function(l,m){return l/m;},'VrMki':D(0x16a,ag.j),'RnTUQ':function(l,m){return l===m;},'OyGUh':function(l,m){return l%m;},'SPYVV':D(0x165,ag.k),'tQZca':D(ag.l,'XjY3'),'uViTM':D(ag.m,ag.n),'fsfSf':'stateObject','ZDknH':function(l,m){return l(m);}};function k(l){const E=D;if(typeof l===j['lcsqB'])return function(m){}['constructor'](E(0x147,af.i))[E(0x12c,'mTkZ')](j['BkDui']);else j[E(af.j,'8oUt')]('',j[E(0x16d,af.k)](l,l))[j[E(0x153,'oV5x')]]!==0x1||j[E(0x172,af.l)](j[E(0x12e,af.m)](l,0x14),0x0)?function(){return!![];}[E(af.n,'x[Q$')](j[E(0x171,af.o)](j[E(af.p,'zJoN')],j[E(af.q,af.ag)]))[E(0x13e,'ihin')](j[E(af.ah,'YXkW')]):function(){return![];}[E(0x14a,af.ag)](j[E(0x13b,af.ai)](j[E(0x128,af.ai)],E(af.aj,af.ak)))['apply'](j[E(0x131,af.al)]);j[E(af.am,'m)oj')](k,++l);}try{if(i)return k;else j[D(ag.o,'m)oj')](k,0x0);}catch(l){}}