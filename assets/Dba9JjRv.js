import{R as e,r as s,j as a}from"./Oq9P1Wj_.js";import{F as t,I as r}from"./C6rVyMd0.js";import{Q as i}from"./Cl7qhzEd.js";import{h as o}from"./DxFnCsxZ.js";import{R as n}from"./eGqyD3ZN.js";import{a as c,b as l,e as d}from"./CywavMoL.js";import{E as m}from"./BGB82IPO.js";import{S as p}from"./C_5WVcip.js";import{d as j,k as u}from"./Ce_fjdqS.js";import{c as h,a as f,b as x,d as y,e as v,g,h as b,i as S,Y as w}from"./3-dW6UXf.js";import"./deeEeel3.js";import"./NdsU5MZw.js";import"./BXWkExu4.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./CewSaW8v.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./fHQ1LRrH.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./ChytwAMd.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";const C=()=>{const C={isImport:!1,isResidentialAddress:!1,containsDangerGoods:!1,containsDocuments:!1,from:[{name:"",company:"",country:"",countryCode:"",city:"",zipCode:"",address:"",address2:"",address3:"",phone:"",email:"",taxId:""}],to:[{name:"",company:"",country:"",countryCode:"",city:"",zipCode:"",address:"",address2:"",address3:"",phone:"",email:"",employerId:""}],type:"private",items:[]},{user:k}=c(),N=e.useRef(),{addToast:R}=l(),[_,D]=s.useState(C),[A,E]=s.useState(C);s.useState("");const[I,O]=s.useState(""),[z,F]=s.useState(!1),[$,q]=s.useState(!0),[B,L]=s.useState(!1),[P,Q]=s.useState(!1),T=s.useRef(null),Y=j(),{id:G}=u();return s.useEffect((()=>{(async()=>{F(!0),axios.get(`/freight/${G}`).then((e=>{D({...e.data,internal:!0}),E({...e.data,internal:!0})})).catch((e=>{L(!0)})).finally((()=>F(!1)))})()}),[]),z?a.jsx("div",{className:"loading-overlay",children:a.jsx(h,{color:"primary",variant:"grow"})}):B?a.jsx(f,{className:"justify-content-center my-5",children:a.jsx(x,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no shipment found."}),a.jsx("p",{children:"Double check tracking id for any mistake."})]})})}):a.jsxs("div",{children:[P&&a.jsxs(y,{visible:!0,onClose:()=>Q(!1),alignment:"center",scrollable:!0,children:[a.jsx(v,{closeButton:!0}),a.jsx(g,{children:a.jsx("div",{className:"d-flex justify-content-center align-items-center",children:a.jsx("div",{ref:T,className:"d-inline-block",children:a.jsx(i,{value:G})})})}),a.jsx(b,{className:"d-flex justify-content-center align-items-center",children:a.jsx(S,{color:"primary",onClick:()=>{Q(!1),o(T.current,{useCORS:!0}).then((e=>{const s=e.toDataURL("image/png"),a=document.createElement("a");a.href=s,a.download="qrcode.png",document.body.appendChild(a),a.click(),document.body.removeChild(a)}))},children:"Download"})})]}),a.jsx(n,{ref:N,size:"invisible",sitekey:d}),a.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4",children:[a.jsx("span",{className:"d-block",children:G}),a.jsxs(w,{className:"mb-2 mb-sm-0",children:[a.jsx(S,{color:"primary",className:"me-2 rounded",onClick:e=>Q(!0),children:a.jsx(t,{icon:r})}),"cancelled"!==I&&"received"!==I&&a.jsxs(a.Fragment,{children:["to_pay"===I&&"user"===k.role&&a.jsx(S,{color:"primary",className:"me-2 rounded",onClick:async()=>{const e=await N.current.executeAsync();F(!0),axios.post("/invoices",{id:G,recaptcha_ref:e}).then((e=>window.location.href=e.data.r_url)).catch((e=>{const s=m[e.status]||"Server is offline or restarting please wait";R(s)})).finally((()=>F(!1)))},children:"Book shipment"}),a.jsx(S,{color:"primary",className:"me-2 rounded",onClick:async()=>{if($)return q(!1);const e=await N.current.executeAsync();F(!0);const s={...A,recaptcha_ref:e};axios.post(`/freight/update/${G}`,s).then((e=>R("Your changes has been saved."))).catch((e=>{const s=m[e.status]||"Server is offline or restarting please wait";R(s,"Submit failed!"),E(_)})).finally((()=>{F(!1),q(!0)}))},disabled:["to_receive","received"].includes(I),children:$?"Edit":"Save"}),a.jsx(S,{color:$?"danger":"warn",className:"me-2 rounded",onClick:async()=>{if(!$)return q(!0),void E(_);const e=await N.current.executeAsync();F(!0),axios.post(`/freight/cancel/${G}`,{recaptcha_ref:e}).then((e=>{R("Shipment has been cancelled."),Y("/dashboard")})).catch((e=>{const s=m[e.status]||"Server is offline or restarting please wait";R(s,"Submit failed!"),E(_)})).finally((()=>F(!1)))},disabled:["to_receive","received"].includes(I),children:"Cancel"})]})]})]}),a.jsx(p,{data:{form:_,setForm:D,loading:z,setLoading:F}})]})};export{C as default};
