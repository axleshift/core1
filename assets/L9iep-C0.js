import{r as e,j as s,R as a}from"./Oq9P1Wj_.js";import{F as t,d as r,l as i,s as l,H as n,V as c,r as d,W as o,X as x}from"./DwMTB8o5.js";import{a as m,V as h,b as p,c as j}from"./DpZRXMGv.js";import{E as u}from"./BGB82IPO.js";import{p as g}from"./B51y9YVM.js";import{c as v,P as y,Q as b,aj as f,ad as N,ae as S,af as w,ag as k,ah as A,ai as C,p as _,a2 as $,g as T,h as R,a3 as K,a as E,b as L,q,r as z,s as D,t as P,a9 as B,ak as U,al as O,am as F,an as I,ao as M}from"./BnevMnkY.js";import{R as H}from"./eGqyD3ZN.js";import{P as V}from"./NdsU5MZw.js";import{d as W}from"./Ce_fjdqS.js";import"./deeEeel3.js";import"./CewSaW8v.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./BKB6Vojr.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./BYNIthp4.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";import"./BXWkExu4.js";const J=()=>{const{addToast:a}=m(),[t,r]=e.useState(!0),[i,l]=e.useState([]);return e.useEffect((()=>{(async()=>{await axios.get(`${h}/api/v1/sec/management/activity`,{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>l(e.data))).catch((e=>{const s=u[e.status]||"Server is offline or restarting please wait";a(s)})).finally((()=>r(!1)))})()}),[]),s.jsxs("div",{children:[t&&s.jsx("div",{className:"loading-overlay",children:s.jsx(v,{color:"primary",variant:"grow"})}),!t&&s.jsx(y,{children:s.jsxs(b,{children:[s.jsx(f,{children:"Activity Logs"}),s.jsxs(N,{hover:!0,responsive:!0,children:[s.jsx(S,{children:s.jsxs(w,{children:[s.jsx(k,{className:"text-muted poppins-regular",children:"Actor"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Type"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Message"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Created At"})]})}),s.jsx(A,{children:i.map(((e,a)=>s.jsxs(w,{children:[s.jsx(C,{children:e.user_id}),s.jsx(C,{children:e.type}),s.jsx(C,{children:e.message}),s.jsx(C,{children:g(e.created_at)})]},a)))})]})]})})]})},Q=()=>{const t=a.useRef(),{addToast:r}=m(),[i,l]=e.useState(!0),[n,c]=e.useState({apiToken:[],deny:!0});return e.useEffect((()=>{(async()=>{await axios.get(`${h}/api/v1/sec/management/apikeys`,{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const s=u[e.status]||"Server is offline or restarting please wait";r(s)})).finally((()=>l(!1)))})()}),[]),s.jsxs("div",{children:[i&&s.jsx("div",{className:"loading-overlay",children:s.jsx(v,{color:"primary",variant:"grow"})}),s.jsx(H,{ref:t,size:"invisible",sitekey:j}),!i&&s.jsxs(s.Fragment,{children:[s.jsx("h4",{children:"Deactivate all apikeys"}),s.jsx(y,{className:"mb-3",children:s.jsxs(b,{children:[s.jsx("p",{children:"Clearing all active apikeys will deny future incoming requests."}),s.jsx(_,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:n.deny,onClick:async()=>{l(!0);const e=await t.current.executeAsync();await axios.post(`${h}/api/v1/sec/management/apikeys/deactivate`,{recaptcha_ref:e},{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>{if(!e.data.error)return window.location.reload()})).catch((e=>{const s=u[e.status]||"Server is offline or restarting please wait";r(s)})).finally((()=>l(!1)))},children:"Deactivate all apikeys"})]})}),s.jsx(y,{children:s.jsxs(b,{children:[s.jsx(f,{children:"API keys"}),s.jsxs(N,{hover:!0,responsive:!0,children:[s.jsx(S,{children:s.jsxs(w,{children:[s.jsx(k,{className:"text-muted poppins-regular",children:"#"}),s.jsx(k,{className:"text-muted poppins-regular",children:"User"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Status"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Token"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Whitelist"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Last Accessed"})]})}),s.jsx(A,{children:n.apiToken.map(((e,a)=>s.jsxs(w,{children:[s.jsx(C,{children:a+1}),s.jsx(C,{children:e.user_id}),s.jsx(C,{children:e.active?"Active":"Inactive"}),s.jsx(C,{children:e.token}),s.jsx(C,{children:e.whitelist_ip.map((e=>e.split(",")[0])).join(" ")}),s.jsx(C,{children:e.last_accessed?g(e.last_accessed):"Never"})]},a)))})]})]})})]})]})},X=({color:e,title:a,value:t,data:r})=>s.jsx($,{color:e,value:t,title:a,action:s.jsx(T,{alignment:"end",children:s.jsx(R,{color:"transparent",caret:!1,className:"text-white p-0"})}),chart:s.jsx(K,{className:"mt-3",style:{height:"70px"},data:{labels:Array(10).fill(""),datasets:[{label:"Data",backgroundColor:"rgba(255,255,255,.2)",borderColor:"rgba(255,255,255,.55)",data:r,fill:!0}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!1}},elements:{line:{borderWidth:2,tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4}},animation:{duration:0}}})});X.propTypes={color:V.string.isRequired,title:V.string.isRequired,value:V.any.isRequired,data:V.any.isRequired};const G=()=>{const[a,t]=e.useState(null),[r,i]=e.useState(!0),{addToast:l}=m(),[n,c]=e.useState(Array(10).fill(0)),[d,o]=e.useState(0),[x,j]=e.useState(Array(10).fill(0)),[g,v]=e.useState(0),y=(e,s,a,t)=>{const r=4*(Date.now()-t),i=parseFloat((a/r*100).toString().match(/^(\d+\.\d)/));j((e=>{const s=[...e,i];return s.length>10&&s.shift(),v(b(s)),s}))},b=e=>{const s=e.filter((e=>0!==e)),a=s.reduce(((e,s)=>e+s),0),t=s.length;return 0===t?0:a/t},f=async()=>{await axios.get(`${h}/metrics/v1/prometheus`,{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>{const s=e.data;t(s),((e,s,a,t)=>{y(e,s,a,t);const r=Date.now()-t,i=parseFloat((s/r).toString().match(/^(\d+\.\d)/));c((e=>{const s=[...e,i];return s.length>10&&s.shift(),o(b(s)),s}))})(s.process_cpu_user_seconds_total[0].value,s.process_cpu_system_seconds_total[0].value,s.process_cpu_seconds_total[0].value,s.process_start_time_seconds[0].value)})).catch((e=>{if(401==e.status)return window.location.reload();const s=u[e.status]||"Server is offline or restarting please wait";l(s,"Submit failed!")})).finally((()=>i(!1)))};return e.useEffect((()=>{f();const e=setInterval((()=>{f()}),1500);return()=>clearInterval(e)}),[]),s.jsx("div",{children:a&&s.jsxs(s.Fragment,{children:[s.jsxs(E,{xs:{gutter:4},children:[s.jsx(L,{sm:6,xl:4,xxl:3,children:s.jsx(X,{color:"primary",title:"Average Load Time",value:d,data:n})}),s.jsx(L,{sm:6,xl:4,xxl:3,children:s.jsx(X,{color:"danger",title:"CPU Usage",value:`${g}%`,data:x})})]}),JSON.stringify(a,null,4)]})})},Y=()=>{const{addToast:a}=m(),[i,l]=e.useState(!0),[n,c]=e.useState([]),[d,o]=e.useState(""),[x,j]=e.useState(0),[_,$]=e.useState(0),[T,R]=e.useState(0);return e.useEffect((()=>{(async()=>{await axios.get(`${h}/api/v1/sec/management/dependabot`,{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const s=u[e.status]||"Server is offline or restarting please wait";a(s)})).finally((()=>l(!1)))})()}),[]),s.jsxs("div",{children:[i&&s.jsx("div",{className:"loading-overlay",children:s.jsx(v,{color:"primary",variant:"grow"})}),0===n.length&&!i&&s.jsx(E,{className:"justify-content-center my-5",children:s.jsx(L,{md:6,children:s.jsxs("div",{className:"clearfix",children:[s.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),s.jsx("h4",{children:"There was no alerts yet."}),s.jsx("p",{children:"Check it out later"})]})})}),0!==n.length&&s.jsxs(s.Fragment,{children:[s.jsxs(q,{className:"d-flex justify-content-left my-2 my-lg-0",children:[s.jsxs(z,{className:"mb-3",children:[s.jsx(D,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:e=>o(e.target.value)}),s.jsx(P,{id:"basic-addon",children:s.jsx(t,{icon:r})})]}),s.jsx("div",{className:"mx-2"}),s.jsx(B,{value:T,onChange:e=>R(e.target.value),options:[{label:"All",value:0},{label:"Resolved",value:1},{label:"Unresolved",value:2},{label:"Not Plan",value:3}],required:!0,className:"mb-3"}),s.jsx("div",{className:"mx-2"}),s.jsx(B,{value:_,onChange:e=>$(e.target.value),options:[{label:"All",value:0},{label:"High",value:1},{label:"Medium",value:2},{label:"Low",value:3}],required:!0,className:"mb-3"}),s.jsx("div",{className:"mx-2"}),s.jsx(B,{value:x,onChange:e=>j(e.target.value),options:[{label:"Newer",value:1},{label:"Older",value:2}],required:!0,className:"mb-3"})]}),s.jsx(y,{children:s.jsxs(b,{children:[s.jsx(f,{children:"Vulnerability Alerts"}),s.jsxs(N,{hover:!0,responsive:!0,children:[s.jsx(S,{children:s.jsxs(w,{children:[s.jsx(k,{className:"text-muted poppins-regular",children:"#"}),s.jsx(k,{className:"text-muted poppins-regular",children:"State"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Scope"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Manifest"}),s.jsx(k,{className:"text-muted poppins-regular",children:"CVE"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Summary"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Severity"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Last Updated"})]})}),s.jsx(A,{children:n.map(((e,a)=>s.jsxs(w,{children:[s.jsx(C,{children:e.number}),s.jsx(C,{children:e.state}),s.jsx(C,{children:e.scope}),s.jsx(C,{children:e.manifest}),s.jsx(C,{children:e.cve}),s.jsx(C,{children:e.summary}),s.jsx(C,{children:e.severity}),s.jsx(C,{children:g(new Date(e.updated_at).getTime())})]},a)))})]})]})})]})]})},Z=()=>{const t=a.useRef(),{addToast:r}=m(),[i,l]=e.useState(!0),[n,c]=e.useState(!1);return e.useEffect((()=>{(async()=>{await axios.get(`${h}/api/v1/sec/management/maintenance`,{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>c(e.data.maintenance))).catch((e=>{const s=u[e.status]||"Server is offline or restarting please wait";r(s)})).finally((()=>l(!1)))})()}),[]),s.jsxs("div",{children:[i&&s.jsx("div",{className:"loading-overlay",children:s.jsx(v,{color:"primary",variant:"grow"})}),s.jsx(H,{ref:t,size:"invisible",sitekey:j}),s.jsx("h4",{children:"Enable maintenance"}),s.jsx(y,{children:s.jsxs(b,{children:[s.jsx("p",{children:"When enabled, it prevents users from interacting with the platform until maintenance is complete."}),s.jsx(_,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",disabled:n,children:"Enable maintenance"})]})})]})},ee=()=>{const{addToast:a}=m(),[i,l]=e.useState(!0),[n,c]=e.useState([]),[d,o]=e.useState(""),[x,j]=e.useState(0),[_,$]=e.useState(0),[T,R]=e.useState(0);return e.useEffect((()=>{(async()=>{await axios.get(`${h}/api/v1/sec/management/sentry`,{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const s=u[e.status]||"Server is offline or restarting please wait";a(s)})).finally((()=>l(!1)))})()}),[]),s.jsxs("div",{children:[i&&s.jsx("div",{className:"loading-overlay",children:s.jsx(v,{color:"primary",variant:"grow"})}),0===n.length&&!i&&s.jsx(E,{className:"justify-content-center my-5",children:s.jsx(L,{md:6,children:s.jsxs("div",{className:"clearfix",children:[s.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),s.jsx("h4",{children:"There was no issues yet."}),s.jsx("p",{children:"Check it out later"})]})})}),0!==n.length&&s.jsxs(s.Fragment,{children:[s.jsxs(q,{className:"d-flex justify-content-left my-2 my-lg-0",children:[s.jsxs(z,{className:"mb-3",children:[s.jsx(D,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:d,onChange:e=>o(e.target.value)}),s.jsx(P,{id:"basic-addon",children:s.jsx(t,{icon:r})})]}),s.jsx("div",{className:"mx-2"}),s.jsx(B,{value:T,onChange:e=>R(e.target.value),options:[{label:"All",value:0},{label:"Resolved",value:1},{label:"Unresolved",value:2},{label:"Not Plan",value:3}],required:!0,className:"mb-3"}),s.jsx("div",{className:"mx-2"}),s.jsx(B,{value:_,onChange:e=>$(e.target.value),options:[{label:"All",value:0},{label:"High",value:1},{label:"Medium",value:2},{label:"Low",value:3}],required:!0,className:"mb-3"}),s.jsx("div",{className:"mx-2"}),s.jsx(B,{value:x,onChange:e=>j(e.target.value),options:[{label:"Newer",value:1},{label:"Older",value:2}],required:!0,className:"mb-3"})]}),s.jsx(y,{children:s.jsxs(b,{children:[s.jsx(f,{children:"Error Reports"}),s.jsxs(N,{hover:!0,responsive:!0,children:[s.jsx(S,{children:s.jsxs(w,{children:[s.jsx(k,{className:"text-muted poppins-regular",children:"#"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Title"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Culprit"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Level"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Status"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Priority"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Count"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Last Updated"})]})}),s.jsx(A,{children:n.map(((e,a)=>s.jsxs(w,{children:[s.jsx(C,{children:e.id}),s.jsx(C,{children:e.title}),s.jsx(C,{children:e.culprit}),s.jsx(C,{children:e.level}),s.jsx(C,{children:e.status}),s.jsx(C,{children:e.priority}),s.jsx(C,{children:e.count}),s.jsx(C,{children:g(new Date(e.updated_at).getTime())})]},a)))})]})]})})]})]})},se=()=>{const t=a.useRef(),{addToast:r}=m(),[i,l]=e.useState(!0),[n,c]=e.useState([]);return e.useEffect((()=>{(async()=>{await axios.get(`${h}/api/v1/sec/management/sessions`,{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>{e.data.error||c(e.data)})).catch((e=>{const s=u[e.status]||"Server is offline or restarting please wait";r(s)})).finally((()=>l(!1)))})()}),[]),s.jsxs("div",{children:[i&&s.jsx("div",{className:"loading-overlay",children:s.jsx(v,{color:"primary",variant:"grow"})}),s.jsx(H,{ref:t,size:"invisible",sitekey:j}),s.jsx("h4",{children:"Logout all sessions"}),s.jsx(y,{className:"mb-3",children:s.jsxs(b,{children:[s.jsx("p",{children:"Clearing all active sessions will log everyone out."}),s.jsx(_,{type:"submit",color:"danger",className:"mt-4 d-block me-2 rounded",onClick:async()=>{l(!0);const e=await t.current.executeAsync();await axios.post(`${h}/api/v1/sec/management/sessions/logout`,{recaptcha_ref:e},{headers:{Authorization:`Bearer ${cookies.get(p)}`}}).then((e=>{if(!e.data.error)return window.location.reload()})).catch((e=>{const s=u[e.status]||"Server is offline or restarting please wait";r(s)})).finally((()=>l(!1)))},children:"Logout all sessions"})]})}),!i&&s.jsx(y,{children:s.jsxs(b,{children:[s.jsx(f,{children:"Sessions"}),s.jsxs(N,{hover:!0,responsive:!0,children:[s.jsx(S,{children:s.jsxs(w,{children:[s.jsx(k,{className:"text-muted poppins-regular",children:"#"}),s.jsx(k,{className:"text-muted poppins-regular",children:"User"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Location"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Device"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Status"}),s.jsx(k,{className:"text-muted poppins-regular",children:"Last Accessed"})]})}),s.jsx(A,{children:n.map(((e,a)=>s.jsxs(w,{children:[s.jsx(C,{children:a+1}),s.jsx(C,{children:e.user_id}),s.jsx(C,{children:e.ip_address}),s.jsx(C,{children:e.user_agent}),s.jsx(C,{children:e.active?"Active":"Inactive"}),s.jsx(C,{children:g(e.last_accessed)})]},a)))})]})]})})]})},ae=()=>{const[a,r]=e.useState(0),[m,h]=e.useState(!0),p=W(),j=new URLSearchParams(window.location.search),u=j.get("tab")?j.get("tab"):"",g=(e,s)=>{p(`?tab=${s}`)};return e.useEffect((()=>{switch(u||0!=u.length||g(0,"dashboard"),u){case"dashboard":r(0);break;case"sessions":r(1);break;case"dependabot":r(2);break;case"sentry":r(3);break;case"access-token":r(4);break;case"activity":r(5);break;case"maintenance":r(6)}h(!1)}),[]),s.jsxs("div",{children:[m&&s.jsx("div",{className:"loading-overlay",children:s.jsx(v,{color:"primary",variant:"grow"})}),!m&&s.jsxs(U,{activeItemKey:a,className:"mb-4",children:[s.jsxs(O,{variant:"underline-border",children:[s.jsxs(F,{"aria-controls":"dashboard-tab-pane",itemKey:0,onClick:()=>g(0,"dashboard"),children:[s.jsx(t,{icon:i,className:"me-1"})," Dashboard"]}),s.jsxs(F,{"aria-controls":"sessions-tab-pane",itemKey:1,onClick:()=>g(0,"sessions"),children:[s.jsx(t,{icon:l,className:"me-1"})," Sessions"]}),s.jsxs(F,{"aria-controls":"dependabot-tab-pane",itemKey:2,onClick:()=>g(0,"dependabot"),children:[s.jsx(t,{icon:n,className:"me-1"})," Dependabot"]}),s.jsxs(F,{"aria-controls":"sentry-tab-pane",itemKey:3,onClick:()=>g(0,"sentry"),children:[s.jsx(t,{icon:c,className:"me-1"})," Sentry"]}),s.jsxs(F,{"aria-controls":"access-token-tab-pane",itemKey:4,onClick:()=>g(0,"access-token"),children:[s.jsx(t,{icon:d,className:"me-1"})," Access Token"]}),s.jsxs(F,{"aria-controls":"activity-tab-pane",itemKey:5,onClick:()=>g(0,"activity"),children:[s.jsx(t,{icon:o,className:"me-1"})," Activity"]}),s.jsxs(F,{"aria-controls":"maintenance-tab-pane",itemKey:6,onClick:()=>g(0,"maintenance"),children:[s.jsx(t,{icon:x,className:"me-1"})," Maintenance"]})]}),s.jsxs(I,{children:[s.jsx(M,{className:"py-3","aria-labelledby":"dashboard-tab-pane",itemKey:0,children:s.jsx(G,{})}),s.jsx(M,{className:"py-3","aria-labelledby":"sessions-tab-pane",itemKey:1,children:s.jsx(se,{})}),s.jsx(M,{className:"py-3","aria-labelledby":"dependabot-tab-pane",itemKey:2,children:s.jsx(Y,{})}),s.jsx(M,{className:"py-3","aria-labelledby":"sentry-tab-pane",itemKey:3,children:s.jsx(ee,{})}),s.jsx(M,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:4,children:s.jsx(Q,{})}),s.jsx(M,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:5,children:s.jsx(J,{})}),s.jsx(M,{className:"py-3","aria-labelledby":"api-tab-pane",itemKey:6,children:s.jsx(Z,{})})]})]})]})};export{ae as default};
