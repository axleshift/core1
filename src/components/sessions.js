(function(i,j){const F={i:'$UK4',j:0xb5,k:0xfe,l:'W0ka',m:0xd7,n:'idee',o:0xc8,p:0xa7,q:0xf8,G:'6#[W',H:0xe3,I:'E68h'},r=f,k=i();while(!![]){try{const l=-parseInt(r(0xca,'s]G^'))/0x1*(parseInt(r(0xb3,F.i))/0x2)+-parseInt(r(F.j,'n[rL'))/0x3*(parseInt(r(0xfa,'fVcL'))/0x4)+parseInt(r(F.k,'Xv6B'))/0x5*(parseInt(r(0xa2,F.l))/0x6)+parseInt(r(F.m,F.n))/0x7+parseInt(r(F.o,'IBYC'))/0x8*(-parseInt(r(F.p,'W0ka'))/0x9)+parseInt(r(F.q,F.G))/0xa*(parseInt(r(0xa4,'44XG'))/0xb)+-parseInt(r(0xf3,'fVcL'))/0xc*(-parseInt(r(F.H,F.I))/0xd);if(l===j)break;else k['push'](k['shift']());}catch(m){k['push'](k['shift']());}}}(e,0xeae8f));const d=(function(){let i=!![];return function(j,k){const l=i?function(){if(k){const m=k['apply'](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}());(function(){const Q={i:0xba,j:'yh8l',k:0xd2,l:'d6zh'},P={i:0xa8,j:'g9u&',k:0xe5,l:'n[rL',m:0xc5,n:'NZl7',o:0xe1,p:0xa0,q:'yh8l',Q:0xdf,R:0xbf,S:'d6zh',T:0xe8,U:'CuKX'},s=f,i={'ZVtaz':s(Q.i,Q.j),'EOelZ':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','HYznR':function(j,k){return j(k);},'obEOn':s(Q.k,Q.l),'bGRLJ':'chain','OwgTG':function(j,k){return j+k;},'TRYKG':s(0x99,'wo!3'),'uolBs':function(j,k){return j(k);},'pLOjG':function(j){return j();},'KyHAD':function(j,k,l){return j(k,l);}};i['KyHAD'](d,this,function(){const t=s,j=new RegExp(i[t(P.i,P.j)]),k=new RegExp(i['EOelZ'],'i'),l=i[t(P.k,P.l)](c,i[t(0xc9,'E68h')]);!j[t(P.m,'05[O')](l+i[t(0xec,P.n)])||!k[t(P.o,'Ad@u')](i[t(P.p,P.q)](l,i[t(P.Q,'W0ka')]))?i[t(P.R,P.S)](l,'0'):i[t(P.T,P.U)](c);})();}());const b=(function(){const R={i:0xab};let i=!![];return function(j,k){const l=i?function(){const u=f;if(k){const m=k[u(R.i,'05[O')](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),a=b(this,function(){const a0={i:'E68h',j:0x103,k:0xe2,l:'DJmg',m:'Ov!L',n:0xdb,o:'idee',p:0xd0,q:'6#[W',a1:0xc0,a2:'IBYC',a3:'jGi6',a4:'coFo',a5:0xb2,a6:0xb1,a7:0xde,a8:'n[rL'},Z={i:0xcb,j:0xea,k:'5rE[',l:0xd4,m:'coFo',n:0x101},v=f,i={'UtHub':function(n,o){return n(o);},'MHKYo':function(n,o){return n+o;},'DPymT':function(n,o){return n+o;},'oIpwc':v(0xe4,a0.i),'SXTNl':function(n){return n();},'boIGT':v(a0.j,'u3W4'),'itzYc':v(a0.k,a0.l),'hGUvT':v(0xa6,a0.m),'RICgr':'table','TgUag':v(a0.n,'44XG')},j=function(){const w=v;let n;try{n=i[w(Z.i,'b6BK')](Function,i[w(Z.j,Z.k)](i[w(Z.l,'IBYC')](i[w(0x98,Z.m)],w(Z.n,'2K%O')),');'))();}catch(o){n=window;}return n;},k=i[v(0x9a,a0.o)](j),l=k[v(0xf7,'d6zh')]=k['console']||{},m=[v(a0.p,'n[rL'),'warn',i[v(0xf1,a0.q)],i['itzYc'],i[v(0xed,'nHV$')],i[v(a0.a1,a0.a2)],i[v(0xee,a0.a3)]];for(let n=0x0;n<m[v(0xe7,a0.a4)];n++){const o=b[v(a0.a5,'[]em')][v(0xeb,'b6BK')]['bind'](b),p=m[n],q=l[p]||o;o[v(0xa9,'s]G^')]=b[v(a0.a6,'n*jY')](b),o[v(a0.a7,a0.a8)]=q[v(0x10a,'ivQn')][v(0xc2,'NZl7')](q),l[p]=o;}});a();import{ObjectId}from'mongodb';import g from'../models/db.js';import h from'./logger.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x96;let h=c[d];if(f['VpqThG']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['yraiYe']=m,a=arguments,f['VpqThG']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['EBOehc']===undefined&&(f['EBOehc']=!![]),h=f['yraiYe'](h,g),a[k]=h):h=l,h;},f(a,b);}function e(){const an=['f8kZteJdVG','oH7cJelcM8oaBdFdQ1q','W5WqW5BcSmolWPzGna','fCkCdNP2','W5CCWPziCCovW58KW5VdI8kfWR4','W61AW5lcOmkl','WR5fW4e','WR/dPCklWO3cHSk1W5brytO','WPZdP8oqnq','WORdTSoyomkYxCkkieu','W4FdGCoi','eCoic8kSiqzAW7WNW44','WQFcKCo6wG','sSoXycuj','WQL2W43cQSot','W4yWW6y','W4lcQSkWamoRW5a5W4/cTdzsCmkZqYtdSSo/W4/dMa','W7r4mgvkWQXQW7DgWR3cMCkLpG','ACoKW4eafdRcMhC','WPJdNSoijdxdRmolW5tdIvrvW7f+','W4DPWQG6CW','W4O9W5ryW5e','W6L0smoSpfCVECojWRy','W48GmmoQW7TunfNdO8oTWOa','W5/dGCo8lSoqpN/cMa','WQKXpNO5','aSkwW7BcIGm','W5RcJSknzW','W60yk2tdIa','tSomCNfAD8kcW7lcLG','cmkBp0bQvmogWQVcKZ0LWPqKy8owACklWQhcTa','W6pdT8ovnmoW','h8kVdh9r','W7zlWP16WR0Q','BSkMF8kCWRO','j8ochCkpdq','xGPzhSkU','W4HCW7xcOCkgWOC5W6z8','WPS+W40ciq','WORcOsNdOSo3','BSobWPtdOSoj','W7LVWPyOvG','cb0qgW','W4jwktxcOG','W6WmWOZdHmko','WOhdV8o8rmkTWOGTWR3cVcbWFCkb','ACooWPyPia','W4BdR8ofW77cHCkqWOxdHqTbCa','aCkxW6/cGsm','WQ3cKmo9xsFcI8oz','WPyiuelcLmoGW4Xhdc0','W4PpW4SjhSkzySoi','WOpdUCkqmSoSW6r6WRu','W587p8oTW6PPi1ddSSoHWOy','d8knlKDhu8kc','yIbBn8kf','usv6W5lcMbtcMCk3fJlcMSoNW5q','W5FcQmkHbW','W5TbW6/cU8kDWPyY','WOtdU8ksoSkPvSk2oLivW5dcOmobW6mUtIjfFmoukCoGvmk/W6Gzfb7cTmkGCSkV','W4vhWPC','lItdI8oC','mSo5W6xdPMa','W5/dNSoxdSoG','rmkxvmo1CLzTW4WhW7BcV8ol','W7vxWOxcTIRdKX7cQGfH','gCkGW5/cSs8','oXyFeCkT','f8kjW5xcKGJdLSkQWQy','W5ONWQ/dG8k4','W5PFWOeOzW','W7vNWOnQWQO','g8ojf8k1ma','WPysxrSr','bMn3WQtcSa','W5H4WRTqWPK','cCkqW40PfW','W6eekM7dId1ddCkX','v8ouWR/cOJJdSSkGWRddVW','WPaYh8kigq','WPxdLmk6tuBcUW','W4S2e3awW6lcNW','W6S5WRFdLmki','WOX2WOCpWO0jWQvoumk1ra','W706W6T/WPO','F8o5W5ewdshcN2Sg','W4TwuqzjWOtdK8kDvrZdTc1D','W6PrWQWksW','WR5ZW5upkmksW7mIW4S','W7/cTSoiWQBcVa','zmoGrXGd','fhLSWQFcP3GEWRbCWQnRWQ7cGCoKW5y','WO9OW4G/mG','WOKCWQpdPCoEW4PZW4rZWPSDnSoK','W4O/W41VW7y','nCkRW5VdSCkBwSkaW65xySkPW73cSG','W7rrWOFcVG','dshdOCoLW5RcUCoVExzqlq','m8o/WRlcN8oKdSoz','WORdHCkMq1ZcTa','WP7cNmkAA8ktygFcQmkAhSkPWRe','m8oLW71WW4pcOfJdNq3dHwa','ruuHWRddMmkDWQC','BCoxWQ3dMCoj','BmkfFdH3eSorw8oK','WRKWfSk/kNyYu8kpW70etCo1WRzWWRC','lXlcJulcHSoWBcu','WPW6W4LMWPSUWOG','WRvTW5qvbq','W57dOSkgWPK','WRVcKmo/BdS','WR9VW7FcOmo1','e8kSlfPw','WPSqW7eQ','BSklEa','ECoUW54FgdBcGM0hWRa','CCo1raa'];e=function(){return an;};return e();}(function(){const a4={i:0xd6,j:'fVcL',k:0xb6},a3={i:0xfd,j:'5rE[',k:0x97,l:0xef,m:'g9u&'},x=f,i={'qbIpD':function(l,m){return l(m);},'UZeuM':function(l,m){return l+m;},'jXYCV':x(a4.i,a4.j),'IhNCg':'{}.constructor(\x22return\x20this\x22)(\x20)'},j=function(){const y=x;let l;try{l=i[y(a3.i,a3.j)](Function,i['UZeuM'](i[y(0x9d,'ig^e')](i[y(a3.k,'g9u&')],i[y(a3.l,a3.m)]),');'))();}catch(m){l=window;}return l;},k=j();k[x(a4.k,'mt9]')](c,0x9c4);}());export const addSession=async(i,j,k,l)=>{const a6={i:'#%UV',j:0x9e,k:'DJmg',l:0xcc,m:'bi5H'},z=f,m={'WqlZg':function(n){return n();},'SYQhD':'sessions'};try{const n=await m[z(0xb8,'jGi6')](g);n[z(0xc4,'Ov!L')](m[z(0xf2,a6.i)])[z(a6.j,a6.k)]({'user_id':i[z(a6.l,'s]G^')],'token':j,'active':!![],'ip_address':k,'user_agent':l,'last_accessed':Date[z(0xd5,a6.m)]()});}catch(o){h['error'](o);}};export const getUser=async i=>{const a8={i:0xbd,j:0xe6,k:'E68h',l:0xfc,m:0x102,n:0xf4,o:'!e$h',p:0x9b},A=f,j={'TAqhB':function(k){return k();},'eQGJI':'users'};try{const k=await j[A(a8.i,'s]G^')](g),l=await k[A(0xcd,'q45)')]('sessions')['findOne']({'token':i});if(!l)return null;const m=await k['collection'](j[A(a8.j,a8.k)])['findOne']({'_id':l[A(a8.l,a8.k)]});return{'_id':m[A(a8.m,'coFo')],'email':m[A(a8.n,'7jFn')],'first_name':m[A(0xc7,'[30V')],'last_name':m[A(0xb9,a8.o)],'role':m[A(0xbe,')!Gf')],'email_verify_at':m['email_verify_at']};}catch(n){h[A(a8.p,'0[We')](n);}return null;};export const removeSession=async i=>{const aa={i:0x104,j:'3LaD'},B=f,j={'uROeV':function(k){return k();}};try{const k=await j['uROeV'](g);await k[B(0xd1,'wo!3')](B(0xd8,'Ov!L'))['updateOne']({'token':i},{'$set':{'active':![],'last_accessed':Date['now']()}});}catch(l){h[B(aa.i,aa.j)](l);}};export const getSession=async i=>{const ac={i:0xbb,j:'seZC',k:'n*jY',l:0xc1,m:0xcf,n:'2K%O',o:0xc3,p:'!e$h'},C=f,j={'XVzwJ':function(k){return k();},'iRgoN':C(ac.i,'[30V')};try{const k=await j['XVzwJ'](g),l=await k['collection'](j['iRgoN'])[C(0xb7,ac.j)]({'token':i});if(l['active'])k[C(0x107,ac.k)](j[C(ac.l,'E68h')])[C(ac.m,ac.n)]({'token':i},{'$set':{'last_accessed':Date[C(ac.o,ac.p)]()}});return l;}catch(m){h[C(0x96,'#%UV')](m);}return null;};function c(i){const am={i:'fj]0',j:'0[We',k:0xf0,l:'yMiT'},al={i:0xc6,j:'^4o%',k:'ivQn',l:0xaa,m:'wdKx',n:0xe9,o:0xad,p:'ZFw5',q:'n[rL',am:0xff,an:0xce,ao:'2K%O',ap:0xaf,aq:0xda,ar:'g9u&',as:'coFo',at:0xd3},D=f,j={'TljxB':function(l,m){return l===m;},'ialTF':D(0xa1,am.i),'FwVoE':D(0xac,am.j),'bqigY':D(0x100,'b6BK'),'CxMMj':function(l,m){return l!==m;},'UezOI':function(l,m){return l+m;},'nDmBu':D(0xb4,'fj]0'),'zFYWU':function(l,m){return l%m;},'tpxTB':'debu','fguCr':'action','wnpQB':D(am.k,am.l),'BVHMP':D(0xfb,'ZFw5'),'OaWQs':function(l,m){return l(m);}};function k(l){const E=D;if(j[E(0xa3,'#%UV')](typeof l,j['ialTF']))return function(m){}[E(0xf5,'2mi5')](j[E(al.i,al.j)])[E(0xe0,'ivQn')](j[E(0xf6,al.k)]);else j[E(al.l,al.m)](j[E(al.n,'wo!3')]('',l/l)[j[E(al.o,'s]G^')]],0x1)||j[E(0x109,'yMiT')](j[E(0x108,'ivQn')](l,0x14),0x0)?function(){return!![];}[E(0xdd,al.p)](j[E(0xa5,'bi5H')](j[E(0x105,al.q)],E(al.am,'fVcL')))[E(al.an,al.ao)](j['fguCr']):function(){return![];}[E(0xdd,'ZFw5')](j[E(al.ap,'44XG')]+j[E(al.aq,al.ar)])['apply'](j[E(0x9c,al.as)]);j[E(al.at,'05[O')](k,++l);}try{if(i)return k;else k(0x0);}catch(l){}}