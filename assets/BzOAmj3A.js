import{r as s,j as e}from"./Oq9P1Wj_.js";import{F as r,C as t}from"./sp1ODoSc.js";import{d as i}from"./DjpJzTqR.js";import{c as a,o,q as n,a as m,b as l}from"./Bj7zDxPh.js";import{a as d,V as p}from"./6IyA7j_C.js";import{p as j}from"./BzOa6JrD.js";import{k as c}from"./Ce_fjdqS.js";import{L as u,M as f,r as h,aa as x,p as g}from"./B68AamsC.js";import"./deeEeel3.js";import"./NdsU5MZw.js";import"./CuOrfwh9.js";import"./CFK1l90-.js";import"./CewSaW8v.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./fHQ1LRrH.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./BYNIthp4.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";const y=()=>{const{user:y}=d(),[v,w]=s.useState([]),[b,N]=s.useState(""),$=s.useRef(null),[z,D]=s.useState(1),M=a(i,"messages"),O="admin"===y.role?c().id:y.ref;s.useEffect((()=>{const s=o(n(M,m("timestamp")),(s=>{const e=s.docs.map((s=>({id:s.id,...s.data()}))).filter((s=>s.ref===O));w(e)}));return()=>s()}),[]),s.useEffect((()=>{$.current&&$.current.scrollIntoView({behavior:"smooth"})}),[v]);const S=async()=>{""!==b.trim()&&(await l(M,{text:b,sender:y.role,timestamp:Date.now(),ref:O}),N(""),D(1))};return e.jsx("div",{className:"row d-flex justify-content-center mx-0 mb-4",children:e.jsxs(u,{style:{height:"78vh",overflow:"hidden",padding:"0px"},children:[e.jsxs(f,{style:{position:"relative",height:"100vh",overflow:"auto"},children:[v.map(((s,r)=>{return e.jsxs("div",{className:"d-flex flex-row "+(s.sender===("user"===y.role?"admin":"user")?"justify-content-start":"justify-content-end"),children:[s.sender===("admin"===y.role?"user":"admin")&&e.jsx(h,{crossOrigin:"Anonymous",className:"rounded-5 me-2",src:"admin"===y.role?`${p}/u/${y.ref}.png`:"/images/default-avatar.jpg",style:{width:"45px",height:"100%"},loading:"lazy"}),e.jsxs("div",{children:[e.jsx("p",{className:"small p-2 mb-1 rounded "+(s.sender!==("user"===y.role?"user":"admin")?"bg-primary text-white me-3":"bg-body-tertiary ms-3"),children:(t=s.text,t.split("\n").map(((s,r)=>e.jsxs("span",{children:[s,r<t.split("\n").length-1&&e.jsx("br",{})]},r))))}),e.jsx("p",{className:"small ms-3 mb-3 text-muted "+(s.sender===("user"===y.role?"user":"admin")?"me-3":""),children:j(s.timestamp)})]}),s.sender===("user"===y.role?"user":"admin")&&e.jsx(h,{crossOrigin:"Anonymous",className:"rounded-5 ms-2",src:`${p}/u/${y.ref}.png`,style:{width:"45px",height:"100%"},loading:"lazy"})]},r);var t})),e.jsx("div",{ref:$})]}),e.jsxs("div",{className:"card-footer text-muted d-flex justify-content-start align-items-center p-3 gap-2",children:[e.jsx("div",{children:e.jsx(h,{crossOrigin:"Anonymous",className:"me-2 rounded-5",src:`${p}/u/${y.ref}.png`,style:{width:"40px",height:"100%"},loading:"lazy"})}),e.jsx(x,{value:b,onChange:s=>(s=>{const e=s.target.value;N(e);const r=Math.max(1,(e.match(/\n/g)||[]).length+1);D(Math.min(r,4))})(s),onKeyDown:s=>{if("Enter"===s.key){if(s.shiftKey)return N((s=>s+"\n")),D((s=>Math.min(s+1,4))),void s.preventDefault();S(),s.preventDefault()}},rows:z,style:{resize:"none"}}),e.jsx(g,{type:"submit",color:"primary",className:"me-2 rounded",onClick:S,children:e.jsx(r,{icon:t})})]})]})})};export{y as default};
