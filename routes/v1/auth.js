const I=f;(function(p,q){const S={p:'0kS%',q:0x1cc,r:'qj!W',s:0x1c7,t:'4j*D',u:0x152,v:'3qmV',w:0x17c,x:0x16d,y:'RyxP'},B=f,r=p();while(!![]){try{const s=-parseInt(B(0x1d6,S.p))/0x1+-parseInt(B(S.q,S.r))/0x2*(-parseInt(B(0x1c6,'Y(ZN'))/0x3)+parseInt(B(S.s,S.t))/0x4+parseInt(B(S.u,S.v))/0x5*(-parseInt(B(S.w,'BwD^'))/0x6)+-parseInt(B(0x17f,'(MFZ'))/0x7+-parseInt(B(0x1d2,'zek0'))/0x8+parseInt(B(S.x,S.y))/0x9*(parseInt(B(0x1ac,'!Mni'))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x7a7c9));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x1b6,'355J')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0x13a,q:'70i&'},Z={p:0x1b9,q:0x148,r:'zek0',s:'IPs4',t:'1uxP',u:0x1c2,v:'1uxP'},D=f,p={'rAuZI':'function\x20*\x5c(\x20*\x5c)','tJbtu':D(a0.p,a0.q),'PiQBM':D(0x187,'T7K5'),'Ojzwy':D(0x14d,'RyxP'),'qndVe':function(q,r){return q+r;},'tuRfC':D(0x165,'H%@p'),'ISTLy':function(q,r){return q(r);}};d(this,function(){const E=D,q=new RegExp(p[E(Z.p,'xp]T')]),r=new RegExp(p[E(0x191,'^]3g')],'i'),s=c(p[E(Z.q,Z.r)]);!q[E(0x1c0,Z.s)](s+p[E(0x1ca,Z.t)])||!r[E(Z.u,Z.v)](p['qndVe'](s,p['tuRfC']))?p[E(0x13e,'0kS%')](s,'0'):c();})();}());const b=(function(){let p=!![];return function(q,r){const a1={p:0x192},s=p?function(){const F=f;if(r){const t=r[F(a1.p,'mEn5')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aa={p:0x1d8,q:'9[4)',r:0x17b,s:0x1d1,t:0x172,u:'4j*D',v:'Y(ZN',w:'Q&84',x:0x1a9,y:0x1a8,z:0x1cb,A:0x1ae,ab:'TwWR',ac:0x162,ad:0x1c3,ae:'T7K5',af:0x196,ag:'qj!W',ah:0x18a,ai:'mz9&',aj:0x14f},a9={p:'Lo)K',q:0x1b0,r:'&)zT',s:0x175},G=f,p={'SVekY':function(u,v){return u(v);},'mHDug':function(u,v){return u+v;},'MyOav':G(aa.p,aa.q),'VLKyY':'{}.constructor(\x22return\x20this\x22)(\x20)','TolCH':function(u){return u();},'SfhrB':G(aa.r,'kE]B'),'TnUpw':G(0x1ce,'eIVP'),'DYOKJ':G(aa.s,'4j*D'),'gMfpu':G(0x136,'gFw8'),'bIkMx':'exception','Iqdwe':G(0x139,'S10#'),'laEhP':function(u,v){return u<v;}},q=function(){const H=G;let u;try{u=p[H(0x12d,a9.p)](Function,p[H(a9.q,a9.r)](p[H(a9.s,'qj!W')],p[H(0x17d,'mEn5')])+');')();}catch(v){u=window;}return u;},r=p[G(aa.t,'mz9&')](q),s=r[G(0x15a,aa.u)]=r[G(0x135,aa.v)]||{},t=[p[G(0x12b,aa.w)],p[G(aa.x,'(MFZ')],p[G(aa.y,'2yhj')],p[G(aa.z,'*4xp')],p['bIkMx'],G(aa.A,aa.ab),p[G(aa.ac,'zek0')]];for(let u=0x0;p[G(0x1da,'4Lop')](u,t[G(0x161,'4j*D')]);u++){const v=b[G(0x145,'8X!C')][G(aa.ad,aa.ae)]['bind'](b),w=t[u],x=s[w]||v;v[G(aa.af,aa.ag)]=b[G(aa.ah,'gFw8')](b),v['toString']=x[G(0x17e,aa.ai)][G(aa.aj,'1uxP')](x),s[w]=v;}});a();import g from'dotenv';g[I(0x1ab,'zek0')]();import h from'express';(function(){const ae={p:'v$(5',q:0x131,r:0x14b,s:'355J',t:'TwWR'},ad={p:0x1cd,q:0x153,r:'H%@p'},J=I,p={'pZGbv':function(s,t){return s+t;},'MLton':J(0x1b2,ae.p),'RIiTz':J(ae.q,'eIVP'),'smRZQ':function(s){return s();}},q=function(){const K=J;let s;try{s=Function(p[K(ad.p,'qj!W')](p[K(0x177,'3qmV')]+p[K(ad.q,ad.r)],');'))();}catch(t){s=window;}return s;},r=p[J(ae.r,ae.s)](q);r[J(0x19b,ae.t)](c,0x9c4);}());import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x12b;let h=c[d];if(f['kjrzfm']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['LpZclT']=m,a=arguments,f['kjrzfm']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['SvpEuZ']===undefined&&(f['SvpEuZ']=!![]),h=f['LpZclT'](h,g),a[k]=h):h=l,h;},f(a,b);}import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[I(0x1a5,'T7K5')]();router['post'](I(0x16e,'1uxP'),async(p,q)=>{const ak={p:'70i&',q:0x1be,r:0x133,s:0x149,t:'RFS!',u:0x1bd,v:'BwD^',w:0x171,x:'mEn5',y:0x155,z:'mz9&',A:0x159,al:'cH[p',am:0x1bc,an:'xp]T',ao:'uJs1',ap:0x18e,aq:0x1a3,ar:'iY@#',as:0x194,at:'H%@p',au:'T7K5',av:'(MFZ',aw:'iY@#',ax:'Aj*D',ay:0x1b1,az:'H%@p'},L=I,r={'awWiP':function(s,t){return s||t;},'VlcXC':L(0x176,'2yhj'),'wQXad':function(s,t){return s<t;},'DaLWQ':L(0x1b5,ak.p),'YTmca':function(s,t){return s!=t;},'opMzj':'Password\x20does\x20not\x20match','bNTvy':function(s){return s();},'oAwbP':L(ak.q,'RyxP'),'MtuLs':'Email\x20id\x20already\x20exists','fnzuX':L(ak.r,'cH[p'),'XjZYi':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[L(ak.s,ak.t)];if(r[L(ak.u,ak.v)](!s,!t)||!u||!v||!w)return q[L(ak.w,'&i0s')](0x190)['send']();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[L(0x185,'6DB[')](s))return q[L(0x147,'Aj*D')](0xc8)[L(0x189,ak.x)]({'error':r[L(ak.y,'mEn5')]});if(r[L(0x1d5,ak.z)](v[L(0x167,'0kS%')],0x8))return q['status'](0xc8)[L(0x195,'xp]T')]({'error':r[L(ak.A,ak.al)]});if(r[L(0x1aa,'v$(5')](v,w))return q['status'](0xc8)['json']({'error':r[L(0x166,'4Lop')]});const x=await r[L(ak.am,ak.an)](k),y=x['collection'](r[L(0x1b7,ak.ao)]),z=await y[L(ak.ap,'3qmV')]({'email':s});if(z)return l[L(ak.aq,'kE]B')](r[L(0x1a0,ak.ar)]),q[L(0x14a,'9[4)')](0x199)['send']();return await y[L(ak.as,ak.at)]({'email':s,'first_name':t,'last_name':u,'role':r['fnzuX'],'password':r[L(0x16f,ak.au)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[L(0x1d3,ak.av)](0xc9)['send']();}catch(A){l[L(0x16c,ak.aw)](A);}return q[L(0x147,ak.ax)](0x1f4)[L(ak.ay,ak.az)]();}),router[I(0x1c5,'4Lop')]('/login',n,async(p,q)=>{const ar={p:0x13d,q:'(MFZ',r:'W1Y9',s:0x1a6,t:'v$(5',u:'TwWR',v:0x1d4,w:'eIVP',x:0x18d,y:'xp]T',z:0x169,A:'BwD^',as:0x180,at:'6DB[',au:0x1bb,av:0x186,aw:0x1c9,ax:'qj!W',ay:0x158,az:0x15d,aA:'S10#',aB:0x12e,aC:0x140,aD:'eIVP',aE:0x144,aF:0x19e,aG:0x134,aH:0x198,aI:'4Lop',aJ:0x170,aK:'9[4)',aL:'6DB[',aM:0x142,aN:'q43B',aO:'hpA%'},M=I,r={'wsuUV':function(s,t){return s||t;},'ykyTl':function(s){return s();},'bhGht':M(0x163,'zk1@'),'bemmB':function(s,t){return s!=t;},'dKIpF':function(s,t){return s(t);},'dGXqi':M(ar.p,ar.q),'HXzkO':function(s){return s();},'kfUcj':M(0x184,ar.r),'GweEj':M(ar.s,ar.t),'EJZdo':function(s,t,u,v,w){return s(t,u,v,w);},'eSzJq':M(0x150,'H%@p')};try{const {email:s,password:t}=p[M(0x181,ar.u)];if(r[M(ar.v,'eIVP')](!s,!t))return q[M(0x1d7,'S10#')](0x190)[M(0x1a7,ar.w)]();const u=await r[M(ar.x,ar.y)](k),v=u['collection'](r[M(ar.z,ar.A)]),w=await v[M(ar.as,ar.at)]({'email':s});if(!w)return q[M(0x14a,'9[4)')](0x194)[M(ar.au,'iY@#')]();if(r[M(0x188,'T7K5')](r[M(ar.av,'mEn5')](o,t),w[M(0x1d0,'cH[p')]))return q[M(0x146,'kE]B')](0x191)[M(ar.aw,ar.ax)]();r[M(ar.ay,'hpA%')](addUserProfileToSession,w);const x=j[M(0x154,'Lo)K')](r['dGXqi'])[M(ar.az,ar.aA)](r[M(ar.aB,'zAP#')](generateUniqueId))[M(0x173,'QVJq')](r['kfUcj']),y=p[M(ar.aC,ar.aD)][r[M(ar.aE,'1uxP')]]||p[M(ar.aF,'2yhj')][M(ar.aG,'IPs4')];return r[M(ar.aH,ar.aI)](addSession,w,x,y,p[M(0x13c,'1uxP')][r[M(ar.aJ,ar.aK)]]),q[M(0x143,ar.aL)](0xc8)['json']({'token':x});}catch(z){l[M(ar.aM,ar.aN)](z);}return q[M(0x130,ar.aO)](0x1f4)['send']();}),router[I(0x15f,'^]3g')](I(0x197,'xp]T'),m,function(p,q,r){const as={p:0x12f,q:'70i&'},N=I;return q[N(0x16b,'!Mni')](0xc8)[N(as.p,as.q)]({'email':p['email']});}),router['post'](I(0x15c,'Q&84'),m,async function(p,q,r){const au={p:0x1b3,q:0x19c,r:0x193,s:'^]3g',t:0x1cf,u:0x183,v:'70i&',w:0x16b,x:'!Mni'},O=I,s={'LTDZC':function(t){return t();},'rEpZe':O(0x1c8,'v$(5')};try{const t=await s[O(au.p,'zAP#')](k),u=t[O(0x168,'RFS!')](s[O(au.q,'4j*D')]),v=await u[O(au.r,au.s)]({'email':p[O(0x14e,'3d^o')]});return q[O(au.t,'4Lop')](0xc8)['json']({'user':{'email':v[O(0x1a1,'TwWR')],'first_name':v[O(au.u,au.v)],'last_name':v['last_name']}});}catch(w){l['error'](w);}return q[O(au.w,au.x)](0x1f4)[O(0x1a7,'eIVP')]();}),router[I(0x137,'T7K5')](I(0x19a,'W1Y9'),m,function(p,q,r){const aw={p:'zk1@',q:0x16b,r:'!Mni',s:0x1c1},P=I,s={'hxlzh':function(t,u){return t(u);}};return s['hxlzh'](removeSession,p[P(0x15e,aw.p)]),q[P(aw.q,aw.r)](0xc8)[P(aw.s,aw.r)]();});function e(){const aI=['W6zGegNdKCoj','u384W5n9AuW/WQ9+WQ1+W4H1WOjfFmkGWRNdLmkOkXXXWQqKptaZdSoAyq','W6/dHf3dVSkUvmkXmLhdUYysWOO','W59PB8kK','W4O4W5xcSSkEWRxdVLmEzeBcOSoR','C13dKbBcSSk9W6C','WQPXWOnYDq','WPpdHmkkzG','W57cUKCWW58','c8kMW4rRW7y','pmogFu9wpxCvlmokWOtdVCole8osW5hcRmogW5lcJhZdVJHuWRnKW5a7v8ozh8kbcq4','W4FcIKKcW6y','WRpcLqNcO8o6fCo3','sXFdOLBdPSoa','W6aEySk6WOi','WPuJASo/W7NdTSktimkypmoH','qgD3W5r3DuW','AJddHcFcNW','mSorWQuSWRu','WRWvkSolW73dKq','WPZcHW3cGSo1','nHtcMmkRtSkedN/dPNOG','W7pdTmoSW7Tluq','WOu4zCo4W7JdTW','sSo/WP1xWRW','W4VdKSkeya','yCkNsg/dN8oa','WP7cKmodWRRdKW','WPtdG8kqFSo9WPzXdsNdIN9cWPdcKmoK','WRZcMSobBCod','r0/cHKDz','WRNcMqBcOW','WO3dGubLWQ0WWR7cS8opvG','sWVdSq3cVCkr','WRWxgqHZWRxcVmoDuCo7WPBdOMW','WQRdU0XdW7O','fSkQdmodW5hcNSkngCk0oq','sfFcUmk3WOC','W69qjbfxlw8','EL7cUCkA','W7fFog3dOG','W657rSkbrq','FCoMq8oOjIpcKW','W5FdGSkZW6BdVmonWQHpW4zuwmowW4S','rtxcQwCW','cSkKW4fPW6FcJW','W7HqoHPn','rmkDjIG','W5jcpGJcVXSSWPLpzmokW5dcSW','CSoSq8o8psC','u8oNWQHIWPq','W7Lmna1q','x8kBoSoVW7O','WPhdNfvIW7q','WOBdKSkTWRlcOa','W4uOwmkrWO8C','W4RdKSkmDwnbnwD7W7y','WRucvtVdLW','W6iMW4uJ','b8kOc8kdnSkK','W5GjW5VdG8kB','W63dGSkqm8kugXldVCopkuq','W7tcGG3cOmo2fmoWh2y','WRVdGCkJs8oX','D8kau1hdMW','WPBcJSoIWQFcU8km','W6pcJuOfW6m','WPxdS8odDGpdRq','W5dcLSorW7VdVSkAECktsCoVfSo2','W4lcRN7dSSoW','hConr8ktW6T0rSorW4pdNCo3DSkrhmk+c8o0WQ4NWRdcSG','W4vVwf4S','Bmk3e8okW4y','WRhdGCkBrSo+','wmkxoZVdJIK','W6ZdR8oQ','W6e5CXxdQSk5xW','shFcKmkwWP0','W4pcJxuYW5NdUCkdWQq','cuBcULBdQ8obWPybWO1xW5PJiq','WQKijCoBW4FdJfK','DtfPWQC','nCotqCkEW74','bSkeuXCcsdflE8o0','W6KIW5e','WRSeomol','ENdcKSkFWOi','WORdHCkqzG','WOhdJSkuF8oA','DeJcTmkb','WQ1QWP95','W7NcPSklxSoK','WQW3qCkekq','cYFdM8klpa','W65kqLunW6JdRa','W58Ri8k9WQ8','jSk8WOxdPJFdTrm','qmk4nYJdJW','F0VcQ8kdWR0','uSkBoZJdTs8L','WPhdNfzYW7iLWPBcUmoe','gd/dJCkX','W5dcIehdOCoPaZldPCkw','xtRdH8kToxmc','WQZdQmk6WQZcPq','zeNdGmoScmoos07dT38FD8ol','WQ4RW4yOhmkoDa','zdT5WPFdSmohW6NcPrytza','BmomxCobla','W7/cV17dL8ol','j8omuSkzW6jP','uSoDevnptXXgCmoJWQa','W7apW5ZdOmkA','CJnSWRFdSG','WPSUo8oMlCkCW6lcICkXESoG','W6xdSSo/W6bm','W4hdP8kUyfu','WRhdHmkmzSo9W4q','W5z/iSk1WOFdNYSNW7ZdUSkhW4yNjZK','w2D4W5q','emo6FSk5W40','BbhdLHtcPa','W7CgkCk5WPq','ECo5WQjZWPH2','qCoOxCohlCkuW4XIy0W','W7/cSCkEqa','yZ9VWRldUW','WQ4cp8owW6FdJa','WO4Zq0/dOa','WOVdL0TZ','W5W3mmkVWOFdHMP9W77dQSknWOG1istdMfvzEW','WPZdQ8ofWRO5','W43cHHiNW64sWOZcMSoxsW','mmkmuHCbEc1onSo8WPdcO8ofCSkDW67dK8kfW73cSI3cP2rhWR5QW7L3y8kMa8o8r05JWR9E','WOZcJCoHWOZdUW','ySkWl8ozW4W','Bu/cUSkBWQfoW4i5WQyLAG','aa3dL8kfgq','W7jZfg8','W44EW4FdIa','ealdTSkPkq','WRyDrtRdSW','WQRcGCofDSoE','s214W4nMDuOOWQLKWRW','W4W4W4VcQq','b8k5bmkt','WQ/cLrVcSW','WPpdMCkwzSo3W4iGct4','ASoAAmothG','WPNdJCktWRW','iqBcJ1xdPmkfW7yFvtxdUa','lmkXhCkUE33dGSoowqT5W4/dSW','W5SHiCkOWOy','W7ZcSL/dTW','WPtcMHlcSmoM','WRSqtSk7pG','WRZdOqxdISopnb7dVSkM','W7/cJxBdSCoW','x2nKW54','WPRdLSkbWRZcV8oF','W5P7ECkLy8kNW6tcIa','D8oNs8o0','k8kKW7OHW4mPrSoBpdBdHYBcKW','sWVdOHdcPSkf','x3fJW6ve','W4dcS34NW48','WPb5b8ofW49cEMCvWRtdOJe','dmkGW4r8W6BcMq','ymk2xw7dMmoDF8k8W50kmrtcRmkDyCowW6BdN0a','FgFdLstcSW','WOxdG8kLWQdcMG','osBcSNaa','W7dcJmk1s8oo','jSkodmojW7W','WPJdP8o7WOS1','cSkEtGO'];e=function(){return aI;};return e();}export default router;function c(p){const aH={p:0x151,q:'(MFZ',r:'T7K5',s:0x17a,t:'^]3g',u:0x1af,v:'6DB[',w:'qj!W'},aG={p:0x145,q:0x182,r:0x156,s:0x1d9,t:'Y(ZN',u:'uJs1',v:0x141,w:0x1bf,x:'T7K5',y:0x12c,z:'hpA%',A:'v$(5',aH:'Aj*D',aI:0x1a4,aJ:'RFS!',aK:0x18c,aL:'*4xp',aM:0x18b,aN:0x1b8,aO:0x13b},Q=I,q={'aFKqZ':Q(aH.p,aH.q),'mKRvO':Q(0x14c,aH.r),'lUkAn':function(s,t){return s!==t;},'RjbTf':function(s,t){return s+t;},'EYpyc':function(s,t){return s/t;},'tSEHW':Q(aH.s,aH.t),'ROGCL':function(s,t){return s===t;},'iXavt':function(s,t){return s%t;},'hZNyS':Q(0x157,'mEn5'),'qyggZ':Q(aH.u,aH.v),'pjiOb':Q(0x1ad,'DNNd'),'phoDM':function(s,t){return s(t);}};function r(s){const R=Q;if(typeof s===q[R(0x178,'uJs1')])return function(t){}[R(aG.p,'8X!C')](q['mKRvO'])[R(aG.q,'2yhj')](R(aG.r,'zk1@'));else q[R(aG.s,aG.t)](q[R(0x164,aG.u)]('',q['EYpyc'](s,s))[q[R(0x1c4,'4j*D')]],0x1)||q[R(aG.v,'(MFZ')](q[R(0x138,'mz9&')](s,0x14),0x0)?function(){return!![];}[R(aG.w,'eIVP')](q[R(0x179,aG.x)](q[R(aG.y,'DNNd')],R(0x1ba,aG.z)))[R(0x16a,'W1Y9')](q[R(0x18f,aG.A)]):function(){return![];}[R(0x13f,aG.aH)](q[R(aG.aI,aG.aJ)]+q[R(aG.aK,aG.aL)])[R(aG.aM,'DNNd')](R(aG.aN,'mEn5'));q[R(aG.aO,'mz9&')](r,++s);}try{if(p)return r;else q[Q(0x19d,aH.w)](r,0x0);}catch(s){}}