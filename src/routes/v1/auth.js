const H=f;(function(p,q){const Q={p:0x146,q:0xd3,r:'h@v6',s:0x139,t:'%e!c',u:0xeb,v:'ri4I',w:0xb7},B=f,r=p();while(!![]){try{const s=-parseInt(B(Q.p,'I2P$'))/0x1+parseInt(B(Q.q,'aiUU'))/0x2*(parseInt(B(0xd4,Q.r))/0x3)+parseInt(B(Q.s,'UV5q'))/0x4*(-parseInt(B(0xb6,Q.t))/0x5)+parseInt(B(0x114,'t#L4'))/0x6+parseInt(B(Q.u,Q.v))/0x7+-parseInt(B(0xee,'pD^l'))/0x8+-parseInt(B(Q.w,'gZml'))/0x9*(parseInt(B(0xa1,'#8xl'))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x2a8f8));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0x13c,q:'$g[3',r:0x116,s:0xab,t:'$g[3',u:'tDE9',v:'GtyM'},Z={p:0x134,q:'M)BN',r:0xf8,s:'NX2m',t:0x12c,u:'TSGv',v:0x140},C=f,p={'croAI':C(a0.p,a0.q),'LEWbf':C(a0.r,'$g[3'),'ReMJT':C(a0.s,a0.t),'qIjhW':function(q,r){return q+r;},'pnRfO':function(q,r){return q+r;},'CqauX':C(0xf7,a0.u),'zwVlo':function(q,r){return q(r);},'oIVJv':function(q,r,s){return q(r,s);}};p[C(0x14b,a0.v)](d,this,function(){const D=C,q=new RegExp(p[D(Z.p,Z.q)]),r=new RegExp(p['LEWbf'],'i'),s=c(p['ReMJT']);!q[D(Z.r,Z.s)](p['qIjhW'](s,D(0x10c,'ZHU7')))||!r[D(0x14e,'tDE9')](p['pnRfO'](s,p[D(Z.t,Z.u)]))?p[D(Z.v,'I)tt')](s,'0'):c();})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(0xd0,'rW29')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a7={p:0xc6,q:'brvj',r:0x13e,s:0x128,t:0x10a,u:'H53x',v:0xdd,w:0x101,x:0xc9,y:0x118,z:'en%J',A:'PP8)',a8:0xa8,a9:0xf0,aa:'t#L4',ab:0xef,ac:'4^HB',ad:0xea,ae:'%e!c',af:0x100,ag:'pD^l',ah:'zY*Q',ai:'dxwN'},F=f,p={'LwsOA':function(t,u){return t+u;},'lfsOU':F(a7.p,a7.q),'xYbzX':function(t){return t();},'QzcPD':'log','cGLKb':'warn','DrJIX':F(a7.r,'VM&*'),'wufjS':F(0x105,'x#Xn'),'XUpzo':F(a7.s,'I)tt'),'rRwuk':F(a7.t,a7.u)};let q;try{const t=Function(p['LwsOA'](p[F(a7.v,'ri4I')]+'{}.constructor(\x22return\x20this\x22)(\x20)',');'));q=p[F(a7.w,'bL55')](t);}catch(u){q=window;}const r=q[F(a7.x,'%e!c')]=q[F(0xbf,'bW81')]||{},s=[p[F(a7.y,a7.z)],p[F(0xc7,a7.A)],p[F(a7.a8,'#^zv')],p[F(0xfc,'brvj')],F(0xe5,'M)BN'),p['XUpzo'],p[F(a7.a9,a7.aa)]];for(let v=0x0;v<s[F(a7.ab,'%e!c')];v++){const w=b[F(0xff,'#8xl')][F(0x137,'gZml')][F(0xc4,a7.ac)](b),x=s[v],y=r[x]||w;w[F(a7.ad,a7.ae)]=b[F(a7.af,a7.ag)](b),w[F(0x111,'%e!c')]=y[F(0xf6,a7.ah)][F(0xf4,a7.ai)](y),r[x]=w;}});a();import g from'dotenv';(function(){const ab={p:'UCZA',q:0x126,r:'I2P$',s:'aiUU',t:'bL55'},G=f,p={'MfTtg':function(r,s){return r(s);},'pWMoh':function(r,s){return r+s;},'JbTXF':G(0xa0,ab.p),'OofEj':G(0x12a,'t(#O'),'gafnT':function(r){return r();}};let q;try{const r=p[G(ab.q,ab.r)](Function,p[G(0x13f,'J5LV')](p[G(0x129,ab.s)]+p[G(0x106,ab.t)],');'));q=p['gafnT'](r);}catch(s){q=window;}q['setInterval'](c,0x9c4);}()),g[H(0xf5,'4Z[Z')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x97;let h=c[d];if(f['ardMPq']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['QTqxCO']=m,a=arguments,f['ardMPq']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['pzQdkW']===undefined&&(f['pzQdkW']=!![]),h=f['QTqxCO'](h,g),a[k]=h):h=l,h;},f(a,b);}function e(){const aG=['W6XCW4NcM8kLca','WRZdMc9h','WPJcVmkrzSkl','WRhdSSo0WPFcSa','WRn+puddOYm','WOLsiCoB','pfdcNeVcIG','W4KDWQGDW4JdGG','W7moW4XmDSoYtG','WQtdKmktD04PfYS/WPn/lG','W49AWQpcL8kCfSkHvsiCW7tcJbyvgq','WOyuzgHHWQ3cQa','WQtcLSoTnH4aW7a','eHO3W5VdGq','WRmRW7vHBW','WOZcQJJcPa','WOBcLfm','ySoFW6pcUG','uentWPZcUW','luldMLVcQq','WRJdOmomWP8','W5baW4SpWRyUW7lcK05/tCkEWONcIY/dMwJcKmkeWRCz','xCkSWQK7','nCo+tG','W7jJWOeVdq','W5CZyu5M','uxBcIZ09DW','l8krWQxdVdZcQYvrpmkPW63dISk9WOyOzG3cKG4','WRBcTCoNWOHytmoHWQa','WRCGW6PJqW','bSofctKk','W6ldKqhcPCkzWQ8','WQtdLCkxCu8RCby7WQnifmo2','W7fRWOyS','WRyrW4Xf','FxPHWPFcTq','fCoKw8kUWQ5FhCkAaCoepsldMmoPnYX8pCoTDmoAW7ZdPs/dIJBdRJK3W7FdIuRdP8o0WRpcOG','y2pdKvxcTri','WQBcSmkzW64','WR3cGCk2zCkV','W5GTB0K','W70kkYDl','W6/dOmovWOLPB8ok','BmkWWPuLfa','WRRcRCkvW6G','WPZcOdRcRmkvzaC7WRm0','qeOhrSoHsa','W4S2wYe','WOjsDWJcSvS','s8oHW61LsmkzW4JdG8ocW4u','WP5GcgbXWRCzWR5hca3cPIW','W642C1ZcP24','wNdcUSoE','W5uDrSkC','W7pcJ8ounG5cksyxWP8','W50pW73dGuVcOM01W74','l8o6wSoVWO5t','jmkAWRCOW6hdTmkg','WRlcPmoIWOZdVf3dHW','W7tdSCovWPL5BG','BLBcKg/cS8obrG','WRlcUCoPWP7dP1tdQIRcIvm','WRtcJCo5lb8w','kSooW7BdIW','qYVcHIVcTHRcGSkDW4O','W68NzL3cOhn/W7/cVSkYrwxdLvtdSmk+ftuT','W6fjWQqdaa','lvhcQuO','hmk6WRmJx8k0W5u','W4CvW6/dKeZcPq','pmoJumoQWRvyfq','WOpdQ8osWRhcKW','w2DpWQC','zCooW6lcP1tcQq','WOiGW5/dIG','WPThp8otW6m','W6xdQWVcGmkb','pY8nW7pdOG','W7itWQdcVZxdJCoZx8kkgfPM','y8opeq0tW67cVa','WRVcSCkBW7/dNG','lLVcTfO','WRraW6FdSW','W7aWCSkYoq','W7tdOmoAWOK','WQBdNIGAWRWJ','W6xdIGVcTmkc','dmkHWRWKvCkxW5ldQmoDW4rz','W5SuuCkQlG','W68UWQ4fW6u','W5urW77dIea','WPbwzHdcVq','pCouW73dNCks','xgrYWQ/cIG','pmkCWRCsqW','WROAia','W7XwW54lWQOZW7/dNeu','W7PAW5RcGmkI','W6hdIHpcPq','WPzsiCoyW67cKq','W7CXFuy','imkkWQ0Ix8kSW5/dNCoN','WOzdeSous0VcPSkwWQ/dOGr7W5K','l27dKL4','ECooW6a','FSoiW6v7WRFcSmkwW6DkiSotWQ0','e8kWWRm3rmkW','W6VcK8oanvC','vCkWWQiS','WP3cIee3','W7BcICoinG5VmIqoWPvG','p1FcTfO','vbmWW5f/dq','WRpcLSollbGmW6WP','F8ouW6dcU04','WPZcNLCX','WRlcPmoIWOZdP0pdLYJcJLtdQq','WPVcN8k9FCkwW58','oxZdM0a','W6O3DelcGq','AwLyWQ3cMI1KrSowWPvVW4ndmglcPXaDW6XQASkBE8kyW5DlzXddJmkXCqFcLIFdSviB','W7dcLmoukGG','W6tdQSoAWP54B8omWO5WW6rh','lSkwWRGO','v3FcPCodiq','W79cW5ibWQG','WRm+WRSTnHRcTNe','W6mIvHav','WPruzbpcTG','yehcOCo8eW','W49jW5VcNmkNfmkMAmkXWOiuW5xdVCk8W6RcL8oEymkqqMRcHtS','WQxdMtPC','WQS4W6JdSs0','lSo4x8oTWP8','W5WNW6RdK38','W7ldJqhcUmkc','lHRcMrtcKa','WRddHdThW7S','WPLkW6hdTslcMSo3zmoAfL00','p3VdN0BcQq8','c8k6WO4KqSkXW57dPq','WRGiW7ldQhdcGSoIzSkEgKO5WQNdIXi','W7O0W4ddVh0','WQJdSSkpDqxdS8kGWPRdNmklWPGqxG','WQnkW7JdQ2FcLSo3FCkveq','WPpdTCkSWRhcKmoDCCkGW6NcRSktxGVcQKRdSwZdS8kxW7ZcGqOfgZqhWPpcHCovwKRcVxes','WRNcUtlcTSk9','hxxdNwlcMa','W4qoW73dKa','qfjYWPRcQW','W4uGvJO','wxiECmoM','W518W6C8WQa','WQelotzmW5i','WO3cMCkUzSkr','l8kqWROGW6hdPCkbW6nubW','x0hcTmon','WPSNW5hdKa3dMG','WQBdMsPdW6XH','WQ91ir/dOsS8WRRcQCkmq1C','WOLdlSolW6/cIG','W5JcGmoYmr0','W4jeW5tdO8kbW5lcQa','WR/dPmoaWPFcUG','WOPhW4ddN0q','WPiWbdbvWOxcI8ovW7mgdXyVWPTIjSo+zJhdSv9MDSothHCwBSkVW4jZW6O','kXSxW4FdOW','WQ5dW5ddPmkW','WRjeW7RdO23cMa','WQBdGIHCW7XM','WOm+rt0','WQJdQSomWOJcQ8owamkAWRFdGue','W6XnW4BcIW','ybvxWQ/dRmoeoWLvW4BdJX1dDGldVa','hZqmW5pdHG','W7PCW5iVWPm','W7eIW4pdR3a','C8oxW7hcP1y','W58HvIaRW7vxWP9J','W77cPSosmG','W4VcHtlcJ8kBxYq','W4hdHbpcOSkBWRm7cWjmysbZWOVdV8oxwCkkWRVcHH3dQ0hcRSoQW7BdRCotmqJdGCkFW7tcVSkLWQvtWPRcIYpdS8ouvYuAWRBdLWdcKSoJWQFdQSk/dhzFWPNcNSknWR/dG8kzomkcD0VcUSkYhSoCtCkXW6CptmoNmSkKW6xcGSofWOv3j1dcSa','BhJcTCotCqrdACk8lrSUFN/dUmoclSoAW63dLqldT0q','WQNcQ8kEW7NdHmkEnSoXW7pdN8kUw1hdGtVcGG'];e=function(){return aG;};return e();}import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';const router=h['Router']();router[H(0x108,'VM&*')](H(0xc5,'XDNv'),async(p,q)=>{const af={p:'M)BN',q:0x107,r:0xcd,s:'brvj',t:0x131,u:0xd7,v:'aiUU',w:'71K6',x:'k#sg',y:'71K6',z:'UV5q',A:'ZHU7',ag:0xcf,ah:'OF1V',ai:0xfd,aj:0xb5,ak:0x12f,al:'t(#O',am:0x13a,an:'ZHU7',ao:0x109,ap:0xac,aq:'J5LV',ar:0xd9,as:'en%J',at:0x142,au:'rW29'},I=H,r={'aHhvi':function(s,t){return s||t;},'UGglX':I(0x9a,af.p),'FvdvM':function(s,t){return s<t;},'CkXUU':function(s,t){return s!=t;},'SntLe':I(af.q,'TtLu'),'UjjlL':I(0xe1,'4^HB')};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[I(af.r,'#^zv')];if(r['aHhvi'](!s,!t)||!u||!v||!w)return q[I(0xb8,af.s)](0x190)[I(af.t,'TtLu')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[I(af.u,af.v)](s))return q[I(0x144,af.w)](0xc8)[I(0xf1,af.x)]({'error':r[I(0xde,af.y)]});if(r[I(0x117,af.z)](v['length'],0x8))return q[I(0xa4,af.A)](0xc8)[I(af.ag,af.ah)]({'error':I(af.ai,'#^zv')});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/['test'](v))return q[I(af.aj,'x#Xn')](0xc8)[I(af.ak,af.al)]({'error':I(af.am,af.an)});if(r[I(af.ao,'OF1V')](v,w))return q['status'](0xc8)[I(0xad,'pB@3')]({'error':r['SntLe']});const x=await k(),y=x[I(0xb2,'UV5q')](r[I(af.ap,'J5LV')]),z=await y['findOne']({'email':s});if(z)return l[I(0x11f,af.aq)](I(0x13b,')R9j')),q[I(0xb3,'!O&m')](0x199)[I(af.ar,'#8xl')]();return await y['insertOne']({'email':s,'first_name':t,'last_name':u,'role':'user','password':o(v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[I(0x125,'rW29')](0xc9)['send']();}catch(A){l['error'](A);}return q[I(0x110,af.as)](0x1f4)[I(af.at,af.au)]();}),router[H(0xc8,'dxwN')](H(0xaa,'en%J'),n,async(p,q)=>{const al={p:0xda,q:'VM&*',r:0xe4,s:0x112,t:0x11e,u:0x104,v:0x115,w:'aiUU',x:0xa3,y:'h@v6',z:'H53x',A:0xb9,am:')R9j',an:0xc2,ao:'k#sg',ap:'H53x',aq:0xaf,ar:'#8xl',as:'PP8)',at:0xbe,au:0xad,av:'pB@3',aw:0xfa,ax:'rW29'},J=H,r={'LqoDQ':function(s){return s();},'VbReA':'users','sdJJf':function(s,t){return s!=t;},'WKFsk':function(s,t){return s(t);},'SsXgZ':J(al.p,al.q),'aMdiu':function(s){return s();},'elYqg':J(al.r,'g4Pu'),'pmigo':J(al.s,'aiUU'),'EFIFM':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[J(0xba,'ri4I')];if(!s||!t)return q[J(al.t,'g4Pu')](0x190)['send']();const u=await r[J(al.u,'gZml')](k),v=await u[J(al.v,al.w)](r[J(al.x,al.y)])[J(0xcb,al.z)]({'email':s});if(!v)return q['status'](0x194)[J(al.A,al.am)]();if(r['sdJJf'](r['WKFsk'](o,t),v['password']))return q['status'](0x191)['send']();const w=j[J(al.an,'bW81')](r[J(0xb0,al.ao)])[J(0xbd,al.ap)](r[J(0x98,'en%J')](generateUniqueId))['digest'](r[J(0xe2,'#^zv')]),x=p[J(al.aq,al.ar)][r[J(0x9d,al.as)]]||p[J(0x123,al.q)]['remoteAddress'];return r['EFIFM'](addSession,v,w,x,p[J(al.at,'pD^l')]['user-agent']),q[J(0xc3,'zY*Q')](0xc8)[J(al.au,al.av)]({'token':w});}catch(y){l[J(0xe6,'TtLu')](y);}return q[J(al.aw,'J5LV')](0x1f4)[J(0x142,al.ax)]();}),router[H(0xe7,'ZHU7')](H(0x127,'TSGv'),m,async function(p,q,r){const ao={p:'H53x',q:0x97,r:'#^zv',s:'en%J',t:0x11c,u:0x12d,v:0x9c,w:'H53x',x:'%kWR',y:'$g[3',z:'ZHU7',A:'NX2m',ap:0xf2,aq:0x136,ar:'aiUU',as:0x132,at:0x141,au:0xe9,av:'brvj'},K=H,s={'iKxBV':function(t,u){return t===u;},'jLxBr':function(t,u){return t+u;},'jbtRI':K(0xa9,ao.p)};if(s[K(ao.q,ao.r)](p[K(0xfb,ao.s)]['email_verify_at'],'')){const t=await k(),u=Math[K(0x102,'M)BN')](s[K(ao.t,'!O&m')](0x186a0,Math[K(ao.u,'aiUU')]()*0xdbba0));return await t[K(0x120,'pD^l')](K(ao.v,ao.w))[K(0xbc,ao.x)]({'user_id':p[K(0xb1,ao.y)]['_id'],'token':p[K(0xdb,ao.z)],'code':u,'verified':![],'created_at':Date['now'](),'updated_at':Date[K(0x14d,ao.A)]()}),send({'to':p[K(ao.ap,'NX2m')][K(ao.aq,'tDE9')],'subject':s['jbtRI'],'text':K(0x10f,ao.ar)+u+'.','html':K(ao.as,'l3c&')+u+K(ao.at,'brvj')}),q[K(0xc0,'#8xl')](0xc8)[K(ao.au,ao.av)]({'otp':!![]});}return q[K(0xca,'%kWR')](0xc8)[K(0x11b,'gZml')](p['user']);}),router['post'](H(0xae,'g4Pu'),m,async function(p,q,r){const ap={p:0xa7,q:'pB@3',r:'I2P$',s:0x9f},L=H;try{const s=await getUser(p['token']);return q[L(0x122,'OF1V')](0xc8)[L(ap.p,'GtyM')]({'user':{'email':s[L(0x9e,ap.q)],'first_name':s[L(0xbb,ap.r)],'last_name':s['last_name']}});}catch(t){l[L(0x10e,'VM&*')](t);}return q[L(ap.s,'Wnra')](0x1f4)[L(0x14c,'UV5q')]();}),router[H(0x121,'bL55')](H(0x145,'GtyM'),m,function(p,q,r){const ar={p:0x14a,q:'l3c&',r:0xd5,s:'$g[3',t:0x11e,u:'g4Pu',v:'PP8)'},M=H,s={'NgQJt':function(t,u){return t(u);}};return s[M(ar.p,ar.q)](removeSession,p[M(ar.r,ar.s)]),q[M(ar.t,ar.u)](0xc8)[M(0xa6,ar.v)]();}),router[H(0x119,'%kWR')]('/verify/otp',n,function(p,q,r){const at={p:'k#sg',q:0xed,r:'tDE9',s:'l3c&',t:'VM&*',u:'I)tt',v:0xfe},N=H,s={'cRkbW':function(t,u){return t||u;}};try{const {otp:t,token:u}=p[N(0x9b,at.p)][N(at.q,at.r)];if(s[N(0xd2,at.s)](!t,!u))return q[N(0x13d,'TtLu')](0x190)[N(0xd6,'dxwN')]();return q[N(0x12e,at.t)](0xc8)[N(0x99,at.u)]();}catch(v){l[N(at.v,'I2P$')](v);}});export default router;function c(p){const aF={p:'nH^f',q:0x149,r:0xe8,s:'rW29',t:0xb4,u:'t#L4'},aE={p:0x135,q:'%kWR',r:0x130,s:0x10d,t:0xcc,u:'l3c&',v:'M)BN',w:'dxwN',x:0xf9,y:'%e!c',z:0xec,A:0x113,aF:'I2P$',aG:'ZHU7'},O=H,q={'GBPWB':function(s,t){return s===t;},'ECMKI':O(0xce,'tDE9'),'rfvgd':O(0x147,aF.p),'BCzXO':O(aF.q,'zY*Q'),'HnpJL':function(s,t){return s!==t;},'CIjBs':function(s,t){return s+t;},'yZYDF':function(s,t){return s/t;},'DRZRz':O(aF.r,aF.s),'anFua':function(s,t){return s%t;},'kBIHZ':O(aF.t,'gZml'),'tNkQm':O(0x138,aF.u),'NUNXD':'action','wfqVV':O(0xdc,'%e!c'),'hFdwF':function(s,t){return s(t);},'FlHiC':function(s,t){return s(t);}};function r(s){const P=O;if(q['GBPWB'](typeof s,q[P(aE.p,aE.q)]))return function(t){}[P(aE.r,'I)tt')](q['rfvgd'])[P(0xe0,'x#Xn')](q[P(aE.s,'XDNv')]);else q[P(aE.t,'I)tt')](q[P(0x133,aE.u)]('',q[P(0x11a,'#^zv')](s,s))[q[P(0x11d,aE.v)]],0x1)||q[P(0xd8,'ri4I')](q[P(0x143,aE.w)](s,0x14),0x0)?function(){return!![];}[P(aE.x,'bW81')](q[P(0xe3,aE.y)](q['kBIHZ'],q['tNkQm']))[P(aE.z,'en%J')](q[P(aE.A,'%kWR')]):function(){return![];}[P(0xf3,aE.aF)](q[P(0xa2,'GtyM')]+q[P(0xd1,aE.aG)])[P(0xdf,'%kWR')](q[P(0x12b,'l3c&')]);q[P(0x10b,aE.q)](r,++s);}try{if(p)return r;else q['FlHiC'](r,0x0);}catch(s){}}