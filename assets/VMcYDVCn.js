import{r as t,j as e}from"./CZAm0P_r.js";import{F as f,t as y}from"./CTIXJa6l.js";import{a as C}from"./CCb-kr4I.js";import{a as S}from"./Cz0CWeBA.js";import{d as N}from"./C4IyKiPt.js";import{C as w,y as T,J as F,L as I,K as A,I as E,a3 as i,a5 as R,a6 as q,a7 as o,a8 as s,a9 as L,aa as r}from"./DRSs6zUJ.js";import"./CaXXqTot.js";import"./BFRZjPD4.js";import"./D_05oOQ-.js";import"./BQBsAJpH.js";import"./C-m1r9Yn.js";import"./CzFDRTuY.js";import"./CWmxXzlZ.js";import"./BZxJdD1U.js";const V=()=>{const[d,n]=t.useState(!1),[c,m]=t.useState("2"),[u,x]=t.useState("1"),[h,j]=t.useState("1"),[p,v]=t.useState(""),[l,b]=t.useState({scm:[]});N();const g=async()=>{n(!0),await C.get("https://backend-core1.axleshift.com//api/v1/threat/",{headers:{Authorization:`Bearer ${S.get("RCTSESSION")}`}}).then(a=>{b(a.data)}).catch(a=>{console.error(a)}).finally(()=>{n(!1)})};return t.useEffect(()=>{g()},[]),e.jsxs("div",{children:[d&&e.jsx("div",{className:"loading-overlay",children:e.jsx(w,{color:"primary",variant:"grow"})}),l.scm.length===0&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(T,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})})}),l.scm.length!==0&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx(I,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:p,onChange:a=>v(a.target.value)}),e.jsx(A,{id:"basic-addon",children:e.jsx(f,{icon:y})})]}),e.jsxs(E,{className:"d-flex justify-content-left my-2 my-lg-0 overflow-scroll no-scrollbar",children:[e.jsx(i,{value:c,onChange:a=>m(a.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(i,{value:u,onChange:a=>x(a.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(i,{value:h,onChange:a=>j(a.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"})]}),e.jsxs(R,{striped:!0,children:[e.jsx(q,{children:e.jsxs(o,{children:[e.jsx(s,{children:"#"}),e.jsx(s,{children:"State"}),e.jsx(s,{children:"Scope"}),e.jsx(s,{children:"Manifest"}),e.jsx(s,{children:"CVE"}),e.jsx(s,{children:"Summary"}),e.jsx(s,{children:"Severity"}),e.jsx(s,{children:"Updated At"})]})}),e.jsx(L,{children:l.scm.map(a=>e.jsxs(o,{children:[e.jsx(r,{children:a.number}),e.jsx(r,{children:a.state}),e.jsx(r,{children:a.scope}),e.jsx(r,{children:a.manifest}),e.jsx(r,{children:a.cve}),e.jsx(r,{children:a.summary}),e.jsx(r,{children:a.severity}),e.jsx(r,{children:new Date(a.updated_at).toLocaleString()})]},a.number))})]})]})]})};export{V as default};
