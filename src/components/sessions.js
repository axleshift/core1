(function(j,k){const H={j:'6Q3L',k:0x136,l:'*hj5',m:0x11d,n:'Wdbz',o:'Z24(',p:0x12c,q:')dZD',r:0x161,I:'0Rn1',J:0x132},s=f,l=j();while(!![]){try{const m=parseInt(s(0x11a,H.j))/0x1*(parseInt(s(H.k,'FbeR'))/0x2)+-parseInt(s(0x17a,H.l))/0x3*(-parseInt(s(0x168,'d(F^'))/0x4)+parseInt(s(H.m,H.n))/0x5+-parseInt(s(0x135,H.o))/0x6+-parseInt(s(H.p,H.q))/0x7+parseInt(s(0x125,'6Q3L'))/0x8*(-parseInt(s(H.r,H.I))/0x9)+-parseInt(s(H.J,'s7Do'))/0xa*(-parseInt(s(0x149,'0mKP'))/0xb);if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0x8e69c));function e(){const ap=['WRVcGJvGFaNdH0BdVCkpev/dT8kewM4fr8kJtGddKmosW4xdQ3S5WPpdTCkBW5Sp','W6Okl8o+W57cImoZ','y8oZAG','WRtdH8oXuSoW','B8k9WR87dSoQW6hdH8ki','W7ldJhlcRG','WQKPWPW','EqOUW4iM','W4hcOqDPW70','jZz8pYRdM8oNwW','ee8iW6PUW5u9W6NcOCoUzW','vmkVWPmxWOO','qCoqDSooWQpcV8kBiq','zvJdOSks','W4ymrSk4W7u','xSoqA8oAWR7cUa','W5FcTbPjW5q','ySohr8owWQdcOh9Z','mK/dLSokhSkHW5W+WPGSWOhcPmknW43dOq','uSkYWO8lWOWGW7VdJ8kFWRJdJq','jmkWW6JcStG','WOTrW5JcUSkR','omobW7rLyW','WO3cVmo4W4lcKa','WO1vW47cO8k8kqVcVSoDoSoTWQW2ztBcP8k6WQNdSq','W4NdMCotW7VcPG/dP2W','W44FxSkEW6K','WOXpW6WmWRPcua','qHbvWRWsW7es','WPqJfa','kSoEW5XHBq','s8kXWQqWcSkXW5xcRmkomSo4jq','WOJcMCkmz8o+W4zcW4H3','WPxcOfVdISo1','WOPdW5/cPmkrlK8','C8ooWQVdMu/dTxNdQColWO3dOSo1','zmo/BxK','Emo1wmkLW50','p8oKW6mga8obW7ZdOCkTuW','ACo5F8kx','WR/dVZezw8oUWPZdKmkhhre','i8kvW7NcIbm','WQpcKhvWzXxdGvhdU8kvaa','WRSzemoCW6S','WRTpW5idoa','gCoRW7XUx8oIW6lcT8kxnW','W4pcRSk4sCox','WRdcQv4UWQm','W7dcGJX9W5hcLLa','WOhcHmkbzCo6W5O','BmoHE3RcSa','WRxdTsOzAq','WRhdJX/dJse','pSkJpYhdUh7cPG7cGYjDWQC','gColW7tdSutcRSobW5/dN3JcK0xdUmk5gSkVW6hcNtVdGCogvLDtW7GOuCkLFqqwWOa','mG8oW5VcI8k9WQTVpZ/cKZW','WOFcLum0','kmo5W64jaW','W6BcGSk3b8k/W6hcNgBcNmolW7tcNLq','WPfFW40','A8knAmkVlW','WPBcRMBdLCod','WQDUW78Xmq','aNBdTmo0kq','rSkUWPeNma','xXzNW4tcNmkMW5KLyHtcUutcN3SyDIddTgjbW59NzCkCaXFcVCkVWROYwNldN3a','maSlWR7dLmoeWPHveG','sCk+WQKFaG','rtiYhaK','W6FcGGf6W4ZcK1Sz','WQpcKhDVDGtdGfVdOmku','cX96mH0','W6HTW6VdVKG','WQtdHSoeaSkWW7tcUmkhWOSuW5NdGgi','W7NcN8odW6XB','k1FdLConkq','a8oTWOixWRCcW7BdQG','DqiBcG','qrrAWReX','iCotw8o0WQzrW5ddT2RcMdvn','gCoRW75XvCoTW7m','WP7dVsjdW4/dQNjuW4XqnGHH','o8ojW6HVEhVdRLVdUuDcbG','W78RpCoLj8oDW7G','sqy6W4uwkmoXga','z2awEM3cG8kXAmkokNH6W5G','zmktWQS','dtDHtSk+W5BcSW','W4lcUSkCrSoH','nSkfW5hcRX4','qSohASojWQxcPmkmiSkJ','pIHZWQhcI8kvW6HaW6NdOW','dCoLW6jS','W7pdNNNcV3ldJCorWPeVWOXCW4XpW7bwla','WRVcNmoJW7VcKW','rmkUWOqkWOS','WPXFW5BcUSkRjf/dV8ouiq','WPHxW5/cPa','CCkogSkTW6meW5u','W7FcQSoFr8os','W4GcqSkcW6/dVCo0W4ddJrnt','kfFdICoacW','c8oSySkPemkQWOfH','ySokWOxcUmoH','W5z0W78','WQhcNg9Qzqi','WR06gCoCdq','ACotWPlcPmo+','WQWOWPldGG','bSoCW5CMmG','WRddSsWECmoYWOJdNSkw','wSoaw3RcOW','W4SgWONdPmo9dwhdOCoZjmoB','WRldUZOzqG','W6BdJMtcR2/dI8oqWOW','trDiWR0VW6S4W7dcJa'];e=function(){return ap;};return e();}const d=(function(){let j=!![];return function(k,l){const I={j:0x12d},m=j?function(){const t=f;if(l){const n=l[t(I.j,'lBGV')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const S={j:0x124,k:'Y@L4',l:0x180,m:'*hj5'},R={j:0x16e,k:0x17c,l:0x11b,m:'iluE',n:0x165,o:'Oi1y',p:0x16d},u=f,j={'ZWXLT':u(0x140,'^Q59'),'uTIhn':u(S.j,'6Q3L'),'nkesm':function(k,l){return k(l);},'uiEGh':u(0x14f,S.k),'majIn':function(k,l){return k+l;},'BEdgY':u(S.l,S.m),'CmzwJ':function(k,l){return k+l;},'DbFdo':'input','oAotC':function(k){return k();},'dMpPE':function(k,l,m){return k(l,m);}};j[u(0x16b,'*hj5')](d,this,function(){const v=u,k=new RegExp(j[v(0x150,'IvhL')]),l=new RegExp(j[v(R.j,'US*o')],'i'),m=j[v(0x154,'w@XP')](c,j[v(R.k,'3TZ^')]);!k[v(R.l,R.m)](j[v(R.n,R.o)](m,j[v(R.p,'#%c*')]))||!l['test'](j['CmzwJ'](m,j[v(0x121,'rdLS')]))?j[v(0x14e,'R%IV')](m,'0'):j['oAotC'](c);})();}());const b=(function(){let j=!![];return function(k,l){const m=j?function(){const w=f;if(l){const n=l[w(0x12b,'npyd')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const a1={j:0x157,k:'Y@L4',l:0x171,m:'#%c*',n:0x113,o:0x123,p:'Z24(',q:0x17b,r:'C7$b',a2:'5xUd',a3:'rdLS',a4:'$vm[',a5:0x147,a6:0x13d,a7:'MYh)',a8:'B#)E'},a0={j:0x117},x=f,j={'REaud':function(o,p){return o(p);},'KZlvj':function(o,p){return o+p;},'YtoVO':x(a1.j,'25jw'),'BwCDR':function(o){return o();},'LRMzx':x(0x15d,a1.k),'npjkR':x(a1.l,'Oi1y'),'XCkVf':x(0x16c,'yHBt'),'PZLcW':x(0x11c,'IvhL')},k=function(){const y=x;let o;try{o=j[y(0x13b,')dZD')](Function,j['KZlvj']('return\x20(function()\x20'+j[y(a0.j,'IqK(')],');'))();}catch(p){o=window;}return o;},l=j['BwCDR'](k),m=l[x(0x133,a1.m)]=l[x(a1.n,'MYh)')]||{},n=[j[x(a1.o,a1.p)],x(0x13f,'#%c*'),x(a1.q,'KLb9'),j[x(0x12e,a1.r)],x(0x177,a1.a2),j[x(0x183,a1.a3)],j[x(0x175,'#%c*')]];for(let o=0x0;o<n[x(0x166,a1.a4)];o++){const p=b[x(a1.a5,'Oi1y')][x(a1.a6,a1.a4)]['bind'](b),q=n[o],r=m[q]||p;p['__proto__']=b['bind'](b),p[x(0x128,a1.a7)]=r[x(0x160,a1.a8)]['bind'](r),m[q]=p;}});(function(){const a5={j:'yHBt',k:'Z24('},a4={j:0x146,k:'pO^H',l:0x11f,m:'0mKP',n:0x148},z=f,j={'QBcBT':function(m,n){return m+n;},'QPhWg':z(0x16f,a5.j),'mpvfp':z(0x119,'!uRY'),'CBuBJ':function(m){return m();}},k=function(){const A=z;let m;try{m=Function(j['QBcBT'](j[A(a4.j,a4.k)](j[A(a4.l,a4.m)],j[A(a4.n,'C7$b')]),');'))();}catch(n){m=window;}return m;},l=j[z(0x126,a5.k)](k);l['setInterval'](c,0x9c4);}()),a();import g from'fs';import{ObjectId}from'mongodb';import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a7={j:0x163,k:0x17d,l:'IvhL',m:0x156,n:'npyd',o:0x139,p:'Z24(',q:0x182},B=f,n={'dXDUp':function(o){return o();},'CigtY':B(a7.j,'$vm[')};try{const o=await n['dXDUp'](h);await o[B(a7.k,a7.l)](n[B(0x15e,'wr&b')])[B(a7.m,'0Rn1')]({'user_id':j[B(0x14b,a7.n)],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[B(a7.o,a7.p)]()});}catch(p){i[B(a7.q,'w$lF')](p);}};function f(a,b){const c=e();return f=function(d,g){d=d-0x113;let h=c[d];if(f['pVSXcS']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['NBGNgH']=m,a=arguments,f['pVSXcS']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['yqbdpK']===undefined&&(f['yqbdpK']=!![]),h=f['NBGNgH'](h,g),a[k]=h):h=l,h;},f(a,b);}export const getUser=async j=>{const a9={j:0x14d,k:'FbeR',l:0x13c,m:'*hj5',n:'lqh(',o:'A6W7',p:'0Rn1',q:0x179,r:'0Rn1',aa:0x13e,ab:'w$lF'},C=f,k={'vpitm':function(l){return l();},'vxINc':'sessions'};try{const l=await k[C(a9.j,a9.k)](h),m=await l[C(0x143,'yHBt')](k[C(a9.l,a9.m)])[C(0x13a,a9.n)]({'token':j});if(!m)return null;const n=await l['collection'](C(0x142,a9.o))[C(0x173,a9.p)]({'_id':m[C(a9.q,'yHBt')]});return{'_id':n[C(0x174,'FbeR')],'email':n[C(0x131,a9.r)],'first_name':n[C(a9.aa,'3DGM')],'last_name':n[C(0x151,'w@XP')],'role':n['role']};}catch(o){i[C(0x182,a9.ab)](o);}return null;};export const removeSession=async j=>{const ab={j:'^Q59',k:0x186,l:0x129,m:'25jw',n:0x159,o:0x14a,p:'R%IV'},D=f,k={'CYnnh':function(l){return l();},'MvVCI':D(0x155,ab.j)};try{const l=await k[D(ab.k,'iluE')](h);await l[D(ab.l,ab.m)](k['MvVCI'])['updateOne']({'token':j},{'$set':{'active':![],'last_accessed':Date[D(ab.n,'3TZ^')]()}});}catch(m){i[D(ab.o,ab.p)](m);}};export const isActiveToken=async j=>{const ad={j:'wr&b',k:'#%c*',l:0x127,m:'y80c',n:'je9d',o:')dZD',p:'yHBt',q:0x14c,r:'25jw',ae:0x162},E=f,k={'jjTJj':function(l){return l();},'SQEzR':E(0x137,ad.j)};try{const l=await k['jjTJj'](h),m=await l[E(0x184,ad.k)](k[E(ad.l,ad.m)])[E(0x172,ad.n)]({'token':j});if(m['active'])await l[E(0x184,'#%c*')](k[E(0x185,ad.o)])['updateOne']({'token':j},{'$set':{'last_accessed':Date[E(0x11e,ad.p)]()}});return m[E(ad.q,ad.r)];}catch(n){i[E(ad.ae,'A6W7')](n);}return![];};function c(j){const ao={j:0x169,k:'5xUd',l:0x144,m:0x164,n:'FjhJ'},an={j:0x16a,k:'A6W7',l:'KLb9',m:0x15a,n:'Wdbz',o:'US*o',p:0x181,q:0x167,r:'MYh)',ao:'y80c',ap:0x17f,aq:0x15c,ar:0x115},F=f,k={'tuwYG':function(m,n){return m===n;},'WQPlj':F(ao.j,'C7$b'),'lDtrn':F(0x145,'s7Do'),'CtRQm':function(m,n){return m!==n;},'GQKRR':function(m,n){return m/n;},'lBUPU':F(0x114,ao.k),'tNwXl':function(m,n){return m%n;},'DYHGj':F(ao.l,'yHBt'),'oJImX':'action','ieusF':F(ao.m,ao.n),'RLUgC':'stateObject','XFUyE':function(m,n){return m(n);},'isFKn':function(m,n){return m(n);}};function l(m){const G=F;if(k['tuwYG'](typeof m,'string'))return function(n){}[G(an.j,an.k)](k[G(0x152,an.l)])[G(an.m,an.n)](k[G(0x178,'FNzA')]);else k[G(0x141,an.o)]((''+k[G(0x122,'C7$b')](m,m))[k['lBUPU']],0x1)||k['tNwXl'](m,0x14)===0x0?function(){return!![];}[G(an.p,'25jw')](G(0x17e,'3TZ^')+k[G(an.q,an.r)])[G(0x130,an.ao)](k[G(0x120,'FNzA')]):function(){return![];}[G(an.ap,'w@XP')](k[G(0x116,'w@XP')]+G(an.aq,'^Q59'))[G(an.ar,'KLb9')](k[G(0x15f,an.r)]);k[G(0x12a,'B#)E')](l,++m);}try{if(j)return l;else k['isFKn'](l,0x0);}catch(m){}}