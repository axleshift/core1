function f(a,b){const c=e();return f=function(d,g){d=d-0x120;let h=c[d];if(f['vJBvYp']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['jhIxUI']=m,a=arguments,f['vJBvYp']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['XYpmfn']===undefined&&(f['XYpmfn']=!![]),h=f['jhIxUI'](h,g),a[k]=h):h=l,h;},f(a,b);}const H=f;(function(p,q){const R={p:'2[0u',q:'MWq3',r:0x145,s:'J6bH',t:0x1ad},B=f,r=p();while(!![]){try{const s=-parseInt(B(0x166,'go2h'))/0x1+parseInt(B(0x167,R.p))/0x2+parseInt(B(0x149,'c[Ha'))/0x3*(parseInt(B(0x15d,'J6bH'))/0x4)+-parseInt(B(0x141,R.q))/0x5+parseInt(B(0x158,'9sWZ'))/0x6+-parseInt(B(0x17d,'2[0u'))/0x7*(parseInt(B(R.r,R.s))/0x8)+parseInt(B(R.t,'xJ[m'))/0x9;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x32285));const d=(function(){let p=!![];return function(q,r){const S={p:0x18f,q:'xJ[m'},s=p?function(){const C=f;if(r){const t=r[C(S.p,S.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a2={p:0x182,q:'k1^e',r:'iS5h'},a1={p:'4Nkv',q:'go2h',r:0x180,s:'c[Ha',t:0x169,u:'4st2'},D=f,p={'GlGhJ':D(0x14c,'bjZb'),'AJjGK':D(0x164,'J39V'),'HRpCH':function(q,r){return q(r);},'ioMdA':function(q,r){return q+r;},'BMjxF':'chain','UQwqq':D(a2.p,a2.q),'TmiPI':function(q,r){return q(r);},'qiNzO':function(q){return q();},'tpvAt':function(q,r,s){return q(r,s);}};p[D(0x1ba,a2.r)](d,this,function(){const E=D,q=new RegExp(p[E(0x12c,a1.p)]),r=new RegExp(p[E(0x14b,a1.q)],'i'),s=p[E(a1.r,'mmyO')](c,'init');!q[E(0x171,a1.s)](p['ioMdA'](s,p[E(a1.t,'mmyO')]))||!r['test'](p[E(0x19e,'Wr!m')](s,p[E(0x19c,a1.u)]))?p['TmiPI'](s,'0'):p[E(0x190,'kY!P')](c);})();}());const b=(function(){const a3={p:'go2h'};let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(0x1a0,a3.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ab={p:0x125,q:'xJ[m',r:'CoP)',s:0x1aa,t:'#Gml',u:0x1a1,v:0x127,w:'x&rH',x:'shAz',y:0x1bc,z:')ZGg',A:0x16e,ac:0x13b,ad:'hJfa',ae:'V^k9',af:0x1bb,ag:'ExKS',ah:0x185,ai:'wp22',aj:0x165,ak:0x17c,al:'J39V',am:0x1c0,an:'wp22',ao:0x162,ap:'uF3z',aq:'rtF3',ar:0x15f},G=f,p={'ISZZq':function(t,u){return t(u);},'hzdGm':function(t,u){return t+u;},'mSZSU':G(ab.p,ab.q),'uenXD':G(0x196,ab.r),'uJJTU':function(t){return t();},'CoOPj':G(ab.s,ab.t),'lHRcz':'error','aCSBI':G(0x18c,')ZGg'),'JmQEc':'trace','SvRZr':function(t,u){return t<u;}};let q;try{const t=p[G(0x198,'J39V')](Function,p['hzdGm'](p[G(ab.u,'(oSp')](p['mSZSU'],p[G(ab.v,ab.w)]),');'));q=p[G(0x14d,ab.x)](t);}catch(u){q=window;}const r=q[G(ab.y,ab.z)]=q[G(ab.A,'MjSO')]||{},s=[G(ab.ac,ab.ad),p[G(0x16b,ab.ae)],G(ab.af,ab.ag),p[G(ab.ah,'uM7B')],p[G(0x184,ab.ai)],'table',p['JmQEc']];for(let v=0x0;p[G(ab.aj,'C^#J')](v,s[G(ab.ak,ab.al)]);v++){const w=b['constructor'][G(ab.am,ab.an)][G(ab.ao,ab.ad)](b),x=s[v],y=r[x]||w;w[G(0x1b1,ab.ap)]=b[G(0x13e,ab.aq)](b),w[G(ab.ar,'7cs5')]=y[G(0x1b4,'^Qep')][G(0x14a,'x&rH')](y),r[x]=w;}});a();import g from'dotenv';function e(){const aG=['z8oziuLQW41FENG','W4TNW7qukLxdVSkeWPLr','W6pdKmkzWQ3cLq','cYW3zw7dLmkyW4W','e0XgW6u8W4pdSZDIW5ZcISoM','W5RcSmojWRhcTW','wmoHcfLy','W4VcSSodWR3cTq','W67cJSkDW53cNmkH','WRldVmk9c30','W6JdU8omWQe','WOVcOM3cPbdcP2m','a8kmW4FdOKRcMZvLWOThW5brW7G','axxdMwiKWP7dHKdcO8k7amk9DG','yxzSWOm3W6pdMW','W79MdvqhWOxcQ8k/yq','WRH6jKKBWOdcGa','W5FdLCk8WR3cP1S','xv7cULaB','WPD5fd0','WO4GivupW7XECb5pWRL/j288pSkvWQ/dRmo4W7uvrWOZASkGhZ3dPSoyW6b+cCknW4RdMepdPZhdN25mgmktmu7dOSomW4RcHWddOmoCqmkrzW/dLLnbC8oDmrZcU8kDrSohjrVcUSkgWQBdGCopW7KSFalcQ0BcGHJcRs8','WQZdISoiW5z5WRSIc8kF','WRhcHCofW7uBFeZcRSk5W4RcG3FcSWX4WQS7pCoK','W79ZlMCp','WQZdMq0jWQ0','cSkcW6BcKv0','W4ZcUmogWRW','WP7dMMRdVa','iKneW5FdLGbkW79SpW','cNHSW4xdPG','g2FcNfldVSoy','wmkpjf7cRq','W7XGa1qDWOi','zJhcGxdcOW','rg0bASoCeq','WQ/dKg3dNa','rg0sD8ohbq','WQZdV8kKja','WRhdMrS','yI3cNcfNW4xcHw3dPSkPfCk6zW5lWP4EW4b1A8kFedi','WQpdHmovW5fsWQC2bCkoscu','rWRcIrbX','vNzfWOFdU8kQ','zSkZbx0','bhZcMG','DmotWOhdKabFCrpdUmkyefO','DmoDEfldGG','WQldGSovW4y','iCkiW4pcIL8j','kNnoW58','kmkxoGZcHdTFWOCGphKS','oCoEW4PsWQOrWRjjW4KNFq','W63cSSoDWQZcVSo2','DCosg2vC','mSkhz0NdQCkXE2/dKSklgu1c','vI7cIMxcIq','WQ7dUCofWQNdPNa4','W5xcU8kRW4RcOG','ECkGW5ddVmoWW4jbW7OClgCD','WRVdLq01','xapcLwWR','q8kSWOfvkCk3W4RdJ28cW7GUWPBdUCk/W5q','WRddQuJdPJ8','WRyNWOT5j8kI','vSk0WQLYnW','qtJcJIzLW5K','xmkYW4RdNCkd','W4VdK8ocWOZdSa','wmobFfZdNgD6W4GZog4RlSkpsdZcLmkwW4miW60','WRxdUmkQpNXx','WRBdO8k4pG','W7JcHNjvW5xdPCkABmod','W4ddImk6WQZcOvW','WOFdPmkrW6/dRCo8omkNWQRdIKK','tSoNg0jpCX1yiSknkW','xN0spcf8','W5ddJSk2WQZcVa','uZZcNgtcJCodnuO','n8otnYdcVSozmG','cSk3zq8WWOTIq0byW7vA','bCkgW7NdUuZcLXPM','juL0W7JcGG','WRBdL2pdHH/cIq','cNRcK0i','WO3cV3hcUa0','hmoaW6VdIbbnlgNcHmkMjryuW7tdKmoDWR0KBwznvY7dGSk7j8o5WRxdS8okvuRcN0a','W6bfWPNdSCog','l3JdIX9vasHzW6BdQSoXW4m','CaeYWQFdI8oacby9W79GkW','qsNcGty','DvqzE8o0','zSkOeKpcHq','b0v5W7tdIa','ghZcJLi','WQRdOfVdOsK','W5fnvKdcImoGEG','ANXHWOS3W7ldNa17DG','W5tdLGmNWPCkewjCWQLwdCkEfSorBSkmW5JdTW','pmo8WPBcUW','A0X3W7hcIq','tSoNg0jFtW','r3yaDW','WRpdI8klW4eRqmkGjh3dTmoi','WOZcQghcOG','W6pdNHy7WOLewc4AWR1uhmkphSoAECkeWPtcR3FcJCkrAW','W5yNuhaxgXz3FdDYdmoy','CSoVaeLO','WQ8GWOvJ','WQpcOhtcJZC','lmkoW5NcHeqp','C1DaW73cImkjlW','BfVcJMSBsCkd','zLRdJ8k8','F0Sdqmo6','zSkWbg7cU8kc','WRNdISkvW4CR','WR7dNIZdKqxcLmolzComWO9mxIxdRbO7vc3cTxZdHSoOW6ddTSk4WO/dGSolE3PwjW','W65xmwiH','W4rDW4mwja','sWqgWRHX','CCksW5FdKSky','w3WDzmoghG','n09yW4a','ECkZd2e','WRldI8kbW4S','WO3cTwdcSG/cV2/cRxW','W6/dJs4fWORdRSkHrCo9W6JcLq','DSofnqlcQa','WQlcKmobW6Wq','fmkoi8octW','g3ZcNK3dRSoF','WR3dNNFdQWddVZaiuJOky8k5WP3dMJSRWQCODSk9xJiSCSknzJNcIX5qW6lcKfRcJszD','fSkOW6BdPLq','bSkmW6hdGKO','WQddPCkLlKzkW4q','rSoUvfvfuGXgnCkBpdyOW7TWvvJcNmoKbmkidWNdJLtdRSkuEIeiqmok','W5THW7abk0m','cCk4W63cUue','W5LaWQtdHq','W6FcHSksW5pcHa','W7HrW5ianq','W7pdOGaJWPq','z0hcV0yd','W7a+W6D1ma','WPVcPwldPuRdVq','FdNcJ0Cz','wJBcIXv9','m8koW5NcHW','zCoxW5f8WQ0l','qdlcGxhcK8ol','kmk3qSoSaq','wd/cGdW','BJ3cNL8vqa','z08BcI0','ymkLdMS','WPb3fsC','WOO8WPTMpG','a8o9W4DEWQa','W7ddMCkhWRbDjL3dJ8k6W4NcL3BcPq','WP87aszxxe9RBJXvwmoWW7Kb','WRpdN8oAW5ztWQy','WRldQCk4pG'];e=function(){return aG;};return e();}g[H(0x1a4,'8c&H')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,removeSession,getUser}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';(function(){const ag={p:0x170,q:'4st2',r:0x183,s:'shAz',t:0x14f,u:'mpwj'},af={p:'Or9&',q:0x1b3,r:'E!CZ'},I=H,p={'uhrLJ':function(s,t){return s(t);},'MMdNd':function(s,t){return s+t;},'GqDdG':I(ag.p,ag.q),'tDGCj':I(ag.r,ag.s),'smFDj':function(s){return s();}},q=function(){const J=I;let s;try{s=p[J(0x16a,af.p)](Function,p['MMdNd'](p[J(af.q,af.r)]+p['tDGCj'],');'))();}catch(t){s=window;}return s;},r=p[I(ag.t,'bjZb')](q);r[I(0x142,ag.u)](c,0x9c4);}());import o,{generateUniqueId}from'../../src/password.js';const router=h[H(0x143,'9sWZ')]();router[H(0x16c,'hJfa')](H(0x156,'gCZE'),async(p,q)=>{const al={p:'MWq3',q:'XcBd',r:0x136,s:'(oSp',t:0x177,u:0x139,v:'tA%s',w:0x189,x:'V^k9',y:0x14e,z:0x17a,A:'FME6',am:'*kLn',an:0x1b9,ao:0x12d,ap:'iS5h',aq:'7cs5',ar:0x1b0,as:'iS5h',at:0x161,au:'shAz',av:0x150,aw:0x18a,ax:'Or9&',ay:0x193,az:0x195,aA:'iS5h',aB:')ZGg',aC:0x15a,aD:'Or9&',aE:0x13a,aF:'Or9&',aG:0x13d,aH:0x168},K=H,r={'FfWvR':function(s,t){return s||t;},'WPXpJ':K(0x153,al.p),'huDCl':function(s,t){return s<t;},'weKOt':K(0x192,al.q),'JFFdM':K(al.r,al.s),'TmsdQ':function(s){return s();},'gALkj':K(0x146,'8c&H'),'PDCuk':K(al.t,'4st2'),'dIDqq':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(r['FfWvR'](!s,!t)||!u||!v||!w)return q[K(al.u,al.v)](0x190)[K(al.w,al.x)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/['test'](s))return q[K(al.y,'me4r')](0xc8)[K(al.z,'me4r')]({'error':r[K(0x148,al.A)]});if(r[K(0x19d,al.am)](v[K(al.an,'FME6')],0x8))return q[K(al.ao,'hJfa')](0xc8)[K(0x134,al.ap)]({'error':r[K(0x194,al.aq)]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[K(al.ar,al.as)](v))return q[K(al.at,al.au)](0xc8)[K(0x1a6,'(oSp')]({'error':K(0x123,'(y0e')});if(v!=w)return q[K(al.av,al.s)](0xc8)[K(al.aw,al.ax)]({'error':r['JFFdM']});const x=await r['TmsdQ'](k),y=x['collection'](r[K(al.ay,'7cs5')]),z=await y[K(al.az,al.aA)]({'email':s});if(z)return l[K(0x163,al.aB)](r[K(0x19b,'uM7B')]),q[K(al.aC,'Xq!z')](0x199)[K(0x1a9,al.aD)]();return await y['insertOne']({'email':s,'first_name':t,'last_name':u,'role':K(al.aE,al.aF),'password':r['dIDqq'](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['status'](0xc9)[K(0x12a,al.q)]();}catch(A){l[K(al.aG,al.p)](A);}return q[K(0x1a7,'go2h')](0x1f4)[K(al.aH,'(oSp')]();}),router['post'](H(0x1a3,'mpwj'),n,async(p,q)=>{const ar={p:0x18e,q:'J6bH',r:')ZGg',s:0x135,t:0x1ae,u:0x1a7,v:'go2h',w:0x129,x:'vInJ',y:0x120,z:'E!CZ',A:0x17f,as:'8c&H',at:0x197,au:'uM7B',av:0x1b2,aw:'uM7B',ax:'Or9&',ay:'(oSp',az:0x157,aA:'vInJ',aB:0x187,aC:0x191,aD:'hJfa',aE:0x1bd,aF:0x199,aG:'iS5h'},L=H,r={'RjAUt':function(s,t){return s||t;},'eGcEi':function(s){return s();},'mXcfH':L(ar.p,ar.q),'ElngY':function(s,t){return s!=t;},'KmwXH':function(s,t){return s(t);},'mSwgj':L(0x19f,ar.r),'uFfBa':function(s){return s();},'AWKJo':L(ar.s,'x&rH'),'tdmfn':L(ar.t,'#Gml'),'sGCcJ':'user-agent'};try{const {email:s,password:t}=p[L(0x18b,'k1^e')];if(r[L(0x121,'*kLn')](!s,!t))return q[L(ar.u,ar.v)](0x190)[L(ar.w,'9sWZ')]();const u=await r['eGcEi'](k),v=u[L(0x16f,ar.x)](r['mXcfH']),w=await v['findOne']({'email':s});if(!w)return q[L(ar.y,ar.z)](0x194)[L(ar.A,'op1I')]();if(r[L(0x130,ar.as)](r[L(0x17b,')ZGg')](o,t),w[L(0x15c,'8c&H')]))return q[L(ar.at,ar.au)](0x191)[L(0x12a,'XcBd')]();const x=j[L(ar.av,ar.aw)](r['mSwgj'])[L(0x181,ar.ax)](r[L(0x138,ar.ay)](generateUniqueId))[L(ar.az,ar.z)](r['AWKJo']),y=p[L(0x1bf,ar.aA)][r[L(ar.aB,'CT]Q')]]||p[L(ar.aC,ar.aD)][L(ar.aE,'7cs5')];return addSession(w,x,y,p['headers'][r['sGCcJ']]),q[L(0x1af,'rtF3')](0xc8)[L(ar.aF,'C^#J')]({'token':x});}catch(z){l['error'](z);}return q[L(0x154,ar.aG)](0x1f4)['send']();}),router[H(0x174,'mmyO')]('/verify',m,function(p,q,r){const as={p:'mmyO',q:'shAz',r:'FME6'},M=H;return q[M(0x133,as.p)](0xc8)[M(0x132,as.q)]({'email':p[M(0x19a,as.r)]});}),router[H(0x122,'#Gml')](H(0x172,'2[0u'),m,async function(p,q,r){const at={p:'E!CZ',q:'9sWZ',r:0x12b,s:0x124,t:'rtF3',u:'CoP)',v:0x12f,w:0x168},N=H;try{const s=await getUser(p[N(0x1b8,'9sWZ')]);return q[N(0x120,at.p)](0xc8)['json']({'user':{'email':s[N(0x1b6,at.q)],'first_name':s[N(at.r,'V^k9')],'last_name':s[N(at.s,at.t)]}});}catch(t){l[N(0x1b7,at.u)](t);}return q[N(at.v,'wp22')](0x1f4)[N(at.w,'(oSp')]();}),router[H(0x155,'iS5h')](H(0x147,'ExKS'),m,function(p,q,r){const av={p:'CT]Q',q:0x173,r:'CoP)'},O=H,s={'YDpiu':function(t,u){return t(u);}};return s[O(0x151,av.p)](removeSession,p[O(0x15b,'E!CZ')]),q[O(av.q,av.r)](0xc8)[O(0x1a2,'J39V')]();});export default router;function c(p){const aF={p:0x131,q:'*kLn',r:'4Nkv'},aE={p:0x144,q:'rtF3',r:0x1a5,s:0x186,t:'wp22',u:0x1ac,v:0x1ab,w:'me4r',x:0x179,y:'uF3z',z:0x16d,A:'shAz',aF:0x175,aG:'k1^e',aH:'Xq!z',aI:0x128,aJ:'J39V',aK:'2[0u'},P=H,q={'IFyEd':function(s,t){return s===t;},'HAaSv':P(aF.p,'mmyO'),'unvRZ':'while\x20(true)\x20{}','pgLGg':P(0x17e,aF.q),'pzLTN':function(s,t){return s+t;},'KODQb':function(s,t){return s/t;},'Ooqkl':function(s,t){return s%t;},'JFhBy':P(0x176,')ZGg'),'JiQrm':P(0x140,aF.r),'oCYSC':P(0x13f,'J39V'),'qCYAs':P(0x159,'CoP)'),'gPpOG':function(s,t){return s(t);}};function r(s){const Q=P;if(q['IFyEd'](typeof s,q[Q(aE.p,'CoP)')]))return function(t){}[Q(0x137,aE.q)](q[Q(aE.r,'zgKO')])[Q(aE.s,'iejW')](q[Q(0x126,aE.t)]);else q['pzLTN']('',q[Q(0x12e,'Or9&')](s,s))[Q(0x188,'mmyO')]!==0x1||q[Q(aE.u,'mpwj')](q[Q(aE.v,aE.w)](s,0x14),0x0)?function(){return!![];}['constructor'](q['pzLTN'](q[Q(0x152,'ExKS')],q[Q(aE.x,aE.y)]))['call'](q[Q(aE.z,aE.A)]):function(){return![];}[Q(aE.aF,aE.aG)](q[Q(0x1a8,aE.aH)]+q[Q(aE.aI,aE.aJ)])[Q(0x160,aE.aK)](q['qCYAs']);r(++s);}try{if(p)return r;else q['gPpOG'](r,0x0);}catch(s){}}