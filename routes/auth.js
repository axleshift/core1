const E=f;(function(p,q){const O={p:0xa8,q:'7r7X',r:0xca,s:'RTTk',t:0xad,u:0xf1,v:'WpYO',w:0xbc,x:'dhKG',y:'xYlu',z:0xf8,P:'73R)'},A=f,r=p();while(!![]){try{const s=-parseInt(A(O.p,O.q))/0x1+parseInt(A(O.r,O.s))/0x2*(-parseInt(A(O.t,'04HN'))/0x3)+-parseInt(A(0x88,'73R)'))/0x4+-parseInt(A(O.u,O.v))/0x5+-parseInt(A(O.w,'R@%F'))/0x6*(-parseInt(A(0x9b,O.x))/0x7)+-parseInt(A(0xab,O.y))/0x8*(-parseInt(A(0xaf,'q$K4'))/0x9)+parseInt(A(O.z,O.P))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xb711c));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());function f(a,b){const c=e();return f=function(d,g){d=d-0x80;let h=c[d];if(f['aWaIgM']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['ZfogHZ']=m,a=arguments,f['aWaIgM']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['cJjNWJ']===undefined&&(f['cJjNWJ']=!![]),h=f['ZfogHZ'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(){const Y={p:0xe2,q:'p%bT',r:0xd6},X={p:'i!Us',q:0xd9,r:'%4uo',s:0xc4,t:'VH5C',u:0xe5},B=f,p={'cKbyJ':B(Y.p,Y.q),'gPKpA':function(q,r){return q(r);},'kwrmc':B(Y.r,'kc8Y'),'XuyEI':function(q,r){return q+r;},'nTmXV':function(q,r){return q+r;},'oDhoP':function(q,r,s){return q(r,s);}};p[B(0xd2,'2joN')](d,this,function(){const C=B,q=new RegExp(C(0x94,X.p)),r=new RegExp(p[C(X.q,'VAom')],'i'),s=p[C(0x106,'[Cf!')](c,p[C(0xb3,X.r)]);!q['test'](p[C(X.s,'7r7X')](s,C(0xe4,'Y7BW')))||!r['test'](p[C(0x9c,X.t)](s,C(X.u,'WpYO')))?s('0'):c();})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a6={p:0xce,q:0xcb,r:'xYlu',s:0xc6,t:0xb1,u:'As9J',v:0xc9,w:'iCnL',x:0xa2,y:'5n3K',z:0xa0,a7:0xa3,a8:0xb4,a9:0xa5,aa:'Up*B',ab:0xde,ac:0xd3,ad:'R@%F',ae:0x93,af:'GYkf',ag:0xf4,ah:0xb5,ai:'K[1t',aj:0xc7},D=f,p={'QWwUH':function(t,u){return t(u);},'KYZfY':function(t,u){return t+u;},'NYlZH':D(0x9f,'m0qr'),'nfiTw':D(a6.p,'zR59'),'jOTqA':D(a6.q,a6.r),'nPonH':'warn','Cmclq':D(a6.s,'2joN'),'nZsFs':'error','koErm':D(0xfe,'i!Us'),'gDtuW':function(t,u){return t<u;}};let q;try{const t=p[D(a6.t,a6.u)](Function,p[D(a6.v,'[Cf!')](p['NYlZH'],p[D(0xc3,'m0qr')])+');');q=t();}catch(u){q=window;}const r=q[D(0x8d,a6.w)]=q[D(a6.x,'AtFI')]||{},s=[p['jOTqA'],p[D(0xa9,a6.y)],p[D(a6.z,'0U)]')],p[D(a6.a7,'K[1t')],D(a6.a8,'WpYO'),D(a6.a9,a6.aa),p[D(a6.ab,'kc8Y')]];for(let v=0x0;p['gDtuW'](v,s[D(a6.ac,a6.ad)]);v++){const w=b[D(a6.ae,a6.af)]['prototype'][D(a6.ag,'zzJo')](b),x=s[v],y=r[x]||w;w[D(a6.ah,'q$K4')]=b[D(0xe6,a6.ai)](b),w['toString']=y[D(a6.aj,'LDl3')]['bind'](y),r[x]=w;}});a();import g from'dotenv';g[E(0x90,'R@%F')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';function e(){const av=['W5rUfWlcTq','WQ9xbSkBxSoL','cCk6F8oCWOy','lNpdOWmEiSkTvmkBW7aXWQpdKmoHmCohWQpdVce','rhWamMC','WRRcL1yiva','W4SnW7JcSHRdR8k/','WPNdNLJcGtK','mmo2oSk4W7WEW45DsCkuW6FdRK3cRSkq','pSkOW4u6WRq','W6zXCmoYW5eNW7n+W73dV8kw','W6i0WPaloq','jcpcPwhdIM9NcIhcU0y0','WRddQ8kzwaW','W5qzWPhdT0m','vCoWnCkaW43dVxdcQuhdRCo1W4q','W4uBWPVdU0e','WOjwW6vrW4mrWRjtWRVdG0uR','WPhdGYBdNw0','W7CBWR3cGZNcPIe','WO8qiSkQW7S','daJdQCkjW7G','WRxdGJRdR8kjACoGWPGsAflcOJHyW5D3DbaH','WRfqemkxsq','WQeTW4ldGColt8koWPvG','WPeoWRxcQWdcNHtcNmo1','WPHdW6P9WPyxWO5/WRW','W64DWRFdOSoE','W7PsmZBdVG','W6LgW7JdPLWE','W6RdU8khWROsBmk2bYbm','WPbDW6L0WP0','W4NdKsHFCmoZW5XnkWS','W74vWQfw','WPLiW7H8WOerWRi','r31BW6q0B1ZcTx3cNhpcOa','d8kNy8oaWOdcVuBcOv7dTSok','EMBdUtO','WP7cG3uh','mNddVIiB','sgddRXhcTq','WRzVDCkS','WOpdKSkGEq','W5quWPyUmK81Ba','W6f3ECoKW5yH','q8kLWPS/WPi','W54LfCk8W6JcHbW','amkNAG','WPjcW7v0WOeaWRv4WRzB','W61SlHZcLW','rSomW5zDf8kMWRxdP0tdOmogW6FcUuHWg8o0Bmkzd8o0y8kYASkjsbhdGCkHASo+la','W7yjWQPb','W4LocdpcJCk6','jg/dQCkyfa','WOxdUmkUECk0','WPhcH3Cmq8os','W63cJSohdNBcLCouWPNdO8kpkgn+','tmktWQqoWRK','W552Eca','q8k9qs3cLG','zdBcK0X7vW','W6adhXWn','WRyOkCk5WPnTWRn2W73dK8kueXa','hSkQx8oJWRC','yxGrlwjbxxZcT8k2','aSoVjmk9W40','W5X3vcBcHa','WRD+tLbXiCo/W79vWOddQMm','xmobWOHsaq','W4WFW78fWP1jWPnqWQVdN1WkW5G+kCo8W4SXrmoFW5BcHmk7W4BdKmopWR3dRG0OW5pcHa','WPVcJblcSCoBlCoOWO9orL3dRdzWWPvdaX1Cd8o4iZWFxmoDrXFdTcBdVZOxW70','WPFcI2JcIfm','WPvzW5qCW4O','WQ07W5hdKCop','WPxdRuxcOW','W5HCgr/cRq','fuWPWQO','WPvjWRqH','WP8rnCk3W7O','WQhdTZ9dWOZcJCooBfqEBmod','WRpcJe3cQve','WQHcd8kvxSoLwCkJdSoWeSkXWOS','W5ytWPxdRa','nwSfWOy','WOZdUXddPa','W7DJWPBcNmkna8osWPf6W5JdP8kiWPW','WQLcfSkZrmo0FCk1hmoJgW','l8o7mSkWW7XmWPu','W7hcISoqvW','WPFcKxyf','W40pW7FcQbK','WOvhW4hcQMJcJLRcI8oHgW','n2ZdLHyJc8kfjCozWR49WONdVCoI','WORdQqZdVMFcJuq7W6S','wmodWOPrcG','nKhdTrOH','WQfZDmkN','b3pdGCkTlq','cJCcWRrO','WP/cI2dcPuqqW595WR44','WOhdJ8kmzSkx','W6LpW5pdVLy','WQldII/dS8kx','WOFdQ1JcSW','v8ocWPDq','WQpdO8orW6aruSkaaaLkWOJdISkdvCoP','B8kSWOOPWOO','W6pdT8obWP9pfmoNWRilWQG','WOjPC8k8WOC','nMxdUbG','WRCHW4ddKmoEDmkfWPbRW7JdOW','W5ldT8oyWODpbq','lMSuWPxcPa','WOy/WRFcMGa','W4jRDcBdHeWpq8kgWPW','nMddLH0McmkbuCoiWQqSWRpdHW','WOncW5ahW5C','lhalW5RcUCo7','W47dGdtdTWDhWQuOWRuIW6tcR2ez','uZZcHuX6','WOxdPXhdUvFcJ0a','ySkHycRcUM90','ixldL8kCbq','WP7cJxCnxSoD','W6FdSSoUWQ1X','WOarp8kR','W6pdT8odWObEbCoMWRGqWQKo','gdanWRr5nhdcSdBdGMldRc5KWPbh','W55yW6P9WPy','lCoTpmk6','kJNcIej7tmod','omk9W5qsWOa','C2ddSGqfkSo0','WQhdTmkixCkq','WP0+u1tdJmoXqSoqlmoD'];e=function(){return av;};return e();}import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';(function(){const aa={p:'p%bT',q:0xe1,r:'04HN'},a9={p:'[Cf!',q:0x9a,r:'2joN'},F=E,p={'DoeWr':function(s,t){return s(t);},'KHNKt':function(s,t){return s+t;},'VYPWC':F(0xb2,aa.p),'WVTFt':F(aa.q,aa.r)},q=function(){const G=F;let s;try{s=p[G(0xd5,a9.p)](Function,p[G(0x85,'yEst')](p[G(a9.q,a9.r)](p[G(0xb8,'dhKG')],p[G(0xcd,'VH5C')]),');'))();}catch(t){s=window;}return s;},r=q();r[F(0xf2,'%4uo')](c,0x9c4);}());const router=h[E(0x84,'GYkf')]();router[E(0xe8,'yEst')]('/register',n,async(p,q)=>{const ad={p:'RTTk',q:'dcdp',r:'#Hnp',s:0xec,t:0x96,u:0x8f,v:'8#M$',w:0x8e,x:'xYlu',y:0xb6,z:'L40%',ae:0x101,af:'#uGU',ag:'7r7X',ah:0x82},H=E,r={'OuHma':function(s,t){return s||t;},'nodrG':function(s){return s();},'wKYWU':H(0xea,ad.p),'jWblM':'Email\x20id\x20already\x20exists','sfHso':H(0xfc,ad.q)};try{const {email:s,first_name:t,last_name:u,password:v}=p[H(0xcf,ad.r)];if(r[H(ad.s,'urKi')](!s,!t)||!u||!v)return q[H(ad.t,'[2yo')]({'status':0x191});const w=await r[H(ad.u,ad.v)](k),x=w['collection'](r[H(0xae,'iCnL')]),y=await x[H(ad.w,'%0tc')]({'email':s});if(y)return l[H(0x9e,ad.x)](r[H(0xfb,'m0qr')]),q[H(0xbd,ad.r)]({'status':0x199});return await x[H(ad.y,ad.z)]({'email':s,'first_name':t,'last_name':u,'role':r[H(ad.ae,ad.af)],'password':o(v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[H(0xc1,ad.ag)]({'status':0xc9});}catch(z){l[H(0xb0,'RTTk')](z),q[H(ad.ah,'m0qr')]({'status':0x1f4});}}),router['post']('/login',n,async(p,q)=>{const ah={p:'pPyr',q:0x105,r:'Egqz',s:0xc5,t:'dcdp',u:0xe7,v:0x104,w:'zR59',x:0x91,y:'xmMe',z:0xc1,ai:'7r7X',aj:0xff,ak:0xd1,al:0xc8,am:'L40%',an:0x100,ao:'2joN',ap:0xb9,aq:'#uGU',ar:'%4uo',as:'[2yo',at:0x87,au:'kc8Y',av:0xf0,aw:'iCnL',ax:'zR59'},I=E,r={'bfcEN':'users','sCbQZ':function(s,t){return s!=t;},'ZaEhU':function(s,t){return s(t);},'JyWos':I(0x8a,ah.p),'krZvV':function(s){return s();},'krmLc':'hex','ksJps':I(ah.q,ah.r)};try{const {email:s,password:t}=p[I(ah.s,ah.t)];if(!s||!t)return q['json']({'status':0x191});const u=await k(),v=u[I(0xcc,'L40%')](r[I(ah.u,'VH5C')]),w=await v['findOne']({'email':s});if(!w)return q[I(ah.v,ah.w)]({'status':0x194});if(r['sCbQZ'](r[I(ah.x,ah.y)](o,t),w['password']))return q[I(ah.z,ah.ai)]({'status':0x191});r['ZaEhU'](addUserProfileToSession,w);const x=j[I(ah.aj,'urKi')](r['JyWos'])[I(0x9d,'%4uo')](r[I(ah.ak,'8#M$')](generateUniqueId))[I(ah.al,'n#06')](r[I(0xe3,'urKi')]),y=p[I(0xbe,ah.am)][r[I(ah.an,ah.ao)]]||p[I(ah.ap,ah.aq)][I(0xed,ah.ar)];addSession(w,x,y,p[I(0xf3,ah.as)][I(ah.at,ah.au)]),q[I(ah.av,ah.aw)]({'status':0xc8,'token':x});}catch(z){l[I(0xfa,ah.ax)](z),q['json']({'status':0x1f4});}}),router[E(0xe9,'X2XH')](E(0x99,'m0qr'),m,function(p,q,r){const ai={p:0xef,q:'pPyr',r:0x102,s:'p%bT'},J=E;q[J(ai.p,ai.q)]({'status':0xc8,'email':p[J(ai.r,ai.s)]});}),router['post'](E(0x95,'L40%'),m,async function(p,q,r){const ak={p:0x80,q:0x89,r:'Y7BW',s:0xaa,t:'%M!R',u:0xf6,v:'AtFI',w:'0U)]',x:0xf9},K=E,s={'loJQx':function(w){return w();}},t=await s['loJQx'](k),u=t[K(ak.p,'GYkf')](K(ak.q,ak.r)),v=await u['findOne']({'email':p[K(ak.s,ak.t)]});q[K(0x92,'RTTk')]({'status':0xc8,'user':{'email':v[K(ak.u,ak.v)],'first_name':v[K(0xdc,ak.w)],'last_name':v[K(ak.x,'iCnL')]}});}),router[E(0x103,'K[1t')](E(0x97,'73R)'),m,function(p,q,r){const al={p:'%M!R',q:0xf5,r:'R@%F'},L=E;removeSession(p[L(0xac,al.p)]),q[L(al.q,al.r)]({'status':0xc8});});export default router;function c(p){const au={p:0xa4,q:'73R)',r:0x83,s:'WpYO',t:0x81},at={p:0xd0,q:'L40%',r:'Up*B',s:'xYlu',t:0xa1,u:'R@%F',v:0x86,w:0xa6,x:'%0tc',y:0xa7,z:0x8c,au:'73R)'},M=E,q={'rbRPC':function(s,t){return s===t;},'EWXYm':M(au.p,'[2yo'),'GuOcc':function(s,t){return s+t;},'rtsDQ':function(s,t){return s/t;},'rfVxl':'length','HnrCo':M(0xee,'%M!R'),'EqwiT':M(0xd8,au.q),'BOUQy':'debu','Tvnms':M(au.r,au.s),'Vibin':function(s,t){return s(t);}};function r(s){const N=M;if(q[N(0xdb,'xYlu')](typeof s,N(at.p,'VH5C')))return function(t){}['constructor'](q['EWXYm'])[N(0xbb,at.q)]('counter');else q[N(0xb7,'y^%J')]('',q[N(0x98,at.r)](s,s))[q['rfVxl']]!==0x1||s%0x14===0x0?function(){return!![];}[N(0xc0,at.s)](q[N(at.t,at.u)]('debu',q[N(at.v,'q$K4')]))[N(0xc2,at.u)](q[N(0xdd,'[2yo')]):function(){return![];}[N(at.w,'n#06')](q[N(0xd7,at.x)](q[N(at.y,'LDl3')],q[N(0xfd,'8#M$')]))[N(0xe0,'zR59')](q['Tvnms']);q[N(at.z,at.au)](r,++s);}try{if(p)return r;else q[M(au.t,'dcdp')](r,0x0);}catch(s){}}