import{r as s,R as a,j as t}from"./CbKKHx2O.js";import{H as r}from"./BxSZibWh.js";import{R as l}from"./DfG9QjQz.js";import{F as i,Z as n}from"./CIhhzLoR.js";import{b as o,e as c}from"./C4IweS36.js";import{k as d,d as p}from"./CXjkhZnE.js";import{d as m,b as u,c as j,T as h,Q as x,R as f,a9 as b,aa as g,ab as v,ac as y,ad as w,ae as N,a as S,U as k,e as D,f as F,g as z,h as O}from"./C-SwLysj.js";import"./D9QqU1Un.js";import"./z-cSZRUs.js";import"./Bnu3OxD9.js";import"./BnBwkiYC.js";import"./0NUvlLuB.js";import"./vr9ZyHRf.js";import"./DylAs1sT.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BKrKJ3DW.js";import"./BFk34ZWe.js";import"./U6rf_yqH.js";import"./D68gzNyG.js";import"./6thM_Rat.js";import"./BsZLDNo0.js";import"./CAJYX4M0.js";import"./Bhaa8ZPc.js";import"./K-dupnmX.js";import"./B7alYAEp.js";import"./DP3P1EsK.js";import"./C3hrCPXF.js";import"./Dw0KO6EP.js";import"./CzGuHLZU.js";import"./B8Let_61.js";import"./CPqRiR-E.js";import"./fZjk1EK6.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./CTpwok2W.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const T=()=>{const{id:T}=d(),$=p(),[C,_]=s.useState(!0),{addToast:P}=o(),R=a.useRef(),[A,U]=s.useState(null),[M,X]=s.useState(null),[q,B]=s.useState(null),[E,H]=s.useState(!1),[L,Q]=s.useState(null);return s.useEffect((()=>{(async()=>{axios.get(`/documents/${T}`).then((e=>U(e.data.documents))).finally((()=>_(!1)))})()}),[]),C?t.jsx("div",{className:"loading-overlay",children:t.jsx(m,{color:"primary",variant:"grow"})}):A?t.jsxs(t.Fragment,{children:[t.jsx(r,{children:t.jsxs("title",{children:[T," - Documents | Axleshift"]})}),t.jsxs(h,{onSubmit:async e=>{e.preventDefault();const s=await R.current.executeAsync();_(!0);const a=new FormData;a.append("exportLicense",M),a.append("certificateOfOrigin",q),a.append("recaptcha_ref",s),axios.post(`/documents/${T}/upload`,a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{U(e.data.data),P("Documents uploaded successfully!","success")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);P(t,"danger")})).finally((()=>_(!1)))},children:[t.jsx("h2",{children:"Upload Documents"}),t.jsx("span",{className:"text-muted",children:T}),t.jsx(x,{className:"mt-2 mb-3",children:t.jsxs(f,{children:[t.jsxs(b,{stripedColumns:!0,hover:!0,responsive:!0,className:"table-even-width",children:[t.jsx(g,{children:t.jsxs(v,{children:[t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Document Name"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Type"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),t.jsx(y,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Upload"})]})}),t.jsx(w,{children:A.map(((s,a)=>t.jsx(t.Fragment,{children:"not_applicable"!==s.status&&t.jsxs(v,{children:[t.jsxs(N,{children:[t.jsx("span",{className:"d-block",children:s.name}),s.file&&t.jsxs(S,{color:"primary",size:"sm",variant:"ghost",onClick:e=>((e,s)=>{if(/bill-of-lading-AX-[0-9]/.test(s))return $(`/documents/${e}/bill-of-lading`);H(!0),axios.post(`/documents/file/${e}`,{file:s}).then((e=>{if(e.data.error)return P(e.data.error);Q(e.data)})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);P(t)})).finally((()=>_(!1)))})(T,s.file.file),children:[t.jsx(i,{icon:n,className:"me-1"})," ","Open File"]})]}),t.jsx(N,{children:s.type}),t.jsx(N,{className:"text-capitalize",children:t.jsx("span",{className:"badge bg-"+(["approved","generated"].includes(s.status)?"success":"rejected"===s.status?"danger":"warning"),children:s.status.replace("_"," ")})}),t.jsx(N,{children:s.file&&"rejected"!==s.status?s.file.file:t.jsxs(t.Fragment,{children:[t.jsx(k,{type:"file",accept:".docx,.pdf",onChange:s=>((s,a)=>{const t=s.target.files[0];if(t&&t.size>26214400)return P("File size exceeds 25MB limit. Please upload a smaller file."),void(e.target.value=null);if(t){const e=[...A];e[a]={...e[a],status:"under_review"},U(e),0===a&&X(t),1===a&&B(t)}})(s,a),disabled:["approved","not_applicable"].includes(s.status)}),s.file&&t.jsx("span",{className:"text-danger text-decoration-line-through",children:s.file.file})]})})]},a)})))})]}),t.jsxs("span",{className:"d-block mb-2 small",children:["Please ensure that the documents you upload are accurate and comply with all applicable laws and regulations.",t.jsx("br",{}),"Submitting false or fraudulent documents may result in legal consequences."]}),t.jsx(S,{color:"primary",type:"submit",disabled:!M&&!q,children:"Submit Documents"}),t.jsx(l,{ref:R,size:"invisible",sitekey:c})]})})]}),t.jsxs(D,{alignment:"center",scrollable:!0,fullscreen:"sm",visible:E,onClose:()=>H(!1),"aria-labelledby":"M",children:[t.jsx(F,{children:t.jsx(z,{children:null==L?void 0:L.file})}),t.jsx(O,{children:"docx"===(null==L?void 0:L.fileFormat)?t.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${null==L?void 0:L.url}`,style:{width:"100%",height:"400px",border:"none"}}):t.jsx("iframe",{src:null==L?void 0:L.url,style:{width:"100%",height:"400px",border:"none"},title:"Document Preview"})})]})]}):t.jsx(u,{className:"justify-content-center my-5",children:t.jsx(j,{md:6,children:t.jsxs("div",{className:"clearfix",children:[t.jsx("h1",{className:"float-start display-3 me-4 text-danger",children:"OOPS"}),t.jsx("h4",{children:"There was no shipment documents found."}),t.jsx("p",{children:"Double check tracking number for any mistake."})]})})})};export{T as default};
