const H=f;(function(p,q){const P={p:0x179,q:0x108,r:'epCp',s:0x166,t:'2F%0',u:'oB%1',v:0x12b,w:'r#1&',x:'Izne'},A=f,r=p();while(!![]){try{const s=parseInt(A(P.p,']g[^'))/0x1*(-parseInt(A(P.q,'r#1&'))/0x2)+-parseInt(A(0x117,'[SB6'))/0x3+-parseInt(A(0x15a,P.r))/0x4+-parseInt(A(P.s,'76gF'))/0x5*(-parseInt(A(0x110,'jk#H'))/0x6)+parseInt(A(0x16e,'XK1j'))/0x7+-parseInt(A(0x14f,P.t))/0x8*(-parseInt(A(0x172,P.u))/0x9)+-parseInt(A(P.v,P.w))/0xa*(parseInt(A(0x18c,P.x))/0xb);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x6b7f1));function e(){const aB=['dwfQW6WLc3zVq8oh','hvtdP3e','xMRdMa1X','eCouW4q6rq','xGldMCkIWQG','rgr4ha','AmkOcSk4FH8Kyq','WOxdRSk3W73cSW','eGBcU8oGba','W77cVSoyWRRdIa','WPZcNahdTW','FXOXWQ0/','WRXLntBcKty','WRtdHdHy','tqmJWPq9','WPOwW7vndG','b8oTns8','j1RdSti','WRm6tSk7W6S','CCkaWO5WEG1VWPmznH3dLeXnl8kECCozWQKgruLxWO40zmoWo8kbW4SQW64','wWtdQmkC','cSkOWOrrWR8','rxZdSrb2','WOJdQSkpkmkQ','hb47W6Cf','j3NcHCoPW48','WRHWtmooDmo5W5VdUtO8W71JWPZcG8ooW5j1Ahm','rwPWcq','W7RcPSkOucH+dCkvgmoZ','fWqoW4q','h8kMWOZcLN4','thT5WO0aWOxcTSofACowe2dcG8kItSkGe8oOWR/cUCkqWRlcHW','WOqHWQFcPwpcH0C','W7PgW6H8W7PXvG','bIm7wXLZWRxcPmkRkry','lqC5zsO','lSoWsmo9puLGFCoKxLLFW54','W6BcOmkUECoPW6zA','xatdR8kHWOHDWPTEWO/cRIG','WO1UWRFdTmoCWOO','BCo9WQZdLwyX','hqdcOSo1mmklW7xcJCoxWQS','df7dICokbr/dLue5','WPDJtSoSoa','crGYW54WWOlcR8oa','W77cT8kGACoJW6bqoSoI','ev/dQCoBbqldTeG','wSkTWQBdPJRcUf7dGYv5W6P+WOS','WO1ZWRZdS8obWOHCeMK3','gCk7WPlcLwLBzG3cQ8ok','d8k/W7L6W78/','DSoqWRddK2q','actdN8oQ','fCo3W70hBmo6Fa/dO8oU','mI8WW4WX','WRddHX5+ra','mCouW4FcPMi','ta7dTCkBWPjBWOTpWO3cOdy','fYK4rXLKWOhcO8k7nahdTda','CmowCZ88jt3cGKabWQqA','a1NdImoCaZtdTe4XW6W','W7roW4ddVmo/','jCklWO7cI2nmFtVcMW','W4xdNSothq','WR50wSoxyW','W6nInZZcKq','W7RcKmoxWOxdJq','gLJcQSoqW5aBW4HIWRBcUGxcQCoU','AhvSWO0dW4S','DaVcQbaWkmkKW58W','q8kSW5OYrCo3FaC','rdK5W502WOlcHG','W5ddICoddmoZatvnbW','cmk5W6TXW7GUWPG','WQj5ySoEtq','cCkGWP/cJwL3Ca7cOCohgG','fmkKWRFcSwC','WOrYWRBdVa','u8kLWOvdWRa8kq','WPdcHGddVxFdT0K','W7ZcOmk7Amo+W7OjySoHW51ky0JdUmoOeCkyWPZdHW','bL/dLmoCgaFdVW','geJdSxFdIW','WRztW77cMx8','cv7dTNa','DKldHJbY','rMhdRGS','BhT5WO0a','sHpdQCkhWPq','imoiW6erFq','gmk9WPdcNq','i8okW58prW','vf9NW67cJq','W4hcR8oeWO/cQwRdPr3dSmod','W6dcT8kADCod','bGPpW4KTWOxcSSotAhDJumkhW4nCWPtcHKNdRmoVWRf7hMyGW6OzoCoyW7NdVta','WOzlW5BcQ3i','rSk6Cr1Qvmk/nua','CaRcRM52BmoCW5m2x8o0fCks','WODVWRddPG','WQOOA8ktW4y','dMnIW6vesKrCwSoEtLK','rNdcNCkNWP50A8klWPmQdCoP','WQ7dP8oJdWm','WPVdKSoByW','btrGrmkw','fHSBEIG','WRldKJLrw8oa','W6uvWRxcGwa','WRVdSCkermoaW7PDkW','CSoqW4z8zXr9WPupjHRcJuvqDq','beddISoddG','ESksW5nN','kISsEdq','W7z7kd7cIG','WRpdOtjoqa','W7i+WOq/WR0HiCkmiCorv0XM','c8kNWPzdWQG','WR/dLmo9fIC','Axbypbm','y2v3WOO','WO3dPCkVW7lcMq','W5eIgCkVE8oYt8ovW4tdHCoDWQeu','nLRcQmoIW7G','W5FdMmoodq','WPGcW7Dcba','WRP6s8op','jN/dHhHw','WR7dPSo0eGi','W5PWkb7cIG','W4tcRSkfACoP','dmkXW7TT','etWLrMdcTfeJm8kFyhZdNa','WQX8vSoFsCo5WP4','WRFcNttdJ3a','ANL2WPCyW5FcQSocpCoydq'];e=function(){return aB;};return e();}const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Y={p:'N$DV',q:0x119,r:'M4Sy',s:0x151,t:'XK1j'},X={p:0x132,q:'*&7B',r:0x180},B=f,p={'qnPzc':function(s,t){return s(t);},'UKSsR':function(s,t){return s+t;},'zpUtv':B(0x145,'vwW9'),'ZPGUp':B(0x13e,Y.p),'tAlvV':function(s){return s();}},q=function(){const C=B;let s;try{s=p[C(X.p,'w7As')](Function,p[C(0x122,'F3ff')](p[C(0x142,X.q)],p[C(X.r,'l*SZ')])+');')();}catch(t){s=window;}return s;},r=p[B(Y.q,Y.r)](q);r[B(Y.s,Y.t)](c,0x9c4);}()),(function(){const a3={p:0x11e,q:'Qhq[',r:'l*SZ'},a2={p:0x144,q:']g[^',r:0x106,s:'[p3t',t:'XK1j',u:0x107,v:0x15f,w:'z&9r'},D=f,p={'rKLbY':'function\x20*\x5c(\x20*\x5c)','lYwjx':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','UuDDJ':function(q,r){return q(r);},'dXNsJ':function(q,r){return q+r;},'xbUDT':D(a3.p,a3.q),'NuLLG':D(0x141,a3.r),'vtMxS':function(q){return q();}};d(this,function(){const E=D,q=new RegExp(p[E(a2.p,'Qhq[')]),r=new RegExp(p[E(0x140,a2.q)],'i'),s=p['UuDDJ'](c,E(a2.r,a2.s));!q[E(0x13f,a2.t)](p['dXNsJ'](s,p[E(a2.u,'^fyA')]))||!r[E(a2.v,'P&KT')](s+p[E(0x11a,a2.w)])?s('0'):p['vtMxS'](c);})();}());const b=(function(){let p=!![];return function(q,r){const a4={p:'9%8R'},s=p?function(){const F=f;if(r){const t=r[F(0x112,a4.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ac={p:'jk#H',q:'Tp(X',r:0x186,s:0x17e,t:0x189,u:0x17c,v:'9%8R',w:0x187,x:'!TzT',y:0x163,z:'AK#&',ad:0x10e,ae:0x158,af:0x185,ag:0x169,ah:'^[$D',ai:0x13c,aj:0x159,ak:'9%8R',al:0x157,am:'oB%1',an:0x11f,ao:'Tp(X'},G=f,p={'yGLXK':function(t,u){return t(u);},'URNdN':function(t,u){return t+u;},'nrUhO':G(0x17b,ac.p),'yqJZd':function(t){return t();},'VPpzt':'log','IyrOr':G(0x10b,'2N3u'),'NBwVj':G(0x115,'pq7j'),'ztkts':G(0x173,ac.q),'BqFtr':G(0x16b,'vwW9'),'XKSqh':'trace','gLUQL':function(t,u){return t<u;}};let q;try{const t=p['yGLXK'](Function,p[G(ac.r,'AK#&')](p[G(ac.s,'cx4w')](p[G(ac.t,ac.p)],G(0x18a,'oB%1')),');'));q=p['yqJZd'](t);}catch(u){q=window;}const r=q[G(ac.u,ac.v)]=q[G(0x17c,ac.v)]||{},s=[p[G(0x184,'AK#&')],'warn',p[G(0x124,'pq7j')],p[G(0x10f,'3kSX')],p['ztkts'],p[G(ac.w,ac.x)],p[G(ac.y,'epCp')]];for(let v=0x0;p[G(0x12e,ac.z)](v,s[G(ac.ad,'E#1J')]);v++){const w=b[G(0x12a,'^zrz')][G(ac.ae,'jk#H')][G(ac.af,'^[$D')](b),x=s[v],y=r[x]||w;w[G(ac.ag,ac.ah)]=b[G(ac.ai,'XC$%')](b),w[G(ac.aj,ac.ak)]=y[G(ac.al,ac.am)][G(ac.an,ac.ao)](y),r[x]=w;}});a();import g from'dotenv';g[H(0x152,'[p3t')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x105;let h=c[d];if(f['eFYSjQ']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['sacVHU']=m,a=arguments,f['eFYSjQ']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['rfbnVz']===undefined&&(f['rfbnVz']=!![]),h=f['sacVHU'](h,g),a[k]=h):h=l,h;},f(a,b);}import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h['Router']();router[H(0x121,'vwW9')]('/register',n,async(p,q)=>{const af={p:'F@Pm',q:0x14a,r:0x10d,s:')4*V',t:0x181,u:'l*SZ',v:0x155,w:'#QEe',x:')phO',y:0x183,z:'XK1j'},I=H,r={'yriVH':function(s){return s();},'sWNRE':I(0x156,af.p),'HKlMG':I(af.q,'^zrz'),'hYnol':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p['body'];if(!s||!t||!u||!v)return q['json']({'status':0x191});const w=await r['yriVH'](k),x=w[I(0x154,'%#Jb')](r[I(af.r,')4*V')]),y=await x[I(0x17a,')phO')]({'email':s});if(y)return l[I(0x149,'^[$D')](r[I(0x14e,af.s)]),q[I(af.t,af.u)]({'status':0x199});return await x[I(af.v,'9%8R')]({'email':s,'first_name':t,'last_name':u,'role':'user','password':r[I(0x15e,af.w)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[I(0x135,af.x)]({'status':0xc9});}catch(z){l[I(af.y,af.z)](z),q[I(0x135,')phO')]({'status':0x1f4});}}),router[H(0x13b,'Izne')](H(0x137,'pq7j'),n,async(p,q)=>{const am={p:0x17d,q:0x111,r:'N$DV',s:0x188,t:'4Plp',u:0x160,v:'pq7j',w:0x10c,x:'ld#$',y:0x125,z:0x131,an:'2F%0',ao:0x15b,ap:'[p3t',aq:0x143,ar:0x165,as:0x16d,at:0x150,au:'jk#H',av:'E#1J'},J=H,r={'eJfVC':function(s,t){return s||t;},'pFGwd':function(s){return s();},'pkmmi':J(am.p,'BabN'),'WoSfQ':function(s,t){return s!=t;},'JkJte':function(s,t){return s(t);},'JbyGL':function(s){return s();},'aiZMG':J(am.q,am.r),'NLvxI':function(s,t,u,v,w){return s(t,u,v,w);},'rRExn':J(am.s,'TwLG')};try{const {email:s,password:t}=p[J(0x146,'z&9r')];if(r[J(0x18b,'cx4w')](!s,!t))return q['json']({'status':0x191});const u=await r[J(0x120,am.t)](k),v=u[J(am.u,'AK#&')](r[J(0x16c,am.v)]),w=await v['findOne']({'email':s});if(!w)return q['json']({'status':0x194});if(r[J(am.w,am.x)](r[J(am.y,'jk#H')](o,t),w[J(am.z,am.an)]))return q['json']({'status':0x191});addUserProfileToSession(w);const x=j[J(am.ao,am.ap)]('sha256')['update'](r[J(0x134,'TwLG')](generateUniqueId))[J(0x15d,'!s&]')]('hex'),y=p['headers'][r[J(am.aq,'oB%1')]]||p['socket'][J(am.ar,')4*V')];r[J(am.as,'TwLG')](addSession,w,x,y,p[J(am.at,am.au)][r[J(0x13a,'4Plp')]]),q['json']({'status':0xc8,'token':x});}catch(z){l[J(0x10a,'M4Sy')](z),q[J(0x138,am.av)]({'status':0x1f4});}}),router[H(0x16a,'Tp(X')](H(0x14b,'3kSX'),m,function(p,q,r){const an={p:'oB%1',q:0x168},K=H;q[K(0x148,an.p)]({'status':0xc8,'email':p[K(an.q,'wC70')]});}),router[H(0x113,'N$DV')]('/user',m,async function(p,q,r){const ao={p:0x15c,q:0x11c,r:0x128,s:0x182,t:'^zrz',u:'[p3t',v:'9%8R'},L=H,s={'yeHuI':L(0x123,'M4Sy')},t=await k(),u=t[L(ao.p,'^[$D')](s[L(ao.q,'w7As')]),v=await u[L(ao.r,'vwW9')]({'email':p[L(ao.s,ao.t)]});q[L(0x178,ao.u)]({'status':0xc8,'user':{'email':v['email'],'first_name':v[L(0x167,ao.v)],'last_name':v['last_name']}});}),router[H(0x12c,'BabN')]('/logout',m,function(p,q,r){const aq={p:0x11b,q:'^zrz'},M=H,s={'hlZeK':function(t,u){return t(u);}};s[M(0x175,'vwW9')](removeSession,p['token']),q[M(aq.p,aq.q)]({'status':0xc8});});export default router;function c(p){const aA={p:0x174,q:0x17f,r:'^zrz',s:'%#Jb'},az={p:0x129,q:'r#1&',r:0x14d,s:')4*V',t:'^fyA',u:0x114,v:0x116,w:'XK1j',x:0x118,y:0x126,z:'!s&]'},N=H,q={'ArZVH':function(s,t){return s===t;},'qQpHA':N(0x153,'#QEe'),'xpktq':'while\x20(true)\x20{}','OgGPY':N(aA.p,'!s&]'),'mVexo':function(s,t){return s+t;},'qcBJN':function(s,t){return s===t;},'CHbqC':function(s,t){return s%t;},'npIHk':N(aA.q,'BabN'),'OXQfs':'gger','zFvTY':N(0x16f,aA.r),'rxYhs':N(0x176,'^[$D'),'liuyQ':function(s,t){return s(t);}};function r(s){const O=N;if(q[O(az.p,')phO')](typeof s,q[O(0x139,az.q)]))return function(t){}[O(az.r,az.s)](q['xpktq'])[O(0x13d,az.t)](q[O(az.u,')4*V')]);else q[O(az.v,'E#1J')]('',s/s)['length']!==0x1||q[O(0x12f,az.w)](q[O(0x136,'r#1&')](s,0x14),0x0)?function(){return!![];}['constructor'](q['mVexo'](q[O(0x162,'E#1J')],q[O(0x161,'oB%1')]))[O(0x130,'z&9r')](q['zFvTY']):function(){return![];}[O(0x164,'XK1j')](q[O(az.x,']g[^')](q[O(0x177,'^[$D')],O(az.y,az.z)))['apply'](q[O(0x12d,'l*SZ')]);r(++s);}try{if(p)return r;else q[N(0x133,aA.s)](r,0x0);}catch(s){}}