(function(j,k){const G={j:0x1c3,k:'zVoi',l:0x19f,m:0x1f5,n:'4zjy',o:'B%8[',p:0x1e2,q:'2%kQ',r:'*r%e',H:'yEbw',I:'L3ye'},s=f,l=j();while(!![]){try{const m=parseInt(s(0x1d0,'x4ei'))/0x1*(-parseInt(s(G.j,G.k))/0x2)+-parseInt(s(G.l,'*r%e'))/0x3*(parseInt(s(0x1a9,'oD%A'))/0x4)+parseInt(s(G.m,G.n))/0x5+-parseInt(s(0x1a2,'&]*N'))/0x6+-parseInt(s(0x1a5,G.o))/0x7+-parseInt(s(G.p,G.q))/0x8*(-parseInt(s(0x1e4,G.r))/0x9)+parseInt(s(0x208,G.H))/0xa*(parseInt(s(0x206,G.I))/0xb);if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0x55cd5));const d=(function(){const H={j:'X[lx'};let j=!![];return function(k,l){const m=j?function(){const t=f;if(l){const n=l[t(0x200,H.j)](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const R={j:'h^#T',k:0x1f8,l:'!RO)'},Q={j:0x1c7,k:'xeEw',l:0x1cb,m:'HP4u',n:0x1ed,o:0x1ec},u=f,j={'LLQav':u(0x1ae,R.j),'zWwVX':function(k,l){return k(l);},'qWFph':function(k,l){return k+l;},'XRRAz':u(R.k,R.l),'LJJeF':function(k,l){return k+l;},'YCmKh':function(k){return k();},'nQBKq':function(k,l,m){return k(l,m);}};j['nQBKq'](d,this,function(){const v=u,k=new RegExp(v(Q.j,Q.k)),l=new RegExp(j[v(Q.l,'IGY3')],'i'),m=j['zWwVX'](c,v(0x1ab,'HBae'));!k['test'](j['qWFph'](m,j['XRRAz']))||!l[v(0x1db,Q.m)](j['LJJeF'](m,v(0x1b8,'*r%e')))?j[v(Q.n,'!RO)')](m,'0'):j[v(Q.o,'HBae')](c);})();}());const b=(function(){let j=!![];return function(k,l){const S={j:0x1ca},m=j?function(){const w=f;if(l){const n=l[w(S.j,'BSR2')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const a0={j:0x1dc,k:'bNM&',l:'%29k',m:0x204,n:'&KuF',o:0x1a6,p:'Fnvn',q:'2%kQ',r:'u%bX',a1:0x1b7,a2:0x1ee,a3:'Fnvn',a4:'xgf(',a5:'oD%A',a6:'jTm]'},Z={j:'jTm]'},x=f,j={'UkfrB':function(o,p){return o(p);},'BgHkd':function(o,p){return o+p;},'drTUG':'{}.constructor(\x22return\x20this\x22)(\x20)','znAFw':function(o){return o();},'YdpQO':'log','ALqXg':x(0x209,'erZ1'),'tSkJb':'error','iXiWf':x(a0.j,a0.k),'stXes':x(0x1fe,'Nj2i')},k=function(){const y=x;let o;try{o=j[y(0x1e5,Z.j)](Function,j[y(0x19e,'L3ye')](y(0x1e1,'zVoi'),j['drTUG'])+');')();}catch(p){o=window;}return o;},l=j[x(0x1f4,a0.l)](k),m=l['console']=l[x(0x201,'Ct[M')]||{},n=[j[x(a0.m,a0.n)],'warn',j['ALqXg'],j[x(a0.o,a0.p)],j[x(0x1b2,a0.q)],'table',j[x(0x1d3,'Q5Lq')]];for(let o=0x0;o<n[x(0x1e6,a0.r)];o++){const p=b[x(a0.a1,'yEbw')][x(a0.a2,a0.a3)]['bind'](b),q=n[o],r=m[q]||p;p[x(0x1ea,a0.a4)]=b['bind'](b),p[x(0x20c,a0.a5)]=r[x(0x1b9,'!RO)')][x(0x1a7,a0.a6)](r),m[q]=p;}});a();import g from'fs';import{ObjectId}from'mongodb';function e(){const ar=['W4ldLSkdW6tdMH4','mmoZEtSjyNFdSJHbW4i','W5BdQSoBW406gCoaWPpdNaJcU8k3W7lcLeeRf2lcHdXZWQ3dLNtdJmoJtSkTWPJdJmk3j8oFWPG','ba8iWPxcSa','lsJdMgO+','WRnJxajS','WQZdJ8k8cZm','DSkRW6NcUmkR','thpcLmkDAY7cTCkehSkNj0tcHSonoCouq8k+W5O','W7NcNtrPW7y','WRKOWQ9iWOW','fdCAemossCktWPRdRSkVW6K','W7ZcP3i/W7q','zsJdImk3W58+FL0','aSkaWRNdHqi','WQ3cP8ko','lxeskahdQq','nSkTd0zUDua','WROtWQhdLCkb','WRZdQ3qIWRCboCoEW4lcJ8kjqX8','W7tcQNyJW7zQ','W6PBW54lW6y','mIicmWfRW5/dOIFdIq','WPBcPCkkW7xdUCogAt/dTHxcRHFcRq','WQ4MWPn2WPa','W6tcRSoW','W4ldH8kcW77dNrBdN2a','WPCIWOBdP8kCWRrdD8k0euqQyCodeSoy','W7zxW4vgWRJcGmkWW47dTa','W6ZcOJ1/W70','W4afrsj5','sCkggM1l','W7/cSCoJWODUvSkNW4lcGW','aSoAW4VdVKm','W48RWQldIIWDW5xcSqXRmLvk','hSoFW43dMwW','F8opq8oTA8k5yG','WQuvWO9FWO8','bCoVd8k2WPhdL8k6dxhdQdK7ENpcIW','bJBdTfO6','ASoKW4eVcCkpWOi','w8o6WQWxW4NdLa','CSoJWQZcHCkM','kdeq','nsiHoSo/','ySkbW7dcNCk0','xmoSW7VcTHbaW7ucCuHF','WOrCW5hdSW','W5BdLmkZWOtcSCkBah7dQa','uSoSWQG/','w2beWP/dN8obhSk8oG','W4BcLGrcW60','nmkyBJlcJCo1qgfa','W5xdSSogWRxcU8krEuFdTdNcTHhcV8ogWPxcUCoIW6eL','W7pcP8oTkHb8W6LCAq','W65XW78DW5lcRKO','WQddSdb9WRrCW7aqWRxcQGO','a8kAfSkUWQS','xSoKaSo9W7ZdGW','gmk1cSkYWO8','yrugW77dUu7dIfbRWOeC','k2ldTGu/sCoDW4JcJK0','W67dVCkbW7/dMW3dNKXR','fcddV0ym','ffFcONJcQW','AXddRmkvW7u','kmklCJlcVCoVwhXa','WQxcOCkxW6ZcQx3dVG','W5buDCoExmokW7DaBLO','aJhdNKu6','s8oYWQRcSmks','W6LTW7yk','W4Lvwmo0tG','eSkBvCo+W7TGW53cMwLhoq','BCoOca','WR/dOGTKW51Mwmoq','CI/dUSkQW4m','zCk2W7lcGSkd','j8oyD8oWymkzxCoZzq','k8kCBJxcU8o0t38','FYJdRa','W6dcPXrPW4O','sMtcGCklFa','p8oZrCoqua','WP9PW6RcK2u','vSoKWQm+WOuouG','CSkaW6FcGmk1','gtBdTvW8','WQxcGsCsBq','jX7cO8kdWQtdU1/dVmo/ba','WRZdONWKWRihoCkXW63cLCk7vqLs','WPC+WOBdOmkNWRnj','rwGYfmo/Amk/WQ8','ncHwWQG','WOXbW7NdKSkTWPhdQ8k7W7LB','jCoYj8k4WOC','nxSVoWFdQmk9uW','iCkbW7lcT8k/FhS','W4/cTqv4W6a','WQBcRKyaW5nlW4C','c8kwrqpcHa','W5ldJ8kKWOJcT8kk','eNGaBgmNWQxdNMJcM8kkWPCa','k8oeDSo6ya','rSk9o3zU','DuldV8oFW7NcQrZdM8oOiZBdTmkG','lmkQDGZcSa','nmkyhSk4','WOnCW5hdTeRcJ8kgWQK','Cc1fFKBcTCoRBmkLWPxcVCo+uq','mIialbb6W57dQdZdImoB','jhRcPKC'];e=function(){return ar;};return e();}import h from'../models/db.js';import i from'./logger.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x19e;let h=c[d];if(f['gfCCNQ']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['Bompcn']=m,a=arguments,f['gfCCNQ']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['zLEDwO']===undefined&&(f['zLEDwO']=!![]),h=f['Bompcn'](h,g),a[k]=h):h=l,h;},f(a,b);}export const addSession=async(j,k,l,m)=>{const a2={j:0x1fb,k:0x1f6,l:'!RO)'},z=f,n={'Xdcjr':function(o){return o();},'CwpzS':z(a2.j,'Fnvn')};try{const o=await n['Xdcjr'](h);o['collection'](n[z(0x1a4,'IGY3')])[z(0x1fa,'x4ei')]({'user_id':j[z(a2.k,'u%bX')],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[z(0x1fc,a2.l)]()});}catch(p){i[z(0x1d9,'YbiG')](p);}};export const getUser=async j=>{const a4={j:'HP4u',k:0x205,l:'B%8[',m:'&plH',n:0x207,o:'xeEw',p:'%29k',q:'YbiG',r:'5U]d',a5:0x1e3,a6:0x1d7,a7:'yEbw',a8:0x1cd,a9:0x1e0,aa:0x1f3,ab:'AO9%',ac:'2[ph'},A=f,k={'XavYM':function(l){return l();},'zAgIv':A(0x1a8,a4.j)};try{const l=await k[A(0x1f2,'!FmP')](h),m=await l[A(a4.k,a4.l)](k[A(0x1af,a4.m)])[A(a4.n,a4.o)]({'token':j});if(!m)return null;const n=await l[A(0x1f0,a4.p)](A(0x202,a4.q))[A(0x1d4,a4.r)]({'_id':m[A(a4.a5,'AO9%')]});return{'_id':n[A(a4.a6,a4.a7)],'email':n[A(a4.a8,'N%jU')],'first_name':n['first_name'],'last_name':n[A(a4.a9,'Fnvn')],'role':n[A(a4.aa,a4.ab)],'email_verify_at':n['email_verify_at']};}catch(o){i[A(0x1ba,a4.ac)](o);}return null;};export const removeSession=async j=>{const a6={j:0x1c6,k:'xgf(',l:0x1f9,m:0x1c2,n:'x4ei',o:0x1cc,p:'h^#T',q:0x1c5},B=f,k={'bEppE':function(l){return l();},'qEAEB':B(a6.j,a6.k)};try{const l=await k[B(a6.l,'YbiG')](h);await l[B(a6.m,'gak1')](k[B(0x1ff,a6.n)])[B(a6.o,a6.p)]({'token':j},{'$set':{'active':![],'last_accessed':Date[B(a6.q,'h^#T')]()}});}catch(m){i[B(0x1a3,'x4ei')](m);}};(function(){const ab={j:0x1b4,k:'jTm]',l:'N%jU'},C=f,j={'qwzps':function(l,m){return l(m);},'qYDdk':function(l,m){return l+m;},'NDznf':function(l,m){return l+m;},'wEPdz':C(ab.j,'Nj2i'),'yhgNC':function(l){return l();}};let k;try{const l=j['qwzps'](Function,j[C(0x1c1,'AO9%')](j[C(0x1e7,ab.k)](j['wEPdz'],'{}.constructor(\x22return\x20this\x22)(\x20)'),');'));k=j[C(0x1cf,ab.l)](l);}catch(m){k=window;}k['setInterval'](c,0x9c4);}());export const isActiveToken=async j=>{const ad={j:'xeEw',k:0x1a1,l:'bNM&',m:'%d#[',n:'L3ye',o:0x1bb,p:']^U4',q:'*r%e'},D=f,k={'SoXEV':function(l){return l();},'KDIQi':'sessions'};try{const l=await k[D(0x1a0,'Fnvn')](h),m=await l[D(0x20a,'R)l)')](k[D(0x1be,ad.j)])[D(0x1ef,']^U4')]({'token':j});if(m[D(ad.k,ad.l)])l[D(0x1e9,ad.m)](k[D(0x1df,ad.n)])[D(0x1de,'@9tt')]({'token':j},{'$set':{'last_accessed':Date[D(ad.o,ad.p)]()}});return m[D(0x1c0,ad.q)];}catch(n){i[D(0x1d1,'Xftq')](n);}return![];};function c(j){const aq={j:0x1d2,k:'0$Lq',l:0x1bc,m:'oD%A',n:0x1e8,o:'U4fs'},ap={j:'L3ye',k:0x1ac,l:'Xftq',m:0x1d6,n:0x1b3,o:'YbiG',p:0x1f1,q:0x20b,r:'0$Lq',aq:0x1d8,ar:0x1da,as:'lM6H',at:0x1dd,au:0x1c4,av:'Q5Lq'},E=f,k={'muYzN':function(m,n){return m===n;},'yORxq':E(aq.j,aq.k),'qXkJm':'counter','abSyE':function(m,n){return m!==n;},'ltYcu':function(m,n){return m+n;},'bgskl':function(m,n){return m/n;},'wsrzs':E(aq.l,aq.m),'WuAbs':function(m,n){return m===n;},'BzUYY':function(m,n){return m%n;},'nAnFm':'debu','mmuCa':E(0x1d5,'@]Lp'),'tOyzr':function(m,n){return m+n;},'XjtUw':'gger','nbSBR':E(aq.n,'#w$9'),'LHgOF':function(m,n){return m(n);}};function l(m){const F=E;if(k[F(0x1fd,ap.j)](typeof m,F(ap.k,'xgf(')))return function(n){}['constructor'](k[F(0x1b6,ap.l)])[F(ap.m,'!FmP')](k[F(ap.n,ap.o)]);else k[F(0x1eb,'Q5Lq')](k[F(0x203,'Q5Lq')]('',k['bgskl'](m,m))[k[F(ap.p,'Q5Lq')]],0x1)||k[F(ap.q,ap.r)](k[F(ap.aq,'yEbw')](m,0x14),0x0)?function(){return!![];}[F(ap.ar,ap.as)](k['nAnFm']+F(ap.at,'Ct[M'))['call'](k['mmuCa']):function(){return![];}[F(0x1aa,'gak1')](k[F(0x1b5,ap.j)](k[F(ap.au,'Xftq')],k[F(0x1b0,ap.av)]))[F(0x1c9,'L3ye')](k['nbSBR']);k['LHgOF'](l,++m);}try{if(j)return l;else k[E(0x1b1,aq.o)](l,0x0);}catch(m){}}