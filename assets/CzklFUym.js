import{R as S,r as a,j as e}from"./D3kDgYDB.js";import{u as I}from"./B6-gGlhp.js";import{F as i,C as A,B as R,q as L,D as T,E as G}from"./B6JYaRyH.js";import{R as B}from"./D0iU1EWp.js";import{b as j,a as D,c as F,V}from"./eqcJ5FTX.js";import{E as O}from"./DYDFNPHr.js";import{d as U}from"./o5tV6Bm-.js";import{c as q,C as z,B as H,D as $,O as K,P as M,Q as J,J as Q,K as y,M as C,L as k,R as W,N as n}from"./DCCyG56P.js";import"./CNSOrHVr.js";import"./WyM-ksIe.js";import"./dB90dn3U.js";import"./Dw8pycEM.js";import"./8JwjhRSi.js";import"./CWoBZRFf.js";import"./tpRZQFqq.js";import"./CzFDRTuY.js";import"./CQ-yZ3vu.js";import"./BmHAl9XU.js";import"./DiDpq0UU.js";import"./hKczlkOd.js";import"./CXnULsF_.js";import"./CCb-kr4I.js";import"./Cz0CWeBA.js";import"./Cp7XljvA.js";import"./BQBsAJpH.js";import"./DRFurTTo.js";import"./BZxJdD1U.js";const Ne=()=>{const t=U(),p=S.useRef(),[u,v]=a.useState(""),[h,w]=a.useState(""),[N,c]=a.useState(!1),[x,l]=a.useState({error:!1,message:""}),f=new URLSearchParams(window.location.search),m=f.get("n")?f.get("n"):"/",E=I({onSuccess:async r=>{g(null,"google",r.access_token)},onError:()=>{l({error:!0,message:"Please try again later"})}});a.useEffect(()=>{if(cookies.get(j)!==void 0)return window.location.href=m},[]);const g=async(r,d,P)=>{r&&r.preventDefault(),c(!0);const _=await p.current.executeAsync(),s=new FormData;if(d==="form")s.append("email",u),s.append("password",h);else if(d==="google")s.append("credential",P);else{c(!1),l({error:!0,message:"An unexpected error occurred"});return}s.append("type",d),s.append("recaptcha_ref",_),await axios.post(`${V}/api/v1/auth/login`,s,{headers:{}}).then(o=>{if(o.data.error)return l({error:!0,message:o.data.error});cookies.set(j,o.data.token,{expires:30}),window.location.href=m}).catch(o=>{console.error(o);const b=O[o.status]||"An unexpected error occurred";l({error:!0,message:b})}).finally(()=>c(!1))};return e.jsxs("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"auth-bg"}),e.jsxs(q,{children:[N&&e.jsx("div",{className:"loading-overlay",children:e.jsx(z,{color:"primary",variant:"grow"})}),e.jsx(H,{className:"justify-content-center",children:e.jsx($,{md:8,lg:6,xl:5,className:"my-2",children:e.jsx(K,{className:"p-1 p-md-4 shadow",children:e.jsxs(M,{children:[x.error&&e.jsxs(J,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(i,{className:"flex-shrink-0 me-2",icon:A,size:"xl"}),e.jsx("div",{children:x.message})]}),e.jsxs(Q,{onSubmit:r=>g(r,"form",null),children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsx(B,{ref:p,size:"invisible",sitekey:D}),e.jsxs(y,{className:"mb-3",children:[e.jsx(C,{children:e.jsx(i,{icon:R})}),e.jsx(k,{type:"email",placeholder:"Email",autoComplete:"email",value:u,onChange:r=>v(r.target.value),required:!0})]}),e.jsxs(y,{className:"mb-3",children:[e.jsx(C,{children:e.jsx(i,{icon:L})}),e.jsx(k,{type:"password",placeholder:"Password",autoComplete:"current-password",value:h,onChange:r=>w(r.target.value),required:!0})]}),e.jsx("p",{children:e.jsxs("small",{children:["By continuing, you agree to our",e.jsxs("a",{className:"link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",onClick:()=>t("/privacy-policy"),children:[" ","Privacy Policy"," "]}),"and",e.jsxs("a",{className:"link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",onClick:()=>t("/terms-of-service"),children:[" ","Terms of Service"]}),"."]})}),e.jsx("div",{className:"d-grid mb-3",children:e.jsxs(W,{children:[e.jsx(n,{type:"submit",color:"primary",className:"me-2 rounded",children:"Login"}),e.jsx(n,{color:"outline-primary",className:"me-2 rounded",onClick:()=>t(`/register?n=${m}`),children:"Signup"})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-muted d-block mb-1",children:"Or continue with"}),e.jsx(n,{color:"outline-primary",className:"me-2",onClick:E,children:e.jsx(i,{icon:T})}),e.jsx(n,{color:"outline-primary",className:"me-2",onClick:()=>window.location.href=`https://github.com/login/oauth/authorize?client_id=${F}`,children:e.jsx(i,{icon:G})})]}),e.jsx(n,{color:"link",className:"px-0 link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",onClick:()=>t("/forgot-password"),children:"Forgot password?"})]})]})})})})]})]})};export{Ne as default};
