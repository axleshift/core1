import{r as s,j as e}from"./B29SdWEC.js";import{F as r,A as t}from"./btt79Gso.js";import{d as i}from"./DAmn4N8z.js";import{c as o,o as a,q as m,a as n,b as l}from"./CvTj7SuE.js";import{a as d,V as p}from"./B1zxkiP4.js";import{p as j}from"./2aPQtUzY.js";import{k as c}from"./BFKNndIN.js";import{Q as u,R as f,A as h,a3 as x,i as g}from"./Cn0dVUrX.js";import"./ucIcx5RQ.js";import"./E8MUDNEF.js";import"./BQRwqC_R.js";import"./CFK1l90-.js";import"./BIw_sdFo.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./BmTZu7tj.js";import"./CxXfFpkk.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./DShVK1TZ.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./D0A342eN.js";import"./DPAjA2jz.js";import"./OBe_9qlD.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const y=()=>{const{user:y}=d(),[v,w]=s.useState([]),[b,N]=s.useState(""),$=s.useRef(null),[A,z]=s.useState(1),D=o(i,"messages"),E="admin"===y.role||"super_admin"===y.role?c().id:y.ref;s.useEffect((()=>{const s=a(m(D,n("timestamp")),(s=>{const e=s.docs.map((s=>({id:s.id,...s.data()}))).filter((s=>s.ref===E));w(e)}));return()=>s()}),[]),s.useEffect((()=>{$.current&&$.current.scrollIntoView({behavior:"smooth"})}),[v]);const _=async()=>{""!==b.trim()&&(await l(D,{text:b,sender:y.role,timestamp:Date.now(),ref:E}),N(""),z(1))};return e.jsx("div",{className:"row d-flex justify-content-center mx-0 mb-4",children:e.jsxs(u,{style:{height:"78vh",overflow:"hidden",padding:"0px"},children:[e.jsxs(f,{style:{position:"relative",height:"100vh",overflow:"auto"},children:[v.map(((s,r)=>{return e.jsxs("div",{className:"d-flex flex-row "+(s.sender===("user"===y.role?"admin":"user")?"justify-content-start":"justify-content-end"),children:[s.sender===("admin"===y.role||"super_admin"===y.role?"user":"admin")&&e.jsx(h,{crossOrigin:"Anonymous",className:"rounded-5 me-2",src:"admin"===y.role||"super_admin"===y.role?`${p}/u/${y.ref}.png`:"/images/default-avatar.jpg",style:{width:"45px",height:"100%"},loading:"lazy"}),e.jsxs("div",{children:[e.jsx("p",{className:"small p-2 mb-1 rounded "+(s.sender!==("user"===y.role?"user":"admin")?"bg-primary text-white me-3":"bg-body-tertiary ms-3"),children:(t=s.text,t.split("\n").map(((s,r)=>e.jsxs("span",{children:[s,r<t.split("\n").length-1&&e.jsx("br",{})]},r))))}),e.jsx("p",{className:"small ms-3 mb-3 text-muted "+(s.sender===("user"===y.role?"user":"admin")?"me-3":""),children:j(s.timestamp)})]}),s.sender===y.role&&e.jsx(h,{crossOrigin:"Anonymous",className:"rounded-5 ms-2",src:`${p}/u/${y.ref}.png`,style:{width:"45px",height:"100%"},alt:"You",loading:"lazy"})]},r);var t})),e.jsx("div",{ref:$})]}),e.jsxs("div",{className:"card-footer text-muted d-flex justify-content-start align-items-center p-3 gap-2",children:[e.jsx("div",{children:e.jsx(h,{crossOrigin:"Anonymous",className:"me-2 rounded-5",src:`${p}/u/${y.ref}.png`,style:{width:"40px",height:"100%"},loading:"lazy"})}),e.jsx(x,{value:b,onChange:s=>(s=>{const e=s.target.value;N(e);const r=Math.max(1,(e.match(/\n/g)||[]).length+1);z(Math.min(r,4))})(s),onKeyDown:s=>{if("Enter"===s.key){if(s.shiftKey)return N((s=>s+"\n")),z((s=>Math.min(s+1,4))),void s.preventDefault();_(),s.preventDefault()}},rows:A,style:{resize:"none"}}),e.jsx(g,{type:"submit",color:"primary",className:"me-2 rounded",onClick:_,children:e.jsx(r,{icon:t})})]})]})})};export{y as default};
