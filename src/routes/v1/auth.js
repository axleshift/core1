const L=f;(function(p,q){const W={p:0x1f4,q:0x2af,r:'Qljw',s:'MC(H',t:0x285,u:'j5*4',v:0x28a,w:'t7R4',x:'@AAV',y:'1F&n',z:'^XYJ',A:0x1e1,B:'%8[O'},E=f,r=p();while(!![]){try{const s=-parseInt(E(0x25c,'3)$5'))/0x1*(parseInt(E(W.p,'UpEi'))/0x2)+parseInt(E(W.q,W.r))/0x3+-parseInt(E(0x25f,W.s))/0x4+parseInt(E(W.t,W.u))/0x5*(-parseInt(E(0x21a,'CVQm'))/0x6)+parseInt(E(W.v,W.w))/0x7*(parseInt(E(0x245,W.x))/0x8)+-parseInt(E(0x28f,W.y))/0x9*(parseInt(E(0x23b,W.z))/0xa)+parseInt(E(W.A,W.B))/0xb;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x8d7d7));const d=(function(){let p=!![];return function(q,r){const s=p?function(){if(r){const t=r['apply'](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a7={p:0x2a9,q:'4zB#',r:0x253,s:0x1d8,t:'phGl',u:0x22b,v:'XADv'},a6={p:0x27e,q:'Qljw',r:'(gG2',s:0x1ed,t:'4zB#',u:0x2ad,v:'viJd',w:'%Ojh',x:'MC(H',y:0x293},F=f,p={'csHsN':F(0x24b,'CJc@'),'lAmCc':F(a7.p,a7.q),'rEcqU':function(q,r){return q(r);},'AwcSV':F(a7.r,'ndm('),'enuvf':F(a7.s,a7.t),'fHtpz':function(q,r){return q+r;},'xOlPu':F(a7.u,a7.v),'nzDbx':function(q,r){return q(r);},'dnKwC':function(q){return q();},'ESnyK':function(q,r,s){return q(r,s);}};p[F(0x28c,'CJc@')](d,this,function(){const G=F,q=new RegExp(p[G(a6.p,a6.q)]),r=new RegExp(p['lAmCc'],'i'),s=p[G(0x278,a6.r)](c,p[G(a6.s,a6.t)]);!q['test'](s+p['enuvf'])||!r[G(a6.u,a6.v)](p[G(0x216,a6.w)](s,p[G(0x220,'$BUX')]))?p[G(0x22a,a6.x)](s,'0'):p[G(a6.y,'a!NF')](c);})();}()),(function(){const aa={p:0x29e,q:0x233,r:0x24a,s:0x1ef,t:'*WxF'},H=f,p={'IPhqR':function(r,s){return r+s;},'BKxqt':H(aa.p,'@AAV'),'IsXTS':'{}.constructor(\x22return\x20this\x22)(\x20)','UgEDF':function(r){return r();}};let q;try{const r=Function(p['IPhqR'](p[H(aa.q,'%8[O')],p[H(aa.r,'^XYJ')])+');');q=p[H(aa.s,aa.t)](r);}catch(s){q=window;}q[H(0x26d,'@AAV')](c,0x9c4);}());const b=(function(){let p=!![];return function(q,r){const ab={p:'CVQm'},s=p?function(){const I=f;if(r){const t=r[I(0x29c,ab.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const aj={p:'Lgt^',q:0x1eb,r:'j5*4',s:0x236,t:0x252,u:'Qljw',v:0x25e,w:'@AAV',x:0x248,y:'K1Zo',z:0x283,A:0x28e,B:0x26b,C:'zKcP',D:0x24e,ak:'*WxF',al:0x2b4,am:'7RPf'},ai={p:0x243,q:'t7R4'},J=f,p={'kwsRR':function(u,v){return u(v);},'zSuif':'return\x20(function()\x20','mjShI':'{}.constructor(\x22return\x20this\x22)(\x20)','EBJeS':function(u){return u();},'ALjgt':J(0x210,aj.p),'Gqpbr':J(0x20e,'%Ojh'),'XvBGO':'error','LVntc':'exception','jUOlc':J(0x1d6,'ev$t'),'sJeeH':J(0x20a,'XADv'),'eLfBK':function(u,v){return u<v;}},q=function(){const K=J;let u;try{u=p[K(0x26f,'@AAV')](Function,p[K(ai.p,ai.q)]+p['mjShI']+');')();}catch(v){u=window;}return u;},r=p['EBJeS'](q),s=r[J(aj.q,'Lgt^')]=r[J(0x244,aj.r)]||{},t=[p[J(aj.s,'DsXo')],J(0x29a,'kWBo'),p[J(0x209,'OL]v')],p[J(aj.t,aj.u)],p['LVntc'],p[J(aj.v,aj.w)],p[J(aj.x,aj.y)]];for(let u=0x0;p[J(aj.z,'^XYJ')](u,t[J(aj.A,'DsXo')]);u++){const v=b[J(aj.B,'zKcP')]['prototype'][J(0x238,'^XYJ')](b),w=t[u],x=s[w]||v;v[J(0x235,'G)Ko')]=b[J(0x22d,aj.C)](b),v[J(aj.D,aj.ak)]=x[J(0x2ba,'t7R4')][J(aj.al,aj.am)](x),s[w]=v;}});a();import g from'dotenv';g[L(0x289,'&r*8')]();import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../components/logger.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x1d1;let h=c[d];if(f['NJHPks']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['OrTYbx']=m,a=arguments,f['NJHPks']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['awzfAl']===undefined&&(f['awzfAl']=!![]),h=f['OrTYbx'](h,g),a[k]=h):h=l,h;},f(a,b);}import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';function e(){const b5=['W4xcVvq/BSot','caCaW4RdMG','amkXWOpdJ8kX','WP4NW57dKmoUvmohAhXYuq','W6DFWOtcIq','W6FcKt3cUXpdG8oKmgZdOW','WO3cVmoiW68','cG3cGJWIW60ex8kOW6a','W5xcPLKNFSodW7XMpCo3','m8kaj10','omkuCWq7','W5dcR8oZWP9RpCkShmk5W44','CxZcVmkGW7BdOqNdP8o/','B13cM8k7yq','uHvYrmomWRFcI3hcOW','WP1mWR/cGa','vmomW41tWPJcTCkuW7dcQa','W58+W4W','W4WqW6JdLY0EWRS/WQxcHCoaW5eo','jSk+W7xcTN5Uu8oH','xxtcN8k4','DSoyW6GUW5D8W4HLWRFcSmoUWOiOW4ldVSkiWQ5KWOhcVCohW7L8AehcGSorWOy','o8oBnq','gSkRWPldJSkWWOK','W6PhvG','xN7cGSkO','fJFcHsyW','oCkxW7a8W5r5W4K','cSkqfmkRkCoLW7DndCkrW7dcOW','W459W4TZ','o8ocD8oy','W4dcISo6WPzg','p8kNEXW9WRCNW7GRWOlcHW','WRzwWONcSeS','W6vegWNcN8kkl8k1B3yGW5NcTg/cI1W','W7ddV8kVkCk0W5S','pCoNaCogWOS','WO0vW60zEMmCW4K','W4hcJrNcVXe','rSoBW4Xa','W7FcIJdcOWpdKW','t8o6W4BcKfu','C8oSW6RcHW','nSowFCoe','mSodlNBdRG','mCorimoW','fCoxkee','u8ozW5LEWO3cS8k+','WRBdJgddOutcL8kNhfpdQmksWQ8D','WOSpW75TW4S','i8kNzSoY','WRJdIq/cUqKQW7i','W7q1W5ZdLmoo','wmo2y8o0EG','v0TXWP3cLeLAl3VdVgldH2i','WQ5sWQVcGM8','EvdcN8kJW78','fqKLW5ZdHZmknxJdMeW','DCk5ewtdJW','eYOjW7JdIW','gCkTBHq7WRCNWOCfWQi','W7pdTCkBcmkr','xsmLW7iOW5TbW6Gz','xriGW4OG','W4uMarzo','WOfUW5hcJvq','W6zzWOtcNL8VFSkYWOtdUmoJ','W5ZcULOL','qCogwmorD8kLW4Hnc8kiW7a','nHW3W5VdLrmAoZ3dLK3dKvaPW7n8kYjBW40eWO5dW5VcIvqBASksWRJcGWX4WRryWPLfr8oVFSkrW5BdHY1awCkFdCkQWO9dctpcK8obWRVdQSotovVdQmkKWPjbh8kiWRtdRK1zWODZtszalcq2WPZdP8oZW6i6W5LScW','wCoux8oksW','pJ/cOCozw8oO','W7ygEx0QW6DH','W5xcU1aQB8ofW6Xqm8oT','WOOoW58zFxK','nHW3W5VdLrmAoZ3dLK3dKvaPW7n8kYrDWOGjWP9hW5RdNqblk8kFW7ddML59WR5lWPvd','qIC4W6i','a8kxW6S9WPT6W5G1W7hcTSoVWOi','WPayW6D/W43cUq','lIldOdJcHa','qdOvW6ObWPG','WPyFW6n5','oGhcVWOJ','WOtdUa1/iSkqWR03pSojhM/dH8oi','uZGxW6Gn','Dmo/W4ZcPfq','W6vpWQqwfq','qZZcU8okuCoVW7W','W7dcGwujBG','CCk+u0xdNW','WPPPWRFcPLm','qIO3WRrcWOm','A8olWQT3WO4KWPWmWRJcKmo/W6Tv','ECoPW7pcPhzjD8o6WRFdNG','rs09W6mz','kCkuECoXW48','WQjYeSoGW6G0','wZ7cIGC4W70G','W67cJt7cUq','W4zIgXpcOa','WP0Szgqs','qNtcN8k7yCoz','xwJcKCoosSozW77cUW','W5RcRSoSWPz8kSkxg8kZ','aYtcPa','W7G/W43dG8oRw8oAz3zRqmofqsjIW7VcKHZdHKtcRW','W7u+cazc','W6pdKCkhaSkw','kCowD8oy','vqb7sSomWRFcHxVcOMRdImoQW7S','zaDRW4e','WPjTW5zYBG','W5PFWO4','iSovmmoR','WO3cOmovW793oW','W5rEqK5p','WPNcPvOSCSoo','qmogwmoTA8k/WO0xg8kCW7lcOCkBW4/cN8oGWRORgG','WO5ZgCkMW5u6FWFcVKddMmk6WPqTfvvRW5WPFsTJna','BCkmfgRdMaK','WPXZbb8','eXBcN1G','WOHZWOtcSfW','dXm3W43dKaGNmxG','zSkbE8k2W5iBW5uxWRTQW6xcVxO','W5dcOfSVvmooW60','WQL4hCoIW6qHyq','cCkDi3ZcN3RcJKRcVq','FCkxW7uzW4ZdUSoZWQhdT8kcWRZcShS7WRm7W7JdNddcN8oNfSoEW6fsph19W6GlWPjeWQ8p','a8oliv/dHCkEW5ldS0ua','W6K7W5ZdImoX','d8kSBGC','uWbLuq','nHtdRcC','jCk+WRxdOsGBnmolWOldICoDWO7cPa','xJyM','WQLxW6ZcJ0i','W7ZdS8kPkmkIW51a','aMRcLv0uW7fWW7VcSe/dNq1LE8ofW5VdPq','WOefW6HV','WQTRW5tcVua','WQjYemoQW6qWzGVdSx4','dqqjW5ldTa','W7bIW7nesa','krZcQhSQ','gaVcOZSKW5Sewq','W5n3W5i','WQLJE0iXW4ZdPgxcImkdW4ddHa','dSoloG','W5/cL8oUWRju','imkTE8oI','lCkskL8L','nSoUc0xdQG','W6FcLJdcVHG','nSoFkmoIWPi','sSkYumkcWQ4','W7z6grv3WRi6W5pcL2WPwSke','r8k8fhxdUq','uSoiW4HgWPNcOW','WRz+W7/cPeq','vsC0W7m','WRj4eSoI','smoUm0f2W6j2W6aiWOBcSSkRWQ7cRa','Emk6f1BdNq','wN7cMSk5EW','iHFcOcWp','dZ/cUSoEsSoOW73cNx85nW','WQBcNCo0WOhcLq','amo9j8oWWOG','W49AWPa1aa','aahcNIGIW5O','W4pcULa5nSobW69QpmoT','WQb0W5VcPfOHBq','wIhcJ1SnW5nVW5i','ymolW4PHWRO','oCktEtO9','WQWDW7SPtG','W7WEW7RdU8oR','cCkRAGe6WQe','W4HRW4bLBW','e8oqp1RdJSkA','ahnIWR5cWOqyW5Wuwmo2WORdLG','cmkFW5SkW48','jmkNE8oI','wCk+DmkvWPdcUde','uI06W6OsW5zuW6Wtvq','nSkhoa','aJ/cOW','WRrdW77cM0y','W6pdIWJcMs0','WRpcNSoRWRNcLSkzW7u','W6nsWRGkeZyYW5HDmse','kSk+WOVdU8ki','qqX4qCo3WRZcOq','drFcHvm','WPC7dbtcNSoiW4K6W73cG8kKtCoPWPGY','F8oVW6lcMIa','qHDKsSok','vdaKW6Kf','W5RcJmotWQzB','qcSAW7O','W4LtWQaycY0JWPTMcGm','W7PPW5v1BG','hCkTWPldMCkG','ySo/W6hcPq','daBdSdRcPSkVACoeW6JcIZBcMCkmW785B0DwW491xSoYiW','t8otW54','FGXJW4O','xwxcKmkOymoc','WQ90W5i','zmo4W6xcO29F','WOuaW6LKW4O','m8oDmmo2WPn3WOSXWOzi','WPvwWR7cIG','W6FdOSkPomkYW5W','CsPXW5vk','W6FdQs0','nmoaAG','W7zbeqVcN8kgd8k1kG','WOqCq0nsW6JdVmkJ','W6fIWRVcP2e','gSk6WP3dNG','WQj3W5K','ACo2W6lcHZNcVq','W7qImr5Z','W7HYWROPeG','kaJdQcZcVW','W5bes0XD','qCogqSo8','fqKLW5ZdLW8','WOOFW5aj','W6rAWOy','W6FcKtxcSG','eHFcJ08'];e=function(){return b5;};return e();}import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';const router=h[L(0x270,'1F&n')]();router[L(0x242,'DsXo')]('/register',async(p,q)=>{const an={p:0x274,q:'MC(H',r:'(gG2',s:0x2a2,t:0x286,u:'Qljw',v:'DsXo',w:'yLaf',x:0x1f6,y:'SO*x',z:0x201,A:'g$N*',B:0x1e9,C:'t7R4',D:'841f',ao:0x1dc,ap:'T5g)',aq:0x1d9,ar:0x222,as:'CVQm',at:'viJd',au:0x277,av:0x1d7,aw:'QZww',ax:0x20d,ay:'4zB#',az:'4zB#',aA:0x1ee,aB:0x234,aC:'OL]v',aD:0x1dd,aE:'9t4c',aF:0x2a1},M=L,r={'Qwzfw':function(s,t){return s||t;},'duznn':M(an.p,'MC(H'),'KStvN':M(0x26e,an.q),'ckjgu':M(0x20c,an.r),'ejynk':function(s){return s();},'hpaju':'users','VJFvJ':M(0x295,'Sbl9'),'sqEmA':function(s,t){return s(t);},'CLrOr':M(an.s,'g$N*'),'RgvJK':M(an.t,an.u)};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w,newsletter:x}=p['body'];if(r[M(0x260,'^XYJ')](!s,!t)||!u||!v||!w||!x)return q[M(0x20f,an.v)](0x190)[M(0x207,an.w)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[M(an.x,an.y)](s))return q['status'](0xc8)[M(an.z,an.A)]({'error':M(0x292,'jaZc')});if(v[M(an.B,an.C)]<0x8)return q['status'](0xc8)['json']({'error':r['duznn']});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/['test'](v))return q[M(0x215,an.D)](0xc8)['json']({'error':r[M(an.ao,an.ap)]});if(v!=w)return q['status'](0xc8)[M(0x254,'Sbl9')]({'error':r[M(an.aq,'kWBo')]});const y=await r[M(an.ar,an.as)](k),z=await y[M(0x2aa,'QZww')](r[M(0x2b5,'Lgt^')]),A=await collection['findOne']({'email':s});if(A)return l[M(0x204,an.at)]('Email\x20id\x20already\x20exists'),q[M(an.au,'7RPf')](0x199)[M(0x275,'UpEi')]();await z[M(0x2a4,'MC(H')]({'email':s,'first_name':t,'last_name':u,'role':r[M(an.av,an.aw)],'password':r['sqEmA'](o,v),'email_verify_at':'','created_at':Date[M(an.ax,an.ay)](),'update_at':Date[M(an.ax,an.az)]()});if(x===r[M(an.aA,'%8[O')]){const B=await y[M(an.aB,'K1Zo')](r['RgvJK']),C=await x[M(0x2a6,'9t4c')]({'email':s});!C&&B[M(0x290,'K1Zo')]({'email':s,'created_at':Date[M(0x1d1,an.aC)](),'update_at':Date[M(0x1d3,an.aw)]()});}return q[M(an.aD,'4zB#')](0xc9)['send']();}catch(D){l['error'](D);}return q[M(0x229,an.aE)](0x1f4)[M(an.aF,'tsE2')]();}),router['post'](L(0x29d,'9t4c'),n,async(p,q)=>{const at={p:0x1f2,q:'OL]v',r:0x284,s:'UpEi',t:0x218,u:0x21e,v:'ndm(',w:0x246,x:'OL]v',y:'3)$5',z:'9t4c',A:'t7R4',B:'U&Wk',C:0x1e0,D:0x25d,au:'jaZc',av:0x224,aw:0x294,ax:0x2ab,ay:'jaZc',az:0x2a7,aA:0x202,aB:'tsE2',aC:'viJd',aD:0x255,aE:'QZww',aF:0x2b2,aG:0x1ea,aH:0x2ae,aI:0x251,aJ:'phGl'},N=L,r={'jMRpL':function(s){return s();},'NsPcY':N(at.p,at.q),'HvrRO':function(s,t){return s!=t;},'EdgvI':function(s,t){return s(t);},'wGONQ':N(at.r,at.s),'Xjgjv':function(s){return s();},'gknmE':N(at.t,'Sbl9'),'RgcEN':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p['body'];if(!s||!t)return q[N(at.u,at.v)](0x190)[N(at.w,at.x)]();const u=await r[N(0x1fc,at.y)](k),v=await u[N(0x231,at.z)](r[N(0x1e4,at.A)])[N(0x1f7,at.B)]({'email':s});if(!v)return q['status'](0x194)[N(at.C,'&r*8')]();if(r['HvrRO'](r[N(at.D,at.au)](o,t),v['password']))return q[N(at.av,'MC(H')](0x191)[N(0x223,'@AAV')]();const w=j['createHash'](r[N(at.aw,'841f')])['update'](r[N(at.ax,at.ay)](generateUniqueId))[N(0x24c,'841f')](r['gknmE']),x=p[N(at.az,'&r*8')][N(at.aA,at.aB)]||p['socket'][N(0x296,at.aC)];return r[N(at.aD,at.aE)](addSession,v,w,x,p[N(at.aF,'841f')][N(at.aG,at.z)]),q['status'](0xc8)[N(at.aH,'(gG2')]({'token':w});}catch(y){l['error'](y);}return q[N(at.aI,at.aJ)](0x1f4)['send']();}),router['post']('/verify',m,async function(p,q,r){const az={p:'9t4c',q:'g$N*',r:0x28b,s:'phGl',t:'UpEi',u:'T5g)',v:0x288,w:'SO*x',x:0x206,y:'G)Ko',z:0x217,A:0x277,B:0x273,C:'(gG2'},O=L,s={'FHPBu':function(z,A){return z!==A;},'CaxAM':O(0x2b0,'UpEi'),'yVqgx':function(z,A){return z*A;},'iLLUU':function(z,A){return z>A;},'WsSqf':function(z,A){return z-A;},'jrRiv':function(z,A,B){return z(A,B);}},{_id:t,email_verify_at:u,...v}=p['user'];v[O(0x2b3,'rPF%')]=s[O(0x281,az.p)](u,'');if(p[O(0x228,az.q)]['email_verify_at']!=='')return q['status'](0xc8)[O(az.r,az.s)](v);const w=await k(),x=await w['collection'](s[O(0x1ff,'XADv')]),y=await x['findOne']({'token':p[O(0x287,az.t)],'verified':![]});if(y){const z=new Date(y[O(0x265,'%8[O')]),A=s[O(0x263,az.u)](s[O(az.v,az.w)](0xa,0x3c),0x3e8);if(!s[O(az.x,'K1Zo')](s[O(0x261,az.y)](Date[O(az.z,'3)$5')](),z),A))return q[O(az.A,'7RPf')](0xc8)['json']({'otp':!![]});}return s['jrRiv'](sendOTPEmail,p,x),q[O(az.B,'*WxF')](0xc8)[O(0x2ae,az.C)]({'otp':!![]});});const sendOTPEmail=(p,q)=>{const aD={p:0x29f,q:'&r*8',r:0x1fb,s:'Lgt^',t:0x21d,u:0x2a8,v:'F]vI',w:0x221,x:'(gG2',y:0x23a,z:'Qljw',A:0x2a3,B:'^XYJ',C:'j5*4',D:0x23e,aE:'kWBo'},P=L,r={'hSCCl':function(t,u){return t+u;},'wXKLs':function(t,u){return t*u;},'uWMPi':function(t,u,v){return t(u,v);},'wVUTD':P(aD.p,aD.q)},s=Math[P(0x212,'7RPf')](r[P(0x24d,'kWBo')](0x186a0,r[P(aD.r,aD.s)](Math['random'](),0xdbba0)));Promise[P(aD.t,'Lgt^')]([q[P(aD.u,aD.v)]({'user_id':p[P(0x2ac,'%8[O')]['_id'],'token':p[P(aD.w,aD.x)],'code':s,'verified':![],'expired':![],'created_at':Date[P(aD.y,'jaZc')](),'updated_at':Date['now']()}),r[P(0x264,'MC(H')](send,{'to':p[P(0x20b,aD.z)]['email'],'subject':r[P(aD.A,aD.B)],'text':P(0x276,aD.C)+s+P(aD.D,'j5*4')},p[P(0x257,'QZww')][P(0x213,aD.aE)])]);};router['post'](L(0x298,'OL]v'),m,async function(p,q,r){const aE={p:0x1e3,q:'DsXo',r:0x214,s:'^XYJ',t:0x230,u:0x267,v:'UpEi',w:'UpEi'},Q=L;try{const s=await getUser(p[Q(aE.p,aE.q)]);return q['status'](0xc8)[Q(aE.r,aE.s)]({'user':{'email':s[Q(0x203,'ndm(')],'first_name':s[Q(aE.t,'t7R4')],'last_name':s[Q(aE.u,aE.v)]}});}catch(t){l[Q(0x205,aE.w)](t);}return q['status'](0x1f4)[Q(0x225,'*WxF')]();}),router[L(0x1d5,'SO*x')](L(0x280,'1F&n'),m,function(p,q,r){const aG={p:0x1e7,q:'kWBo'},R=L,s={'UIeuo':function(t,u){return t(u);}};return s[R(aG.p,aG.q)](removeSession,p['token']),q['status'](0xc8)[R(0x22f,'[G*A')]();}),router['post']('/verify/otp/new',[m,n],async function(p,q,r){const aM={p:0x22e,q:'9t4c',r:0x1f0,s:0x1d4,t:'K1Zo',u:0x1e2,v:'T5g)',w:'4zB#',x:0x237,y:'viJd',z:0x217,A:'3)$5',B:'Lgt^',C:'UpEi',D:0x27f},S=L,s={'MxPDo':function(t){return t();},'MOAYl':function(t,u){return t*u;},'lWqAZ':function(t,u){return t>u;},'tUwUj':function(t,u){return t-u;},'jLYXw':'system','bzAnz':function(t,u,v){return t(u,v);}};try{const t=await s['MxPDo'](k),u=await t[S(aM.p,'phGl')]('otp'),v=await u['findOne']({'token':p[S(0x282,'D!Z^')],'verified':![],'expired':![]});if(v){const w=new Date(v[S(0x272,aM.q)]),x=s[S(aM.r,'jaZc')](0xa,0x3c)*0x3e8;s[S(aM.s,aM.t)](s[S(aM.u,aM.v)](Date[S(0x20d,aM.w)](),w),x)&&(await u[S(aM.x,aM.y)]({'_id':new ObjectId(v['_id'])},{'$set':{'verified':![],'expired':!![],'updated_at':Date[S(aM.z,aM.A)](),'modified_by':s[S(0x2b1,aM.B)]}}),s[S(0x27d,aM.C)](sendOTPEmail,p,u));}}catch(y){l[S(aM.D,'$BUX')](y);}return q[S(0x240,'XADv')](0x1f4)[S(0x297,'%Ojh')]();}),router['post'](L(0x22c,'jaZc'),[m,n],async function(p,q,r){const aS={p:0x29b,q:0x1f1,r:0x21c,s:'XADv',t:0x24f,u:'UpEi',v:0x21b,w:0x1f5,x:'8#j]',y:0x217,z:'3)$5',A:0x232,B:'ev$t',C:0x249,D:'%8[O',aT:'4zB#',aU:0x26c,aV:0x208,aW:0x226,aX:0x241,aY:0x25a,aZ:'&r*8',b0:0x219,b1:'7RPf',b2:'zKcP',b3:'Qljw',b4:'DsXo',b5:0x21f,b6:0x279,b7:'SO*x'},T=L,s={'EsHhg':function(t){return t();},'dTQJJ':T(0x291,'1F&n'),'RgEEt':function(t,u){return t>u;},'vljVw':function(t,u){return t-u;},'JUUoU':function(t,u){return t!==u;},'lPvLW':function(t,u){return t(u);},'hcxfs':T(aS.p,'[G*A'),'McXcd':'users'};try{const t=p['body'][T(0x1f9,'ev$t')];if(!t)return q[T(aS.q,'%8[O')](0x190)[T(aS.r,aS.s)]();const u=await s[T(aS.t,'phGl')](k),v=await u[T(0x1f8,aS.u)](s[T(aS.v,'zKcP')]),w=await v[T(0x200,'viJd')]({'token':p['token'],'verified':![],'expired':![]});if(w){const x=new Date(w['created_at']),y=0xa*0x3c*0x3e8;if(s[T(aS.w,'j5*4')](s[T(0x1e6,aS.x)](Date[T(aS.y,aS.z)](),x),y))return q['status'](0xc8)[T(aS.A,aS.B)]({'error':T(aS.C,aS.D)});}if(s['JUUoU'](w[T(0x227,'phGl')],s[T(0x268,aS.u)](parseInt,t[T(0x258,aS.aT)](/[^0-9]/g,''))))return q['status'](0xc8)[T(aS.aU,'9t4c')]({'error':T(aS.aV,'$BUX')});return await Promise[T(aS.aW,'zKcP')]([v[T(0x239,'4zB#')]({'_id':new ObjectId(w[T(aS.aX,'CVQm')])},{'$set':{'verified':!![],'updated_at':Date['now'](),'modified_by':s[T(aS.aY,'7RPf')]}}),u[T(0x2b6,aS.aZ)](s['McXcd'])[T(aS.b0,'CJc@')]({'_id':new ObjectId(p[T(0x27a,aS.b1)][T(0x299,aS.b2)])},{'$set':{'email_verify_at':Date[T(0x23f,'kWBo')](),'updated_at':Date[T(0x1fa,'1F&n')]()}})]),q[T(0x211,aS.b3)](0xc8)[T(0x23d,aS.b4)]();}catch(z){l[T(aS.b5,'a!NF')](z);}return q[T(aS.b6,'yLaf')](0x1f4)[T(0x25b,aS.b7)]();});export default router;function c(p){const b4={p:0x1f3,q:'QZww',r:'UpEi',s:0x2a0,t:'T5g)',u:'Lgt^'},b3={p:0x2b9,q:'g$N*',r:0x26a,s:'Lgt^',t:'t7R4',u:0x28d,v:0x2b7,w:'MC(H',x:'$BUX',y:0x266,z:0x1e8,A:0x256,B:'kWBo',C:'Sbl9'},U=L,q={'TvBgO':U(b4.p,b4.q),'lXqpT':U(0x1fd,'8#j]'),'NxBFD':function(s,t){return s!==t;},'BudZa':function(s,t){return s+t;},'VeOEu':function(s,t){return s/t;},'ZeHIP':function(s,t){return s===t;},'kyMzV':function(s,t){return s%t;},'MzVST':U(0x1df,b4.r),'QOHVd':U(0x250,'4zB#'),'gcSDV':U(b4.s,b4.t),'OgFLg':function(s,t){return s+t;},'PwhpZ':U(0x262,'MC(H'),'ueJsq':function(s,t){return s(t);}};function r(s){const V=U;if(typeof s===q[V(0x269,'a!NF')])return function(t){}[V(0x1e5,'1F&n')]('while\x20(true)\x20{}')['apply'](q['lXqpT']);else q[V(b3.p,b3.q)](q[V(b3.r,b3.s)]('',q[V(0x27b,b3.t)](s,s))['length'],0x1)||q[V(b3.u,'B6yd')](q[V(b3.v,b3.w)](s,0x14),0x0)?function(){return!![];}[V(0x1fe,b3.x)](q[V(0x2b8,'OL]v')]+q['QOHVd'])['call'](q[V(b3.y,'841f')]):function(){return![];}['constructor'](q[V(b3.z,'$BUX')](V(b3.A,b3.B),V(0x247,b3.C)))['apply'](q['PwhpZ']);q[V(0x1da,'U&Wk')](r,++s);}try{if(p)return r;else q[U(0x1de,b4.u)](r,0x0);}catch(s){}}