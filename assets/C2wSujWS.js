import{R as T,r as c,j as e}from"./D3kDgYDB.js";import{a as L}from"./t_wxcTun.js";import{F as t,B as F,A as D,x as b,p as _,C as G}from"./3V3OsIEt.js";import{R as B}from"./D0iU1EWp.js";import{b as S,V as q,c as U,a as V}from"./Dxvdh3Uh.js";import{E as z}from"./DYDFNPHr.js";import{d as O}from"./FDBtgKq2.js";import{c as $,C as H,D as E,E as g,P as M,R as K,Q as W,K as Q,L as d,N as m,M as p,T as X,S as Y,O as C}from"./CRebGdRz.js";import"./CNSOrHVr.js";import"./WyM-ksIe.js";import"./dB90dn3U.js";import"./Dw8pycEM.js";import"./8JwjhRSi.js";import"./D3kAHpSt.js";import"./tpRZQFqq.js";import"./CzFDRTuY.js";import"./CQ-yZ3vu.js";import"./BmHAl9XU.js";import"./DiDpq0UU.js";import"./CHUBTVDa.js";import"./CXnULsF_.js";import"./CCb-kr4I.js";import"./Cz0CWeBA.js";import"./Cp7XljvA.js";import"./BQBsAJpH.js";import"./CWmxXzlZ.js";import"./BZxJdD1U.js";const be=()=>{const i=O(),y=T.useRef(),[a,I]=c.useState({email:"",first_name:"",last_name:"",password:"",repeat_password:""}),[P,x]=c.useState(!1),[v,A]=c.useState(!1),[k,u]=c.useState({error:!1,message:""}),w=new URLSearchParams(window.location.search),h=w.get("n")?w.get("n"):"/";c.useEffect(()=>{if(cookies.get(S)!==void 0)return i(h)},[]);const n=r=>{const{id:l,value:f}=r.target;I(j=>({...j,[l]:f}))},N=async(r,l,f)=>{r&&r.preventDefault(),x(!0);const j=await y.current.executeAsync(),o=new FormData;if(l==="form")for(const s in a)o.append(s,a[s]);else if(l==="google")o.append("credential",f);else{x(!1),u({error:!0,message:"An unexpected error occurred"});return}o.append("type",l),o.append("recaptcha_ref",j),o.append("newsletter",v),await axios.post(`${V}/api/v1/auth/register`,o,{headers:{}}).then(s=>{if(s.data.error)return u({error:!0,message:s.data.error});if(s.data.type==="form")return i(`/login${h}`);cookies.set(S,s.data.token,{expires:30}),window.location.href=h}).catch(s=>{console.error(s);const R=z[s.status]||"An unexpected error occurred";u({error:!0,message:R})}).finally(()=>x(!1))};return e.jsxs("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"auth-bg"}),e.jsxs($,{children:[P&&e.jsx("div",{className:"loading-overlay",children:e.jsx(H,{color:"primary",variant:"grow"})}),e.jsx(E,{className:"justify-content-center",children:e.jsx(g,{md:8,lg:6,xl:5,className:"my-2",children:e.jsxs(M,{className:"p-1 p-md-4 shadow",children:[e.jsxs(K,{children:[k.error&&e.jsxs(W,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(t,{className:"flex-shrink-0 me-2",icon:F,size:"xl"}),e.jsx("div",{children:k.message})]}),e.jsxs(Q,{onSubmit:r=>N(r,"form",null),children:[e.jsx("h1",{children:"Register"}),e.jsx("p",{className:"text-body-secondary",children:"Create your account"}),e.jsx(B,{ref:y,size:"invisible",sitekey:q}),e.jsxs(d,{className:"mb-3",children:[e.jsx(m,{children:e.jsx(t,{icon:D})}),e.jsx(p,{id:"email",type:"email",placeholder:"Email",autoComplete:"email",value:a.email,onChange:r=>n(r),required:!0})]}),e.jsxs(E,{children:[e.jsx(g,{md:6,className:"mb-3",children:e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(t,{icon:b})}),e.jsx(p,{id:"first_name",type:"text",placeholder:"First Name",autoComplete:"given-name",value:a.first_name,onChange:r=>n(r),required:!0})]})}),e.jsx(g,{md:6,className:"mb-3",children:e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(t,{icon:b})}),e.jsx(p,{id:"last_name",type:"text",placeholder:"Last Name",autoComplete:"family-name",value:a.last_name,onChange:r=>n(r),required:!0})]})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(m,{children:e.jsx(t,{icon:_})}),e.jsx(p,{id:"password",type:"password",placeholder:"Password",autoComplete:"new-password",value:a.password,onChange:r=>n(r),required:!0})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(m,{children:e.jsx(t,{icon:_})}),e.jsx(p,{id:"repeat_password",type:"password",placeholder:"Repeat password",autoComplete:"new-password",value:a.repeat_password,onChange:r=>n(r),required:!0})]}),e.jsx(X,{id:"newsletter",className:"mb-1",checked:v,onChange:r=>A(event.target.checked),label:"Subscribe to our newsletter"}),e.jsx("p",{children:e.jsxs("small",{children:["By continuing, you agree to our",e.jsxs("a",{className:"link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",onClick:()=>i("/privacy-policy"),children:[" ","Privacy Policy"," "]}),"and",e.jsxs("a",{className:"link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",onClick:()=>i("/terms-of-service"),children:[" ","Terms of Service"]}),"."]})}),e.jsx("div",{className:"d-grid mb-3",children:e.jsxs(Y,{children:[e.jsx(C,{type:"submit",color:"primary",className:"me-2 rounded",children:"Create Account"}),e.jsx(C,{className:"me-2 rounded border-2 border-primary text-primary",onClick:()=>i(`/login${h}`),children:"Login"})]})}),e.jsx("div",{className:"d-flex justify-content-center mb-3",children:e.jsx(L,{onSuccess:r=>{N(null,"google",r.credential)},onError:()=>{u({error:!0,message:"Login Failed"})},useOneTap:!0})}),e.jsx("div",{className:"d-flex justify-content-center mb-3",children:e.jsxs(C,{color:"secondary",className:"d-block",size:"sm",onClick:()=>window.location.href=`https://github.com/login/oauth/authorize?client_id=${U}`,children:[e.jsx(t,{icon:G})," Signup using Github"]})})]})]}),e.jsx("div",{className:"ms-auto",children:e.jsx("a",{href:"https://stats.uptimerobot.com/5l58Mua0Wi",target:"_blank",rel:"noopener noreferrer",className:"link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover",children:"System Status"})})]})})})]})]})};export{be as default};
