/**
 * Â© 2025 Melvin Jones Repol & its contributors . All rights reserved.
 * This project is licensed under the MIT License with Commons Clause.
*/
import{r as e,j as a}from"./CbKKHx2O.js";import{u as s}from"./C3hrCPXF.js";import{Z as t,a as i,b as r,c as l,_ as n,$ as o,a0 as c,a1 as d,e as m,d as u,f as h,t as p,v as x}from"./BCoDuBWI.js";import{F as v,J as g}from"./B9OiE7iL.js";import{p as j}from"./2aPQtUzY.js";import{d as b}from"./zoz2lpix.js";import"./D9QqU1Un.js";import"./Dw0KO6EP.js";import"./CzGuHLZU.js";import"./z-cSZRUs.js";import"./CTpwok2W.js";import"./CvkuIoXT.js";import"./B3ZIOLOa.js";import"./Bzwk9agu.js";import"./BqHrj3jM.js";import"./tM1qHAtJ.js";const y=()=>{var y,f,k,C,N,w,W,I,O,_,F,S;const{setIsOpen:D}=s(),P=b(),[E,J]=e.useState(!1),[M,R]=e.useState(null),[A,$]=e.useState({smallDetailWidgets:{cancelled:[0,"0%"],toPay:[0,"0%"],toShip:[0,"0%"],toReceive:[0,"0%"],received:[0,"0%"]},invoicesInfoWidgets:{success:[0,"0%"],expired:[0,"0%"]}}),z={x:{border:{display:!1},grid:{display:!1},ticks:{display:!1}},y:{display:!1,grid:{display:!1},ticks:{display:!1}}},X={line:{borderWidth:1,tension:.4},point:{radius:4,hitRadius:10,hoverRadius:4}},B=e=>{if(!e||0===e.length)return 0;return(e.reduce(((e,a)=>e+a),0)/e.length).toFixed(2)},T=[{color:"primary",value:a.jsx(a.Fragment,{children:B(null==(y=A.shipmetOvertime)?void 0:y.data)}),title:"Shipments",pointColor:t("--cui-primary"),labels:(null==(f=A.shipmetOvertime)?void 0:f.labels)||["Jan","Feb","Mar","Apr","May","Jun"],data:(null==(k=A.shipmetOvertime)?void 0:k.data)||[0,0,0,0,0,0],url:"/shipments"},{color:"info",value:a.jsx(a.Fragment,{children:B(null==(C=A.costOvertime)?void 0:C.data)}),title:"Cost",pointColor:t("--cui-info"),labels:(null==(N=A.costOvertime)?void 0:N.labels)||["Jan","Feb","Mar","Apr","May","Jun"],data:(null==(w=A.costOvertime)?void 0:w.data)||[0,0,0,0,0,0],url:"/cost"},{color:"warning",value:a.jsx(a.Fragment,{children:B(null==(W=A.itemsOvertime)?void 0:W.data)}),title:"Items",pointColor:t("--cui-warning"),labels:(null==(I=A.itemsOvertime)?void 0:I.labels)||["Jan","Feb","Mar","Apr","May","Jun"],data:(null==(O=A.itemsOvertime)?void 0:O.data)||[0,0,0,0,0,0],url:"/items"},{color:"danger",value:a.jsx(a.Fragment,{children:B(null==(_=A.weightOvertime)?void 0:_.data)}),title:"Weight",pointColor:t("--cui-danger"),labels:(null==(F=A.weightOvertime)?void 0:F.labels)||["Jan","Feb","Mar","Apr","May","Jun"],data:(null==(S=A.weightOvertime)?void 0:S.data)||[0,0,0,0,0,0],url:"/weight"}],U=e=>axios.get(e).then((e=>e.data)).catch((e=>{throw console.error("Error fetching dashboard data:",e),e})),Z=async()=>{(async()=>{try{const e=U("/insights/shipment-overtime").then((e=>$((a=>({...a,shipmetOvertime:e}))))),a=U("/insights/cost-overtime").then((e=>$((a=>({...a,costOvertime:e}))))),s=U("/insights/items-overtime").then((e=>$((a=>({...a,itemsOvertime:e}))))),t=U("/insights/weight-overtime").then((e=>$((a=>({...a,weightOvertime:e}))))),i=U("/insights/shipment-info-widgets").then((e=>$((a=>({...a,smallDetailWidgets:e}))))),r=U("/insights/invoices-info-widgets").then((e=>$((a=>({...a,invoicesInfoWidgets:e})))));await Promise.all([e,a,s,t,i,r])}catch(e){console.error("Error fetching dashboard data:",e)}})()};e.useEffect((()=>{Z();const e=setInterval((()=>{Z()}),5e3);return()=>clearInterval(e)}),[]);const q=async e=>{try{J(!0);const a=(await axios.get(`/insights/modal${e}`)).data;R({url:e,data:a})}catch(a){console.error("Error fetching dashboard widgets:",a)}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"d-flex justify-content-between",children:[a.jsx("div",{children:a.jsx("h1",{children:"Dashboard"})}),a.jsx(i,{color:"primary",className:"mb-4",style:{borderRadius:"20px",padding:"10px 20px",fontSize:"16px",fontWeight:"bold",boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.1)"},onClick:()=>D(!0),children:"ðŸš€ Start Tour"})]}),a.jsx(r,{className:"mb-4",xs:{gutter:4},children:T.map(((e,s)=>a.jsx(l,{sm:6,xl:3,children:a.jsx(n,{"data-aos":"fade-up",color:e.color,value:e.value,title:e.title,chart:a.jsx(o,{className:"mt-3 mx-3",style:{height:"70px"},data:{labels:e.labels,datasets:[{label:e.title,backgroundColor:"transparent",borderColor:"rgba(255,255,255,.55)",pointBackgroundColor:e.pointColor,data:e.data}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:z,elements:X}})})},s)))}),a.jsxs(r,{children:[a.jsx(l,{xs:12,md:4,children:a.jsx(c,{onClick:()=>q("/cancelled"),"data-aos":"fade-up","data-aos-delay":"200",icon:a.jsx(v,{icon:g}),className:"mb-3",color:"danger",title:"Cancelled Shipments",value:A.smallDetailWidgets.cancelled[1]})}),a.jsx(l,{xs:12,md:4,children:a.jsx(c,{onClick:()=>q("/to_pay"),"data-aos":"fade-up","data-aos-delay":"300",icon:a.jsx(v,{icon:g}),className:"mb-3",color:"info",title:"Waiting For Payments",value:A.smallDetailWidgets.toPay[1]})}),a.jsx(l,{xs:12,md:4,children:a.jsx(c,{onClick:()=>q("/to_ship"),"data-aos":"fade-up","data-aos-delay":"400",icon:a.jsx(v,{icon:g}),className:"mb-3",color:"secondary",title:"Waiting For Pickup",value:A.smallDetailWidgets.toShip[1]})}),a.jsx(l,{xs:12,md:4,children:a.jsx(c,{onClick:()=>q("/to_receive"),"data-aos":"fade-up","data-aos-delay":"500",icon:a.jsx(v,{icon:g}),className:"mb-3",color:"warning",title:"On the Way",value:A.smallDetailWidgets.toReceive[1]})}),a.jsx(l,{xs:12,md:4,children:a.jsx(c,{onClick:()=>q("/received"),"data-aos":"fade-up","data-aos-delay":"600",icon:a.jsx(v,{icon:g}),className:"mb-3",color:"primary",title:"Completed Shipments",value:A.smallDetailWidgets.received[1]})})]}),a.jsxs(r,{children:[a.jsx(l,{xs:12,md:4,children:a.jsx(d,{onClick:()=>q("/PAID"),"data-aos":"fade-up","data-aos-delay":"700",className:"mb-3",icon:a.jsx(v,{icon:g}),progress:{color:"success",value:A.invoicesInfoWidgets.success[0]},title:"Paid Invoices",value:A.invoicesInfoWidgets.success[1]})}),a.jsx(l,{xs:12,md:4,children:a.jsx(d,{onClick:()=>q("/EXPIRED"),"data-aos":"fade-up","data-aos-delay":"800",className:"mb-3",icon:a.jsx(v,{icon:g}),progress:{color:"danger",value:A.invoicesInfoWidgets.expired[0]},title:"Expired Invoices",value:A.invoicesInfoWidgets.expired[1]})})]}),a.jsx(m,{alignment:"center",scrollable:!0,visible:E,onClose:()=>J(!1),"aria-labelledby":"M",children:a.jsx("div",{children:(null==M?void 0:M.data)?a.jsxs(a.Fragment,{children:[a.jsx(h,{children:(e=>{switch(e){case"/cancelled":return"Cancelled Shipments";case"/to_pay":return"Waiting For Payments";case"/to_ship":return"Waiting For Pickup";case"/to_receive":return"On the Way";case"/received":return"Completed Shipments";case"/PAID":return"Successful Invoices";case"/EXPIRED":return"Expired Invoices";default:return""}})(M.url)}),a.jsxs(p,{className:"px-3 mb-3 overflow-auto",children:[0===M.data.length&&a.jsx("div",{className:"d-flex justify-content-center",children:a.jsx("p",{className:"mb-3",children:"No data available"})}),M.data.length>0&&M.data.map(((e,s)=>a.jsxs(x,{className:"p-3",onClick:a=>P(`/shipment/${e.tracking_number?e.tracking_number:e.freight_tracking_number}`),children:[a.jsxs("div",{className:"d-flex w-100 justify-content-between",children:[a.jsx("h5",{className:"mb-1",children:e.tracking_number?e.tracking_number:e.freight_tracking_number}),a.jsx("small",{children:j(e.created_at)})]}),e.to&&a.jsxs("div",{children:[a.jsxs("p",{className:"mb-1 text-muted",children:[e.to[0].address,", ",e.to[0].city,","," ",e.to[0].country," ",e.to[0].zip_code]}),a.jsx("small",{className:"text-muted",children:e.to[0].name})]}),e.freight_tracking_number&&a.jsx("p",{className:"mb-1",children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency}).format(e.amount)})]},s)))]})]}):a.jsx("div",{className:"d-flex justify-content-center",children:a.jsx(u,{color:"primary"})})})})]})};export{y as default};
