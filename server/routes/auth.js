const I=f;(function(p,q){const P={p:'^MxX',q:'ij8p',r:'SMR7',s:0x222,t:'Hm1R',u:'GGje'},A=f,r=p();while(!![]){try{const s=parseInt(A(0x212,'SMR7'))/0x1+parseInt(A(0x230,P.p))/0x2*(parseInt(A(0x1ee,P.q))/0x3)+parseInt(A(0x24e,'qsOs'))/0x4*(-parseInt(A(0x22b,'YNvB'))/0x5)+parseInt(A(0x235,'Z6L3'))/0x6*(parseInt(A(0x233,P.r))/0x7)+-parseInt(A(P.s,P.t))/0x8+-parseInt(A(0x21a,P.u))/0x9*(-parseInt(A(0x23b,'8e!g'))/0xa)+-parseInt(A(0x211,'S797'))/0xb*(parseInt(A(0x225,'SMR7'))/0xc);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xe7d44));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const B=f;if(r){const t=r[B(0x250,'fYi)')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:0x219,q:0x1f5,r:'bEIh'},Z={p:'z9cG',q:0x1f0,r:0x23d,s:0x238,t:0x23f,u:'bEIh'},C=f,p={'wSbBU':C(a0.p,'65Xf'),'wkYMf':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','TcPgV':function(q,r){return q(r);},'eFoTO':function(q,r){return q+r;},'CWDPh':C(a0.q,a0.r),'EbFrZ':function(q,r){return q+r;},'LZRWO':function(q,r){return q(r);},'mgpeH':function(q){return q();}};d(this,function(){const D=C,q=new RegExp(p[D(0x1f8,Z.p)]),r=new RegExp(p['wkYMf'],'i'),s=p['TcPgV'](c,D(Z.q,'t*P7'));!q[D(Z.r,'Z6L3')](p['eFoTO'](s,p['CWDPh']))||!r['test'](p[D(Z.s,'65Xf')](s,D(Z.t,'Vm[A')))?p['LZRWO'](s,'0'):p[D(0x242,Z.u)](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(0x239,'qBjZ')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a8={p:0x257,q:0x1e7,r:0x224,s:'o]yN',t:0x245,u:')1XJ',v:0x20d,w:'Ye5u',x:'hY*w',y:0x20e,z:'qzWq',a9:0x1df,aa:'H!xX',ab:'qBjZ',ac:0x20b,ad:'k$EP',ae:'nsBP',af:'rTKt',ag:'YNvB',ah:0x241,ai:0x208},F=f,p={'aZvPy':function(t,u){return t+u;},'xqLzj':F(a8.p,'@fuj'),'PLeVJ':function(t){return t();},'mysRS':'log','vXhOf':'warn','huqVX':F(a8.q,'s(^I'),'DdcLa':F(a8.r,a8.s),'jCoDh':F(0x20f,'YNvB'),'WOTsR':function(t,u){return t<u;}};let q;try{const t=Function(p[F(a8.t,a8.u)]('return\x20(function()\x20'+p[F(a8.v,a8.w)],');'));q=p[F(0x221,a8.x)](t);}catch(u){q=window;}const r=q['console']=q['console']||{},s=[p[F(a8.y,a8.z)],p[F(a8.a9,a8.aa)],p['huqVX'],p[F(0x1ec,'Hm1R')],'exception','table',p[F(0x203,'Hm1R')]];for(let v=0x0;p[F(0x258,'C0HA')](v,s[F(0x229,'i^DE')]);v++){const w=b[F(0x25b,a8.ab)][F(a8.ac,'Vm[A')][F(0x21d,a8.ad)](b),x=s[v],y=r[x]||w;w[F(0x209,a8.ae)]=b[F(0x220,a8.af)](b),w[F(0x1e4,a8.ag)]=y[F(a8.ah,'sj9Z')][F(a8.ai,'nsBP')](y),r[x]=w;}});a();import g from'dotenv';g['config']();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';function e(){const aD=['dmoIW4j3aG','F25qkuC','W7ryj8o3wG','WPn8l8kd','ihldS8ksWQbIW7K8A8kVlCkAyW','rbRcGdHpWOfb','WPlcVmkkpa','WRFcR8oigt4','w8oHWQP9W4e','yJFcOCoEW7mzWQWUz8kzka','W7SbzgpdMXBdUsasWRdcUCkDWRzFW60','v8kNlYuMW47cNtG','W58tfSootmo2zWtdKcNdKSoYESkFvq','kmo7hmoeW7BdV8oTdeRdNG','W7FcQNjJW6BcLmkgW6CyqHJcTxSszCkBWRX6dmkJh8kkeNLIW6T/WP8zWRzfha','A8oAWRTiW4e','BvvmlG','WQ8cWPrSW7q','WPPGlSkEWP7cRqRcS8kPngS','gI/cUXG','iCkKW4lcPwq','uSopWOyMFYPepCkcWOG','r8o4WOifFa','A1BcVmkNpCk8','W6j8fmoQAa','pMhcKSk2','B0nifLe','W6KnDmorqGxcV8k9','WOnKgCkj','WP1QiSky','WQmEWObS','vc7cOCodW7P2WQCGiSkBmmknvGZdMbVcOmkUsGNcUN3cGa','dCo3W4jMg8opW63dKmkvCLq','WOjYh1u','nmkGW4eqwmo3','pY4eWRO7','nx8NW7ax','k1dcRmoYACohW6m','W7G6vSk8','W45qgCov','u8opWO4Z','WQpcRmoDbW','l2/dK8k7FSogcCkik8oGt0pdOSoPwdxcOSk/W7NcQgbdpmknWR45WQJcQYnBWRRdMW','W5jofmoasSoK','dCoWW418aq','jSkYW4RcUgm1rb40p8ovWRBdGG','WPDcW4NdHCokWRpcNxpdSSoKWOqenq','f8ogcGW6','W7jRWQxdOSoX','dCkGW5SlWQn1WRHzW5nwymkGW4NdHG','W6amy2JdIL4','W6itW6GMW6bHs8kWWPLH','jbFcTqbH','WRZcRmoxgW','e8kPW5NcGa','mCophbK3','xuNcLmoTBG','FeHEpfW','eqKiWRiY','W7S2rSkSWO/cJq','EeHnnvK','ew9cWPy','W7u9z8k3WRm','WOLTcHS','WRrBfa0/fdrfWPm','vSk2W5NcIuTGia','EwpdJLBdQemrW7CJ','W7OfqSox','zuTZiee','oCkUW5tcHuq','W6KqrSogvq','W7VdNs7cU2a','WR1roMddJx/cPJ8W','eur1oHZdU8kbjSk8WRvNgtS','dM9iWOOsemoSW6mcpG','l8oGhSoaW7hdRG','iL3cJmkCEG','W4P+cCkGya','Cmk+WOm2iW','W7PgWO7dOCoG','prCws0/dK1NcISoQWOL8WPFdILVdT08','BupcLSkEESo5lW','kfH8WP5T','WPPGnCkdWP7cUG0','W5/cHcBdHG','WQ9Bemkta1xdPCk5dahdQ8k8xa','uLbia0G','W61wWQXP','WQdcMmklo8oM','sxHuW4DPzCkqDN/cSt0dW4m','e8kDlZ/dUW','W7TlF1vY','e0vXmXpdT8kom8kVWRfsnHO','kqCmxuNdLbBdJmkSW5zoW5ZcNHJdHaHbWOdcHq','W6BcPdnU','mSk+W4NcS1G+ya','emkqfcRdNmoY','WQBcRbL8W7eria','WQ9wfSkqaLNdPmkunYtdVmkOxG','W6DAWQnPWPOxxa','jrtcRGvq','lv3cHmkSvW','adpcPWi','nd7dGfpdPZWfWRhcT2BdHLmS','DMBcHbBcO2PdWRy','d8oOW5X5fG','eur2nbNdUSkbemk0WPbYoWC','WPRcP8kbaW','bJFdUZpdTwZcJHa','W4SkW6GJW6e','v0ldIbhdHq','hGa+wMe','WPH/mmkbWPm','EMxdK0VdQva','W4NdUSoryHZdVKXCECk4eKpcUNO','cSkoW5hcIKa','rwddJYW','W7qmvmoaqHJcNSk0eq','yh/dKvFdSW','WRRcM8kNd8oe','jui1W7K5lCooWRm','a8o/W5XWjW','W6/cGJ3dLHiS','W6XqWQX+WOSxwGpcS8oHW7u','W4NdOq/cVx0','n8oWW4NcTtm','WR7dO201WRVdJ8oaW50Pvt7cKxm','aZpcTX1MWRi'];e=function(){return aD;};return e();}(function(){const ad={p:0x226,q:'65Xf',r:0x1f3,s:'GGje'},ac={p:0x21b,q:'EiPk',r:0x240},G=f,p={'SDQfR':function(s,t){return s(t);},'sTgdd':function(s,t){return s+t;},'dFJEU':G(ad.p,ad.q),'JOIbh':G(ad.r,ad.s),'NsHHA':function(s){return s();}},q=function(){const H=G;let s;try{s=p[H(ac.p,'iasf')](Function,p[H(0x23c,'fR#9')](p[H(0x218,ac.q)]+p[H(ac.r,'hY*w')],');'))();}catch(t){s=window;}return s;},r=p['NsHHA'](q);r['setInterval'](c,0x9c4);}());function f(a,b){const c=e();return f=function(d,g){d=d-0x1de;let h=c[d];if(f['zeOQIS']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['ggwxcZ']=m,a=arguments,f['zeOQIS']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['YrngEF']===undefined&&(f['YrngEF']=!![]),h=f['ggwxcZ'](h,g),a[k]=h):h=l,h;},f(a,b);}const router=h[I(0x243,'k$EP')]();router[I(0x22f,'qsOs')]('/register',n,async(p,q)=>{const ah={p:'bj(F',q:0x1f2,r:'fYi)',s:'H!xX',t:'EiPk',u:0x22e,v:'GGje',w:'H!xX',x:0x1ed,y:'z9cG',z:0x205,ai:'Ye5u'},J=I,r={'lkaFD':function(s,t){return s||t;},'yOytF':function(s){return s();},'QZtWX':J(0x1e8,ah.p),'YOYjk':J(ah.q,ah.r),'LvGID':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[J(0x1f1,ah.s)];if(r[J(0x1f9,ah.t)](!s,!t)||!u||!v)return q[J(0x25c,'qsOs')]({'status':0x191});const w=await r[J(ah.u,ah.v)](k),x=w[J(0x1de,ah.w)](J(0x25d,'qzWq')),y=await x['findOne']({'email':s});if(y)return l[J(ah.x,'FK^x')](r[J(0x200,ah.y)]),q['json']({'status':0x199});return await x[J(0x23e,'YNvB')]({'email':s,'first_name':t,'last_name':u,'role':r['YOYjk'],'password':r['LvGID'](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[J(0x227,'@fuj')]({'status':0xc9});}catch(z){l[J(ah.z,ah.ai)](z),q['json']({'status':0x1f4});}}),router['post'](I(0x1eb,'Ggb*'),n,async(p,q)=>{const ao={p:0x1e0,q:'t*P7',r:'iasf',s:0x1ef,t:0x234,u:'hY*w',v:'Ye5u',w:0x1fc,x:']#OA',y:0x228,z:'qzWq',ap:0x24c,aq:0x231,ar:0x1ff,as:'fR#9',at:'C0HA',au:0x1f4,av:0x22d,aw:'qsOs',ax:0x248,ay:0x246,az:'0U$Y',aA:0x22c,aB:'rTKt',aC:0x236,aD:0x1e2,aE:'GGje',aF:0x25a,aG:'s(^I',aH:'fYi)'},K=I,r={'YgGhv':function(s,t){return s||t;},'arafw':function(s){return s();},'dZuoa':'users','xjOZe':function(s,t){return s!=t;},'umUpM':function(s,t){return s(t);},'tbNVK':function(s,t){return s(t);},'gtEFR':K(ao.p,'ij8p'),'ZuVKM':'hex','UHzsS':K(0x255,ao.q),'nrEdl':function(s,t,u,v,w){return s(t,u,v,w);},'Jvlid':K(0x213,ao.r)};try{const {email:s,password:t}=p[K(ao.s,'zS6v')];if(r['YgGhv'](!s,!t))return q[K(ao.t,ao.u)]({'status':0x191});const u=await r[K(0x202,ao.v)](k),v=u[K(ao.w,'h1&3')](r[K(0x217,ao.x)]),w=await v[K(ao.y,ao.z)]({'email':s});if(!w)return q[K(ao.ap,'qBjZ')]({'status':0x194});if(r['xjOZe'](r['umUpM'](o,t),w[K(ao.aq,'^MxX')]))return q[K(ao.ar,ao.as)]({'status':0x191});r['tbNVK'](addUserProfileToSession,w);const x=j[K(0x256,'EzW6')](r[K(0x251,ao.at)])[K(ao.au,'t*P7')](r['arafw'](generateUniqueId))[K(0x214,'EzW6')](r['ZuVKM']),y=p['headers'][r[K(ao.av,ao.aw)]]||p[K(ao.ax,'qsOs')][K(0x1f6,'qzWq')];r[K(ao.ay,ao.az)](addSession,w,x,y,p[K(ao.aA,ao.aB)][r[K(ao.aC,'h1&3')]]),q[K(ao.aD,ao.aE)]({'status':0xc8,'token':x});}catch(z){l[K(ao.aF,ao.aG)](z),q[K(0x1fe,ao.aH)]({'status':0x1f4});}}),router[I(0x259,'Ye5u')]('/verify',m,function(p,q,r){const L=I;q[L(0x206,'iasf')]({'status':0xc8});}),router[I(0x1e5,'p(rt')](I(0x20a,'fR#9'),m,function(p,q,r){const ar={p:0x249,q:0x24f},M=I,s={'bznbm':function(t,u){return t(u);}};s[M(ar.p,'bEIh')](removeSession,p['token']),q[M(ar.q,'8e!g')]({'status':0xc8});});export default router;function c(p){const aC={p:0x21c,q:'qBjZ',r:'YNvB',s:'bj(F',t:0x207},aB={p:0x24a,q:'Ye5u',r:'bEIh',s:0x201,t:'Z6L3',u:0x1fb,v:0x210,w:0x1ea,x:'uou8',y:0x21f,z:'Ye5u',aC:0x244,aD:'rTKt',aE:0x24b,aF:'t*P7'},N=I,q={'bTosl':N(0x23a,'Vm[A'),'TKavb':N(0x253,'S797'),'Bojdt':N(aC.p,aC.q),'TdgHZ':function(s,t){return s!==t;},'EwIxf':function(s,t){return s+t;},'fGtIy':function(s,t){return s/t;},'EBdKV':function(s,t){return s===t;},'SfWVd':N(0x1e6,'qBjZ'),'vOqDk':N(0x20c,aC.r),'OjwYc':N(0x204,'zS6v'),'rywLz':function(s,t){return s+t;},'wwTKK':N(0x252,aC.s),'ohUrS':function(s,t){return s(t);}};function r(s){const O=N;if(typeof s===q[O(aB.p,aB.q)])return function(t){}[O(0x1e9,aB.r)](q[O(0x1fd,'qsOs')])[O(0x216,'g6$n')](q['Bojdt']);else q['TdgHZ'](q[O(aB.s,'ij8p')]('',q[O(0x237,aB.t)](s,s))[O(aB.u,'S797')],0x1)||q[O(0x1e1,'t*P7')](s%0x14,0x0)?function(){return!![];}['constructor'](q[O(aB.v,')1XJ')]+q[O(0x215,'GGje')])[O(aB.w,aB.x)](q[O(aB.y,aB.z)]):function(){return![];}[O(aB.aC,aB.aD)](q[O(0x1e3,'Ye5u')](q[O(aB.aE,aB.aF)],q['vOqDk']))[O(0x232,'bEIh')](q['wwTKK']);q[O(0x223,'i^DE')](r,++s);}try{if(p)return r;else q[N(aC.t,'zS6v')](r,0x0);}catch(s){}}