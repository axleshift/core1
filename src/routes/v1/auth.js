const H=f;function f(a,b){const c=e();return f=function(d,g){d=d-0x1c5;let h=c[d];if(f['NBmHzh']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['sVrSLz']=m,a=arguments,f['NBmHzh']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['RQGLRl']===undefined&&(f['RQGLRl']=!![]),h=f['sVrSLz'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(p,q){const R={p:0x25a,q:'VaO$',r:'2cg1',s:0x255,t:0x256,u:0x1f6,v:'Y0s@',w:0x1ea,x:'F^qC',y:'f6Hw',z:'z$fX',A:0x246,S:'Q$M*'},B=f,r=p();while(!![]){try{const s=-parseInt(B(R.p,R.q))/0x1+-parseInt(B(0x214,R.r))/0x2*(-parseInt(B(R.s,'nv[@'))/0x3)+-parseInt(B(R.t,'aFt9'))/0x4+parseInt(B(R.u,')UUs'))/0x5+parseInt(B(0x211,R.v))/0x6*(-parseInt(B(R.w,R.x))/0x7)+parseInt(B(0x1ed,R.y))/0x8*(parseInt(B(0x1e9,R.z))/0x9)+-parseInt(B(R.A,'VKMf'))/0xa*(-parseInt(B(0x22b,R.S))/0xb);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xca291));const d=(function(){const S={p:0x23d};let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(S.p,'8Tou')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());function e(){const aE=['fmkZW55NWPdcPmkmWPelvmkz','W49FWPZdG0BcIcpcMH4','ggq6bWfMW5LNFa','ACkmW5DJ','WRpcMSokWPjxWQ3cNCkAiq','WRS+W4tcVSkRW5rrb8o+W5zZwmoFWOL8','WO/cPr7cIIq','W5tcRgiHu8oWW7JcNSkqkhxcJhu4W59h','WONcQCobzG','W6LDv8kg','wCoUWO8lW4e','lSolemo9AchdJr/dNCoWWQddPKa','W5lcQsBdHcq','j3XdW63dQfpdSgLOrSoOEmoM','DNFcHmoN','W4u4W6HNW4i','W7xdR8o8eeK','trFcN8kB','zbFdQSkGWQf/','jbddUSoE','W5hcOHNdSIb4W7FdKLNcIaO/AgDbvuSEWQPYxXxdMSoaBtXLW41hcLlcTwhcLrj2W6e','WRbNW4pcPCkSW5a','FxpcICoVba0y','qhKCt8o9','W6DRW7jGW7TU','W6zHW6v+W6X0ESo9W5ddJmkvWR7dMcVdP146cJC','ymkPWO7dTWS','WR3dHGe','zJaAWQZcPru','gSkBWQL8Cq','W5tdK8oBWOf2','WRtcMWneW74','dbiLF2G','WOeIfNCD','WQtcHYTs','wsDOkYrI','BmoDW5Ldra','W73dQSo4fW','B8kEW4T5W6yWw8otvW','aCk2amoGWQns','W4VdUmkBmevYWPr8cW0NW4q','g8k+WOzsEG','qCoIW4b5CG','tw4skYNdSmkjF3zjuNxcHG','W7pcUSkjuSkakIucWQ8s','W7v0W6fNW6C','WPLTW61ysSoZ','W6moW7LpW4JcJSkBW5bS','W4BcVh82','p8kDWPXnxW','W7FcT8kuce0','W59NW61XWRebW7e4ka','rJzNocv5','WORcRCoCCqOVWRnV','WRdcLJLBWQ9BWQVcKsW','W4HYW6D3','FseAWRZcTrtcTG','ECkls8kTigdcKrxdNq','ku9HkSoUW4a','W6VcSCkSjNKkbSozCW','W4GWW6TrW4i','axbJzq','bmkoWQXau8kdWRVdSSongf8','W6hcVmkqrmkA','WQlcKsbe','WOTBhCoyWQe','W5tcQmkJBa7cRuFdJa','W6DHW79V','WP4hW4pdT3pcNalcNcGh','WPtcRGpcKcrlWRldKCk3W5L3WRxdMa','zWHUFmor','fs8KzgtcUNzyWRVdP8on','cI92WQW','tH3cHCkwbxO','WOtcPaRcHG','hY4SEa','WPZdJq/dUwPkWO/dMHufoNpcVmkcetjnafRcPmov','W6FdTSoKdq','W7tcSW7dOcnY','W5NdRCkaBJa','W5KQWRuucSk3oCozWO9ZvSotW6a','WRzPoSoPWO3cQa','W6JdG8kqWPTjWQJcUCkFpKVcLG','W4G+W5PjW5xcK8kAW6G','WRtdKWNdTh8','WOpdJ8ktBay','ACk4W5jaW6a','udxdNmkmWOW','W5HMW4ncW7C','WRfYcmoPWORcSGSd','u8oZWO8LW5hcNq','W41ICCk2WRm','W53dPCk/WPjS','rCoiW74hbCo7W6NdKSopl3JdPmoN','W6Kya34H','DCktWR7dNZC','gwz4FSozgrP6WQaFF8kWWOGeWRb6W4LSAG','fmkiWQHvqSkPWPhdUCoBeW','WRZcSCkUW5ucW6r9aa49p8kD','W4RdM8kuwcu','fJLkzW','wWHFCSor','W6tcTSkXj0qqla','gHbfWPCM','WQtcLIrcW47cOa','AmkCWRzzWPFcGW','AmoFW5TatW','kmohgmo+zf7cGJldQ8oPWOu','WP0ynNWeACoA','WRldSfpcUwiGWRFdJWhcIZqlvq','WPddR8kQCtO','W5ldMmkhtGjK','DG7dGmkhWQu','W7SNWPhdOmoPWPDejSo0W6PZhW','W7lcPGtdPq','ACkatCk6iW','W6NdKh1nWRW','W5pdHmk4WRfp','W4XkW79yW68','bmkFWQnq','W7Hrv8kg','zxNcM8o/','tbhcN8kmhMBcGW7dUHiM','WQZdVIC6','C8kqW4T5','nXddP8ozWQ5UnIreWPFcPG','W5yIW6zt','kXHUrvO','WQxdOIyNxCo8W7i','EWBdPCkZWQbK','WRldS8kxAYJcMW','W5fOvmkuWOm','W6lcQWVdQdK','m8onqg8','CSk6W4PUW7q','kSoFcLBdPSoIWQhcTCoTDCo1duL9Et/dUGjQcSkyemkmWOPeW70LW4D7WOtcGvq','W7ZdV8oTl3K','hSkNd8oZWQjj','ySkCW7XkW50','W4NdUmkNcSoux2nCW7GSWPjKmJBcLgRcVhRcRmoVw2hcVN3dRSk7xConwhldM8kht8kL','CZbTjIa','W5S4f3q/','wuyFyG','WRnPW7PeEW','zN7cICk5veK','WRhdIH7dVxvx','WQpcJs5tW5u','WPDIW47cUSkk','W7xcPHNdTq','hxrMmSov','W7HbW6LPWPG'];e=function(){return aE;};return e();}(function(){const Z={p:0x1f0,q:'aFt9',r:'Q$M*'},Y={p:0x206,q:'aFt9',r:0x1ef,s:'yVPu'},D=f,p={'madHG':D(Z.p,'PS[F'),'cJDnf':D(0x24d,'2cg1'),'qErcM':D(0x1d6,Z.q),'mgrzw':function(q,r){return q+r;},'cSqsK':function(q,r,s){return q(r,s);}};p[D(0x23e,Z.r)](d,this,function(){const E=D,q=new RegExp(p[E(Y.p,'VKMf')]),r=new RegExp(E(0x1dd,'Q4#e'),'i'),s=c(p['cJDnf']);!q['test'](s+p[E(0x1d8,'1x(P')])||!r[E(0x1e6,Y.q)](p['mgrzw'](s,E(Y.r,Y.s)))?s('0'):c();})();}());const b=(function(){let p=!![];return function(q,r){const a0={p:'LAHz'},s=p?function(){const F=f;if(r){const t=r[F(0x1c6,a0.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a8={p:0x249,q:'eQ9!',r:'a!7&',s:0x22f,t:'UrBF',u:'a!7&',v:'63z$',w:'1x(P',x:0x1e1,y:'SB]9',z:0x1da,A:'C*O%',a9:'wQLS',aa:')P]^',ab:0x21c,ac:')4m$',ad:0x242,ae:0x23c,af:'wQLS'},G=f,p={'VIAzQ':function(t,u){return t(u);},'zRohx':function(t,u){return t+u;},'uhKKF':G(a8.p,a8.q),'WTklF':function(t){return t();},'acDGd':'warn','YpvhD':G(0x234,a8.r),'kfzVe':G(a8.s,a8.t),'uTkTU':G(0x222,'Q5fj'),'XNnSq':function(t,u){return t<u;}};let q;try{const t=p[G(0x245,'f6Hw')](Function,p[G(0x209,a8.u)](p[G(0x21b,a8.v)],'{}.constructor(\x22return\x20this\x22)(\x20)')+');');q=p[G(0x1e8,'msay')](t);}catch(u){q=window;}const r=q['console']=q[G(0x1d2,'mR#v')]||{},s=['log',p[G(0x1dc,a8.w)],p[G(a8.x,a8.y)],p[G(a8.z,a8.A)],p['uTkTU'],G(0x225,a8.a9),'trace'];for(let v=0x0;p[G(0x1c8,a8.aa)](v,s[G(0x21d,'h]oH')]);v++){const w=b[G(0x1cf,'Ry&v')][G(a8.ab,'msay')][G(0x1ca,'!b(9')](b),x=s[v],y=r[x]||w;w[G(0x218,'wQLS')]=b[G(0x1fa,a8.ac)](b),w[G(a8.ad,'#F]B')]=y[G(a8.ae,a8.af)][G(0x1d7,'@dHG')](y),r[x]=w;}});a();import g from'dotenv';g[H(0x252,'$]tk')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';(function(){const ad={p:0x1d9,q:'[DJq'},ac={p:'VC[*',q:0x202,r:')P]^'},I=H,p={'tZQNY':function(s,t){return s(t);},'cyFrE':function(s,t){return s+t;},'uFOHG':I(ad.p,ad.q),'amKSq':function(s){return s();}},q=function(){const J=I;let s;try{s=p[J(0x250,ac.p)](Function,p[J(0x208,'#1g0')](J(ac.q,ac.r)+p['uFOHG'],');'))();}catch(t){s=window;}return s;},r=p[I(0x259,'z*9H')](q);r['setInterval'](c,0x9c4);}());import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../components/password.js';const router=h[H(0x1d4,'Q$M*')]();router[H(0x236,'C*O%')]('/register',async(p,q)=>{const ai={p:0x235,q:0x229,r:'#1g0',s:0x223,t:'EblJ',u:0x20b,v:0x226,w:'eQ9!',x:0x21a,y:'VKMf',z:0x1d3,A:0x205,aj:0x1ec,ak:'1x(P',al:0x219,am:'PS[F',an:'mR#v',ao:0x217,ap:'SB]9',aq:'wQLS',ar:'aFt9',as:'VaO$',at:0x23a,au:'#F]B',av:0x224,aw:0x1c7,ax:0x210,ay:'p66#',az:'!b(9',aA:0x22f,aB:'UrBF',aC:'@wBi'},K=H,r={'HgQyi':K(ai.p,'8Tou'),'lDKfL':function(s,t){return s<t;},'xAfTG':'Password\x20must\x20be\x20at\x20least\x208\x20characters\x20long\x20and\x20contain\x20letters,\x20numbers,\x20and\x20symbols.','GVWXX':function(s,t){return s!=t;},'yKZQN':'Password\x20does\x20not\x20match','SjLEs':function(s){return s();},'TqlkS':'users','XhFYr':K(ai.q,ai.r),'VrwoV':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(!s||!t||!u||!v||!w)return q[K(ai.s,ai.t)](0x190)[K(ai.u,ai.r)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(0x219,'PS[F')](s))return q['status'](0xc8)[K(ai.v,ai.w)]({'error':r[K(ai.x,'VKMf')]});if(r[K(0x212,ai.y)](v[K(ai.z,'z*9H')],0x8))return q[K(ai.A,')UUs')](0xc8)[K(ai.aj,ai.ak)]({'error':K(0x1fd,'aFt9')});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/[K(ai.al,ai.am)](v))return q['status'](0xc8)[K(0x1cd,ai.an)]({'error':r[K(0x238,'@wBi')]});if(r[K(0x240,'z*9H')](v,w))return q[K(ai.ao,ai.ap)](0xc8)[K(0x1d0,ai.aq)]({'error':r['yKZQN']});const x=await r[K(0x1f5,ai.ar)](k),y=x['collection'](r[K(0x1e5,ai.as)]),z=await y['findOne']({'email':s});if(z)return l['error']('Email\x20id\x20already\x20exists'),q[K(ai.at,ai.au)](0x199)['send']();return await y[K(ai.av,'63z$')]({'email':s,'first_name':t,'last_name':u,'role':r[K(ai.aw,'f6Hw')],'password':r['VrwoV'](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(ai.ax,ai.ay)](0xc9)[K(0x1f2,ai.az)]();}catch(A){l[K(ai.aA,ai.aB)](A);}return q[K(0x258,ai.aC)](0x1f4)[K(0x1c9,'VKMf')]();}),router[H(0x1cb,'pT]*')]('/login',n,async(p,q)=>{const an={p:0x1c5,q:0x203,r:'SVSB',s:0x207,t:'zeZ)',u:0x24e,v:'UrBF',w:0x1f9,x:'Y0s@',y:0x24a,z:0x22a,A:'#F]B',ao:'8Tou',ap:0x24c,aq:0x221,ar:0x1ee,as:')P]^',at:0x22e,au:'xkS7',av:0x20c,aw:'T4rZ',ax:0x253,ay:'Y0s@'},L=H,r={'pWQAP':function(s,t){return s||t;},'YVAfL':function(s){return s();},'YrCar':L(an.p,'Q5fj'),'bvkiU':function(s,t){return s!=t;},'NFFEY':L(0x1e2,'pT]*'),'kwrbR':L(0x204,'8Tou'),'LOiVO':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[L(0x233,'yVPu')];if(r[L(an.q,an.r)](!s,!t))return q['status'](0x190)['send']();const u=await r[L(an.s,an.t)](k),v=await u[L(0x22d,'F^qC')](r[L(an.u,an.v)])[L(0x24f,'63z$')]({'email':s});if(!v)return q['status'](0x194)[L(0x25b,'aFt9')]();if(r[L(an.w,'C*O%')](o(t),v[L(0x21e,an.x)]))return q['status'](0x191)['send']();const w=j[L(an.y,'VKMf')](r[L(an.z,an.A)])[L(0x237,'aFt9')](generateUniqueId())[L(0x1e3,an.ao)](r[L(an.ap,'@wBi')]),x=p[L(an.aq,')UUs')][L(an.ar,'VaO$')]||p[L(0x201,an.as)][L(an.at,'yVPu')];return r[L(0x213,an.au)](addSession,v,w,x,p[L(0x1ff,'pT]*')]['user-agent']),q[L(an.av,'h]oH')](0xc8)[L(0x1e0,an.aw)]({'token':w});}catch(y){l[L(an.ax,an.au)](y);}return q['status'](0x1f4)[L(0x1f1,an.ay)]();}),router[H(0x1fc,'Ry&v')]('/verify',m,function(p,q,r){const ao={p:0x251},M=H;return q[M(ao.p,'#1g0')](0xc8)[M(0x1ec,'1x(P')]({'email':p['email'],'role':p['role']});}),router[H(0x1ce,'1x(P')](H(0x20a,'nv[@'),m,async function(p,q,r){const ap={p:0x1fe,q:'VaO$',r:0x20e,s:'C*O%',t:0x215,u:'Q4#e',v:'1x(P',w:0x22c},N=H;try{const s=await getUser(p[N(0x1e4,'#1g0')]);return q[N(ap.p,ap.q)](0xc8)[N(ap.r,ap.s)]({'user':{'email':s[N(0x248,'SVSB')],'first_name':s[N(ap.t,ap.u)],'last_name':s[N(0x20f,ap.v)]}});}catch(t){l['error'](t);}return q[N(0x243,'z$fX')](0x1f4)[N(ap.w,')P]^')]();}),router['post']('/logout',m,function(p,q,r){const ar={p:'2cg1',q:'Q4#e',r:0x1fb,s:'z*9H',t:0x25b,u:'aFt9'},O=H,s={'TOMVE':function(t,u){return t(u);}};return s[O(0x1d1,ar.p)](removeSession,p[O(0x228,ar.q)]),q[O(ar.r,ar.s)](0xc8)[O(ar.t,ar.u)]();});export default router;function c(p){const aD={p:0x1db,q:'msay',r:0x232,s:0x241},aC={p:0x1f3,q:'z$fX',r:')4m$',s:')P]^',t:0x244,u:'!b(9',v:'wQLS',w:0x257,x:0x230,y:'pT]*',z:0x1df,A:0x23b,aD:'f6Hw',aE:0x23f,aF:'1x(P',aG:'nv[@',aH:0x20d,aI:0x227},P=H,q={'yiaZe':function(s,t){return s===t;},'sLlCR':'counter','WZHTg':function(s,t){return s!==t;},'lJJjB':function(s,t){return s/t;},'Ycdyq':P(aD.p,'p66#'),'psHnw':function(s,t){return s%t;},'KPmvW':function(s,t){return s+t;},'GOflN':P(0x231,'VC[*'),'yYbFJ':P(0x220,aD.q),'uorfP':P(aD.r,')4m$'),'jGjMY':function(s,t){return s+t;},'LbRIi':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(aC.p,aC.q)](typeof s,'string'))return function(t){}[Q(0x1cc,aC.r)]('while\x20(true)\x20{}')[Q(0x216,aC.s)](q[Q(0x200,'T4rZ')]);else q[Q(aC.t,aC.u)]((''+q['lJJjB'](s,s))[q[Q(0x1de,'h]oH')]],0x1)||q[Q(0x1f8,aC.v)](q[Q(aC.w,'Q$M*')](s,0x14),0x0)?function(){return!![];}[Q(aC.x,'a!7&')](q[Q(0x1d5,'!b(9')](q[Q(0x1e7,'EblJ')],q['yYbFJ']))[Q(0x1f7,aC.y)](q[Q(aC.z,'nv[@')]):function(){return![];}[Q(aC.A,aC.aD)](q[Q(aC.aE,aC.aF)](q[Q(0x247,aC.aG)],'gger'))[Q(aC.aH,'xkS7')](Q(aC.aI,'VKMf'));r(++s);}try{if(p)return r;else q[P(aD.s,')P]^')](r,0x0);}catch(s){}}