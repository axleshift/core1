const I=f;function f(a,b){const c=e();return f=function(d,g){d=d-0xeb;let h=c[d];if(f['ECTbQP']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['QSWbUr']=m,a=arguments,f['ECTbQP']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['YUvckc']===undefined&&(f['YUvckc']=!![]),h=f['QSWbUr'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(p,q){const R={p:0x168,q:0xfe,r:'UQaO',s:0x10e,t:0xf3,u:0x110,v:'0fpr'},B=f,r=p();while(!![]){try{const s=parseInt(B(R.p,'aejV'))/0x1*(parseInt(B(R.q,R.r))/0x2)+parseInt(B(R.s,'T1[H'))/0x3+-parseInt(B(R.t,'aejV'))/0x4+-parseInt(B(R.u,'KmG5'))/0x5+-parseInt(B(0x15c,'dqpo'))/0x6+-parseInt(B(0x124,R.v))/0x7+parseInt(B(0x160,'yU9#'))/0x8;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xd6528));const d=(function(){let p=!![];return function(q,r){const s=p?function(){const C=f;if(r){const t=r[C(0x14b,'UQaO')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a1={p:0x144,q:'K^KD',r:0x154,s:'8%]4',t:0xff,u:'pzDB'},a0={p:'a27s',q:'szHg',r:'gJRf',s:0x103,t:0xf4,u:'0%k2',v:0x14f,w:0x18a,x:'c3kL',y:0x12b,z:'V8o3',A:0x17f,a1:'BJKO'},D=f,p={'MHkiN':D(a1.p,a1.q),'MOcGC':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','kWSvT':function(q,r){return q(r);},'rdfpC':D(a1.r,a1.s),'TzrHW':function(q,r){return q+r;},'TLwuH':D(a1.t,'yIjd'),'mpPCb':function(q){return q();},'UrwJa':function(q,r,s){return q(r,s);}};p[D(0x146,a1.u)](d,this,function(){const E=D,q=new RegExp(p[E(0x165,a0.p)]),r=new RegExp(p[E(0x172,a0.q)],'i'),s=p[E(0x131,'yIjd')](c,p[E(0x100,a0.r)]);!q[E(a0.s,'qa&K')](p[E(a0.t,a0.u)](s,E(a0.v,'f0U9')))||!r[E(a0.w,a0.x)](p[E(a0.y,a0.z)](s,p[E(a0.A,'&A4H')]))?s('0'):p[E(0x13b,a0.a1)](c);})();}());const b=(function(){let p=!![];return function(q,r){const a2={p:'Mref'},s=p?function(){const F=f;if(r){const t=r[F(0x16b,a2.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ab={p:0x113,q:0x174,r:'&A4H',s:0x13a,t:'gJ9y',u:0x13f,v:'FvUY',w:0x188,x:'V8o3',y:'dqpo',z:0x101,A:'KXeZ',ac:0x17e,ad:'ym*)',ae:0x115,af:'8%]4',ag:0x11d,ah:'yIjd',ai:0x12c},aa={p:0x149,q:0x133,r:0x157,s:'KmG5'},G=f,p={'MYFvw':function(u,v){return u(v);},'adsak':function(u,v){return u+v;},'UeadA':function(u,v){return u+v;},'yjexV':'warn','AwMwb':G(0x13c,'[fb!'),'QOFhm':G(ab.p,'Q2E9'),'vcfsG':G(ab.q,ab.r),'vyFrB':G(ab.s,ab.t),'cGpLp':function(u,v){return u<v;}},q=function(){const H=G;let u;try{u=p['MYFvw'](Function,p[H(aa.p,'GUwe')](p[H(aa.q,'KXeZ')](H(aa.r,aa.s),H(0x16f,']z(]')),');'))();}catch(v){u=window;}return u;},r=q(),s=r[G(ab.u,ab.v)]=r[G(0x15b,'KXeZ')]||{},t=[G(ab.w,'xDiw'),p['yjexV'],p[G(0x175,ab.x)],p[G(0x111,ab.y)],p[G(ab.z,'T1[H')],G(0x189,ab.A),p[G(ab.ac,ab.ad)]];for(let u=0x0;p[G(0x128,'9ESm')](u,t[G(0x12d,'ym*)')]);u++){const v=b[G(0x13d,'GUwe')][G(ab.ae,ab.af)][G(0xec,'8%]4')](b),w=t[u],x=s[w]||v;v['__proto__']=b[G(ab.ag,'V8o3')](b),v[G(0x132,ab.ah)]=x[G(0x127,'ym*)')][G(ab.ai,'aejV')](x),s[w]=v;}});a();import g from'dotenv';g[I(0xf6,'BJKO')]();import h from'express';(function(){const af={p:0x176,q:0x17b,r:'W5sa',s:0x158,t:'UQaO',u:0x122,v:'0fpr',w:0x140,x:'KXeZ'},J=I,p={'qDWfP':function(r,s){return r(s);},'gGJMl':function(r,s){return r+s;},'CZYdv':J(af.p,'9ESm'),'ZAKJU':function(r){return r();}};let q;try{const r=p[J(af.q,af.r)](Function,p[J(af.s,af.t)](J(0x139,'yU9#')+p[J(0x14d,'xoG8')],');'));q=p[J(af.u,af.v)](r);}catch(s){q=window;}q[J(af.w,af.x)](c,0x9c4);}());import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[I(0x186,'H5@z')]();router[I(0xf7,'kl47')](I(0x14c,'KXeZ'),async(p,q)=>{const ak={p:0x135,q:'GUwe',r:0x138,s:0x155,t:'r5hb',u:0x109,v:0xf8,w:'xoG8',x:0x118,y:'kl47',z:0x164,A:'yU9#',al:'8X96',am:'Mref',an:0x181,ao:'Q2E9',ap:0x141,aq:0x183,ar:'xDiw',as:'[fb!',at:'ZCWt',au:0x116,av:'W5sa',aw:0x147,ax:0x10d,ay:'Mref',az:'f0U9',aA:0x173,aB:'xDiw',aC:0x14a,aD:'Mref',aE:0xeb,aF:'UQaO',aG:0x184,aH:0x121,aI:'pzDB',aJ:0x12f,aK:0x15e},K=I,r={'NCxfE':function(s,t){return s||t;},'FemKw':K(0xf1,'T1[H'),'Hrfnr':K(ak.p,ak.q),'Oplfq':function(s,t){return s!=t;},'kXXDa':'Password\x20does\x20not\x20match','puOfq':function(s){return s();},'UopbO':K(ak.r,'H5@z'),'GlgiI':'Email\x20id\x20already\x20exists','bIEat':K(ak.s,ak.t),'idQZg':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[K(ak.u,'ym*)')];if(r[K(ak.v,ak.w)](!s,!t)||!u||!v||!w)return q[K(ak.x,ak.y)](0x190)[K(ak.z,ak.A)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(0xfa,ak.al)](s))return q[K(0x14e,ak.am)](0xc8)[K(ak.an,ak.ao)]({'error':r[K(ak.ap,'a27s')]});if(v['length']<0x8)return q[K(0x17c,'0%k2')](0xc8)[K(0xf0,'0%k2')]({'error':r[K(ak.aq,'c3kL')]});if(r[K(0x112,ak.ar)](v,w))return q[K(0x123,ak.as)](0xc8)['json']({'error':r[K(0x178,ak.at)]});const x=await r[K(0x162,'GUwe')](k),y=x[K(ak.au,ak.av)](r[K(ak.aw,'W5sa')]),z=await y[K(ak.ax,ak.ay)]({'email':s});if(z)return l[K(0xee,ak.az)](r[K(ak.aA,'K^KD')]),q['status'](0x199)['send']();return await y[K(0x143,ak.at)]({'email':s,'first_name':t,'last_name':u,'role':r[K(0x13e,ak.aB)],'password':r[K(ak.aC,ak.aD)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(ak.aE,ak.aF)](0xc9)[K(ak.aG,'kl47')]();}catch(A){l[K(ak.aH,ak.aI)](A);}return q[K(ak.aJ,'FvUY')](0x1f4)[K(ak.aK,'T1[H')]();}),router[I(0x10f,'Q2E9')](I(0x170,'r5hb'),n,async(p,q)=>{const aq={p:0x114,q:0x148,r:'0fpr',s:0x145,t:0x106,u:'T1[H',v:0x152,w:'qa&K',x:0xfd,y:0x159,z:'GUwe',A:0x15d,ar:'W5sa',as:0x156,at:'&A4H',au:0x102,av:0xf9,aw:'f0U9',ax:'8X96',ay:0x134,az:0xf2,aA:'y^88',aB:0x12a,aC:'gJ9y',aD:0x119,aE:'KmG5',aF:'gJRf',aG:'xDiw',aH:0xee,aI:'dqpo'},L=I,r={'bKcYN':function(s,t){return s||t;},'KJBve':L(aq.p,'V8o3'),'VfFBk':function(s,t){return s!=t;},'VmjSZ':function(s,t){return s(t);},'ZCAQG':function(s,t){return s(t);},'BkXcV':'sha256','VxJYz':function(s){return s();},'UtbHG':L(aq.q,aq.r),'UhlIb':L(aq.s,'0%k2'),'MWdez':L(aq.t,'szHg')};try{const {email:s,password:t}=p[L(0x126,aq.u)];if(r[L(aq.v,aq.w)](!s,!t))return q[L(aq.x,'r5Gf')](0x190)['send']();const u=await k(),v=u['collection'](r[L(aq.y,aq.z)]),w=await v[L(aq.A,'y^88')]({'email':s});if(!w)return q[L(0x182,'T1[H')](0x194)[L(0x11a,aq.ar)]();if(r[L(aq.as,aq.at)](r[L(aq.au,'f0U9')](o,t),w[L(aq.av,aq.aw)]))return q['status'](0x191)[L(0x17d,aq.at)]();r[L(0x108,aq.ax)](addUserProfileToSession,w);const x=j['createHash'](r[L(aq.ay,'z((b')])[L(0x104,'xDiw')](r['VxJYz'](generateUniqueId))['digest'](r[L(aq.az,aq.aA)]),y=p['headers'][r[L(aq.aB,aq.aC)]]||p[L(aq.aD,aq.aE)][L(0x150,'0%k2')];return addSession(w,x,y,p[L(0x136,aq.aF)][r[L(0x153,aq.aG)]]),q['status'](0xc8)['json']({'token':x});}catch(z){l[L(aq.aH,'f0U9')](z);}return q[L(0x10a,aq.aI)](0x1f4)[L(0x179,'c3kL')]();}),router[I(0x185,'X5N^')](I(0x107,'gJ9y'),m,function(p,q,r){const ar={p:'GUwe',q:0x180,r:0x11e},M=I;return q[M(0x16c,ar.p)](0xc8)[M(ar.q,'0fpr')]({'email':p[M(ar.r,'aejV')]});}),router[I(0x151,'W5sa')](I(0x12e,'xDiw'),m,async function(p,q,r){const at={p:0xef,q:0x16a,r:'[fb!',s:'r5hb'},N=I,s={'SHnmG':function(t){return t();},'fMIPf':N(0x17a,'KmG5')};try{const t=await s[N(at.p,'xoG8')](k),u=t['collection'](s[N(0x129,'yU9#')]),v=await u['findOne']({'email':p[N(0x137,'&A4H')]});return q['status'](0xc8)['json']({'user':{'email':v['email'],'first_name':v[N(at.q,at.r)],'last_name':v['last_name']}});}catch(w){l['error'](w);}return q[N(0x120,at.s)](0x1f4)['send']();}),router[I(0x11b,'0fpr')]('/logout',m,function(p,q,r){const au={p:0x15a,q:'X5N^',r:'a)1V',s:0x161,t:'ZCWt'},O=I;return removeSession(p[O(au.p,au.q)]),q[O(0x16e,au.r)](0xc8)[O(au.s,au.t)]();});export default router;function e(){const aF=['oCoXtmkeWRe','x8kXW7lcPa','ymkzWRpdRCoXW60','WQPsmCkrWOu','WRlcJwPfWRj1','WQHNW53cPq','WQrxW6VcOCo8','WRTVW6VcO8oAWOZcUbe','W54zWRjQoq','W5u2WPzoW4q','vJBcR0ldOJewWQLDW5bYW43cG2ddNCkiD8kOW557E8o7WQ7dKxfPqIdcLNpcQmoNWRrfxmoQW74','l8k6WRaXWQhcLCkW','zmk+WOpcHCkh','W4GVbSoyhq','W7VdTmopbCoFcmkoW6hcVSooW6tcSCkYdmkiWRRdG8oIFq','W43cHmocwCkL','W5dcPZXdla','WQLlWQX2','ztJcSKldOsWrWQ4jW5j1','W6DUb8kvWOm','WQlcLMvcWQHQW64','W7GzWQDhfSoOWOJdVmodjYC','mrVdHMiH','CSoDW4FdHmomCmkiW5n/uSkd','rgFcVxPpWPCafaq','WRSkWObBoSo4W55UW5JdIhGKaSootWu','omkMW5FcRmkwWPBcQCorjuvyWPqGfmkv','WO/cRuG1cW','vmogW5BdKSoM','W400Eq','zZpcR1ddVG','WPGBbLTo','t8o4WQpdOee','WQqoWRzPeCoVWPNdQ8oh','hbiCtmkE','WOilnNvCW7a','W6ZcJNLfWRi','mSoUW5ZcRmkqWOtcICohjvjzW4O1','CCogW5xdHa','W4VdOmoLigu','W4HWjSkrWO0','ethdQmoG','nszgW74','v8k1WQtcRSka','W57cR8ozu15BeHBdRW3dQIeEWQpcN8k6yd9I','sCopWPNdGvq','tr3cNKFdSa','WR80WQ8Oea','W6GtWR19f8oWWOG','y8oZWRldQCoPWPpdL8kyWOhcScZdHmkH','WQ5TWQ5EWPGfiq','DSk0gMK','ruFcMXPMpcH/fd5sDCo/','WRJcP8kjsmkFvSkCW73cTSo+W6NcLSkJla','xMZcOhS','DIlcK1FdPa','bg7cK8k5W5G','W7RdTmovfa','oJBdGeay','AN90h8ozWPRdTConcrFcUSk8','W6ZcIxzFWQG1ffaRrey','dmkzW7RcKmo0yYG','y8koWRxdRSoS','WQzmWRHQW45ku1KOhW','WPapj21q','DspcVuxdOc0','lb9iW5RcIG','W4GEW7zKnCke','FvtcUSk/WPSOWOjhgCkVjw8gWRv3lCkWWRlcISoUEmo1WPyjW48lBgldNSovW5BdQG','BZLmW6VcQ8kt','WQnkWQrQW45NsfSXfCkQ','W6v+WRBdQdW','WPOtWOLrbW','zmkRWOhcICkBCSk1W4zk','lmo8C8k7WOq','lmoRW57dHmkPW7pcQXvZWRHdW4ZcThBdSmkUW7/cGmkFWOXzWOvEeH3dPmkSWQRcQCoavre','W7GiWQfNfSo7','rLhcLLTC','xmkvimon','W5NcUCoivf8','CmoTW7hdLSo5','m8o/W5dcT8krWPi','CSk2WOZcIa','ESkfWPVdUmoh','vCkFWPxcMCkJ','W48IBJi','WQrtW6ZcSq','DSkLfxKCW6G','z8kckmohWOG','W4VcNmkpW7S','WRS0WRC5','W68ZfSoEc2S','W6hdM8oclMW','W6Lijq','W78DWRfIhq','w8kvpCoD','xCo8WRldUe1h','gJBdR8oW','y0RdPCkkWRy','W6RcLgPdWQ4','daaRrCkV','kSo4W57cRq','tmk/aMWfW7jNh8kUk1WyyCkxW6fJy3ZcTYhcQq','WP1WWQjYWPa','cmoVWQ3dT8ksndeNvd7cKCkS','fmoXW4pcI8kZ','WRXQW6BcH8kY','W57cUajMj3m','W4JcLSksW6S','eqS9tSkT','W7/cH2TFWQSOe1C','rbxcTfm','W5FdNw3dS8ks','W7CXfSoYkG','jvhcMSkfW6ddQW','h8k/W6FcTqSaWRNdQha4WPfEpW','WQzUW4JcOSoC','nCk7WRCLWOC','C8kYeN4U','W5NcI3j/WOy','W53dJSo1dq','W7bxjSkvWOnA','W7hdGKZdKSkE','W51cWRddNvlcRh8CWPxcGa','WPBcGmogsmkPWPtcJa','AJpcHNBdIW','BSktWRNdSW','kCkYW6lcQ8kLW5y','uCkcpKOZ','mmk3WRG5WQhdH8oRW5NdRZZcPCkYu3mW','WPCwowvMW61N','n8oJqZrDWQ0ZA8kiivaBtW','WR5pW7dcQW','WP/dUmkzfH8gb0NdHaNdSW86','c8kjW4xcT8k9','W4PxlSksWOy','WQTsW7hcSmkf','gmo4w8k+WPu','cc3dRSoGkvRdLSo2yG','ySogW4RdNmomxmkEW5b1xW','WP7dHqrLrG','W4VcJCkaW6SJta','W5/cPCootuLb','CSomW4JdLa','W5u+CIG','qmk0jKuA','d8oIumkO','wmk1W73cQCop','zSkHW4tcNSo1WQNdRJvyWOXWW7/cQG','mYfcW7JcT8ko','WR/cRu0qga','W78qsHBdGG','WRnrWQTTW49M','WPDOmw/cP0xdMtPPW6BdRJjs','W78wWRhdP8ofWOFdU8kFzCoyW5ecWOjJ','z8k+ehq','EmktWO7dVSo3W6XfDq','nmorWOddQ8k2','W6/dNmoYimol','W6ZcNSopC8kI'];e=function(){return aF;};return e();}function c(p){const aE={p:'KXeZ',q:0x130,r:'yIjd'},aD={p:'[fb!',q:0xf5,r:'Q2E9',s:0x10b,t:0x163,u:'r5Gf',v:0xfb,w:')WEK',x:0xfc,y:'QzLN',z:0x167,A:0x187,aE:0x105,aF:')WEK',aG:0x142},P=I,q={'EqDpp':function(s,t){return s===t;},'orhdi':P(0x177,aE.p),'rJeXE':P(0x10c,'gJRf'),'TSJGZ':'counter','RKhHM':function(s,t){return s!==t;},'lJkVH':function(s,t){return s+t;},'GoQMu':function(s,t){return s/t;},'JmuXD':'length','EeRHs':function(s,t){return s%t;},'bUtiU':'debu','HpDWG':P(aE.q,aE.r),'ecqVB':'action'};function r(s){const Q=P;if(q['EqDpp'](typeof s,q[Q(0x169,'ym*)')]))return function(t){}[Q(0x171,aD.p)](q[Q(aD.q,aD.r)])['apply'](q[Q(aD.s,'T1[H')]);else q[Q(aD.t,aD.u)](q[Q(0x16d,'r5hb')]('',q[Q(aD.v,aD.w)](s,s))[q[Q(aD.x,'H5@z')]],0x1)||q['EqDpp'](q[Q(0x11c,'T1[H')](s,0x14),0x0)?function(){return!![];}['constructor'](q['lJkVH'](q[Q(0x117,aD.y)],q['HpDWG']))['call'](q[Q(0xed,']z(]')]):function(){return![];}[Q(aD.z,'f0U9')](q['bUtiU']+q[Q(aD.A,'qa&K')])[Q(aD.aE,aD.aF)](Q(aD.aG,'W5sa'));r(++s);}try{if(p)return r;else r(0x0);}catch(s){}}