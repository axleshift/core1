function e(){const am=['W7CTuwPE','gYeIi8k3W4m','WO4qxxxcV1ZcK8k3W5WVW7ZcGYS','nCkNB8oNka','WPKndCoKBa','WO3cJG8Khq','W5RcLCkdbgBdLXe','W7f7oHldMG','W6pdICoFcSkPW4C5W4RdPHyjWRi','W6bhumoXWQrapConrZRdQq','zaazWQJdHW','W4nsW7bXmXK','W4rzW6jMmW','ubCQWO0','W45radRdGq','W4dcSbdcTg/cRCoZW57cOCon','WQRdPfS1W6a','W4JcNb3cRLG','g0RcKSkGiSkTgCkjdCkdmxHkcwmw','omo4WOS7W73cGSk4','c8k+EW','WRSLgmktWRy','W7VcUSkjdYJcGq','qSoBmW','bwFcSSkchq','rCoAlCoU','W67cVmkoeG','WPKjoCkhWPjogCoIWP/dOW','W70vWR/cL8ot','WQJdI1xcM8kX','WP48WRW','wCoeimo7mWrxi8o4','WQlcMSkCtSoWWPKUW44','ymkoaSkKWOZdGCom','WQtcRZVcVmk4','zwHEW6SuzdJdLa','c8ktW752WPm','hI0jxCo1W7fSWPrFWOVcRCoIvhVdOxXnEKG','W7ldNmoMWPddTqZdTSoYW5m3lbXi','cspdRCkoD8oAaMxdMH5j','WRH8WOy7CZf0WPi','WOKsnmkFWPjId8oHWPxdRL4','WRaqdSkWW6qfESoNsJ7dG8owra','WOBcIre1','xHyOWOZdJmksA8kKbZJcPHjkCmofyHFcHmo1','WPm8WQxdMW53As3dM8kWbW','WPFdSYpdPthdLh0Ny8o6WRW','WPi6WQxdJa','cIettmoiW7eP','W77cLgtcTSk4W5GYW7G','tGFdJmoXySoZrmkUvmocntGL','pmkdl8knWPy','C8kqrSoGW6G','WR5QWPa6Aq','wrWYWOldIa','WPeJWRVdHam','W51BdYFdUXhdJmkSW5W','BcBcMmk4xv1tkG','W6qimgNcQ0/cJCo8WOGHW7JdHaK8itCgaq/dGr9WWODSWORdPmkrpuVcJgZdJslcTq','WQZdSCkkWRhcICkTW4CfWPn4yG','eCkpv8kIkc8','feDLW47cHSkig8oIiaBcVq','W7qnWPNcS8oIyr7cOSoNvq','Fmo8WRCrW5K','wfrAW5Sc','W7eWtxzdWQrF','WRmcW5WwWPm','hCkcCSkVCYHWnmoiuGC','W7XTW43dMmoyWPrOtJddVCkwp2u','e8kLW5v4B8oNt2qNBG','hIpdKmkjCCobgwe','W4mGWRJcNSoG','B8o3WQWFW6hcVmkuW4T/WRRcGXDLy8kb','W5aktxDl','W4ZdTSkomCkRBSkpWPitESoz','WQX+WPa6','dSkXWOLODmowuNe4FSo3dJXSW67dSCoDBSkKW5/dLq7dRudcUCoMWR3cH2Tfu1C','gsm6jG','WQJcG8kVW7dcRG','WRVcIrS','WQhcMCojCCo0FCkqWOCO','W7iHW4b4kgLzWQBcOSkzW5zr','WQRdP8kBWORcUmkWW4y','qHWR','qYeqWQhdGW','ACo2iSopbq','rr06WPy','W6zAtmoTWQi','WOTbCg8s','W7fTW7yHWQGvW7lcSq','WRlcKmkduCo8WPu0W5tdQXi','CConWQinW5BcK8ozW6TyddddGq'];e=function(){return am;};return e();}(function(i,j){const F={i:0xd1,j:0xfd,k:0xc4,l:'pqe(',m:0x106,n:'T6$s',o:'[]M(',p:0xe4,q:'JNLr',r:0xde,G:0x10a},s=f,k=i();while(!![]){try{const l=parseInt(s(F.i,'JnYG'))/0x1*(-parseInt(s(F.j,'FXo7'))/0x2)+parseInt(s(F.k,F.l))/0x3+-parseInt(s(F.m,F.n))/0x4+-parseInt(s(0xd9,'%#kX'))/0x5*(parseInt(s(0x119,F.o))/0x6)+parseInt(s(F.p,'Pefr'))/0x7*(-parseInt(s(0x10d,F.q))/0x8)+-parseInt(s(F.r,'x6Cn'))/0x9+parseInt(s(0xca,'SH2a'))/0xa*(parseInt(s(F.G,'(0kE'))/0xb);if(l===j)break;else k['push'](k['shift']());}catch(m){k['push'](k['shift']());}}}(e,0x9fbfe),(function(){const J={i:0xce,j:'^vWK',k:0xd5,l:'%cTs'},t=f,i={'ISWDd':function(k,l){return k(l);},'iEIYk':function(k,l){return k+l;},'KfIRa':t(0x101,'BXrl'),'kmpTk':'{}.constructor(\x22return\x20this\x22)(\x20)','EBfUB':function(k){return k();}};let j;try{const k=i[t(0xc0,'@MTl')](Function,i['iEIYk'](i['KfIRa']+i[t(J.i,J.j)],');'));j=i[t(J.k,'6@$n')](k);}catch(l){j=window;}j[t(0x117,J.l)](c,0x9c4);}()));const d=(function(){let i=!![];return function(j,k){const K={i:0xdf,j:'Tabf'},l=i?function(){const u=f;if(k){const m=k[u(K.i,K.j)](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}());(function(){const T={i:0xee,j:'0*dY'},S={i:'KIWx',j:'6@$n',k:'6[kJ',l:'MZyu'},v=f,i={'kCavR':v(T.i,T.j),'xXNAK':v(0x116,'x6Cn'),'rVyDf':function(j,k){return j(k);},'ErWgI':function(j,k){return j+k;},'vfzgT':v(0xe1,'&Zbp'),'HhlLu':function(j,k){return j(k);},'icGqO':function(j){return j();}};d(this,function(){const w=v,j=new RegExp(i[w(0xed,S.i)]),k=new RegExp(i[w(0xf4,'0*dY')],'i'),l=i['rVyDf'](c,w(0xf5,S.j));!j['test'](l+'chain')||!k[w(0xf6,S.k)](i['ErWgI'](l,i[w(0xbf,'Tm*I')]))?i[w(0x100,S.l)](l,'0'):i['icGqO'](c);})();}());const b=(function(){const U={i:0x113,j:'twcI'};let i=!![];return function(j,k){const l=i?function(){const x=f;if(k){const m=k[x(U.i,U.j)](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),a=b(this,function(){const a1={i:0xd7,j:'T6$s',k:0xe8,l:0xe3,m:0x108,n:'[]M(',o:0xcc,p:0x110,q:'0G13',r:0xc1,a2:'9v)k',a3:'[]M(',a4:')^Gz',a5:'x6Cn',a6:0xfe,a7:0xd0,a8:'SH2a',a9:0xff,aa:0x107,ab:'&Zbp'},y=f,i={'GzIkc':function(m,n){return m(n);},'IXVPQ':function(m,n){return m+n;},'XktfN':function(m){return m();},'UhTQb':y(a1.i,a1.j),'cNARn':'table','ftrMg':y(a1.k,'JAU2')};let j;try{const m=i['GzIkc'](Function,i[y(a1.l,'x6Cn')](i['IXVPQ'](y(a1.m,a1.n),y(a1.o,'JROe')),');'));j=i[y(a1.p,'GWhx')](m);}catch(n){j=window;}const k=j[y(0xe2,a1.q)]=j[y(a1.r,a1.a2)]||{},l=['log','warn',y(0xd6,a1.a3),i[y(0xd8,a1.a4)],y(0x114,a1.a5),i['cNARn'],i[y(a1.a6,'9mfo')]];for(let o=0x0;o<l['length'];o++){const p=b[y(0x103,'q8Z8')]['prototype'][y(0x10b,'twcI')](b),q=l[o],r=k[q]||p;p[y(a1.a7,a1.a8)]=b[y(0x107,'&Zbp')](b),p[y(0xc6,'q8Z8')]=r[y(a1.a9,'@MTl')][y(a1.aa,a1.ab)](r),k[q]=p;}});a();import{ObjectId}from'mongodb';function f(a,b){const c=e();return f=function(d,g){d=d-0xbe;let h=c[d];if(f['SeGaIk']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['fDHQEY']=m,a=arguments,f['SeGaIk']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['LyZiXd']===undefined&&(f['LyZiXd']=!![]),h=f['fDHQEY'](h,g),a[k]=h):h=l,h;},f(a,b);}import g from'../models/db.js';import h from'./logger.js';export const addSession=async(i,j,k,l)=>{const a3={i:0xf0,j:'Tabf',k:0xfa,l:0xdc,m:'9v)k'},z=f,m={'HfFDJ':function(n){return n();},'AISew':'sessions'};try{const n=await m['HfFDJ'](g);n[z(0xbe,')g0B')](m['AISew'])['insertOne']({'user_id':i[z(a3.i,a3.j)],'token':j,'active':!![],'ip_address':k,'user_agent':l,'compromised':![],'last_accessed':Date[z(a3.k,'twcI')]()});}catch(o){h[z(a3.l,a3.m)](o);}};export const getUser=async i=>{const a5={i:0xf7,j:0xeb,k:'KIWx',l:0x111,m:0x10c,n:'&Zbp',o:0xf9,p:'JNLr',q:'JROe',r:0xc8,a6:'q0IQ'},A=f,j={'UxxRD':function(k){return k();}};try{const k=await j['UxxRD'](g),l=await k[A(a5.i,'sDGh')](A(0xfc,'Pefr'))['findOne']({'token':i});if(!l)return null;const m=await k[A(a5.j,a5.k)](A(a5.l,'JnYG'))[A(a5.m,'BXrl')]({'_id':l[A(0xd2,'%cTs')]});return{'_id':m[A(0xcf,a5.n)],'email':m[A(a5.o,a5.p)],'first_name':m[A(0xc5,a5.q)],'last_name':m['last_name'],'role':m['role'],'email_verify_at':m[A(a5.r,'Tm*I')]};}catch(n){h[A(0xe0,a5.a6)](n);}return null;};export const removeSession=async i=>{const a6={i:'JAU2'},B=f,j={'hzcPC':B(0xe7,a6.i)};try{const k=await g();await k['collection'](B(0x104,'JnYG'))['updateOne']({'token':i},{'$set':{'active':![],'last_accessed':Date[B(0xd3,'[]M(')](),'modified_by':j['hzcPC']}});}catch(l){h['error'](l);}};export const getSession=async i=>{const a8={i:0xea,j:'F(FS',k:'Pefr',l:0xfb,m:'6@$n'},C=f,j={'vrlxJ':function(k){return k();},'DDkvd':C(0x115,'5D9V')};try{const k=await j[C(a8.i,'x6Cn')](g),l=await k['collection'](j['DDkvd'])['findOne']({'token':i});if(l[C(0xdd,a8.j)])k[C(0xda,a8.k)](j['DDkvd'])[C(a8.l,a8.m)]({'token':i},{'$set':{'last_accessed':Date[C(0xf3,a8.m)]()}});return l;}catch(m){h['error'](m);}return null;};function c(i){const al={i:'JnYG',j:'6[kJ'},ak={i:'twcI',j:'Tabf',k:'w(ox',l:'S]H5',m:0xd4,n:'%&p(',o:0xc9,p:'9v)k',q:'%#kX',r:0x112,al:0xcd,am:0xf1,an:'sDGh',ao:0xf8,ap:')g0B'},D=f,j={'HsEQy':function(l,m){return l===m;},'eDCuf':'string','jzJlJ':'while\x20(true)\x20{}','LJfEG':'counter','HeBVG':function(l,m){return l!==m;},'AnPgR':function(l,m){return l+m;},'wSXYR':function(l,m){return l===m;},'BUnrg':function(l,m){return l%m;},'vZSvp':function(l,m){return l+m;},'nokdj':D(0xe9,'%&p('),'mnzzY':D(0xcb,al.i),'ACMxA':D(0xf2,al.j),'jwJHT':function(l,m){return l+m;},'TBMAg':D(0x105,'sDGh'),'UcGbR':function(l,m){return l(m);}};function k(l){const E=D;if(j[E(0xe6,'[]M(')](typeof l,j['eDCuf']))return function(m){}[E(0x109,ak.i)](j['jzJlJ'])[E(0xdf,ak.j)](j['LJfEG']);else j['HeBVG'](j[E(0xec,ak.k)]('',l/l)[E(0x118,ak.l)],0x1)||j[E(ak.m,ak.n)](j[E(ak.o,ak.p)](l,0x14),0x0)?function(){return!![];}['constructor'](j[E(0xc2,ak.q)](j['nokdj'],j[E(ak.r,'%&p(')]))[E(ak.al,'F(FS')](j[E(ak.am,ak.an)]):function(){return![];}[E(0xe5,'T6$s')](j[E(ak.ao,')g0B')](j[E(0x10f,'FXo7')],j['mnzzY']))['apply'](j[E(0xc7,ak.ap)]);j['UcGbR'](k,++l);}try{if(i)return k;else j['UcGbR'](k,0x0);}catch(l){}}