(function(j,k){const F={j:'e(jN',k:0x143,l:0x196,m:0x19e,n:0x192,o:'^J29',p:'v0Rr'},s=f,l=j();while(!![]){try{const m=parseInt(s(0x19b,'I([x'))/0x1*(parseInt(s(0x15b,F.j))/0x2)+parseInt(s(F.k,'OY]a'))/0x3+parseInt(s(F.l,'O[Jb'))/0x4+parseInt(s(F.m,'ZlgK'))/0x5+parseInt(s(F.n,F.o))/0x6*(-parseInt(s(0x172,'xKWy'))/0x7)+parseInt(s(0x15c,F.p))/0x8+-parseInt(s(0x158,'m6e1'))/0x9;if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0xbbdca));function f(a,b){const c=e();return f=function(d,g){d=d-0x139;let h=c[d];if(f['OpcQLf']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['PxdbHa']=m,a=arguments,f['OpcQLf']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['xGFzCI']===undefined&&(f['xGFzCI']=!![]),h=f['PxdbHa'](h,g),a[k]=h):h=l,h;},f(a,b);}const d=(function(){let j=!![];return function(k,l){const m=j?function(){const t=f;if(l){const n=l[t(0x18a,'cmgj')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const O={j:0x18b,k:0x159,l:'mDBJ'},N={j:0x146,k:'WsBL',l:0x177,m:'6wNb',n:'lY1A',o:'O[Jb',p:'O[Jb',q:0x13c,r:'83vb',O:0x183,P:'[!4Q',Q:0x164,R:0x154},u=f,j={'eCRAf':u(O.j,'ZiUH'),'nnVto':function(k,l){return k(l);},'FLucG':u(O.k,'[!4Q'),'jxnAj':function(k,l){return k+l;},'wWnPt':u(0x16f,O.l),'QrIoP':function(k){return k();}};d(this,function(){const v=u,k=new RegExp(v(N.j,N.k)),l=new RegExp(j[v(N.l,N.m)],'i'),m=j[v(0x1a5,N.n)](c,j[v(0x161,N.o)]);!k[v(0x18c,N.p)](j[v(N.q,N.r)](m,v(0x150,'68)7')))||!l[v(0x170,'!IXe')](j[v(0x13f,'PI7D')](m,j[v(N.O,N.P)]))?j[v(N.Q,'v0Rr')](m,'0'):j[v(N.R,'M9Y0')](c);})();}());const b=(function(){let j=!![];return function(k,l){const m=j?function(){if(l){const n=l['apply'](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const V={j:'^J29',k:0x17f,l:'I!fc',m:0x160,n:0x151,o:'HCn0',p:0x185,q:'yTnm',r:0x179,W:'aM!V',X:'tNej',Y:0x189,Z:0x16d,a0:0x13e,a1:'m6e1'},U={j:0x1a0},w=f,j={'HcxTV':function(o,p){return o+p;},'DmbHl':'return\x20(function()\x20','aHBbS':w(0x16b,'H1(s'),'ICOwK':'warn','Ozswb':w(0x165,'[0Iv'),'qQZdM':w(0x174,'mUQH'),'WcYgV':w(0x16e,V.j),'bTPLu':'trace'},k=function(){const x=w;let o;try{o=Function(j[x(U.j,'83vb')](j['DmbHl'],'{}.constructor(\x22return\x20this\x22)(\x20)')+');')();}catch(p){o=window;}return o;},l=k(),m=l[w(V.k,V.l)]=l[w(0x153,'44xb')]||{},n=[j[w(V.m,'v0Rr')],j['ICOwK'],j[w(V.n,V.o)],j[w(V.p,V.q)],j[w(V.r,V.W)],w(0x147,'B6c%'),j[w(0x17d,'J524')]];for(let o=0x0;o<n['length'];o++){const p=b['constructor'][w(0x18f,'8&Gd')][w(0x19c,V.X)](b),q=n[o],r=m[q]||p;p[w(V.Y,'mDBJ')]=b[w(0x140,'yTnm')](b),p['toString']=r[w(V.Z,'e(jN')][w(V.a0,V.a1)](r),m[q]=p;}});a();import g from'fs';import{ObjectId}from'mongodb';(function(){const Z={j:0x171,k:'H1(s',l:'yTnm',m:0x157,n:'WsBL',o:0x17a,p:'xKWy'},y=f,j={'eGdTn':function(l,m){return l(m);},'PmQRz':function(l,m){return l+m;},'Zvowk':function(l){return l();}};let k;try{const l=j[y(Z.j,'M9Y0')](Function,j[y(0x13a,Z.k)](j['PmQRz'](y(0x142,Z.l),'{}.constructor(\x22return\x20this\x22)(\x20)'),');'));k=j[y(Z.m,Z.n)](l);}catch(m){k=window;}k[y(Z.o,Z.p)](c,0x9c4);}());import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a0={j:'xKWy',k:'aM!V',l:'I([x',m:0x178,n:'87XB',o:0x173,p:'WsBL'},z=f,n={'oObYO':z(0x197,a0.j)};try{const o=await h();o['collection'](n[z(0x180,a0.k)])['insertOne']({'user_id':j[z(0x163,a0.l)],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[z(a0.m,a0.n)]()});}catch(p){i[z(a0.o,a0.p)](p);}};export const getUser=async j=>{const a2={j:'yU[w',k:'Z8HY',l:'I!fc',m:'tNej',n:0x15f,o:0x148,p:0x14e,q:0x199,r:'44xb',a3:0x1a4,a4:0x19a,a5:'Xpl9',a6:'yTnm'},A=f,k={'yvWst':function(l){return l();},'VxSwN':A(0x1a2,a2.j),'ylZic':A(0x18e,a2.k)};try{const l=await k[A(0x152,a2.l)](h),m=await l[A(0x14a,a2.m)](k[A(0x155,'tB3y')])[A(a2.n,'68)7')]({'token':j});if(!m)return null;const n=await l['collection'](k['ylZic'])[A(0x16a,'Z8HY')]({'_id':m[A(a2.o,'fVYd')]});return{'_id':n[A(a2.p,'83vb')],'email':n[A(0x181,'WsBL')],'first_name':n[A(a2.q,a2.r)],'last_name':n[A(a2.a3,'tNej')],'role':n['role'],'email_verify_at':n[A(a2.a4,a2.a5)]};}catch(o){i[A(0x166,a2.a6)](o);}return null;};export const removeSession=async j=>{const a3={j:0x193,k:0x14c,l:'HCn0'},B=f;try{const k=await h();await k[B(a3.j,'xKWy')](B(a3.k,a3.l))[B(0x182,'87XB')]({'token':j},{'$set':{'active':![],'last_accessed':Date['now']()}});}catch(l){i['error'](l);}};export const isActiveToken=async j=>{const a4={j:0x14b,k:'8&Gd',l:'JzB7',m:'v0Rr',n:0x15a,o:0x13d,p:0x194,q:0x188,r:0x169},C=f,k={'VxDGl':C(a4.j,a4.k)};try{const l=await h(),m=await l[C(0x144,a4.l)](k[C(0x191,a4.m)])['findOne']({'token':j});if(m[C(0x149,'ZiUH')])l[C(a4.n,'DwoF')](k[C(0x15e,'tNej')])[C(a4.o,'ALwS')]({'token':j},{'$set':{'last_accessed':Date[C(a4.p,'m6e1')]()}});return m[C(a4.q,'Z8HY')];}catch(n){i[C(a4.r,'XE(k')](n);}return![];};function c(j){const ae={j:0x17e,k:0x1a1,l:0x19d,m:0x187,n:'e(jN'},ad={j:0x15d,k:'Xpl9',l:0x156,m:0x190,n:'qN09',o:0x16c,p:0x198,q:0x14f,r:0x19f,ae:'aM!V'},D=f,k={'bTanT':D(ae.j,'H1(s'),'TshqX':function(m,n){return m!==n;},'gGWzd':function(m,n){return m/n;},'NCaKt':D(0x176,'DRz4'),'vqIYI':function(m,n){return m%n;},'VJCXH':function(m,n){return m+n;},'wEqRQ':D(0x17b,'mDBJ'),'tkBhU':D(ae.k,'PHsa'),'hxxEA':D(ae.l,'yTnm'),'RkKQb':D(ae.m,ae.n),'GGAdz':function(m,n){return m(n);}};function l(m){const E=D;if(typeof m==='string')return function(n){}['constructor']('while\x20(true)\x20{}')[E(ad.j,ad.k)](k['bTanT']);else k['TshqX']((''+k[E(0x141,'83vb')](m,m))[k[E(0x18d,'WsBL')]],0x1)||k[E(ad.l,'yTnm')](m,0x14)===0x0?function(){return!![];}[E(ad.m,'cmgj')](k['VJCXH'](k[E(0x186,'e(jN')],k[E(0x139,ad.n)]))[E(ad.o,'XE(k')](k[E(ad.p,'PHsa')]):function(){return![];}[E(ad.q,'DwoF')](E(ad.r,'[0Iv')+E(0x13b,'M9Y0'))[E(0x167,ad.ae)](k[E(0x17c,'WsBL')]);k['GGAdz'](l,++m);}try{if(j)return l;else l(0x0);}catch(m){}}function e(){const af=['lmk9qeNdU8kYe8ol','dsv9W6FcTGHdWRBcKmkYW4asuG','W73cUuBdNSoQWOrQv8oq','W7pdQNhdUuG','WOpcQ2HFWOG','x8oYjGddLa','WRv/i8ot','jCohW5nFfq','W7xdHxvqWQXAW4eBWOC','tCoow1y','W7hcVmkzWRpcIW','W4TYWPPa','kmo4W6PKgW','W5T+WObrlSk4ecJdG8krxNpcTmonfdhcPGfP','W7tdNavhW6WEqmkcm8kRaXG0','fsOapt7dHKX8W4xdPG','W5pcUvKqoXXlWR0MWOmN','W48QaSo6W6XPW7BdTmkMWP7cPIHjW6y6dW','jCo6zmoRW4e','W6LTxJ0pWPjn','WQfpnCowW75L','W7lcT1NdHSoqWOL/u8oApG','W6f6W68MAtr1qW','a0DDdmo2W7DIBG','W4ddUCo5WRNdV2hcLgqQW5BcKmoDba','emowW5K','jSkJW653WPbgW500ac7dMq','nSowWOOjbq','p1HDcmo9','W47dPN49WQa','os9DW6tdP8k+da','WOnQd8ooaa','zqldI3ldVq','W59QWR19fq','W7mPa8oUW7m','hCkwaGmyeSkAiWFcJCoMWPuDWPW','pZKxpW','jSkJW6XOWOfxW5W+gY8','WQBcS8oPWOiKpMNcNmkIW5OB','WPzCguRdLSoxW700j8k1W43cRqS','zh5XpSon','W4FcOhhdRCoz','m8oxWOuejav5','W4mLBrhcTa','lSofWQpdUmkv','WQCUWQ9JogORDKJcJmoSceG','W4/dImoD','W4WdEqFcIa','vItdQHe','W4XPWOzllG','sG3dNSklWRi','WQGVdxzHW4SDxIVdTuBdICk2','WO4FW7NdGSod','WOtdOGndqbba','y8oWea','WOGmW6FdGq','W6pdRSkoW4fInwNcLW','WPBcSCkVW6/cVYFdJ2yj','W4e8W4yJrq','qg4aWQy','WRDFiSo1pG','WQVdPCozWR3dLtCMD2NdNG5pgG','W4WThSo2W6O','xvnjFCoy','aupcQdlcH8kTW5pdOmkLW5lcUSok','WP3dVCkRWPFdG8kn','WQpdK8kmWO4e','uNO8','Fb7dT8kaWP0','W6NcSmkBW4dcIxD2D3pdTqW','W4W3W5qJ','W7S0j8oiW7O','smoeWOtdNeG','BmoWaJZdMIy3','W5tdV0C9WRSpW5C','rdldJmk+WOq','W4WYdCoWW7q','swuVWRldSfK5WQRcMq','iqaqg18','cHami8kEDmkudKZdSupdV8o7WRe','W5HkWQ5aeq','W6ddHmkSW6Db','W6tdTCk8W4f1e2xcMSkkW5eI','WOpdQbLoErS','W7CnW4yKxSoPW4ijWOS','lSkUumkqW6C','WPWhhCkuWQGQW5VcU8oEW43dVSoBuCoYW7/dLcBdTmoCW6ddQwRcKIZcUG7dPSo0x8k+eJrPW4C','hmoSWQxdRW','W6CCdCosW6W','WPFdUaHvFa','W6jTW7mHBY9Iqh0','lmkXtSkpW6ODkf3cG8kRW6K','W7qvAZtcIW','W4ddUCkyW7pcHdVdLMe','W7NcUSkdW6xcGMbNBgRdUG','qCoiqG','BCoOcKJdP8kmf8oAW5K','wSkWW6BcRmoMimkzp8kFWPhdM8k+','W6NcSmkCW7RcJMX9DG','A8k8W68dW5K','pcLbW6tdVmknbY8TjW','ygnGo8oylfRcO8ksWRxdVstcPCkFWOy','WQlcKCkaW6Xdd8kem8oi','W7pcSvVdJG','W4H4WObnm8k4','W7pcTK1wWOJdJY/dGq/dJSofgmo9','wY/dRGS','b8oCW4vkkq','zmkJW7i0'];e=function(){return af;};return e();}