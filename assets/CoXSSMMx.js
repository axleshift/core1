import{j as e,r as u}from"./BfF3Wqld.js";import{F as S,B as T}from"./CvRhtR9Y.js";import{P as s}from"./BGpjnhzs.js";import{p as q}from"./Ced3TTKs.js";import{y as w,K as P,L as _,M as O,N as F,aa as j,ab as R,ac as f,ad as p,ae as i,af as N,ag as a,C as U,ah as E,ai as M,aj as g,ak as k,al as b}from"./DUVR4xq_.js";import{U as H}from"./BTzV-kGC.js";import{i as C}from"./CnpJVEP9.js";import{d as B}from"./DVKfn1E0.js";import"./DnfDba0r.js";import"./BQBsAJpH.js";import"./DLZ1bwg6.js";import"./CzFDRTuY.js";import"./CWmxXzlZ.js";import"./BZxJdD1U.js";import"./D3goV2Zm.js";import"./CJGb7kgi.js";import"./D3kAHpSt.js";const A=({query:c,setQuery:d,state:t,setState:l,priority:o,setPriority:h,order:m,setOrder:x,result:n})=>e.jsxs(e.Fragment,{children:[n.scm.length===0&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(w,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any threats."}),e.jsx("p",{children:"Should we add one? :)"})]})}),n.scm.length!==0&&e.jsxs(e.Fragment,{children:[e.jsxs(P,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(_,{className:"mb-3",children:[e.jsx(O,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:c,onChange:r=>d(r.target.value)}),e.jsx(F,{id:"basic-addon",children:e.jsx(S,{icon:T})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:t,onChange:r=>l(r.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:o,onChange:r=>h(r.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:m,onChange:r=>x(r.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(R,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(i,{children:"#"}),e.jsx(i,{children:"State"}),e.jsx(i,{children:"Scope"}),e.jsx(i,{children:"Manifest"}),e.jsx(i,{children:"CVE"}),e.jsx(i,{children:"Summary"}),e.jsx(i,{children:"Severity"}),e.jsx(i,{children:"Last Updated"})]})}),e.jsx(N,{children:n.scm.map(r=>e.jsxs(p,{children:[e.jsx(a,{children:r.number}),e.jsx(a,{children:r.state}),e.jsx(a,{children:r.scope}),e.jsx(a,{children:r.manifest}),e.jsx(a,{children:r.cve}),e.jsx(a,{children:r.summary}),e.jsx(a,{children:r.severity}),e.jsx(a,{children:q(new Date(r.updated_at).getTime())})]},r.number))})]})]})]});A.propTypes={query:s.string.isRequired,setQuery:s.func.isRequired,state:s.string.isRequired,setState:s.func.isRequired,priority:s.string.isRequired,setPriority:s.func.isRequired,order:s.string.isRequired,setOrder:s.func.isRequired,result:s.shape({scm:s.arrayOf(s.shape({number:s.number.isRequired,state:s.string.isRequired,scope:s.string.isRequired,manifest:s.string.isRequired,cve:s.string.isRequired,summary:s.string.isRequired,severity:s.string.isRequired,updated_at:s.string.isRequired})).isRequired}).isRequired};const K=({result:c})=>{const d=t=>{const l=new H;return l.setUA(t),l.getResult(),t};return e.jsx(e.Fragment,{children:e.jsxs(R,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(i,{children:"#"}),C&&e.jsx(i,{children:"User"}),e.jsx(i,{children:"Location"}),e.jsx(i,{children:"Device"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Last Accessed"})]})}),e.jsx(N,{children:c.sessions.map((t,l)=>e.jsxs(p,{children:[e.jsx(a,{children:l+1}),C&&e.jsx(a,{children:t.user_id}),e.jsx(a,{children:t.ip_address}),e.jsx(a,{children:d(t.user_agent)}),e.jsx(a,{children:t.active?"Active":"Inactive"}),e.jsx(a,{children:q(t.last_accessed)})]},l))})]})})};K.propTypes={result:s.shape({browser:s.string,os:s.string,sessions:s.arrayOf(s.shape({_id:s.string.isRequired,user_id:s.string,ip_address:s.string.isRequired,user_agent:s.string.isRequired,active:s.bool.isRequired,last_accessed:s.number.isRequired})).isRequired}).isRequired};const L=({query:c,setQuery:d,state:t,setState:l,priority:o,setPriority:h,order:m,setOrder:x,result:n})=>e.jsxs(e.Fragment,{children:[n.sentry.length===0&&e.jsx("div",{className:"text-center border rounded",children:e.jsxs("div",{className:"p-0 p-md-5 my-5 my-md-0",children:[e.jsx(w,{src:"/images/threat.png",fluid:!0,width:"50%"}),e.jsx("h1",{children:"We couldn't find any issues."}),e.jsx("p",{children:"Should we add one? :)"})]})}),n.sentry.length!==0&&e.jsxs(e.Fragment,{children:[e.jsxs(P,{className:"d-flex justify-content-left my-2 my-lg-0",children:[e.jsxs(_,{className:"mb-3",children:[e.jsx(O,{"aria-label":"tracking id","aria-describedby":"basic-addon",value:c,onChange:r=>d(r.target.value)}),e.jsx(F,{id:"basic-addon",children:e.jsx(S,{icon:T})})]}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:t,onChange:r=>l(r.target.value),options:[{label:"All",value:"0"},{label:"Resolved",value:"1"},{label:"Unresolved",value:"2"},{label:"Not Plan",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:o,onChange:r=>h(r.target.value),options:[{label:"All",value:"0"},{label:"High",value:"1"},{label:"Medium",value:"2"},{label:"Low",value:"3"}],required:!0,className:"mb-3"}),e.jsx("div",{className:"mx-2"}),e.jsx(j,{value:m,onChange:r=>x(r.target.value),options:[{label:"Newer",value:"1"},{label:"Older",value:"2"}],required:!0,className:"mb-3"})]}),e.jsxs(R,{hover:!0,responsive:!0,className:"rounded",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(i,{children:"#"}),e.jsx(i,{children:"Title"}),e.jsx(i,{children:"Culprit"}),e.jsx(i,{children:"Level"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Priority"}),e.jsx(i,{children:"Count"}),e.jsx(i,{children:"Last Updated"})]})}),e.jsx(N,{children:n.sentry.map(r=>e.jsxs(p,{children:[e.jsx(a,{children:r.id}),e.jsx(a,{children:r.title}),e.jsx(a,{children:r.culprit}),e.jsx(a,{children:r.level}),e.jsx(a,{children:r.status}),e.jsx(a,{children:r.priority}),e.jsx(a,{children:r.count}),e.jsx(a,{children:q(new Date(r.updated_at).getTime())})]},r.id))})]})]})]});L.propTypes={query:s.string.isRequired,setQuery:s.func.isRequired,state:s.string.isRequired,setState:s.func.isRequired,priority:s.string.isRequired,setPriority:s.func.isRequired,order:s.string.isRequired,setOrder:s.func.isRequired,result:s.shape({sentry:s.arrayOf(s.shape({id:s.string.isRequired,title:s.string.isRequired,culprit:s.string.isRequired,level:s.string.isRequired,status:s.string.isRequired,priority:s.string.isRequired,count:s.string.isRequired,updated_at:s.string.isRequired})).isRequired}).isRequired};const G=()=>e.jsx(e.Fragment,{children:e.jsx("b",{children:"OTP 24252424 "})}),de=()=>{const[c,d]=u.useState(!1),[t,l]=u.useState("2"),[o,h]=u.useState("1"),[m,x]=u.useState("1"),[n,r]=u.useState(""),[v,D]=u.useState({scm:[],sessions:[],sentry:[]});B();const I=async()=>{d(!0),await axios.get("http://142.93.121.73:5051/api/v1/threat/",{headers:{Authorization:`Bearer ${cookies.get("RCTSESSION")}`}}).then(y=>{D(y.data)}).catch(y=>{console.error(y)}).finally(()=>{d(!1)})};return u.useEffect(()=>{I()},[]),e.jsxs("div",{children:[c&&e.jsx("div",{className:"loading-overlay",children:e.jsx(U,{color:"primary",variant:"grow"})}),e.jsxs(E,{activeItemKey:1,className:"mb-4",children:[e.jsxs(M,{variant:"underline-border",children:[e.jsx(g,{"aria-controls":"home-tab-pane",itemKey:1,children:"Sessions"}),e.jsx(g,{"aria-controls":"profile-tab-pane",itemKey:2,children:"Dependabot"}),e.jsx(g,{"aria-controls":"profile-tab-pane",itemKey:3,children:"OTP"}),e.jsx(g,{"aria-controls":"profile-tab-pane",itemKey:4,children:"Sentry"})]}),e.jsxs(k,{children:[e.jsx(b,{className:"py-3","aria-labelledby":"home-tab-pane",itemKey:1,children:e.jsx(K,{result:v})}),e.jsx(b,{className:"py-3","aria-labelledby":"profile-tab-pane",itemKey:2,children:e.jsx(A,{query:n,setQuery:r,state:t,setState:l,priority:o,setPriority:h,order:m,setOrder:x,result:v})}),e.jsx(b,{className:"py-3","aria-labelledby":"profile-tab-pane",itemKey:3,children:e.jsx(G,{})}),e.jsx(b,{className:"py-3","aria-labelledby":"profile-tab-pane",itemKey:4,children:e.jsx(L,{query:n,setQuery:r,state:t,setState:l,priority:o,setPriority:h,order:m,setOrder:x,result:v})})]})]})]})};export{de as default};
