import{R as e,r as s,j as a}from"./Oq9P1Wj_.js";import{F as r,H as t}from"./IXMtX5d7.js";import{Q as i}from"./Cl7qhzEd.js";import{h as o}from"./DxFnCsxZ.js";import{R as n}from"./eGqyD3ZN.js";import{a as c,b as l,e as d}from"./LbyR-rF8.js";import{S as m}from"./CfkOPZos.js";import{d as p,k as j}from"./Ce_fjdqS.js";import{c as u,a as h,b as f,d as x,e as y,g as v,h as b,i as g,Y as S}from"./GAhPWFs0.js";import"./deeEeel3.js";import"./NdsU5MZw.js";import"./BXWkExu4.js";import"./C5ktbw-a.js";import"./c0eKk1Db.js";import"./CewSaW8v.js";import"./DvQD94mg.js";import"./DhxmCZ7v.js";import"./fHQ1LRrH.js";import"./CUvxBZEH.js";import"./CA9sZ-Z2.js";import"./YLYDLWv3.js";import"./ChytwAMd.js";import"./Dn-qDmp9.js";import"./XtWrBBVz.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CDdQWEAe.js";import"./BqHrj3jM.js";const w=()=>{const w={isImport:!1,isResidentialAddress:!1,containsDangerGoods:!1,containsDocuments:!1,from:[{name:"",company:"",country:"",countryCode:"",city:"",zipCode:"",address:"",address2:"",address3:"",phone:"",email:"",taxId:""}],to:[{name:"",company:"",country:"",countryCode:"",city:"",zipCode:"",address:"",address2:"",address3:"",phone:"",email:"",employerId:""}],type:"private",items:[]},{user:N}=c(),k=e.useRef(),{addToast:C}=l(),[R,_]=s.useState(w),[D,A]=s.useState(w);s.useState("");const[O,z]=s.useState(""),[E,F]=s.useState(!1),[I,T]=s.useState(!0),[$,B]=s.useState(!1),[H,L]=s.useState(!1),P=s.useRef(null),Q=p(),{id:Y}=j();return s.useEffect((()=>{(async()=>{F(!0),axios.get(`/freight/${Y}`).then((e=>{_({...e.data,internal:!0}),A({...e.data,internal:!0})})).catch((e=>{B(!0)})).finally((()=>F(!1)))})()}),[]),E?a.jsx("div",{className:"loading-overlay",children:a.jsx(u,{color:"primary",variant:"grow"})}):$?a.jsx(h,{className:"justify-content-center my-5",children:a.jsx(f,{md:6,children:a.jsxs("div",{className:"clearfix",children:[a.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),a.jsx("h4",{children:"There was no shipment found."}),a.jsx("p",{children:"Double check tracking id for any mistake."})]})})}):a.jsxs("div",{children:[H&&a.jsxs(x,{visible:!0,onClose:()=>L(!1),alignment:"center",scrollable:!0,children:[a.jsx(y,{closeButton:!0}),a.jsx(v,{children:a.jsx("div",{className:"d-flex justify-content-center align-items-center",children:a.jsx("div",{ref:P,className:"d-inline-block",children:a.jsx(i,{value:Y})})})}),a.jsx(b,{className:"d-flex justify-content-center align-items-center",children:a.jsx(g,{color:"primary",onClick:()=>{L(!1),o(P.current,{useCORS:!0}).then((e=>{const s=e.toDataURL("image/png"),a=document.createElement("a");a.href=s,a.download="qrcode.png",document.body.appendChild(a),a.click(),document.body.removeChild(a)}))},children:"Download"})})]}),a.jsx(n,{ref:k,size:"invisible",sitekey:d}),a.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4",children:[a.jsxs("span",{className:"d-block",children:[a.jsx("span",{className:"text-primary fw-bold small",children:"Tracking Number:"}),a.jsx("br",{}),Y]}),a.jsxs(S,{className:"mb-2 mb-sm-0",children:[a.jsx(g,{color:"primary",className:"me-2 rounded",onClick:e=>L(!0),children:a.jsx(r,{icon:t})}),"cancelled"!==O&&"received"!==O&&a.jsxs(a.Fragment,{children:["to_pay"===O&&"user"===N.role&&a.jsx(g,{color:"primary",className:"me-2 rounded",onClick:async()=>{const e=await k.current.executeAsync();F(!0),axios.post("/invoices",{id:Y,recaptcha_ref:e}).then((e=>window.location.href=e.data.r_url)).catch((e=>{var s,a;const r=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||"Server is offline or restarting please wait";C(r)})).finally((()=>F(!1)))},children:"Book shipment"}),a.jsx(g,{color:"primary",className:"me-2 rounded",onClick:async()=>{if(I)return T(!1);const e=await k.current.executeAsync();F(!0);const s={...D,recaptcha_ref:e};axios.post(`/freight/update/${Y}`,s).then((e=>C("Your changes has been saved."))).catch((e=>{var s,a;const r=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||"Server is offline or restarting please wait";C(r,"Submit failed!"),A(R)})).finally((()=>{F(!1),T(!0)}))},disabled:["to_receive","received"].includes(O),children:I?"Edit":"Save"}),a.jsx(g,{color:I?"danger":"warn",className:"me-2 rounded",onClick:async()=>{if(!I)return T(!0),void A(R);const e=await k.current.executeAsync();F(!0),axios.post(`/freight/cancel/${Y}`,{recaptcha_ref:e}).then((e=>{C("Shipment has been cancelled."),Q("/dashboard")})).catch((e=>{var s,a;const r=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||"Server is offline or restarting please wait";C(r,"Submit failed!"),A(R)})).finally((()=>F(!1)))},disabled:["to_receive","received"].includes(O),children:"Cancel"})]})]})]}),a.jsx(m,{data:{form:R,setForm:_,loading:E,setLoading:F}})]})};export{w as default};
