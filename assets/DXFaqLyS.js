import{R as s,r as e,j as r}from"./B29SdWEC.js";import{F as a,M as t}from"./Crdnh4fn.js";import{Q as i}from"./5hkdeL0n.js";import o from"./D9496bDv.js";import{R as n}from"./Cri8ushB.js";import{a as l,b as c,e as m}from"./DM7e1kiA.js";import{S as d}from"./0RO5ZSck.js";import{d as j,k as p}from"./BFKNndIN.js";import{c as f,a as h,b as x,d as u,e as b,g as y,h as g,i as v,Y as N}from"./oveYcU8Y.js";import"./ucIcx5RQ.js";import"./E8MUDNEF.js";import"./4RmQ9_ev.js";import"./CIdotNGq.js";import"./yJGO6Amu.js";import"./BIw_sdFo.js";import"./BjhGVRpM.js";import"./BFk34ZWe.js";import"./BmTZu7tj.js";import"./CxXfFpkk.js";import"./DPENoFOj.js";import"./Ba2eFa9Y.js";import"./DShVK1TZ.js";import"./CjjZDEdp.js";import"./K-dupnmX.js";import"./D0A342eN.js";import"./DPAjA2jz.js";import"./OBe_9qlD.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./CA9thugF.js";import"./BPjVUy-D.js";import"./C_n0TLp5.js";import"./DYPlXUME.js";import"./BqHrj3jM.js";const k=()=>{const{user:k}=l(),w=s.useRef(),{addToast:S}=c(),[C,R]=e.useState([]),[T,B]=e.useState(!0),[D,E]=e.useState(!1),[F,L]=e.useState(!1),O=e.useRef(null);j();const{id:$}=p();return e.useEffect((()=>{(async()=>{axios.get(`/freight/${$}`).then((s=>R({...s.data,internal:!0}))).catch((s=>{E(!0)})).finally((()=>B(!1)))})()}),[]),T?r.jsx("div",{className:"loading-overlay",children:r.jsx(f,{color:"primary",variant:"grow"})}):D?r.jsx(h,{className:"justify-content-center my-5",children:r.jsx(x,{md:6,children:r.jsxs("div",{className:"clearfix",children:[r.jsx("h1",{className:"float-start display-3 me-4",children:"OOPS"}),r.jsx("h4",{children:"There was no shipment found."}),r.jsx("p",{children:"Double check tracking number for any mistake."})]})})}):r.jsxs("div",{children:[F&&r.jsxs(u,{visible:!0,onClose:()=>L(!1),alignment:"center",scrollable:!0,children:[r.jsx(b,{closeButton:!0}),r.jsx(y,{children:r.jsx("div",{className:"d-flex justify-content-center align-items-center",children:r.jsx("div",{ref:O,className:"d-inline-block",children:r.jsx(i,{value:$})})})}),r.jsx(g,{className:"d-flex justify-content-center align-items-center",children:r.jsx(v,{color:"primary",onClick:()=>{L(!1),o(O.current,{useCORS:!0}).then((s=>{const e=s.toDataURL("image/png"),r=document.createElement("a");r.href=e,r.download="qrcode.png",document.body.appendChild(r),r.click(),document.body.removeChild(r)}))},children:"Download"})})]}),r.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4",children:[r.jsxs("span",{className:"d-block",children:[r.jsx("span",{className:"text-primary fw-bold small",children:"Tracking Number:"}),r.jsx("br",{}),$]}),r.jsxs(N,{className:"mb-2 mb-sm-0",children:[r.jsx(v,{color:"primary",className:"me-2 rounded",onClick:s=>L(!0),children:r.jsx(a,{icon:t})}),"to_pay"===C.status&&r.jsx(v,{color:"danger",className:"me-2 rounded",onClick:async()=>{const s=await w.current.executeAsync();B(!0),axios.post(`/freight/cancel/${$}`,{recaptcha_ref:s}).then((s=>{S("Shipment has been cancelled."),setTimeout((()=>{window.location.reload()}),3e3)})).catch((s=>{var e,r;const a=(null==(r=null==(e=s.response)?void 0:e.data)?void 0:r.error)||"Server is offline or restarting please wait";S(a,"Submit failed!")})).finally((()=>B(!1)))},children:"Cancel"})]})]}),r.jsx(d,{data:{form:C,setForm:R,loading:T,setLoading:B}}),r.jsx(n,{ref:w,size:"invisible",sitekey:m})]})};export{k as default};
