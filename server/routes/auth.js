const G=f;(function(p,q){const P={p:0xa9,q:'Vp$S',r:'n9s$',s:0xeb,t:'2STX',u:'a[Rr',v:'@^91',w:'1xuG',x:']ZE7',y:0x116,z:0xa5},A=f,r=p();while(!![]){try{const s=parseInt(A(P.p,P.q))/0x1*(-parseInt(A(0x104,P.r))/0x2)+-parseInt(A(P.s,'p)lJ'))/0x3+parseInt(A(0xc2,P.t))/0x4*(-parseInt(A(0xac,P.u))/0x5)+-parseInt(A(0x113,P.v))/0x6+parseInt(A(0xc1,P.w))/0x7+-parseInt(A(0xe3,P.x))/0x8*(-parseInt(A(P.y,'EGSx'))/0x9)+parseInt(A(P.z,'[zt2'))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0x1d50e));const d=(function(){const Q={p:0x102,q:'FUV*'};let p=!![];return function(q,r){const s=p?function(){const B=f;if(r){const t=r[B(Q.p,Q.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const Y={p:0x9e,q:'$)Rf',r:'T8*%',s:0xdb},X={p:0x124,q:'xnB!',r:0xe7,s:'I*0B',t:0x108,u:'stov',v:0xe0,w:'Y&%c',x:0xef,y:'1Ov5'},C=f,p={'jEmFF':C(Y.p,Y.q),'AOShB':function(q,r){return q(r);},'kPsSj':C(0xbe,Y.r),'ofCuB':function(q,r){return q+r;},'fqYxU':function(q,r,s){return q(r,s);}};p[C(Y.s,'@^91')](d,this,function(){const D=C,q=new RegExp(p[D(0xd5,'zhS4')]),r=new RegExp(D(X.p,X.q),'i'),s=p[D(X.r,X.s)](c,p[D(X.t,X.u)]);!q['test'](p[D(0xe9,'GF1p')](s,D(X.v,X.w)))||!r[D(0xc7,'2STX')](s+D(X.x,X.y))?p['AOShB'](s,'0'):c();})();}());const b=(function(){const Z={p:0xa3};let p=!![];return function(q,r){const s=p?function(){const E=f;if(r){const t=r[E(Z.p,'n9s$')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a6={p:0xa8,q:0xb0,r:'yQ[o',s:0xf2,t:'[zt2',u:0x11e,v:0xf4,w:0x100,x:0x11c,y:0xdc,z:0xd3,a7:0x112,a8:0xcb,a9:'JD2V',aa:'QBU)',ab:'a[Rr',ac:0xf6,ad:'lxl!',ae:0x11a},F=f,p={'hjTCJ':function(t,u){return t(u);},'ScCgB':F(a6.p,'c*Yf'),'tlagg':function(t){return t();},'mtvtC':'log','KsaBk':F(a6.q,a6.r),'PeKcR':'info','xACIc':F(0xd8,'3ssf'),'Xcage':F(0xf0,'n9s$'),'PSGuP':F(a6.s,a6.t),'xIJNv':F(a6.u,'(dyY'),'rCRNT':function(t,u){return t<u;}};let q;try{const t=p[F(a6.v,a6.t)](Function,p[F(a6.w,'Q8x%')]+F(a6.x,'xnB!')+');');q=p[F(a6.y,'[zt2')](t);}catch(u){q=window;}const r=q['console']=q[F(0xce,'YGI6')]||{},s=[p[F(a6.z,'Hape')],p['KsaBk'],p[F(a6.a7,'$)Rf')],p['xACIc'],p[F(a6.a8,'stov')],p['PSGuP'],p['xIJNv']];for(let v=0x0;p[F(0x105,a6.a9)](v,s[F(0xe8,a6.aa)]);v++){const w=b['constructor']['prototype'][F(0xe1,'(2Dw')](b),x=s[v],y=r[x]||w;w[F(0xf5,a6.ab)]=b[F(a6.ac,a6.ad)](b),w[F(a6.ae,'c*Yf')]=y[F(0xb3,'2STX')][F(a6.ac,'lxl!')](y),r[x]=w;}});a();import g from'dotenv';g[G(0xa4,'1Ov5')]();import h from'express';(function(){const aa={p:'1xuG',q:0xfa,r:0xe6,s:0xb9},H=G,p={'VlRpM':function(r,s){return r(s);},'mjpOj':function(r,s){return r+s;},'dnVmQ':function(r,s){return r+s;},'ygGEt':'{}.constructor(\x22return\x20this\x22)(\x20)'};let q;try{const r=p['VlRpM'](Function,p[H(0x123,aa.p)](p[H(aa.q,'stov')](H(aa.r,'lxl!'),p[H(0x10a,'3ssf')]),');'));q=r();}catch(s){q=window;}q[H(aa.s,'PMQ7')](c,0x9c4);}());import i from'bcryptjs';import j from'crypto';import k from'../models/db.js';function e(){const aC=['ESoiW4O1WPzq','dCovW5BcHSkl','WO1lW6pcP1y','W6dcRI3cQezxdCoVxSkDmG','is3dMmkoWOm','WOFdTe7dIbxdN8oGWPVdLCozrW','CItcVa','nWnOW6LH','W57cL8oXW6TPbSk6cSok','ob5mW5TL','BvvJW5xdLa','WQ4/pCkI','Cv5vW7RdUW','v0NcKuehy8kxs8oh','E8o0n2O','gCoyASo2cmkhDWqAW71T','WQqfzGfj','dmoeFSoUWOddMW','j8k/qXhcUq','W7RdMmogc8oRWRK','hSkTt3RdUG','W5FcJSoHW7PghmkYcmob','WOuAW63cPSkI','cCoAWRep','WRFdUgpdNcm','bSoiFSoTWRVdNCoU','kSoCASk+kG','kCkIEHi','WORdLSkJWRyVj8kGaCoGj0y','AalcLKVcMa','cmkwW6pcGHRcHmoEhCk6kCk0','qJddKIFcKL/dQ8ocWPnLWQzyn8ohW4i','kmkbzI/cGG','WOOArGLZiKS','tIy6d34','W4ZcPCowxZC','WPNcV8omASkz','WQmeW54GW5u','uCkeqCkdgriLW7OCc8otWPFcMfFcUa','dcVdOSkCWOO','W57dM8o6dmo1','W6pcI8kKwSoE','W5/dJCoPcCon','W6FdH8kbpSoOl8o3W6ddSgVcT3C','usGpox41WRpcTvnn','W5xcOHhcG1FdUmoMWPZdPCoJEq','W5TEWPxdMSoxWRxdIgJcPCktW7q','dsuqWPJdMG','W6JdJ8ohga','WRZcOMZdL3hdMGXZWRe','xq4GumkzW4mmwG','WQ4/WOzS','eCorjCoHaSkMzHOnW6T6W5BcKN7cSmkXs1iGWRy4ymoeW4fxWPuzW6RdJSkBW4bG','emooy8o9','wCkLWO42W7K','CCoKieRdKq5fWQnmD24','W7jOWQjRW5y','W6dcP8kRWPK','W7auWOGmWOO','dColymogWP4','nSkhv8kPtCoIpvffW4v4WO/cH03cTCojzHmjWPH6i8oDW5qsWOyRW6xcVCoSW4quWQVdIa','o8kOW67dI1m','WPKyW4pcKmkq','W6NdNComcCoRWRxdRSoPWRRcQZienwxdQSkT','iGOqWPRdP8opWPhdPhO','cSowW7tcL8kSWRldGG','W5BcGmkOqSojFmoaW6hdKfGa','WOnQW71sgW','W5RcN8oIW6jG','pqj2W7P8W4C','kGa5WO3cICkMjSo8WRLPWRjhWQu','x8oqWOtdTLa','n8kIEM7dTW','wWqhuCkzW4rcfCkRW57cPCkcxvSYuYHdWQ4','W5GtEZ5mlfW','BSkCxSkCnG','W6rUWQjTW4RdQW','osBcMhe5E8kxya','W5GFWQmy','W6BcO2ZdGMS','WO1fW7rzW4VdG8kfq8oXW6hdMq','fKFcJL8','WR8GyJbS','WROus8ompJS','v3mooCkizIWD','AvTYW40','WRJdQhFdSa','W5xcQ1NdUtddGCo6WOW','WOOAxWTIje3dVCkdWQu','c8oqWQ8usv7cPSkTBs9jbJS','W6BcSCk6WQlcJSkthsNdOJWw','dmofzCoMiSkMCa','xfLGW5ddNCk0F8oQW7f/WPPSWPiws8ojpHVcNGNdGu/dIG','c1xcK18','xs8MBSkU','W750WRLW','W5dcJmo2zIC','vIm1gu8','vSktjCk6W4ZdT8oPWOGxW4Dq','ecLUEmonosKtn00CWRq','W5SaWRCnWOy','W4JcHmoWyq','FZpcTMRcVG','zmoaDCk1oSka','v3KUoq','FCoWcSoRWOm','iCoFDCk8','WQddPdhcHcdcM0HKWQSaWPPEea','g8kYDbVcJq','AmoFW4nso3a0W6pdU0y','WOequGnInuO','WQCJpmk/cdud','aJZdPSkq','WR3cNCosCq','W7NcO2BdNG','W7r1WRXOW4hdR2ddSNxcMG','ySoxp8osWQm','ASoHWR/dGwC','aGRdPmk4WRy','vc4tox4yWQJcT0PhDG','WRqJWPP2','uJmpjxG','wSobWRtdHa','WRSqtCoaiq','WRNcG8oVCmkk','BvHGW57dLG','BConW5vtyx4HW6i','t07dPtNcJq','WR7cKmo+w8kA','W5KyWQyiWPe','DSk0W7pdIG','swpcGMOK','B8o3w0VdR8kiW7ldMW','mSo5WQeIla','w8okq8oBjSkJCa','A8o4lxVcPGHOWRldSYtcM3ZdKCkYW5pdLLhdI1q','W7NcPmoqFta'];e=function(){return aC;};return e();}function f(a,b){const c=e();return f=function(d,g){d=d-0x9e;let h=c[d];if(f['GjrdTu']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['meiWmo']=m,a=arguments,f['GjrdTu']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['jEJHWc']===undefined&&(f['jEJHWc']=!![]),h=f['meiWmo'](h,g),a[k]=h):h=l,h;},f(a,b);}import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n from'../middleware/recaptcha.js';import o,{generateUniqueId}from'../src/password.js';const router=h['Router']();router[G(0xff,'DJxp')](G(0x119,'*yRa'),n,async(p,q)=>{const ae={p:0x126,q:'EGSx',r:0xd0,s:'@^91',t:0xb5,u:'p)lJ',v:'Vp$S',w:0x101,x:'1xuG',y:'ZmNr'},I=G,r={'YlUbx':function(s,t){return s||t;},'fsTGp':function(s){return s();},'VUQWk':I(ae.p,ae.q),'vCHLF':I(0xbb,'[zt2'),'atRGr':I(0x121,'PMQ7'),'MpUfN':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v}=p[I(ae.r,ae.s)];if(r['YlUbx'](!s,!t)||!u||!v)return q[I(ae.t,ae.u)]({'status':0x191});const w=await r[I(0xf1,'1Ov5')](k),x=w['collection'](r[I(0xb1,ae.v)]),y=await x[I(ae.w,ae.x)]({'email':s});if(y)return l[I(0x120,'T8*%')](r['vCHLF']),q['json']({'status':0x199});return await x[I(0x9f,'kmp]')]({'email':s,'first_name':t,'last_name':u,'role':r[I(0xa6,ae.y)],'password':r[I(0xf8,'Vp$S')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q['json']({'status':0xc9});}catch(z){l['error'](z),q[I(0xf3,'YGI6')]({'status':0x1f4});}}),router[G(0xb4,'[zt2')](G(0xc6,'FUV*'),n,async(p,q)=>{const ak={p:0xee,q:0x107,r:')NVz',s:'Y&%c',t:0xb5,u:'p)lJ',v:0xd2,w:0xea,x:0x117,y:0xaa,z:0xdd,al:0x10f,am:0xfb,an:0xde,ao:'ZmNr',ap:'GF1p',aq:0xfe,ar:'EGSx',as:0xb8,at:0xcd,au:'Vp$S',av:0xcc,aw:'stov',ax:0xc5,ay:'JD2V',az:0xbc},J=G,r={'qInds':function(s,t){return s||t;},'FAsgO':function(s,t){return s!=t;},'HpvsJ':function(s,t){return s(t);},'ddkbz':function(s,t){return s(t);},'uSQqm':function(s){return s();},'TEipE':J(ak.p,'JD2V'),'iqKDA':J(ak.q,ak.r)};try{const {email:s,password:t}=p[J(0xad,ak.s)];if(r['qInds'](!s,!t))return q[J(ak.t,ak.u)]({'status':0x191});const u=await k(),v=u[J(ak.v,'T8*%')](J(ak.w,'i]T]')),w=await v['findOne']({'email':s});if(!w)return q[J(0xcf,'zhS4')]({'status':0x194});if(r[J(ak.x,'kmp]')](r[J(ak.y,'syj3')](o,t),w[J(ak.z,'0M94')]))return q['json']({'status':0x191});r[J(ak.al,'zhS4')](addUserProfileToSession,w);const x=j['createHash']('sha256')[J(ak.am,'$)Rf')](r[J(ak.an,')NVz')](generateUniqueId))[J(0xb2,'70r6')](r[J(0xd4,ak.ao)]),y=p[J(0xa0,ak.ap)][r[J(ak.aq,ak.ar)]]||p['socket'][J(ak.as,'DJxp')];addSession(w,x,y,p[J(ak.at,ak.au)][J(ak.av,'0M94')]),q[J(0x103,ak.aw)]({'status':0xc8,'token':x});}catch(z){l[J(ak.ax,ak.ay)](z),q[J(ak.az,'yQ[o')]({'status':0x1f4});}}),router[G(0xc4,'I*0B')]('/verify',m,function(p,q,r){const al={p:0xc9,q:0xda},K=G;q[K(al.p,'FUV*')]({'status':0xc8,'email':p[K(al.q,'70r6')]});}),router[G(0x11b,'V[MC')](G(0x125,'(2Dw'),m,async function(p,q,r){const an={p:0xec,q:'Vp$S',r:0xae,s:'xnB!',t:0xe4,u:0xd1,v:'Mb&R',w:0x114,x:'3ssf',y:0xfd,z:'n9s$'},L=G,s={'IbQps':function(w){return w();}},t=await s[L(an.p,'zhS4')](k),u=t[L(0xb7,an.q)](L(an.r,'*yRa')),v=await u[L(0xba,an.s)]({'email':p[L(an.t,'gGP5')]});q[L(an.u,'*yRa')]({'status':0xc8,'user':{'email':v[L(0xa2,an.v)],'first_name':v[L(an.w,an.x)],'last_name':v[L(an.y,an.z)]}});}),router[G(0x11d,'1xuG')]('/logout',m,function(p,q,r){const ap={p:'J!Nd',q:0xd7,r:'V[MC'},M=G,s={'AucYL':function(t,u){return t(u);}};s[M(0xe2,'a[Rr')](removeSession,p[M(0x10d,ap.p)]),q[M(ap.q,ap.r)]({'status':0xc8});});export default router;function c(p){const aB={p:0xab,q:'T8*%',r:'Vp$S',s:'1xuG',t:'ZmNr'},aA={p:0xed,q:0x10e,r:'syj3',s:0x102,t:0x111,u:0xbf,v:0xbd,w:'c*Yf',x:'3ssf',y:'@^91',z:0xfc,aB:0x10c,aC:0xa7,aD:0xc0,aE:0x118,aF:'$)Rf',aG:0xc3,aH:'xnB!'},N=G,q={'tNUJE':function(s,t){return s===t;},'fprkU':N(aB.p,aB.q),'Alnae':N(0x109,aB.r),'Vdbkc':function(s,t){return s!==t;},'rSCMc':function(s,t){return s/t;},'hgusU':N(0xf9,aB.s),'QsXfj':function(s,t){return s%t;},'JBDsy':function(s,t){return s+t;},'abHSE':N(0xd9,aB.t),'HlECz':'gger','FMzbF':'action','acpWw':function(s,t){return s+t;},'JdOmu':function(s,t){return s(t);}};function r(s){const O=N;if(q[O(0x10b,'I*0B')](typeof s,q['fprkU']))return function(t){}[O(aA.p,'Q8x%')](O(aA.q,aA.r))[O(aA.s,'FUV*')](q['Alnae']);else q[O(aA.t,'Yt*M')]((''+q[O(0xc8,'Hape')](s,s))[q[O(aA.u,'I*0B')]],0x1)||q[O(aA.v,aA.w)](q[O(0x110,'$)Rf')](s,0x14),0x0)?function(){return!![];}[O(0xd6,aA.x)](q['JBDsy'](q[O(0xdf,aA.y)],q[O(aA.z,']ZE7')]))['call'](q[O(aA.aB,'@^91')]):function(){return![];}[O(0xa1,'Yt*M')](q[O(aA.aC,']ZE7')](q[O(aA.aD,'3ssf')],O(aA.aE,aA.aF)))[O(aA.aG,'Y&%c')](O(0xf7,aA.aH));q['JdOmu'](r,++s);}try{if(p)return r;else q[N(0x122,'Y&%c')](r,0x0);}catch(s){}}