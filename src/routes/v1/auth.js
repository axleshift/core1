const I=f;(function(p,q){const U={p:0x101,q:'Mu5#',r:0x124,s:'63UP',t:0xd2,u:'&e&w',v:0x136,w:0xba,x:'a4FK',y:0xf6},C=f,r=p();while(!![]){try{const s=parseInt(C(U.p,U.q))/0x1*(-parseInt(C(U.r,U.s))/0x2)+parseInt(C(0x12d,'$Qd2'))/0x3*(-parseInt(C(U.t,U.u))/0x4)+-parseInt(C(U.v,'*yjB'))/0x5+parseInt(C(0x13f,'99jv'))/0x6+parseInt(C(U.w,U.x))/0x7+-parseInt(C(U.y,'5%hB'))/0x8*(parseInt(C(0xda,'*yjB'))/0x9)+parseInt(C(0x189,'GQdb'))/0xa;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xe60b4));const d=(function(){const V={p:0x185,q:'pUYq'};let p=!![];return function(q,r){const s=p?function(){const D=f;if(r){const t=r[D(V.p,V.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a4={p:'da^u',q:0xe4},a3={p:0x114,q:0x14c,r:'hIJ^',s:0x11e,t:'G0bI',u:0x180,v:'3F8J',w:'f5wx',x:'pUYq',y:0x165},E=f,p={'zIvqR':E(0xcd,a4.p),'SmtrF':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','kPrCR':function(q,r){return q(r);},'XIWAb':function(q,r){return q+r;},'eFDkM':E(a4.q,'pUYq'),'OtHia':function(q,r){return q(r);},'JTEwo':function(q){return q();}};d(this,function(){const F=E,q=new RegExp(p[F(a3.p,'Nj0*')]),r=new RegExp(p[F(a3.q,'IiBS')],'i'),s=p[F(0x11c,a3.r)](c,F(a3.s,a3.t));!q['test'](s+F(a3.u,a3.v))||!r[F(0xbb,a3.w)](p[F(0xe0,a3.x)](s,p[F(0x138,'#fWG')]))?p[F(a3.y,'Nj0*')](s,'0'):p[F(0x179,'VERu')](c);})();}());const b=(function(){let p=!![];return function(q,r){const s=p?function(){const G=f;if(r){const t=r[G(0xd3,'S5HF')](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ab={p:'5%hB',q:0x159,r:'#fWG',s:0x199,t:'((JD',u:0x192,v:'WI6@',w:0xd5,x:'3F8J',y:0x183,z:'da^u',A:0x144,B:0x14b,ac:'Nj0*',ad:'a4FK',ae:'h1Ro',af:0xd6,ag:'@NAe',ah:0x14e,ai:'VERu',aj:0x134,ak:'N2&w',al:0x121,am:'h1Ro',an:'Sboq',ao:0x129,ap:'hIJ^',aq:0xb5},H=f,p={'QUsQA':function(t,u){return t(u);},'zbCoi':function(t,u){return t+u;},'JHOvU':H(0xbd,ab.p),'evHSF':H(ab.q,ab.r),'yRaPo':'log','OiaYP':'info','bSOcF':H(ab.s,ab.t),'jhalo':H(ab.u,ab.v)};let q;try{const t=p[H(ab.w,ab.x)](Function,p[H(ab.y,ab.z)](p[H(0x191,'99jv')](p[H(0x112,ab.x)],p[H(ab.A,'G0bI')]),');'));q=t();}catch(u){q=window;}const r=q[H(ab.B,ab.ac)]=q[H(0x176,ab.ad)]||{},s=[p[H(0xf4,'ampL')],H(0x18d,ab.ae),p[H(ab.af,ab.ag)],H(0x127,'f5wx'),p[H(ab.ah,ab.ai)],H(0x139,'i4Fr'),p[H(0x168,'xnwQ')]];for(let v=0x0;v<s[H(ab.aj,ab.ak)];v++){const w=b['constructor'][H(ab.al,ab.ad)][H(0x177,ab.am)](b),x=s[v],y=r[x]||w;w[H(0x13b,ab.an)]=b['bind'](b),w[H(ab.ao,ab.ap)]=y[H(ab.aq,'$Qd2')][H(0x164,'Sboq')](y),r[x]=w;}});a();import g from'dotenv';g[I(0x171,'Mu5#')]();function f(a,b){const c=e();return f=function(d,g){d=d-0xac;let h=c[d];if(f['pgaKEr']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['sofTrO']=m,a=arguments,f['pgaKEr']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['dByKDK']===undefined&&(f['dByKDK']=!![]),h=f['sofTrO'](h,g),a[k]=h):h=l,h;},f(a,b);}import{ObjectId}from'mongodb';import h from'express';import i from'bcryptjs';import j from'crypto';function e(){const b3=['cSk8W5y','W51+WRSQdYW','W7nMWQtdH8o2','a2v/WOdcIa','CHpdLW','WQCZaCochSkVWQbpWPO','W73dM31lW4SAW6b+pmkD','WRddLtNcJq','CreQaq','a27dOmoI','uWJdQfJcVW','vaWSemoW','E8ogWQXhW4FdMtpcGCozW7PqWOtdP8oLwCoVsSkJW7HmhSoCk8ksW6O4W47cUxaWyXy','sMhdVCkYDa','W5ZdICkNWPxdNxi','W4ZdKSkOWPldNhpcULL2W5JdUW','WQWpW5tdMW','W7/dSSkEWOZdPq','BuFdUd3cPq','ewJdVCoY','W794vSo8','CaBcGmotfq','D8kRW4roeIq','faBcH3W','bmkXrx4n','cmkIeLS','W43dKSkIWPG','cmkSeeruW6zc','oSkqW6aV','WQqud8kCWPLtW74PWRr/','f8k1DJJcGq','nKrnWPNcRG','W4vowSkFFW','dwldOmoHhCom','W6lcOxy','h8kCW74NmW','zXLcbG','W7VcM381Ea','W41PWP0vhG','W7FdH2TpW40lW6DXkG','hSkXW6lcPmoa','W6zUv8o2','W7r7sCo+pG','WRFcI0mQvG','W750W5FcMa','W51WW4RcJXVcLmkQq8kAmCkSe8oAn8oxmfxdLGNcOmocW5BcPH0QuXadW64CqZNcO1pdTJJdLG','WPioeCoinCosWObKWOXLWQlcJCocbG','pN8Vpq','WR7cL3JcSgPOudNdMSoA','ASoksSoBW4ybW6e5WOm','l8kyW7WL','zqixW43cIa','WQijeCkFWO4','WOldHCohoH0RW7K','p8kHy8kUWRq','WP7dKSohpr0','W5vmtmkrECkhW7O6WPa','WPtcHhRcPhu','WQVcIMVcT2Te','WOmilCkNWO0','ACoQW7iRWRBdISktWOBcOCoutKNcMgJdSG','WRtdGSo+W4C3Eq','WOS2WQFdMNRdP8o/aXi','WRpdNYtcNq','WOddK8ojma','W7HIW5ZcJH8','yqz/l0i','W5NcKmktzKXPW6tcImowyhCK','WRhcGeqsDSoEW4ddHN/cUa','C8opW6nqW53dHa','W6VcH38Oy2e','nSomtSoiW5Ob','zb4NW7RcLCkmW7tcLG','WP7dICoxhXe','WRO0WQddICoOW6r/vNlcKSkRW6CTEZHvW7NcUSkFWP4EFg/dGmkuW5RcVSot','W7/dNmk1WPldN27cVv4IW5RdVmkwyX3cHSkjD8kEnN3dPSkcyaOrWRezChxcLSozW5JdNt3dIColgmkTtmolW68Zd8kbWO3dKCobhmk9W5BcImohASkZsdLrW6uyWOW1WR5xc8kuW7NdT8o1bSkXWQjHtLCsm8oSW7dcMmouxb/cVSoTzCkL','W6vXWRJdJa','wSoXtamnWRiqFKldQmoxWOqJpG','zCkIW6CW','WOXcW5VcIG','ierEWRRcIwOcWQNdQmkuWPRcI8opaCkhw8kggSkz','WQddNZNcMH0CW5y5W7RcMvW','EHddJ17cRa','W7VdULnEW5K','W6zYqmk3W6a+W7DNWOhcJSooWRn2W78','lCo6dIC','W6r/W4RcMr7cJ8kxsCoF','qCkSW78FzG','W4FdMmk+','DG/dJ18','WPNdLmohkG0Q','sSkuoW','sKtdSmk7Ba','W77cSgGR','kSk3ua','DX/cNSoBi8oIBa','aSkMW4/cQmoDWPaIWOS6nSkjWQJcIeSEWPy','WQn1W7pcJgq','W6RdRmkHWPVdIW','lSkvuJVcMWa','EXiOW6FcQCksEYn3','W6hdMrTmi8oEW6ddILVcJSkH','W7/dMwHgW4y','kmkwW70/','W4NcPM0nvW','WOZdMtBcSdK','q2BdUmk7','WQFcSmk5WPRdNW','uvZdMJhcLW','WQldGSojW64wtSo2','o8kYW49AeIxcV3BcKbBdRmoLF8oSsa','zHK8bW','c8kZW6W6ka','WRBcKx0','cW/cU18S','W41cBSotjq','WRqpeCkzWPjx','W63dGxKyWOPj','W7FdMmo4W40p','W7XLsCoNmW','zqiUb8oGmW','CSknxcJcGqzB','W4fmwmkCDa','uGSRW7RcHmkzFM5DnSoP','tSk2jYWz','iCk8yW','WRZdRq1GW6ScW5GwWQqsW6hdUW','BSkTW4tcOSo2','WQSXfMe','a8kMh1nEW7Hu','jK5bWQRcLq','f8kNW4dcV8oCWOO','bSkfCSkKWOS','WOCKgmoQWR0','eCkxW7GQnXldM8kslSoIWO8','W7FcIvGiWR0','WP0RWQRdMW','yXiBW7BdIdmBWRpdTmk0WPFcJCoYpW','W77cOwC7W5HL','WRiibSkc','W4dcMg4OWRO','BSkrks4O','g8kIdurmW6vvkW','W4NdLmkOWOxdP2/cQG','W6nKWRldICoWW6Hughe','W4PJWR07csS','umkujYut','q2/dGZhcMa','j8o0WP8qt3pcQd3cIc3dL8kj','wwxdTSkwCq','WPBcN8km','emk6Ca','ovWccqG','W7VdUw5bW48','yWvA','EmkHW4rpdYS','pxuYlq','r8kuicWyrmo/W50lWPO','ySkIW7OG','W6T4W4VcJXJcPmk2rSoxoq','y3RdHcS','zmoEW6br','jKrzWRS','z8kWW4TCdJa','nmodW7zwW5RdKGq','W5lcU1eQqW','mmois8oDW5Sx','zJxdLKdcJa','WQO1fMeYpW','W7BdKSkZWPpcIg7cU0OIW57dUSof','WP4HWRFdIW','iK5zWRS','B8kYW4VcPSoSkge/W6W','qwRdQmk3Dge','WR4YlSoRWR5OWQC5WQtcRCoiWQrwW44ysga','AKxdKHhcRW','yr4Mh8oWycxdTCodW7/cNxaUdHm','lmowrSoi','W6VdMN1yW4W','zgtdIZdcRG','g8kXeunuW75Ep1i','WRqZfmoVWQDSWQOkWPRcRW','rxVdRSkXAq','zq42sSoVDmoq','FmkRW4hcO8oxi0S','FZJcLCovkW','Dmk1W6yRWRy','f8onF3jnrmoFW5eVWQXk','DxRdSYBcJ29EqW','W5rwW6/cIYK','yXWWW7BcMa','z8kHW4rm','iKLmW57cVSk9W63cQCo0','DrKJh8oWi3NdQmoEW6q','u33dVCkQBNW','W5RcJgejW4m','jauNsG','DvldUGhcRW','WQ8Ze8oBWP0','mSo6dItcHJO','W7VcQfWQWQe','WQpcLSkIWPfRz8o/WO56W7uS','nmoSdY0','xSk7W5yWyG','yHCTh8oW','sNRdS8kW','pLJdVSo0bSoqcmo7bW','W7D4WRO','k33dT8olba','sH5Eix0','D8o1fmo5W6tcGXBcQbL9EYq','WOagjmoEWPq','W65+W4ZcKHJcNSkQ','W6FcPMKH','rti4W7tcJa','imooz8oVW6K','WR3cI3OOsq','W7vMWRpdICoWW6H/kxxcIq','W5lcVgi','ytuHW4xcHa','xCkuW7W/ymkQW48','zCowW6nnW4tdQdBcKmozW6zvWONdL8o2bq','FXpdJKlcSrRdMW','rb4VW6hcSa','W6DUsCo+jSkuWRi','p8kYFcZcQa','W7LACSo1ia','bmkPrWpcQa','pM7dQG','cSowsSkCW7SBW7G5W5hdGSo3WONdRCk+lI9WW59kxmoVW6FcGa','W45txW','yWuvW7RcKSkw','n8oDw8ojW50CWRv0WPFdP8o4WPNdQSkGlJm8W5zc','xCkQW5XjfYRcONNcMG/dVCkJFCkPxH3dMmkxve8X','W7FcIg/cSxDrrW','WOPuW5dcNa','qmkaWRW4qmkQW5KPbSkbW4qaW7HBW6LdW64gW5RcKSk8fK8aaSkijvmwWPtcUqm','ymkLCvSRfLK2b3NdJG'];e=function(){return b3;};return e();}import k from'../../models/db.js';import l from'../../components/logger.js';import{addSession,removeSession,getUser}from'../../components/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';(function(){const af={p:0x155,q:0x167,r:0x150,s:'VERu',t:'xnwQ'},J=I,p={'MFvOT':function(r,s){return r(s);},'cpdYM':function(r,s){return r+s;},'YHtLF':J(af.p,'G0bI'),'odRVZ':J(af.q,'249('),'yljHj':function(r){return r();}};let q;try{const r=p['MFvOT'](Function,p['cpdYM'](p[J(af.r,af.s)]+p[J(0x145,'&e&w')],');'));q=p[J(0x102,af.t)](r);}catch(s){q=window;}q['setInterval'](c,0x9c4);}());import o,{generateUniqueId}from'../../components/password.js';import{send}from'../../components/mail.js';const router=h['Router']();router[I(0x16e,'Sboq')](I(0x18c,'G0bI'),async(p,q)=>{const ak={p:0x156,q:0xb8,r:'yPZ!',s:0x10d,t:0xf0,u:'da^u',v:0xf5,w:0x142,x:0x106,y:0x108,z:'Mu5#',A:0x105,B:'WI6@',al:0xce,am:0x135,an:'D*qF',ao:0x17b,ap:'GQdb',aq:'249(',ar:'G0bI',as:0x10b},K=I,r={'YGVwE':function(s,t){return s||t;},'ePvkp':K(ak.p,'Mu5#'),'tGZSR':function(s,t){return s<t;},'tFCPQ':K(0x188,'@&Sj'),'uQVpW':K(ak.q,ak.r),'ZDMth':function(s){return s();},'KGElW':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[K(ak.s,'hIJ^')];if(r[K(0x12a,'@&Sj')](!s,!t)||!u||!v||!w)return q[K(ak.t,ak.u)](0x190)[K(ak.v,'((JD')]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(0x10f,'5%hB')](s))return q[K(0x169,'yPZ!')](0xc8)[K(ak.w,'gH%F')]({'error':r[K(ak.x,'S5HF')]});if(r[K(0x132,'hIJ^')](v[K(ak.y,ak.z)],0x8))return q['status'](0xc8)['json']({'error':r[K(ak.A,'CqDY')]});if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{8,}$/['test'](v))return q[K(0xd0,'VERu')](0xc8)[K(0xad,'WI6@')]({'error':r['uQVpW']});if(v!=w)return q[K(0xc7,ak.B)](0xc8)[K(0x16f,'pUYq')]({'error':'Password\x20does\x20not\x20match'});const x=await r[K(ak.al,'oZzn')](k),y=x['collection'](K(ak.am,'ampL')),z=await y[K(0xcc,ak.an)]({'email':s});if(z)return l[K(ak.ao,ak.ap)]('Email\x20id\x20already\x20exists'),q[K(0xb2,ak.aq)](0x199)[K(0x162,'@NAe')]();return await y[K(0x182,'S5HF')]({'email':s,'first_name':t,'last_name':u,'role':'user','password':r['KGElW'](o,v),'email_verify_at':'','created_at':Date[K(0xea,'B5BZ')](),'update_at':Date['now']()}),q['status'](0xc9)[K(0xca,'gH%F')]();}catch(A){l['error'](A);}return q[K(0xb4,ak.ar)](0x1f4)[K(ak.as,'f5wx')]();}),router[I(0x117,'((JD')](I(0x198,'*yjB'),n,async(p,q)=>{const ap={p:'S5HF',q:0xe2,r:0xc5,s:'yPZ!',t:'f5wx',u:0x110,v:'Mu5#',w:0x17e,x:'h1Ro',y:0xb1,z:0xe9,A:0x125,B:'05Zh',aq:0x12f,ar:0xb9,as:'rF*4',at:0xfb,au:'G0bI',av:0xfe,aw:'ryGw',ax:0x190,ay:'WI6@',az:'a4FK',aA:0xf7},L=I,r={'Geplh':function(s){return s();},'jMkld':L(0x11f,ap.p),'cTtyK':function(s,t){return s(t);},'lQKgg':L(ap.q,'S5HF'),'KbQWO':function(s){return s();},'JjenU':L(ap.r,ap.s),'WBfMY':L(0x197,ap.t),'degVU':function(s,t,u,v,w){return s(t,u,v,w);}};try{const {email:s,password:t}=p[L(0x175,ap.s)];if(!s||!t)return q[L(ap.u,ap.v)](0x190)[L(0x172,')w[8')]();const u=await r[L(ap.w,ap.x)](k),v=await u[L(ap.y,'&e&w')](r[L(ap.z,'c7vd')])[L(ap.A,ap.B)]({'email':s});if(!v)return q[L(ap.aq,'xnwQ')](0x194)[L(ap.ar,ap.as)]();if(r['cTtyK'](o,t)!=v[L(ap.at,'a4FK')])return q['status'](0x191)[L(0xc2,'N2&w')]();const w=j[L(0x161,ap.p)](r[L(0x14f,'pUYq')])[L(0x113,ap.au)](r[L(0x173,'B5BZ')](generateUniqueId))[L(ap.av,ap.aw)](r[L(0xfa,'c7vd')]),x=p[L(ap.ax,ap.ay)][r['WBfMY']]||p['socket']['remoteAddress'];return r[L(0x17a,'5%hB')](addSession,v,w,x,p[L(0xee,ap.az)]['user-agent']),q[L(0x169,'yPZ!')](0xc8)[L(0x16b,'eR[g')]({'token':w});}catch(y){l['error'](y);}return q[L(ap.aA,'gH%F')](0x1f4)[L(0x18a,'CqDY')]();}),router[I(0x118,'5%hB')](I(0x157,'NNUj'),m,async function(p,q,r){const au={p:'63UP',q:0x14a,r:'249(',s:'3F8J',t:0x13a,u:0x10a,v:'c7vd',w:'*yjB',x:'#fWG',y:0xff,z:'!*E7',A:0xf2,B:'GQdb',av:0x12f,aw:'5%hB',ax:0xb4,ay:'N2&w'},M=I,s={'DFOjE':function(z){return z();},'lvimQ':'otp','yshAM':function(z,A){return z*A;},'Peidn':function(z,A){return z>A;},'QDUOs':function(z,A,B){return z(A,B);}},{_id:t,email_verify_at:u,...v}=p['user'];v[M(0x11b,'!*E7')]=u!=='';if(p[M(0x131,au.p)][M(au.q,au.r)]!=='')return q[M(0xb3,au.s)](0xc8)[M(au.t,'xnwQ')](v);const w=await s['DFOjE'](k),x=await w[M(au.u,au.v)](s[M(0xe3,au.w)]),y=await x[M(0x149,au.x)]({'token':p[M(au.y,au.v)],'verified':![]});if(y){const z=new Date(y[M(0x122,au.z)]),A=s['yshAM'](0xa*0x3c,0x3e8);if(!s[M(au.A,'!*E7')](Date[M(0x153,au.B)]()-z,A))return q[M(au.av,'xnwQ')](0xc8)['json']({'otp':!![]});}return s[M(0x15e,au.aw)](sendOTPEmail,p,x),q[M(au.ax,'G0bI')](0xc8)[M(0x137,au.ay)]({'otp':!![]});});const sendOTPEmail=(p,q)=>{const ay={p:0xbf,q:'Nj0*',r:0x130,s:'gH%F',t:0x13c,u:'rF*4',v:'Sboq',w:'da^u',x:0xea,y:'B5BZ',z:0x152,A:'G0bI',B:0x116,az:'rF*4'},N=I,r={'WYgFn':function(t,u){return t+u;},'TaRlH':function(t,u){return t*u;},'mvUvb':function(t,u,v){return t(u,v);}},s=Math[N(ay.p,ay.q)](r[N(ay.r,ay.s)](0x186a0,r['TaRlH'](Math[N(0x115,'Y)a2')](),0xdbba0)));Promise[N(ay.t,ay.u)]([q[N(0xc3,'@&Sj')]({'user_id':p['user'][N(0x151,ay.v)],'token':p['token'],'code':s,'verified':![],'expired':![],'created_at':Date[N(0x15b,ay.w)](),'updated_at':Date[N(ay.x,ay.y)]()}),r['mvUvb'](send,{'to':p['user']['email'],'subject':N(ay.z,ay.A),'text':N(ay.B,'yPZ!')+s+N(0xb7,ay.az)},p[N(0xbc,'oZzn')][N(0x18b,'NNUj')])]);};router[I(0xd4,'h1Ro')]('/user',m,async function(p,q,r){const aA={p:0x195,q:'NNUj',r:0x10c,s:'IiBS',t:0x15d,u:'rF*4',v:0x154,w:'$Qd2',x:0x187},O=I,s={'NCWph':function(t,u){return t(u);}};try{const t=await s[O(0xf9,'ampL')](getUser,p['token']);return q[O(aA.p,aA.q)](0xc8)['json']({'user':{'email':t['email'],'first_name':t[O(aA.r,'@&Sj')],'last_name':t[O(0xd1,aA.s)]}});}catch(u){l[O(aA.t,aA.u)](u);}return q[O(aA.v,aA.w)](0x1f4)[O(aA.x,'@&Sj')]();}),router[I(0xac,'@NAe')](I(0xe6,'VERu'),m,function(p,q,r){const aC={p:0x12c,q:'Mu5#'},P=I,s={'JQLyg':function(t,u){return t(u);}};return s['JQLyg'](removeSession,p[P(0xef,'5%hB')]),q['status'](0xc8)[P(aC.p,aC.q)]();}),router[I(0xdc,'i4Fr')](I(0xdb,'Mu5#'),[m,n],async function(p,q,r){const aH={p:'gH%F',q:0x13e,r:0x149,s:'05Zh',t:0xd8,u:'p*Wa',v:0x148,w:'AafI',x:0x193,y:'Nj0*',z:0x123,A:'xnwQ',B:0xed},Q=I,s={'GtsIm':function(t){return t();},'XCxfo':Q(0x17d,aH.p),'eqkbS':function(t,u){return t*u;},'PCYOp':function(t,u){return t>u;},'vFzVr':function(t,u){return t-u;}};try{const t=await s[Q(aH.q,'AafI')](k),u=await t['collection'](s['XCxfo']),v=await u[Q(aH.r,'#fWG')]({'token':p[Q(0xec,aH.s)],'verified':![],'expired':![]});if(v){const w=new Date(v['created_at']),x=s[Q(0x120,'hIJ^')](0xa,0x3c)*0x3e8;s[Q(aH.t,aH.u)](s[Q(aH.v,'IiBS')](Date[Q(0x107,aH.w)](),w),x)&&(await u[Q(aH.x,'GQdb')]({'_id':new ObjectId(v[Q(0x147,aH.p)])},{'$set':{'verified':![],'expired':!![],'updated_at':Date[Q(0x15f,aH.y)]()}}),sendOTPEmail(p,u));}}catch(y){l[Q(aH.z,aH.A)](y);}return q['status'](0x1f4)[Q(aH.B,'Y)a2')]();}),router[I(0x109,'CqDY')](I(0x15a,'B5BZ'),[m,n],async function(p,q,r){const aP={p:'99jv',q:'h1Ro',r:0xf7,s:0x184,t:0xc9,u:0xfc,v:'yPZ!',w:'IiBS',x:0x146,y:'hIJ^',z:0xdd,A:'h1Ro',B:'Sboq',aQ:'AafI',aR:0xe8,aS:'IiBS',aT:0x133,aU:0xd7,aV:'xnwQ',aW:0x126,aX:'D*qF',aY:0x14d,aZ:0xc6,b0:0x103,b1:'p*Wa',b2:0x119,b3:'@&Sj',b4:0xf8,b5:'Bbyp',b6:0x147,b7:0xde,b8:'NNUj',b9:0x18f,ba:0x158,bb:'oZzn'},R=I,s={'jMlew':function(t){return t();},'zQmDI':R(0xcb,aP.p),'lRXoX':function(t,u){return t*u;},'tiqAi':function(t,u){return t*u;},'SJbqs':function(t,u){return t>u;},'JzyMm':function(t,u){return t-u;},'xrbUN':function(t,u){return t!==u;},'nNejG':function(t,u){return t(u);},'PIzcj':R(0xf3,aP.q)};try{const t=p['body']['otp'];if(!t)return q[R(aP.r,'gH%F')](0x190)[R(aP.s,'pUYq')]();const u=await s[R(aP.t,'xnwQ')](k),v=await u[R(0x178,'Bbyp')](s[R(0xc4,'#fWG')]),w=await v[R(aP.u,aP.v)]({'token':p[R(0x12b,aP.w)],'verified':![],'expired':![]});if(w){const x=new Date(w[R(aP.x,'rF*4')]),y=s[R(0x16d,aP.y)](s[R(0xb6,'WI6@')](0xa,0x3c),0x3e8);if(s[R(aP.z,aP.A)](s[R(0x13d,aP.B)](Date['now'](),x),y))return q[R(0xe5,'i4Fr')](0xc8)[R(0x17f,aP.aQ)]({'error':R(aP.aR,aP.aS)});}if(s[R(aP.aT,'!*E7')](w[R(aP.aU,aP.aV)],s[R(aP.aW,aP.aX)](parseInt,t[R(aP.aY,'pUYq')](/[^0-9]/g,''))))return q[R(0x15c,'ryGw')](0xc8)[R(aP.aZ,'Nj0*')]({'error':s[R(0xd9,'hIJ^')]});return await Promise[R(aP.b0,aP.b1)]([v[R(aP.b2,'05Zh')]({'_id':new ObjectId(w[R(0x104,'B5BZ')])},{'$set':{'verified':!![],'updated_at':Date[R(0xc8,'c7vd')]()}}),u[R(0x12e,'i4Fr')](R(0xae,aP.b3))[R(0xfd,'rF*4')]({'_id':new ObjectId(p[R(aP.b4,aP.b5)][R(aP.b6,'gH%F')])},{'$set':{'email_verify_at':Date['now'](),'updated_at':Date[R(aP.b7,aP.b8)]()}})]),q['status'](0xc8)['send']();}catch(z){l[R(aP.b9,'Bbyp')](z);}return q[R(0xf7,'gH%F')](0x1f4)[R(aP.ba,aP.bb)]();});export default router;function c(p){const b2={p:'Bbyp',q:0x11d,r:0x141,s:'@&Sj',t:'249(',u:'IiBS'},b1={p:0x18e,q:'yPZ!',r:'&e&w',s:'S5HF',t:0xcf,u:'hIJ^',v:'ryGw',w:'NNUj',x:0xaf,y:'i4Fr',z:0x174,A:'xnwQ',B:0xbe,b2:'@NAe',b3:')w[8',b4:0xf1,b5:'99jv',b6:'D*qF',b7:0x140},S=I,q={'uscCo':S(0xe1,b2.p),'edkTE':S(b2.q,'i4Fr'),'eSKtf':S(b2.r,b2.s),'EQgzc':function(s,t){return s!==t;},'Bzcce':function(s,t){return s+t;},'ccGKd':function(s,t){return s/t;},'DsNWq':S(0x17c,'Sboq'),'Lzpgk':function(s,t){return s===t;},'DUoBS':function(s,t){return s%t;},'POXmM':function(s,t){return s+t;},'llRGR':S(0x10e,b2.t),'CFReV':'gger','WGUPG':function(s,t){return s(t);},'RAcgz':function(s,t){return s(t);}};function r(s){const T=S;if(typeof s===q[T(b1.p,'$Qd2')])return function(t){}[T(0x16a,b1.q)](q[T(0x186,b1.r)])[T(0xe7,'GQdb')](q[T(0xc0,b1.s)]);else q[T(b1.t,'yPZ!')](q[T(0x100,b1.u)]('',q[T(0x181,b1.v)](s,s))[q[T(0x196,'Bbyp')]],0x1)||q[T(0x194,b1.w)](q['DUoBS'](s,0x14),0x0)?function(){return!![];}['constructor'](q[T(0x16c,b1.q)](q[T(b1.x,'AafI')],T(0x163,b1.y)))[T(b1.z,'a4FK')](T(0x11a,b1.A)):function(){return![];}[T(b1.B,b1.b2)](q[T(0x166,'i4Fr')](q[T(0xdf,b1.b3)],q[T(b1.b4,b1.b5)]))[T(0x170,b1.b6)]('stateObject');q[T(b1.b7,'!*E7')](r,++s);}try{if(p)return r;else q[S(0x143,b2.u)](r,0x0);}catch(s){}}