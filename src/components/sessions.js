(function(j,k){const G={j:'LX$W',k:')ZWF',l:0xc9,m:'km1S',n:0x10d,o:'B7qz',p:0xbc,q:'eE@y',r:0xd6,s:0x111,H:'j@uD'},t=f,l=j();while(!![]){try{const m=parseInt(t(0xc6,G.j))/0x1*(parseInt(t(0xe7,G.k))/0x2)+parseInt(t(G.l,G.m))/0x3+-parseInt(t(G.n,G.o))/0x4*(-parseInt(t(G.p,'KpXh'))/0x5)+parseInt(t(0xdf,G.q))/0x6+parseInt(t(G.r,'f[G]'))/0x7+-parseInt(t(G.s,'(Gj9'))/0x8+parseInt(t(0xf1,'&T&n'))/0x9*(-parseInt(t(0xda,G.H))/0xa);if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0x3eb60));const d=(function(){let j=!![];return function(k,l){const H={j:0x114,k:'aG7a'},m=j?function(){const u=f;if(l){const n=l[u(H.j,H.k)](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const S={j:0xf6,k:'U]Zq',l:0x113,m:'Zs&s'},R={j:0xc5,k:'kyQf',l:0xdb,m:0xdc,n:'PLM1',o:0xe3,p:'39O#',q:0xfc,r:'eE@y'},v=f,j={'ojrQs':v(S.j,S.k),'iKYgE':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ESJsN':function(k,l){return k(l);},'cMmkC':v(S.l,S.m),'fKJCk':function(k,l){return k+l;},'OrPId':function(k,l){return k+l;},'urKPR':function(k,l){return k(l);},'GnjFZ':function(k){return k();},'pBJxS':function(k,l,m){return k(l,m);}};j['pBJxS'](d,this,function(){const w=v,k=new RegExp(j[w(R.j,R.k)]),l=new RegExp(j[w(R.l,'cBwR')],'i'),m=j[w(R.m,'%tIu')](c,j['cMmkC']);!k['test'](j[w(0x10c,R.n)](m,w(R.o,'j@uD')))||!l['test'](j[w(0xcb,'U]Zq')](m,'input'))?j[w(0x102,R.p)](m,'0'):j[w(R.q,R.r)](c);})();}());const b=(function(){let j=!![];return function(k,l){const T={j:0xd5},m=j?function(){const x=f;if(l){const n=l[x(T.j,'3t$q')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const a0={j:0xef,k:0x108,l:'JRtV',m:0x116,n:0xd9,o:'#dNa',p:0xc2,q:0xc3,r:0xd0,s:'SJ)v',a1:'3t$q',a2:'SJ)v',a3:0x115,a4:0xb4,a5:'xbk#',a6:0xd1,a7:'%QbS',a8:0xf7,a9:'j@uD',aa:0xea},y=f,j={'EETRN':function(n,o){return n(o);},'HiCQC':function(n,o){return n+o;},'gmatp':function(n){return n();},'wHcKB':y(a0.j,'KpXh'),'NbxFe':y(a0.k,a0.l),'zhqYK':y(a0.m,'AybZ'),'ldGXM':'trace'};let k;try{const n=j['EETRN'](Function,j[y(a0.n,'N4MS')](y(0xcf,a0.o)+y(0x101,'mhhz'),');'));k=j[y(a0.p,'j@uD')](n);}catch(o){k=window;}const l=k['console']=k[y(0xb6,'3t$q')]||{},m=[j[y(a0.q,'*fKo')],y(a0.r,a0.s),j[y(0x106,'Kw[C')],j[y(0x10f,a0.a1)],y(0x104,a0.a2),y(a0.a3,'eE@y'),j[y(a0.a4,a0.a5)]];for(let p=0x0;p<m[y(a0.a6,a0.a7)];p++){const q=b['constructor']['prototype'][y(0xbb,'%QbS')](b),r=m[p],s=l[r]||q;q[y(a0.a8,'wryN')]=b[y(0xe1,a0.a9)](b),q[y(a0.aa,a0.o)]=s['toString'][y(0xe1,'j@uD')](s),l[r]=q;}});a();import g from'fs';import{ObjectId}from'mongodb';function f(a,b){const c=e();return f=function(d,g){d=d-0xb4;let h=c[d];if(f['UOBzfk']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['ZxnhqL']=m,a=arguments,f['UOBzfk']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['TdZNeZ']===undefined&&(f['TdZNeZ']=!![]),h=f['ZxnhqL'](h,g),a[k]=h):h=l,h;},f(a,b);}import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a1={j:'UBTc',k:0x110,l:0xf0,m:'eE@y'},z=f;try{const n=await h();n[z(0xba,a1.j)](z(a1.k,'b]k%'))[z(0xb5,'1(Ee')]({'user_id':j[z(a1.l,a1.m)],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date['now']()});}catch(o){i['error'](o);}};export const getUser=async j=>{const a2={j:0xb8,k:'Zs&s',l:0xdd,m:'Kw[C',n:'gN%M',o:0xe8,p:'B7qz',q:0xc8,r:0xeb,s:'AybZ',a3:'aTo7'},A=f,k={'ytexU':'sessions','XkZUL':'users'};try{const l=await h(),m=await l[A(a2.j,'9O^W')](k[A(0xbd,a2.k)])[A(a2.l,a2.m)]({'token':j});if(!m)return null;const n=await l[A(0x109,a2.n)](k[A(a2.o,a2.p)])[A(a2.q,'#dNa')]({'_id':m['user_id']});return{'_id':n[A(a2.r,a2.s)],'email':n[A(0xc0,a2.a3)],'first_name':n[A(0xf9,'gN%M')],'last_name':n[A(0x112,'lj$h')],'role':n['role'],'email_verify_at':n[A(0xbf,'&I^q')]};}catch(o){i['error'](o);}return null;};(function(){const a6={j:'UBTc',k:0xde,l:'3t$q',m:0xc4,n:'9O^W',o:'*fKo'},B=f,j={'GoJeo':function(l,m){return l(m);},'beWEq':function(l,m){return l+m;},'AAMBl':B(0x100,a6.j),'NTFUw':function(l){return l();}};let k;try{const l=j[B(a6.k,a6.l)](Function,j[B(a6.m,'&I^q')](j['beWEq']('return\x20(function()\x20',j[B(0xe4,a6.n)]),');'));k=j['NTFUw'](l);}catch(m){k=window;}k[B(0xcc,a6.o)](c,0x9c4);}());export const removeSession=async j=>{const a8={j:0xb7,k:0x105,l:'lj$h',m:0xd2},C=f,k={'KoCVM':function(l){return l();}};try{const l=await k[C(a8.j,'aG7a')](h);await l[C(a8.k,a8.l)](C(a8.m,'*fKo'))[C(0xfd,'b]k%')]({'token':j},{'$set':{'active':![],'last_accessed':Date['now']()}});}catch(m){i['error'](m);}};export const isActiveToken=async j=>{const aa={j:'39O#',k:'T#w7',l:0xed,m:'Zvfj',n:0xe0,o:'cBwR',p:0xce,q:'kyQf',r:0xff},D=f,k={'xTeAV':function(l){return l();},'uhJYs':D(0xec,aa.j)};try{const l=await k[D(0xfe,aa.k)](h),m=await l[D(0xf5,'eE@y')](k[D(aa.l,aa.m)])['findOne']({'token':j});if(m['active'])l[D(aa.n,aa.o)](k[D(aa.p,'*ZWX')])['updateOne']({'token':j},{'$set':{'last_accessed':Date['now']()}});return m[D(0xd3,aa.q)];}catch(n){i[D(aa.r,'f[G]')](n);}return![];};function e(){const an=['AcvsWPadi8kYWQLwW6q','u8oiWQfL','qeTZWPS','uSojWQ5OfW','WQi5WQqCnq','hSoGWOSvwq','i8oNeZmN','W55dW6OcW6XkWPFcNH4b','cmkPDre6','zXddKSoFBMRcVSkdA2VcNxO','kq3cLu3cHWL+oW','Cmo8W5q','yM3cJbSzWOzPxq','W5ddNY84tG','eH8OW4nGhtFdQCo+W70','mCovcW','WO5wW6y','i8oAb8oYWRlcVX3dOmk+','W4n+WRyjWQddGCoiW5eWWQa','WOxdQHVcTmoDWQZcVmogW7WeW45q','WPdcPCkypaK','WRjqW65HW7tcMu0yy8o0','W70LWQldPdNcSWZdPMGjW7TJpK8bW4C','uwSDW7atfwPatq','pSovaSkoW64fWPmsW5XLW6q','neJcLSkvkWxcTmkVz0y','u8oZWQD2kG','WRBcRmoOW5hcMa','WPzrW6HlW4S','WRFcG2b3W4n7WPddRCkY','W6ONv0ddNa','W55Zd8oEeG','EhbBW73cIc3dNZDwvmoPW6emW4C5Ce/cHufoWQ/cOeCwCG0qW68PACk/ja','umk5iCodWPVdOe4CFZ7dKSkSr8oqBfxcL23dJehcL8oCW7BdKSo3WRtdUXdcQ8kRxxe','zhRcTdGI','tmo6W55LzmkqWPpcT8oAgYy','i8oUW6rUouRcN8k8kq','v03cRs4IWQRdHSkedCkD','hXtdGCksW7q','rmkFACoK','k8oKjWG','mu7cImkkoJNcRSkNzu0','WRJcVCkPC2NcM8ou','WOhdOCoYA8oE','rCkZrSovFG','y8oYhxaGWR3dOCkqWONdRG','qwOAW7/cRq','qSkdtIWB','WRhcLNDLW55XWRhdSa','W4K4W7eZuSkdWOhcG0ZdRgPu','wepcSJyyWQFdK8kabW','WPBdQwJcRW','WRxcTseIia','WQvEW6bHW7q','sSoNW4j5yG','WR3cMSoyW4hcGq','sKrSWPjraYJdSmov','w8keuqy/fCkI','WP/cQHiyfa','WOaxWOuYpmkXdeVcQM0','yN0fW7lcNG','ygizW7lcGIddMcPltW','y8oyW7Pc','B8kixCoiW7WHWPWjW659','WOBdS2tcOYi','W7BcIGO4oG','yJqaoSkDxmkPW6GiWQmsi8kdow4','aLvjW7vB','bCk0W4dcRhi','vSomWQ51cq','W5ldRmkYWPRcIG','ztW2fSka','WPtcVSkegXq','ASkjW5q1v8ouACoWW7G','dSoag8kiW7y','oWVcQf3cUG51','WPuPW6SlzCkqWQeZW6vEWQhcGa','yNZcJqeEWO4','W5qIWPZdJIK','W5BdGCkLWPJcPNaOW77dPmkjnW','fmkVFIaM','WPBdKmoNWRhcQq','lWFcSKZcHW4WDmk9WOJdRmo9lSotdhPDxmk0','mCo3W7vL','BCouW7Pbl3i','W5BdGCkIWQlcOwSJW78','WPRcT8kciXfm','WQFcHdxdOCo7','wCkBtXKP','WOK5rmkgvSoTlCk6iCkNd8oMFW','q0RcQc4IW6NcMSkzemkgW4mHlCojW7W','WPldOmomWP/cKa','WRKLW4rTWOu','bmkqW7K4sfZdIcJdRmkifCkH','yGfNWPSJ','m8kYW73cJ1m','nX/dL8kWW55JW48','F8keDra/','W6mkWRa7WQldJGePw8oruwTG'];e=function(){return an;};return e();}function c(j){const am={j:0xca,k:0x10a,l:'Z@$D'},al={j:0x10e,k:'UBTc',l:0xd4,m:'!See',n:0xb9,o:0xfb,p:0xcd,q:'B7qz',r:0xf8,s:0xe2,am:'KpXh',an:0x103,ao:0xfa,ap:0x10b,aq:'X$fB',ar:0x107,as:'PLM1',at:0xd5,au:'vPGU'},E=f,k={'BgoaJ':function(m,n){return m===n;},'AXoNo':E(am.j,'39O#'),'WOGph':E(0xd7,'lj$h'),'kqnvn':E(am.k,am.l),'gRwHT':function(m,n){return m!==n;},'sUwPo':function(m,n){return m/n;},'qXawJ':'length','DmQdP':function(m,n){return m===n;},'bjXYa':function(m,n){return m%n;},'bRhwS':function(m,n){return m+n;},'amRTf':'debu','Szwul':'action','XhBaC':'stateObject','CqVHq':function(m,n){return m(n);}};function l(m){const F=E;if(k[F(al.j,al.k)](typeof m,k[F(0xe5,'LX$W')]))return function(n){}['constructor'](k[F(al.l,al.m)])[F(al.n,al.k)](k[F(0xf4,'kyQf')]);else k[F(al.o,'xbk#')]((''+k[F(0xc1,'%tIu')](m,m))[k[F(0xd8,'*ZWX')]],0x1)||k[F(al.p,al.q)](k['bjXYa'](m,0x14),0x0)?function(){return!![];}[F(al.r,'KpXh')](k['bRhwS'](k[F(0xe6,'JRtV')],'gger'))[F(al.s,'1(Ee')](k[F(0xc7,al.am)]):function(){return![];}[F(al.an,'AybZ')](k[F(al.ao,'j@uD')](k[F(al.ap,al.aq)],F(al.ar,al.as)))[F(al.at,'3t$q')](k['XhBaC']);k[F(0xbe,al.au)](l,++m);}try{if(j)return l;else l(0x0);}catch(m){}}