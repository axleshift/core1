const B=f;(function(m,n){const J={m:0x13d,n:0x146,o:'3L0Z',p:0x19c,q:'k*E8',r:0x19f,s:'C19P',t:'Vr]&',u:0x152,K:0x18c,L:'i5EI',M:'6MJc',N:0x14b,O:'5jR8',P:0x195},v=f,o=m();while(!![]){try{const p=-parseInt(v(J.m,'Mu*P'))/0x1+-parseInt(v(J.n,J.o))/0x2*(parseInt(v(J.p,'RLNO'))/0x3)+parseInt(v(0x142,J.q))/0x4*(parseInt(v(J.r,J.s))/0x5)+parseInt(v(0x172,J.t))/0x6*(parseInt(v(0x140,'B[A%'))/0x7)+parseInt(v(J.u,'E2wu'))/0x8*(parseInt(v(J.K,J.L))/0x9)+parseInt(v(0x13f,J.M))/0xa*(-parseInt(v(J.N,J.O))/0xb)+parseInt(v(J.P,'niGH'))/0xc;if(p===n)break;else o['push'](o['shift']());}catch(q){o['push'](o['shift']());}}}(e,0x2ba42));const d=(function(){let m=!![];return function(n,o){const p=m?function(){if(o){const q=o['apply'](n,arguments);return o=null,q;}}:function(){};return m=![],p;};}());(function(){const U={m:0x16c},T={m:'xk(4',n:0x13b,o:'Vr]&',p:'C19P',q:0x13a,r:0x14e,s:'a##w'},w=f,m={'IsVro':w(0x150,')8s!'),'Npzzq':w(0x147,'5vqg'),'TjQoE':function(n,o){return n(o);},'wsqdu':'init','BfNcG':function(n,o){return n+o;},'ohjxe':w(0x186,'RLNO'),'rICaW':'input','QfTRM':function(n,o){return n(o);},'XoqZx':function(n){return n();},'PUoMN':function(n,o,p){return n(o,p);}};m[w(U.m,'QW&A')](d,this,function(){const x=w,n=new RegExp(m[x(0x154,'5jR8')]),o=new RegExp(m[x(0x17b,'CaOY')],'i'),p=m[x(0x165,T.m)](c,m[x(0x170,'B&t%')]);!n[x(T.n,'VSR5')](m[x(0x169,'E2wu')](p,m[x(0x171,T.o)]))||!o['test'](m[x(0x188,T.p)](p,m[x(T.q,'3Z3i')]))?m[x(T.r,T.s)](p,'0'):m[x(0x153,'RLNO')](c);})();}());const b=(function(){const V={m:0x160,n:'7fC#'};let m=!![];return function(n,o){const p=m?function(){const y=f;if(o){const q=o[y(V.m,V.n)](n,arguments);return o=null,q;}}:function(){};return m=![],p;};}()),a=b(this,function(){const a3={m:'niGH',n:'C19P',o:0x18a,p:'k*E8',q:0x158,r:'5jR8',s:'@YRR',t:0x1a1,u:0x143,a4:'JR7Z',a5:0x18f,a6:'oMtN',a7:'5jR8',a8:'y8E9',a9:0x16d,aa:'VSR5',ab:'iao2',ac:0x19d,ad:'niGH'},a2={m:0x13c,n:'iao2'},z=f,m={'XMPcs':function(r,s){return r+s;},'Opude':z(0x13e,a3.m),'gNWil':z(0x183,'Mu*P'),'SSKqc':function(r){return r();},'GyTdX':z(0x182,'oMtN'),'QamEC':z(0x175,a3.n),'ydfyv':z(a3.o,'k*E8'),'fDHiU':z(0x162,a3.p),'tAwCa':z(0x17f,'usK#'),'dGmWJ':'trace','hQewV':function(r,s){return r<s;}},n=function(){const A=z;let r;try{r=Function(m[A(0x139,'k9i^')](m['Opude'],m[A(a2.m,a2.n)])+');')();}catch(s){r=window;}return r;},o=m[z(a3.q,a3.r)](n),p=o[z(0x14f,a3.s)]=o[z(0x14a,'niGH')]||{},q=[m[z(a3.t,'6MJc')],m[z(a3.u,a3.a4)],m[z(a3.a5,a3.a6)],'error',m['fDHiU'],m[z(0x180,a3.a7)],m[z(0x184,'usK#')]];for(let r=0x0;m[z(0x18d,a3.a8)](r,q[z(0x17d,'7fC#')]);r++){const s=b[z(0x144,'k*E8')][z(a3.a9,a3.aa)][z(0x15b,a3.ab)](b),t=q[r],u=p[t]||s;s[z(a3.ac,'8i&z')]=b['bind'](b),s['toString']=u['toString'][z(0x17c,a3.ad)](u),p[t]=s;}});function e(){const aq=['W5NdLCoNWQVcJW','a8olW7/dRfZdMdm','WO0jW6ddM8kOyCoYcSoRDb/dGSkQE8okWOy','WQ1mW6rsg8ooWRrFWPm','WO7dHsNcHcqXW6HtaNhdT2G','WRKMc3Gi','W5ZdUCkfCe0','ECo6W7C','fmkZDxNcTCk5','pCkZgCkoW74','W4BdMCkyC0e','AtNdPSowWO41W5HbW4BcGCocoCkB','WQddTSoYCmoL','oricwa','W5RdN37cHmosW5G6WRqpsCkN','cgiEW5bdzuVcQ8oFvmounCkiW6xdOrDWWP3dVW','k0yoW65C','W70mWQXTaq','mN8MkCkI','u3xcLxBcHvRdTCoxWR5FW4G','W7hdLmoFW44MitJcPHW','Cu3cIqKTW4i','w1iFWRa','jmoDtSkIsa','W6ddG1u/hq','WOVcKcNcK8oxWOPyDmoyaq','juOzW7Wo','W73cKf/dN1m','W7OvWRjL','W45XWO00W4y','WOHVW5VcP0e','cNufW5fEFXldS8oC','rrBdUSk2tmkN','W6ZdGw4ujW','zXiVEMG','W6RdQeCnfq','WRpcTrXdrHlcP3VdMZZcOq','WOZcJYhcPCo8','if0CW5SL','WOpdU8oGW6i','Bqm9W4dcNG','WQW7e8keWQm','W7tdQCkNA03cGG','F3NcHq','rSoYcM/cSa','WPBcQf7cLri','WORcLIVcMW','p2O4iSkVWOS','W7DSW4hcQMG','c1FcSdFcMq','W6hdI8kKqum','muDyWQ7cKG','a3TL','W59aWPVcONuxvH/cQGrRWQORWRWLWQbhW6rOuXfGW67cMmkNWRWAWO9wWOuNWQy','g3hcVWZcTG','W6hdPCksCfdcJCom','WOiHg0SE','iwa6ia','WRBdVmoCW6/cTq','nmogwCkfyW','W73dGSoAW4q','x8kTWRtdVeDBFGCVWP3dNSo5gtCG','BdZdR8k9W5ruWRL1W7y','aHFcUcHZ','WP7cHd/dUCk3','fNbKs2G','bmkucmk7W6W','fei0W47dKW','WRRcJdBdM8kM','WQRdNCoswCo0wCkvWQa','r8oykMBcThL5','W5ZdINtdH8klW5OAwCoGfuJdJSoq','WPi9g1yvWQVcHebGW6JdSa','W6xcLhldR24','b8obW6u','WOBdR8oKW73cNa','oKlcRCkGW5W','WP7dQCo9W6i','W5jWoxidWOlcVM4','WRH1WOmBvSkCW7JcKGu','b8kMjmk0','W4ZcQmkHWRJdGYq9WQGkW5DsyW','W4vrW5K','bLq4W5me','feJdTSkXymkihMu','gGHEWPaKWQ8HpZ0','W7BdUSkur0q','WR4Rh8kzWRJcRG','W409WRHkfq','gfKgW6BdKG','wSkmWP7dSxu','dMizW5e','pdu7vCkR','WPupWOldTcjiuqhcJHzXWRC','WPRcMJhcISoaWOCmnCorgNhdQ8ojtmorWONcGmoepW','CbHyWOnLW73cSvr8W7VcIhi','WQNdNG3cJSkHcSk6tG','beVdVdJcK8ohvSoPECkhW5ddHIdcOdKYWQ8aEX8el10BaWNcUcD2WPiFW5m','WQZdG8oMW68ZisS','sCo3W7BcVa8','W7FdG8osW5GIjYtcQGBdS8o8','gqHzW7bKW7aolctdR2DB','W5tdRxNcJ8okW5BdPCofqmoPWQa','W4HaDCo3WPj+imkPWP99j2rOWOz0W5RdQ1GqWRtcISoFWQhdQSoNo8osWRtcRb3dGN7cVq0','W5XFW5FdGee','W4ZdU8k8DKe','WOVcKcVcJmoDWOvj','WQFcV8oGvLVcG8o5WORcQG','gCk6imk/W5u','W5VcK3pdIq'];e=function(){return aq;};return e();}a();import g from'dotenv';g[B(0x16e,'ZVyA')]();import{ObjectId}from'mongodb';import h from'express';import i from'../../models/db.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x137;let h=c[d];if(f['TqrDpN']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['tmnFRv']=m,a=arguments,f['TqrDpN']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['FjDvki']===undefined&&(f['FjDvki']=!![]),h=f['tmnFRv'](h,g),a[k]=h):h=l,h;},f(a,b);}(function(){const a9={m:'VSR5',n:0x176},a8={m:'ZXMH',n:0x19a,o:'q)Kw'},C=B,m={'bEUgp':function(p,q){return p(q);},'NpFUC':function(p,q){return p+q;},'gNzNk':function(p,q){return p+q;},'ZbcSz':C(0x15d,a9.m),'PfRTE':C(0x141,'usK#'),'DnYgJ':function(p){return p();}},n=function(){const D=C;let p;try{p=m[D(0x17a,a8.m)](Function,m['NpFUC'](m[D(a8.n,'i5EI')](m[D(0x197,'E2wu')],m[D(0x157,a8.o)]),');'))();}catch(q){p=window;}return p;},o=m[C(a9.n,'9oZB')](n);o[C(0x161,'ZaFs')](c,0x9c4);}());import j from'../../components/logger.js';import k from'../../components/scm.js';import l from'../../middleware/auth.js';import{getUser}from'../../components/sessions.js';const router=h['Router']();router['get']('/',l,async(m,n)=>{const ae={m:'WV[p',n:'Mu*P',o:0x156,p:0x19e},ad={m:0x15a,n:0x149,o:'niGH',p:0x193,q:0x16a,r:'wbUL',s:0x1a4,t:'5jR8',u:0x187,ae:'7fC#',af:0x17e,ag:'Mu*P'},E=B,o={'yNSZx':function(r,s){return r(s);},'Yqotc':function(r){return r();},'cpGEf':function(r,s){return r!==s;},'SQtkr':E(0x177,ae.m)},[p,q]=await Promise[E(0x1a0,ae.n)]([o[E(0x181,'PQ[c')](k),((async()=>{const F=E,r=await o[F(ad.m,'VbR*')](getUser,m[F(0x14c,'q)Kw')]),s=await o[F(ad.n,'5jR8')](i),t=await s[F(0x167,ad.o)](F(ad.p,'VbR*'))[F(ad.q,ad.r)](o[F(ad.s,ad.t)](r[F(ad.u,ad.ae)],o[F(ad.af,ad.ag)])?{'user_id':new ObjectId(r[F(0x179,'ZaFs')])}:{})[F(0x164,'fHSD')]({'last_accessed':-0x1})[F(0x185,'5jR8')]();return t;})())]);return n[E(ae.o,'HkvD')](0xc8)[E(ae.p,'q)Kw')]({'scm':p,'sessions':q});}),router[B(0x198,'@YRR')]('/scan',l,async(m,n)=>{const af={m:'JR7Z',n:'C19P'},G=B,[o]=await Promise[G(0x155,af.m)]([k()]);return n[G(0x137,'WV[p')](0xc8)[G(0x19b,af.n)]({'scm':o});});export default router;function c(m){const ap={m:'3Z3i',n:'J7E7',o:0x14d,p:'E2wu',q:0x196},ao={m:'3L0Z',n:0x16b,o:0x173,p:0x174,q:'6MJc',r:0x168,s:0x199,t:'C19P',u:'xk(4',ap:0x191,aq:0x18e,ar:0x16f,as:'Vr]&',at:0x138,au:0x15f,av:'wbUL',aw:0x148},H=B,n={'ZRwaT':function(p,q){return p===q;},'wgJaY':'string','dpdZN':H(0x18b,ap.m),'dguKR':H(0x163,ap.n),'ruvqn':function(p,q){return p===q;},'DqFHn':function(p,q){return p%q;},'iACaW':H(ap.o,ap.p),'QAdKm':'gger','TVbKr':H(0x178,'5jR8'),'rnpKS':function(p,q){return p+q;},'NGyjW':H(ap.q,'RLNO'),'eCxJm':function(p,q){return p(q);}};function o(p){const I=H;if(n[I(0x192,ao.m)](typeof p,n[I(ao.n,'E(4A')]))return function(q){}['constructor'](n[I(ao.o,'niGH')])[I(ao.p,ao.q)](I(0x194,'ZXMH'));else(''+p/p)[n[I(ao.r,'6MJc')]]!==0x1||n[I(ao.s,ao.t)](n[I(0x189,ao.u)](p,0x14),0x0)?function(){return!![];}['constructor'](n[I(0x190,'q)Kw')]+n[I(0x15e,'VSR5')])['call'](n[I(ao.ap,'k9i^')]):function(){return![];}['constructor'](n[I(ao.aq,'VYBR')](n[I(ao.ar,ao.as)],n[I(ao.at,'wbUL')]))[I(ao.au,ao.av)](n[I(ao.aw,'JsEK')]);n[I(0x166,'Vr]&')](o,++p);}try{if(m)return o;else o(0x0);}catch(p){}}