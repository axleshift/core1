import{r as e,R as s,j as t}from"./kqbr3HuW.js";import{R as i}from"./Cn6opJBz.js";import{F as r,L as a,K as o,V as n,b as l,W as c}from"./BNSBxhWN.js";import{b as d,V as m,c as h}from"./BjA19cT9.js";import{E as p}from"./URk2IvX2.js";import{C as j,N as x,O as u,t as w,n as y,q as v,o as b}from"./DJLAdtNU.js";import"./BgRKNlhe.js";import"./CgN-7aKy.js";import"./BSjYzxj3.js";import"./BJ13bZ6b.js";import"./c0eKk1Db.js";import"./DFarnK1O.js";import"./uhX4GmSj.js";import"./oXqQd4Ap.js";import"./CQYGjB7w.js";import"./DbzcfNKS.js";import"./BGKE3O6B.js";import"./DJeUPDeV.js";import"./B0UoamS-.js";import"./HSznFPq-.js";import"./omosduih.js";import"./D3yCfJ5s.js";import"./BXEMiIsG.js";import"./B60PFSOe.js";import"./DoV6T4jL.js";import"./CJ2-25UQ.js";import"./BqHrj3jM.js";const f=()=>{const[f,k]=e.useState(!0),g=s.useRef(),[N,_]=e.useState(!0),[A,C]=e.useState(!1),[z,I]=e.useState({token:"",whitelist_ip:[]}),S=async()=>{try{await navigator.clipboard.writeText(z),alert("API Key copied!")}catch(e){console.log(e),alert("Failed... no idea why.")}},$=async()=>{k(!0);const e=await g.current.executeAsync();await axios.post(`${m}/api/v1/auth/token/new`,{recaptcha_ref:e},{headers:{Authorization:`Bearer ${cookies.get(h)}`}}).then((e=>I((s=>({...s,token:e.data.token}))))).catch((e=>{console.error(e);const s=p[e.status]||"Internal Application Error";alert(s)})).finally((()=>k(!1)))};return e.useEffect((()=>{(async()=>{await axios.get(`${m}/api/v1/auth/token/`,{headers:{Authorization:`Bearer ${cookies.get(h)}`}}).then((e=>{e.data.error||I(e.data)})).catch((e=>{console.error(e);const s=p[e.status]||"Internal Application Error";alert(s)})).finally((()=>k(!1)))})()}),[]),t.jsxs("div",{children:[f&&t.jsx("div",{className:"loading-overlay",children:t.jsx(j,{color:"primary",variant:"grow"})}),t.jsx(i,{ref:g,size:"invisible",sitekey:d}),!f&&t.jsxs(x,{xs:{cols:1},sm:{cols:2},children:[t.jsxs(u,{children:[t.jsx("h4",{children:"Auth token"}),!z.token&&t.jsx("div",{className:"text-center border rounded mb-4",children:t.jsxs("div",{className:"p-1 p-md-5 my-5 my-md-0",children:[t.jsx(w,{src:"/images/threat.png",fluid:!0,width:"50%"}),t.jsx("h4",{children:"There was no Auth Token"}),t.jsx(y,{color:"primary",size:"sm",onClick:$,children:"Generate Token"})]})}),z.token&&t.jsx("div",{className:"text-center border rounded mb-4",children:t.jsxs("div",{className:"p-2 p-md-3",children:[t.jsxs("div",{className:"d-flex mb-3",children:[t.jsx(v,{className:N?"blurred":"",value:z.token,"aria-describedby":"basic-addon"}),t.jsx(y,{className:"ms-2",onClick:()=>{_((e=>!e))},children:t.jsx(r,{icon:N?a:o})}),t.jsx(y,{className:"ms-2",onClick:S,children:t.jsx(r,{icon:n})})]}),t.jsx(y,{color:"primary",size:"sm",onClick:$,children:"Generate new token"})]})})]}),t.jsxs(u,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("h4",{children:"Ip address"}),t.jsxs(y,{color:"success",size:"sm",className:"text-white",onClick:()=>Array.isArray(z.whitelist_ip)?z.whitelist_ip.length<6?I((e=>({...e,whitelist_ip:[...e.whitelist_ip,""]}))):void alert("Max number of whitelisted ip address reached"):I((e=>({...e,whitelist_ip:[""]}))),disabled:A,children:[t.jsx(r,{icon:l})," Create"]})]}),0===z.whitelist_ip.length&&t.jsx("div",{className:"text-center border rounded mb-4",children:t.jsx("div",{className:"p-2 p-md-3 my-5 my-md-0",children:t.jsx("h6",{children:"There was no Whitelisted IP Addresses"})})}),0!==z.whitelist_ip.length&&t.jsx("div",{className:"text-center border rounded mb-4",children:t.jsx("div",{className:"p-2 p-md-3",children:t.jsxs(b,{onSubmit:async e=>{e.preventDefault(),k(!0);const s=await g.current.executeAsync();await axios.post(`${m}/api/v1/auth/token/whitelist-ip`,{whitelist_ip:z.whitelist_ip,recaptcha_ref:s},{headers:{Authorization:`Bearer ${cookies.get(h)}`}}).then((e=>{if(e.data.error)return alert(e.data.error);alert("done")})).catch((e=>{console.error(e);const s=p[e.status]||"Internal Application Error";alert(s)})).finally((()=>k(!1)))},children:[z.whitelist_ip.map(((e,s)=>t.jsxs("div",{className:"d-flex mb-2",children:[t.jsx(v,{value:e,onChange:e=>((e,s)=>{const t=[...z.whitelist_ip];t[e]=s,I((e=>({...e,whitelist_ip:t})))})(s,e.target.value),placeholder:`192.168.0.${s+1}`}),t.jsx(y,{color:"danger",className:"text-white ms-2",onClick:S,children:t.jsx(r,{icon:c})})]},s))),t.jsx(y,{type:"submit",color:"primary",className:"d-block me-2 rounded",children:"Save changes"})]})})})]})]})]})};export{f as default};
