const A=f;(function(k,l){const H={k:0x1f1,l:'fXZ5',m:'p9Uo',n:0x1f6,o:'$ikk',p:0x1f7,q:0x234,r:'kynN',s:0x238},v=f,m=k();while(!![]){try{const n=parseInt(v(H.k,H.l))/0x1+parseInt(v(0x208,H.m))/0x2*(-parseInt(v(H.n,'0H6y'))/0x3)+parseInt(v(0x22c,H.o))/0x4+-parseInt(v(0x210,'p9Uo'))/0x5*(-parseInt(v(H.p,'oL71'))/0x6)+parseInt(v(0x1f8,'b(&*'))/0x7*(-parseInt(v(H.q,H.r))/0x8)+-parseInt(v(0x246,'5l[J'))/0x9+parseInt(v(H.s,'B994'))/0xa;if(n===l)break;else m['push'](m['shift']());}catch(o){m['push'](m['shift']());}}}(e,0xe33d1));const d=(function(){let k=!![];return function(l,m){const n=k?function(){if(m){const o=m['apply'](l,arguments);return m=null,o;}}:function(){};return k=![],n;};}());(function(){const S={k:0x1ea,l:0x1eb},R={k:'cEcp',l:0x233,m:'K9mp'},w=f,k={'VNEdm':w(S.k,'21ae'),'YgUfE':w(0x214,'WIUc'),'KvdJQ':function(l,m){return l(m);},'PHtqa':w(S.l,'$ikk'),'gPcYg':function(l,m){return l+m;},'vOpdk':function(l,m){return l+m;},'dtEVd':'input','mZLSn':function(l){return l();},'sktiE':function(l,m,n){return l(m,n);}};k[w(0x20e,'Au1&')](d,this,function(){const x=w,l=new RegExp(k[x(0x212,R.k)]),m=new RegExp(k['YgUfE'],'i'),n=k[x(R.l,'oL71')](c,k['PHtqa']);!l['test'](k[x(0x209,R.m)](n,x(0x211,'Au1&')))||!m['test'](k['vOpdk'](n,k['dtEVd']))?k['KvdJQ'](n,'0'):k[x(0x21c,'1vqC')](c);})();}());const b=(function(){let k=!![];return function(l,m){const n=k?function(){if(m){const o=m['apply'](l,arguments);return m=null,o;}}:function(){};return k=![],n;};}()),a=b(this,function(){const a1={k:0x239,l:'kynN',m:'I0(&',n:0x1ff,o:0x204,p:'%27Q',q:0x21e,r:'&xab',s:0x1fc,t:'WIUc',u:'b(&*',a2:'0H6y',a3:'B994',a4:0x241,a5:0x220,a6:'tg5v',a7:0x21f,a8:'j$gC',a9:'ynPH'},a0={k:'ynPH',l:0x217},y=f,k={'YsYfM':function(p,q){return p(q);},'cGhHw':function(p,q){return p+q;},'aGcms':y(a1.k,'J(R^'),'MSBJW':y(0x245,a1.l),'nGnHt':function(p){return p();},'gbKVr':'log','apenk':'error','oDkwC':y(0x23f,a1.m),'LeWrx':y(0x1e9,'nBaT')},l=function(){const z=y;let p;try{p=k[z(0x1e5,a0.k)](Function,k[z(a0.l,'TQnh')](k[z(0x1f0,'pqVn')],k[z(0x1df,'J(R^')])+');')();}catch(q){p=window;}return p;},m=k[y(a1.n,'0H6y')](l),n=m['console']=m[y(a1.o,a1.p)]||{},o=[k[y(a1.q,a1.r)],'warn',y(0x1ed,'kynN'),k[y(a1.s,a1.t)],k['oDkwC'],y(0x243,a1.u),k['LeWrx']];for(let p=0x0;p<o[y(0x23c,a1.a2)];p++){const q=b[y(0x227,'B994')][y(0x23e,a1.a3)][y(a1.a4,'$ikk')](b),r=o[p],s=n[r]||q;q[y(a1.a5,a1.a6)]=b[y(a1.a7,a1.a8)](b),q[y(0x23a,'B994')]=s['toString'][y(0x1f2,a1.a9)](s),n[r]=q;}});function f(a,b){const c=e();return f=function(d,g){d=d-0x1dd;let h=c[d];if(f['sKztNf']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['FjnsEu']=m,a=arguments,f['sKztNf']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['CFSFwL']===undefined&&(f['CFSFwL']=!![]),h=f['FjnsEu'](h,g),a[k]=h):h=l,h;},f(a,b);}a();import g from'dotenv';g[A(0x22e,'J(R^')]();import h from'fs';import{MongoClient}from'mongodb';import i from'../components/logger.js';import j from'../components/password.js';function e(){const al=['yCkuWOSWb8oWW4tcISkdW60fW6jmW47cVXJcVSkhW6KHWRVdP0RcRCo8WORcIGimWOhcUmkt','WOSXWQtcKtD2WOFdLZRcIHBdKw3dICkBWQBdJume','AsJdPCkTW7lcOG','WOe/WQJdHM4','W4JdOq3cVJdcJmkffvDnW4tdLe0','x8oSjKG+','WPm6WPXNWQa','W5DqWR8ZW6jZ','W7pdUhtdKthdTW','omkTW47dGmoF','WO/dRXtdKbbXWRtdLZtcJmkXW7fiW7XchW','W7RdRSkryG','b8opDSoFeJH1WQm','WRi/WQ5/','rqWxvCorWRmJWQxcPSoQWQG','W4vLDCk3WO8','AqZdSSkPW64','W63dTsFdHZiOWOBdLhSOf8kOlW','zmo2euO','ymounSkfhmktWOW','vSodW6BcSCo2','jmoSWPaAqmkPW7y','WP9zy8oVW7HTrq','W6ahW58zW4NdK8kxahRcU8k9WPFdPa','W4j9W73cGsJcP3xcVu/dLSkIWPddLq','tSk3W6akjSoHWQS','lCkZW4m','DmosWPX5WQW','WP/cQvddOM8','eCoEWOaqvq','b8opDSoFeJHKWRnY','W4jxACoQW7S','eaVdNSoX','W57cUh1QsW','W6NdOMddLW','hXDEEW4DW7CoWOa6','WRhcN3hdI8o8WP3cTa','tmoUW5BcG8oe','WRRcH3RcMNC','W6NcTY3cJvv6s00','W4TMW6BdL3uSWPhcUtxcMcNdMwS','cSkQw8oNW4O','dmkwfd3cLq','W5XXDmorW7HJtwS','WO0eW6fHWQmOeJlcNdhcHSouWQ0','bZHgCX0','ACkcW5e6lq','WR80WQPL','W4W1WP3cTaTjW4i','ECkbW4q6bG','W4ZcNbVcMLe','m8orxCo3pW','WQldSMNcPYtcLSkvBsz9W6dcLvajr8o8WOD8ymkxW5G3W4vgBrjGvCkypZRdQmo3W4W','dsRdUSo5da','uGyaBW','ft5fvGS','BrBcMW','gCkIhCoRs8kuW7r5uNFdJCo3lW','BSkVW7WMwq','tSkSW6Kxjmo7','vsndW6ZdRa','W5TxySohW7G','W6FdRK3dRI0','W5j/FSkH','W6rQWQeMW7LVtIBcQG','W41QF8ojW4K','WP3cTLNdOghdN8ojo3ni','WRhcGNRdMCoNWPtcKSo+w0LLW48IW67cGCoO','Bmk7lW','imk6W4hdHmooFa','bmo7xLGhW4ye','WQ1vW7hcTbhcSNhcOCkxWRtdKa','W5vuWRWX','rCkKW7u','uv4d','W5XXDCorW6O','WQtcUmopiCo/emoHl8kNW7fI','WQ/dUH51W58gjG','e8kJamoOumkh','W5HuWR04','WPH5WOrBWPC','DSo+df0eWQZcVmoe','W6nXCCkjWQ0','WPHgWOLIWQe','W6mqWODhWO/cICor','W7KDWO1itfdcO8kWyrzM','WRhcO2q','W47dTxntW7pcUmo6','W78jWQ3dTLtdSdpdSSk1WRtdRLtdJmop','aSkPgSo7s8koWRe1D23dLSo6l8orrryFmMy','WRPvW4ZcSXFcQwRcPq','WP/cRKhdP0S','W4b1ACofW7TK','W6hdOgO','WR5iW7dcSWRcTh3cSSkg','BqdcJSoOW7ZdK2SbBa','ESoXvKuL','W7hdQCkwCG','xrmrtSoV','WOaTWQ/dMhG','W7RcMSoXc34','WQaSW6zZWRxcRmoZpaSGW6tcIu/dVmo+WRVdNrHUoSk7lSohW67cRK9MDX7cUKZdSW','WR/dOhz1qCoCWPVdHNCpWOxcPdy','W70nWQ3dTLZdTttcRmkfWPFdJxVdIa','kmk2W53dJCoBECkN','WQbFW6JcTaNcPxdcTSkgWQK','zCocW53cUSoq','wSkOW4SSEu3cPmkkW5PHWRy','eWTFCq4','mmkqirxcSCofgMHAWRNdLfCehvRcHCo2srldSa','dCkreWlcSCoqbG','eCkfsSos','pCkFlmoeBG'];e=function(){return al;};return e();}const data=JSON[A(0x22b,'0H6y')](h['readFileSync'](import.meta[A(0x248,'nBaT')]+'/users.json','utf8'))[A(0x216,'PD0j')];let dbInstance=null;const requiredCollections=[A(0x1e3,'b(&*'),A(0x1f9,'ECuc'),A(0x207,'cEcp'),'threats',A(0x224,'lLkO'),'newsletter'],db=async()=>{const a5={k:0x1f5,l:'B994',m:0x22a,n:0x1fe,o:'ivxc',p:'EXb*',q:'MvhT',r:0x1ec,s:'ivxc',t:0x1dd,u:'YCq^',a6:0x236,a7:'fXZ5',a8:0x242,a9:'PD0j',aa:0x215,ab:'Nqvk',ac:0x1fd,ad:'%x#I',ae:0x1fb,af:'690F',ag:'ECuc',ah:'&xab',ai:0x1fa,aj:0x24c,ak:'TQnh'},a4={k:0x222,l:'WIUc',m:0x1ef,n:0x1e7,o:'tg5v',p:'0H6y',q:0x202,r:'YCq^',s:0x219,t:'J(R^'},B=A,k={'KkEMl':function(l,m){return l!=m;},'PERRu':function(l,m){return l(m);},'HkTwz':'Successfully\x20connected\x20to\x20MongoDB\x20Atlas','kzrRP':B(0x244,'BcVF'),'zFAzY':B(0x22d,'MeYy'),'osxhq':B(a5.k,'%x#I'),'AZbot':'otp','SIzHZ':B(0x249,a5.l)};if(dbInstance)return dbInstance;try{const l=new MongoClient(process[B(a5.m,'bibu')][B(a5.n,a5.o)]);await l[B(0x237,a5.p)](),i[B(0x1de,a5.q)](k[B(0x1e6,'kynN')]),dbInstance=l['db'](process[B(0x218,'I0(&')][B(a5.r,a5.s)]);const m=await dbInstance['listCollections']()[B(a5.t,a5.u)](),n=m[B(a5.a6,a5.a7)](q=>q[B(0x228,'tg5v')]),o=[k[B(a5.a8,a5.a9)],k[B(a5.aa,a5.ab)],'sessions',k['osxhq'],k[B(a5.ac,a5.ad)],k[B(a5.ae,a5.af)]],p=o[B(0x21b,'ECuc')](q=>!n['includes'](q))[B(0x229,a5.ag)](q=>dbInstance[B(0x223,'%27Q')](q));await Promise[B(0x23d,a5.ah)](p),Promise[B(a5.ai,'nBaT')]([((async()=>{const C=B,q=dbInstance[C(a4.k,a4.l)](C(a4.m,'j$gC'));let r=await q['find']({}),s=await r['toArray']();if(k[C(0x240,'TD$c')](s[C(a4.n,a4.o)],0x0))return dbInstance;for(const u of data){u[C(0x20b,a4.p)]=k[C(0x24a,'G&]d')](j,u[C(0x231,'ynPH')]);}const t=await q[C(0x203,'TQnh')](data);i[C(a4.q,'&xab')](C(0x24d,a4.r)+t[C(a4.s,a4.t)]);})())]);}catch(q){i[B(a5.aj,a5.ak)]('Failed\x20connecting\x20to\x20mongodb\x20atlas',q);}return dbInstance;};(function(){const aa={k:0x1e0},a9={k:'YCq^'},D=A,k={'iLUzj':function(n,o){return n(o);},'WhYyT':function(n,o){return n+o;},'uhFMV':D(aa.k,'Au1&'),'qAkma':function(n){return n();}},l=function(){const E=D;let n;try{n=k['iLUzj'](Function,k[E(0x21a,'Dm[%')](E(0x1e1,'p9Uo')+k[E(0x20a,a9.k)],');'))();}catch(o){n=window;}return n;},m=k[D(0x20d,'TQnh')](l);m[D(0x1ee,'PD0j')](c,0x9c4);}());export default db;function c(k){const ak={k:0x225,l:'nBaT',m:'kynN',n:0x200,o:'Nqvk',p:0x1e2,q:'pqVn',r:'fXZ5'},aj={k:0x1f4,l:'G&]d',m:0x1e8,n:0x23b,o:0x230,p:'oL71',q:0x213,r:0x24b,s:'Dm[%',t:0x21d,u:'0H6y',ak:0x205},F=A,l={'cDiYS':function(n,o){return n===o;},'awtkO':'while\x20(true)\x20{}','KIisg':function(n,o){return n!==o;},'wkVrA':function(n,o){return n/o;},'SgaLQ':F(ak.k,ak.l),'yQeob':function(n,o){return n%o;},'wGeew':F(0x20f,ak.m),'azxkF':F(ak.n,ak.o),'lLqVf':F(ak.p,ak.q),'yiYka':'stateObject','fEneu':function(n,o){return n(o);}};function m(n){const G=F;if(l[G(aj.k,aj.l)](typeof n,G(aj.m,'&xab')))return function(o){}[G(0x235,'zChq')](l[G(aj.n,'WIUc')])[G(0x201,'owHz')](G(0x1f3,'(KWn'));else l[G(aj.o,aj.p)]((''+l['wkVrA'](n,n))[l[G(0x232,'j$gC')]],0x1)||l[G(aj.q,'ivxc')](n,0x14)===0x0?function(){return!![];}[G(aj.r,aj.s)](l[G(aj.t,aj.u)]+l[G(0x221,'0H6y')])[G(0x22f,'tg5v')](l['lLqVf']):function(){return![];}[G(0x24b,'Dm[%')](l['wGeew']+l['azxkF'])['apply'](l[G(aj.ak,'G&]d')]);m(++n);}try{if(k)return m;else l[F(0x206,ak.r)](m,0x0);}catch(n){}}