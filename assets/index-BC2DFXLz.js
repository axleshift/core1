import{R,r,j as e}from"./react-BO5Oafrg.js";import{a as x}from"./js-cookie-Cz0CWeBA.js";import{a as k}from"./axios-CCb-kr4I.js";import{F as l,n as A,o as F,p as L}from"./@fortawesome-CVOXNFAe.js";import{R as P}from"./react-google-recaptcha-ClMkg6TR.js";import{u as T}from"./react-redux-BozUOnCr.js";import{d as _}from"./react-router-CrAkkUaR.js";import{c as D,C as G,E as B,F as q,G as z,H,I as K,J as M,K as h,L as f,M as g,N as Y,O as m}from"./@coreui-Bdd1l_dn.js";import"./core-js-Bohkx0y1.js";import"./prop-types-BwQq7MVh.js";import"./react-async-script-Bc3ESSJZ.js";import"./hoist-non-react-statics-BhEK_q3m.js";import"./react-is-8JwjhRSi.js";import"./use-sync-external-store-DMl-RlYg.js";import"./@remix-run-D_05oOQ-.js";import"./react-dom-MgmTyvJo.js";import"./scheduler-CzFDRTuY.js";import"./@popperjs-BQBsAJpH.js";import"./chart.js-DpsrBYWd.js";import"./@kurkle-BZxJdD1U.js";const de=()=>{const j="",a=_(),d=R.useRef(),C=T(),[n,v]=r.useState(""),[p,w]=r.useState(""),[y,i]=r.useState(!1),[u,N]=r.useState({error:!1,message:""}),E={401:"You failed the robot test",429:"Too many attempts",401:"Invalid password",404:"Email address not found",500:"Internal server error"};r.useEffect(()=>{if(x.get("")!==void 0)return a("/")},[]);const S=async s=>{s.preventDefault(),i(!0);const b=await d.current.executeAsync(),t=new FormData;t.append("email",n),t.append("password",p),t.append("recaptcha_ref",b),await k.post("/api/v1/auth/login",t,{headers:{}}).then(c=>{i(!1),x.set("",c.data.token);const o=new URLSearchParams(window.location.search),I=o.get("n")?o.get("n"):"/";C({type:"set",email:n}),a(I)}).catch(c=>{i(!1);const o=E[c.status]||"An unexpected error occurred";N({error:!0,message:o})})};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsxs(D,{children:[y&&e.jsx("div",{className:"loading-overlay",children:e.jsx(G,{color:"primary",variant:"grow"})}),e.jsx(B,{className:"justify-content-center",children:e.jsx(q,{md:8,lg:6,xl:5,children:e.jsxs(z,{className:"p-4",children:[u.error&&e.jsxs(H,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(l,{className:"flex-shrink-0 me-2",icon:A,size:"xl"}),e.jsx("div",{children:u.message})]}),e.jsx(K,{children:e.jsxs(M,{onSubmit:S,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsx(P,{ref:d,size:"invisible",sitekey:j}),e.jsxs(h,{className:"mb-3",children:[e.jsx(f,{children:e.jsx(l,{icon:F})}),e.jsx(g,{type:"email",placeholder:"Email",autoComplete:"email",value:n,onChange:s=>v(s.target.value),required:!0})]}),e.jsxs(h,{className:"mb-4",children:[e.jsx(f,{children:e.jsx(l,{icon:L})}),e.jsx(g,{type:"password",placeholder:"Password",autoComplete:"current-password",value:p,onChange:s=>w(s.target.value),required:!0})]}),e.jsx("div",{className:"d-grid",children:e.jsxs(Y,{children:[e.jsx(m,{type:"submit",color:"primary",className:"me-2 rounded",children:"Login"}),e.jsx(m,{color:"success",className:"me-2 rounded",onClick:()=>a("/register"),children:"Signup"})]})}),e.jsx(m,{color:"link",className:"px-0",onClick:()=>a("/forgot-password"),children:"Forgot password?"})]})})]})})})]})})};export{de as default};
