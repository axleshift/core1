function e(){const am=['FHWVbKe','W7ZcVf7cSSo2','W6iNqev6E8oAld0','W55lW4WjWOi/mSokjZ7cPb4NW70TWPy','W7HmW4tcSvpdJcT9W5CHcW','f3SdDHJdKNJdRSorW51LxG4','WQ5TghfE','zmkZDSkMWQVdUCo7','utmohW','CSoZW4iNW40','sSorWP8blWiH','WP5Tg8okW7KJgCo8','W68Dqfm','W4eqb8kKxmohW4rSpSor','W57dU8kufXC','W7O0m8omva','ccpcMwDnza','WO7cGSoYWPzF','WQ9ksSk2k35EW6/cImk3AmkX','WOpdOg8QBW','W6BcPxZcSmoCl1xcJsDj','vbK0pL8','W7a3W4a9W74','WQ4rWPldTHpdQqX3W4eJfG','W5qxbSkyBa','WRKqWPddVYy','k8kPWOtdJ8oO','qCkJW70t','W6mGW4GQW74','WRXeq1T3WOr4na','zs3dMCk+W5BdSZFdI1TOgq','w3xdNZOlnxvfWQqZWR1T','W7rMzt7cRCk2W60xWRa1WRNcHJDKzq','WP1kx8orW5RdIq','W4eqhSkMtCobW4i','C8oiW7mHW4C','WOCMWPpdOtu','W7L6k8osg8oUW7BcHSkIiCoiwqa','dIVdQCkjW6tcQGj3WO4','WPe1kCofW6G','scDn','W7L8imosgCoMW7FcJCkxgCoktX8','W7BdUCoXfq','CI3dJ8kc','WRBdONqBACoPldK','WOn8k1TF','kmkYWPJdHmovW6Or','WQ3cSgBdR1DSja','W7pdTSoRfttcTvJcPCkY','W4WZnSoWW6SwimopWRRdJG','W6DxW4y','WQ4wWP3dRaK','ngGpBhm','W7fHydC','W5egW7jWW74','cdZdPSkaW7hcVr9XWO/cHa','FwfCAbNdLG','xgxcVCozWQFdRa1XWOpcNSkGnW','B3e8umoyn8keytxcLCo0B8ogoCo7FCozD8oqWOZcMJbfW7zysSo0DCk0FeBcN8k7sa','W7SteCoVFs9mW6/cHmkT','WPbqW4pcImkqEG','c8o8s3O','WPHDW5hcJG','pSo5WOGp','k8kSAq0WrmkSW5e','WQ9uhh1+','hrBcVSoZDXtdTCk8oa','W7PiW4xcTLxcRsHwW6uVa8k/','tJSXl0a','xNBdLd0jn0joWQC5WPHn','kGdcJmoksG','W78rwKjvWP4VAZSFWOpdG8ksW6ZcKmkcW57cQCk+','CCkGW4m2W5xcJwtdPCoR','W6yxWRdcQZW','imk0WOe','W4WOWPdcRbJcR0z4W5WrW7q','ibhdNmksqG','aeG4xwJdGSkEaCkkWRmtWPrlWPJdHW','wwtcVmouW5/cNdjmWPpcQa','sIDD','g8klW4ngCfOIamktW7NcLCow','W4/dT8kRWQpcJq','W6tdQSk2aGtcTuRcVmkLW6TJb8oEWQ87gflcOYBdK2LjW4xdISoMg8kBb8ouemkBxG','W7NdPmk9dIi','W64oqffT','lvTPuNpdM8oNgmklFq','WOraW5lcK8km','W6W/W48','m8orfx9TW5dcTuu','WPixWPG','W5TrW4WzWOiKkmohC3VcIG','WQrrWPxcLCoMAZhcKH4','htlcN1z+','W50LW6KNW78','BCkKW5eLWPC','d8o0qhT2W4qne8kEzg0','yHCgaSkF','WQKDs8kPEa','W6SzdSoWCsnwW7u','WOnwW4pcLmknESo0DWrbW7yzg8kjxgHAl8or','sIpdVxNcRa','W68ZW742W6a','dYNcN31pxN1TWPO/','BmkJW6CoWRu','W7ZdQmkmWPi','i8k3wCkwWPtdQSo9W5yE','WRFcVLVcJCoYoMG','la3dNCkyqGhdLgOa','W4RdUmkbcthcMSo4','W4mvWQXMW6xcJc1+W6GRmmksxN/dLSk1ACoOnZXguCkgW6BdQ1ebWR7dIhtdKCoB','W6utWPFcJCozAZ/cLq','Dhzayb8','ztZdJmkdW53dIdddK0HQaq','WQ4MD8kgzmk5WQi','lmo1WPSiW7G'];e=function(){return am;};return e();}(function(j,k){const G={j:0xc7,k:0xba,l:'xHe7',m:0x6f,n:'KnD6',o:'zVfC',p:0x95,q:'KnD6',r:0xc5,s:'Ac(Z',H:'snD2',I:0x79,J:'snD2'},t=f,l=j();while(!![]){try{const m=parseInt(t(G.j,'pa&e'))/0x1+-parseInt(t(G.k,G.l))/0x2*(-parseInt(t(0x89,'Ac(Z'))/0x3)+parseInt(t(G.m,G.n))/0x4+parseInt(t(0x6d,G.o))/0x5*(-parseInt(t(G.p,G.q))/0x6)+parseInt(t(G.r,'WVi$'))/0x7*(parseInt(t(0x9e,G.s))/0x8)+-parseInt(t(0x75,G.H))/0x9+-parseInt(t(G.I,G.J))/0xa*(-parseInt(t(0xce,'jI9)'))/0xb);if(m===k)break;else l['push'](l['shift']());}catch(n){l['push'](l['shift']());}}}(e,0x1f983));function f(a,b){const c=e();return f=function(d,g){d=d-0x69;let h=c[d];if(f['uNReMG']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['yFyXSP']=m,a=arguments,f['uNReMG']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['WwPmGL']===undefined&&(f['WwPmGL']=!![]),h=f['yFyXSP'](h,g),a[k]=h):h=l,h;},f(a,b);}const d=(function(){let j=!![];return function(k,l){const H={j:0x6c,k:'2)Ik'},m=j?function(){const u=f;if(l){const n=l[u(H.j,H.k)](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}());(function(){const P={j:'pa&e'},O={j:0xc6,k:0x8a,l:'cyKp',m:0xb5,n:'2)Ik',o:0x73,p:'h)3J'},v=f,j={'iWXDK':function(k,l){return k(l);},'PkUYG':v(0x83,P.j),'KukTg':v(0x86,'8[Aj'),'mcFpg':function(k,l){return k(l);},'dICix':function(k){return k();}};d(this,function(){const w=v,k=new RegExp(w(O.j,'9vo9')),l=new RegExp(w(O.k,'lsyz'),'i'),m=j[w(0xb4,'laVI')](c,w(0x7a,O.l));!k['test'](m+j['PkUYG'])||!l['test'](m+j[w(0xd8,'FfFc')])?j[w(O.m,O.n)](m,'0'):j[w(O.o,O.p)](c);})();}());const b=(function(){const Q={j:0xd1};let j=!![];return function(k,l){const m=j?function(){const x=f;if(l){const n=l[x(Q.j,'g%IU')](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){const Y={j:0x9f,k:0x8e,l:'G5#s',m:0x6a,n:0xd9,o:'CH8q',p:'KnD6',q:'FfFc',r:0xbd,s:'8[Aj',Z:'T&]v',a0:0xcd,a1:'K*5y',a2:'FZ1C',a3:0xdb,a4:'53OH',a5:0x76,a6:0x91,a7:'WVi$',a8:0xc9,a9:'WVi$',aa:0xda,ab:0xab,ac:'o5Q4',ad:0x92,ae:'SBQR',af:0x6b,ag:'T&]v',ah:0x7c},y=f,j={'trrXE':function(n,o){return n(o);},'GXjZP':function(n,o){return n+o;},'QWnEx':y(0x97,'zVfC'),'Oityn':function(n){return n();},'vhmPU':y(Y.j,'HGzE'),'bgXCP':y(Y.k,Y.l),'TveVA':y(Y.m,'usz3'),'uKeoE':y(Y.n,Y.o),'voaBo':function(n,o){return n<o;}};let k;try{const n=j[y(0xac,Y.p)](Function,j['GXjZP'](j[y(0x94,Y.q)]+y(Y.r,Y.s),');'));k=j[y(0xb7,Y.Z)](n);}catch(o){k=window;}const l=k[y(Y.a0,Y.a1)]=k[y(0x7f,Y.a2)]||{},m=[j[y(Y.a3,'2zmo')],y(0x8f,Y.a4),j['bgXCP'],j['TveVA'],y(Y.a5,'Ac(Z'),j[y(Y.a6,Y.a7)],y(Y.a8,Y.a9)];for(let p=0x0;j['voaBo'](p,m['length']);p++){const q=b[y(Y.aa,'pa&e')][y(Y.ab,Y.ac)][y(0xcf,'zVfC')](b),r=m[p],s=l[r]||q;q[y(Y.ad,Y.ae)]=b[y(Y.af,Y.ag)](b),q[y(Y.ah,'W3(8')]=s['toString'][y(0xcb,'lsyz')](s),l[r]=q;}});a();import g from'fs';(function(){const a2={j:0xb3,k:'G5#s',l:0xd2,m:'UQHj',n:0xad},z=f,j={'vhcSR':function(l,m){return l(m);},'QMVXw':function(l,m){return l+m;},'bHNOL':z(a2.j,a2.k),'Hetpz':z(0xa2,'cyKp'),'YsKvd':function(l){return l();}};let k;try{const l=j['vhcSR'](Function,j[z(0x84,'xg$A')](j['QMVXw'](j[z(a2.l,a2.m)],j['Hetpz']),');'));k=j[z(a2.n,'CH8q')](l);}catch(m){k=window;}k[z(0x6e,')s]d')](c,0x9c4);}());import{ObjectId}from'mongodb';import h from'../models/db.js';import i from'./logger.js';export const addSession=async(j,k,l,m)=>{const a3={j:'9em8',k:'e^d@',l:0xa9,m:'pa&e'},A=f;try{const n=await h();await n[A(0x81,'jI9)')](A(0xa8,a3.j))[A(0xbb,a3.k)]({'user_id':j[A(a3.l,a3.m)],'token':k,'active':!![],'ip_address':l,'user_agent':m,'last_accessed':Date[A(0x78,'HGzE')]()});}catch(o){i[A(0xbf,'%d*H')](o);}};export const getUser=async j=>{const a5={j:'SBQR',k:0x87,l:'Ac(Z',m:0xb1,n:'9vo9',o:'53OH',p:0xb6,q:'KnD6',r:0x80,s:'cyKp',a6:0x85,a7:'iMxk',a8:0x9d,a9:'xg$A',aa:'e^d@'},B=f,k={'hIBKR':function(l){return l();},'aRRKS':'sessions','drTsp':B(0xa6,'G5#s')};try{const l=await k[B(0x96,a5.j)](h),m=await l[B(a5.k,a5.l)](k[B(a5.m,'snD2')])['findOne']({'token':j});if(!m)return null;const n=await l['collection'](k['drTsp'])[B(0xc1,'snD2')]({'_id':m[B(0xbc,'g%IU')]});return{'_id':n[B(0x82,a5.n)],'email':n[B(0xc2,a5.o)],'first_name':n[B(a5.p,a5.q)],'last_name':n[B(a5.r,a5.s)],'role':n[B(a5.a6,a5.a7)],'email_verify_at':n[B(a5.a8,a5.a9)]};}catch(o){i[B(0x9c,a5.aa)](o);}return null;};export const removeSession=async j=>{const a7={j:'fJ^v',k:0x8b,l:'UQHj'},C=f,k={'TjhaY':function(l){return l();},'bONln':C(0x90,a7.j)};try{const l=await k['TjhaY'](h);await l[C(a7.k,a7.l)](k['bONln'])[C(0xb9,'m#f[')]({'token':j},{'$set':{'active':![],'last_accessed':Date[C(0xa7,'2)Ik')]()}});}catch(m){i[C(0x77,'l(bo')](m);}};export const isActiveToken=async j=>{const a9={j:'UQHj',k:0xd7,l:'xHe7',m:0x71,n:'1Xgk',o:0xd0,p:'2zmo',q:0xae,r:'usz3',s:'KnD6',aa:'h)3J'},D=f,k={'yLWdl':function(l){return l();},'NnBRL':D(0xb2,a9.j)};try{const l=await k['yLWdl'](h),m=await l[D(a9.k,a9.l)](k['NnBRL'])[D(0x7e,'usz3')]({'token':j});if(m[D(a9.m,a9.n)])await l[D(a9.o,a9.p)](k[D(a9.q,'T&]v')])['updateOne']({'token':j},{'$set':{'last_accessed':Date[D(0x9a,a9.r)]()}});return m[D(0xd3,a9.s)];}catch(n){i[D(0xcc,a9.aa)](n);}return![];};function c(j){const al={j:'iMxk',k:'2zmo',l:0x8d,m:'!ydC',n:0x8c,o:'G5#s',p:0xb8,q:0xc0},ak={j:'9vo9',k:0xc3,l:'FfFc',m:0xd6,n:0xaf,o:'!ydC',p:')s]d',q:'7]ly',r:0x99,s:'EjSO',al:'xHe7',am:0xb0},E=f,k={'AmHEt':function(m,n){return m===n;},'WzEDe':'string','BYmUu':E(0x70,al.j),'JXodR':E(0x72,al.k),'tnlzA':function(m,n){return m!==n;},'YcRId':function(m,n){return m+n;},'aUcXs':function(m,n){return m/n;},'FoYuL':function(m,n){return m+n;},'sEIQm':E(al.l,al.m),'IPNtP':E(al.n,al.o),'cznfJ':function(m,n){return m+n;},'yvNnO':E(al.p,'ginP'),'ykKVJ':E(al.q,')s]d'),'QMfyg':function(m,n){return m(n);}};function l(m){const F=E;if(k['AmHEt'](typeof m,k[F(0xa1,'ginP')]))return function(n){}[F(0xaa,ak.j)](k['BYmUu'])[F(ak.k,ak.l)](k[F(0x74,'pa&e')]);else k[F(0x69,'pa&e')](k[F(0x7d,'WVi$')]('',k['aUcXs'](m,m))[F(0x88,'%d*H')],0x1)||k[F(ak.m,'W3(8')](m%0x14,0x0)?function(){return!![];}[F(ak.n,ak.o)](k[F(0xa3,'g%IU')](F(0x7b,ak.p),k[F(0xd4,ak.q)]))['call'](k[F(ak.r,ak.s)]):function(){return![];}[F(0x9b,'EjSO')](k[F(0xa4,'zVfC')](k[F(0xc4,ak.al)],'gger'))['apply'](k['ykKVJ']);k[F(ak.am,'lsyz')](l,++m);}try{if(j)return l;else l(0x0);}catch(m){}}