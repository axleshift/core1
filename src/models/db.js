const A=f;(function(k,l){const G={k:0x20f,l:'&7wV',m:'JZ1i',n:'n$gZ',o:0x1c7,p:0x22c,q:'6DT*'},v=f,m=k();while(!![]){try{const n=parseInt(v(0x207,'g]cC'))/0x1*(-parseInt(v(G.k,G.l))/0x2)+-parseInt(v(0x1fe,G.m))/0x3*(-parseInt(v(0x1e8,G.n))/0x4)+-parseInt(v(G.o,'[]Z('))/0x5*(-parseInt(v(G.p,'Ltf6'))/0x6)+-parseInt(v(0x1ec,'fnw['))/0x7+-parseInt(v(0x212,'%V3K'))/0x8+-parseInt(v(0x200,G.q))/0x9+parseInt(v(0x1ce,'5L29'))/0xa*(parseInt(v(0x1e1,'SAuR'))/0xb);if(n===l)break;else m['push'](m['shift']());}catch(o){m['push'](m['shift']());}}}(e,0x45037));const d=(function(){let k=!![];return function(l,m){const n=k?function(){if(m){const o=m['apply'](l,arguments);return m=null,o;}}:function(){};return k=![],n;};}());(function(){const O={k:0x1ca,l:'&7wV'},N={k:0x208,l:'g]cC',m:0x1e2,n:'&7wV',o:0x201,p:0x1c8},w=f,k={'XDCDm':w(O.k,'Gx3T'),'ZZwLk':function(l,m){return l(m);},'pzwLy':'init','gYUrd':'chain','ghUhd':w(0x1f6,O.l),'AYccz':function(l,m,n){return l(m,n);}};k['AYccz'](d,this,function(){const x=w,l=new RegExp('function\x20*\x5c(\x20*\x5c)'),m=new RegExp(k[x(N.k,N.l)],'i'),n=k[x(N.m,N.n)](c,k[x(N.o,'%jgl')]);!l[x(N.p,'u$t3')](n+k['gYUrd'])||!m[x(0x1cf,'x4B]')](n+k[x(0x1fb,'g)fR')])?k['ZZwLk'](n,'0'):c();})();}());const b=(function(){let k=!![];return function(l,m){const P={k:'KmMV'},n=k?function(){const y=f;if(m){const o=m[y(0x225,P.k)](l,arguments);return m=null,o;}}:function(){};return k=![],n;};}()),a=b(this,function(){const X={k:0x21b,l:0x1d9,m:'6^p$',n:0x228,o:0x1d4,p:'HXnv',q:'x4B]',r:0x21d,s:'[96N',t:0x215,u:0x213,Y:'fnw[',Z:0x238,a0:'%V3K',a1:'8v@F',a2:0x1d8,a3:'%jgl',a4:'jIYh',a5:'n$gZ',a6:0x222,a7:'u$t3',a8:0x1e4,a9:'@poP',aa:0x1ef,ab:0x1e7},z=f,k={'cnqZb':function(o,p){return o(p);},'tDMPs':function(o,p){return o+p;},'sBbch':z(X.k,'6DT*'),'ZetQz':z(0x214,'QU[!'),'VHVta':function(o){return o();},'mcZIL':'log','bsjLj':z(X.l,X.m),'dBoYh':z(X.n,'CPNy'),'yXvaU':z(X.o,'JZ1i'),'pmJZA':z(0x23a,'AoZ*'),'JaRBq':z(0x22d,X.p),'LUVBg':function(o,p){return o<p;}};let l;try{const o=k[z(0x1dc,'wp[!')](Function,k[z(0x209,X.q)](k['tDMPs'](k[z(X.r,X.s)],k[z(X.t,']*kV')]),');'));l=k[z(X.u,'SAuR')](o);}catch(p){l=window;}const m=l['console']=l[z(0x210,X.Y)]||{},n=[k[z(X.Z,X.a0)],k[z(0x1f2,X.a1)],k[z(0x1da,'[]Z(')],k[z(X.a2,'jukB')],k[z(0x1fd,X.a3)],k[z(0x1e0,X.a4)],'trace'];for(let q=0x0;k['LUVBg'](q,n[z(0x1cb,X.a5)]);q++){const r=b[z(X.a6,X.a7)][z(X.a8,X.a9)][z(0x1c4,'&7wV')](b),s=n[q],t=m[s]||r;r['__proto__']=b[z(X.aa,'@(HT')](b),r['toString']=t[z(X.ab,'jukB')]['bind'](t),m[s]=r;}});function e(){const ag=['WODphmkEW4S','D8kHW7xdR8o1W6meW7DJk8k8FSo+WQ1ExCoDW4u2','BCo8WQZcHSoDWRtcImkGWQ1VhHD/WONcJ3b8W6BcKmkpW5pcOmkTv8oZW6xcU2qrWQ06ga','WPNcHSoFzNa','AhhcSCk+W4W','B8kLW6tcVG','WOb+d8k7W6NdJ8okW5JdV8op','W5hdQrKm','fwpdJmkqd8kjW7JcQ3/cJ08','wSkFaHWpWRpdK8ktimoD','lLf6WQKzCmoB','iSkWiSobyq','WQZdTCkwW44V','Bmk1iCoiANRdLG4OEJq','WQ0qW4FcOa','CSkSWOBcSeFcMh/dOmk1jI8Op2RdMmo2g8o3tW','WQZdS0ZdO8o2','CSoRp2yviZ7cGHL0k0K','W5NcHSooWOTSabhcQLldTSk8W50g','W5lcKSodsmkY','zNxcSq','FtquyYDhWP49','kCkLmmodFG','sYRdJ1H/','a3/dH8krca','bshdN0NdGW','WPRcMSoRWOZcR3Xfka','omkMWQJcJNlcHGy','lXddJfddUq','w8kTjmkvdW','WOJdIeFdPSoE','WP7cM1LoW60NdH7dKmoeW51Qxa','BhNcOSk3W4xcMSk7W4tdRa','sYDIzSo2','jezXWQCkCa','bavKybe','mXxcTCoAW5S','WPxcNerp','gbZdQW','qdBdNhbyWOX3','nCkhWRtcHLlcPbC','aMNdKCkx','paK+lc1QWRW','W5OdW5pcISk6WR88a00aWP8ExrRdMSoIWRJdNWGrFCkMpHzqWO/dQmkGEg/dLColW6W6','jSkPWQiRkCkd','WQO+lSkBW6/cR8ottaNdTmoT','W43dJCoJWOO','W7ddMYzRkCo2urtdU8osCw7dQW','arJdQmoE','csn4xG','oejSWRmjD8oDeG','vCkfWPRcLbvdimo4imkmfCop','W7ldJmky','WRZcV2vZnG','WQZcGMi','W5BcImoHCSkEWQe','WRqFW5pcVdy','WRaXtID3','EGzHWOi','zmklWP3cNf0','WOtcKf5IW7eNdGJdPCokW4q','jSkYEqPp','WRXpcCo9B8oGW4xcQSoAjNa','WQjAga','kmo1WQfbDLG','kIXmCXK','cfHdr8oblCoIya','WQ3cR11NW7q','W5RdLSoYWPdcTwm','W7BdOu/cO0ldGgWEW4a','jmkSEdXu','WQ/cNNeZFCkPfq','WR0gAZjqfmk8WO0','CSkJWPyhgSkByq','htmhlZq','DJFdPwP+','dKGVuIS','W58ItCo7WRhcNmkhW5JdLmonWPVdG0a','W4BdHCkdixG','bHFdUeBdJ8o0WPVdIG','kG8roG','W7dcPCkuWO7cKCkiW416WOeorW','fSoxW4ldH2qzDmonhSkyoSoftW','kLb1WOWu','kaFcVCon','asfY','x8kzabq','WP7cM1PEW6S','erJdUCoF','WRTtgSoSA8oBW5q','E8o1W7L/ACoDaCkPWPBcP8kgy8kt','xaDm','W7tcOSkVWPxcGq','W6vhW7RdJ8oUW7bM','mmkgWRhcOZm','W67dUIaQFmo3WQpdSCkBWRqeWOi','WO4Ye0NdPSo2eCoQW5hdKGJdUJS','nmoXWRFcQmk1WRKtWOLNg8kdC8oR','mmkrWOZcTqS','ivuuqda','W4ldOCo6WR7cNG','mmkLiCoECwBcLHC','mrpcHCoKW5S','yCkSW6FcOW','FJnAa3j3WO4LW4e6W7G','feeUDY0','atNdLSo6yW','W7/cR8kuWPRcKCks','q8kvWPpcIsa','W5VdPHymW7X5nKq','W6NdP1a','WPldG3tdG8o3hmopW57cNCouix1LDhu','W4tdJufEW6SRcJG','WO10fSk7W6RdHSoB','kcRdK2ddTmooWPZdPWyHomkqWRSgWQu1','W5hcMcxcN8kMdmoFW5NcL8oabXCF','BYfSy8oh','W4X4dXVcUSkVuSoiW6tdLqldUraFW4ZdI8keW5TnW6VdRCkKW4n1WPldJ30zW5DahCod','WPvEhmoyCa','kapcP8oBW4tdLCoGW61EWQO','W5BdRrCv','WR0gEtrqhmkR','W5rQtWVcOCkZvmoFW6ldJXm'];e=function(){return ag;};return e();}a();import g from'dotenv';g[A(0x1d6,'H1N8')]();import h from'fs';import{MongoClient}from'mongodb';import i from'../components/logger.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x1c2;let h=c[d];if(f['iFvAps']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['GfYmSY']=m,a=arguments,f['iFvAps']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['OduPgL']===undefined&&(f['OduPgL']=!![]),h=f['GfYmSY'](h,g),a[k]=h):h=l,h;},f(a,b);}import j from'../components/password.js';const data=JSON[A(0x1d7,'CPNy')](h[A(0x1d2,'5x61')](import.meta[A(0x1c6,'MHwa')]+A(0x227,'KmMV'),'utf8'))[A(0x1cd,'!IjB')];let dbInstance=null;const requiredCollections=[A(0x232,'u$t3'),A(0x224,'8v@F'),'sessions','threats',A(0x20d,'@poP'),A(0x216,'F&jL')],db=async()=>{const a0={k:0x1e6,l:'5L29',m:0x22e,n:'AoZ*',o:0x1d5,p:'oHTi',q:'hr9)',r:'jukB',s:0x1de,t:']*kV',u:0x1c3,a1:'F&jL',a2:'KmMV',a3:']*kV',a4:0x220,a5:'fnw[',a6:0x1d3,a7:'yB2V'},Z={k:0x223,l:'n8dE',m:'@(HT',n:0x23c,o:'8v@F',p:0x20b,q:'8v@F',r:0x1d0,s:0x239,t:'&7wV'},B=A,k={'lRRlU':'users','duhys':function(q,r){return q(r);},'EwTOn':'Connected\x20successfully\x20to\x20server','rNXqP':B(a0.k,a0.l),'wCFTC':B(a0.m,a0.n)};if(dbInstance)return dbInstance;const l=new MongoClient(process[B(a0.o,'5L29')]['MONGO_URL']);await l['connect'](),i[B(0x21f,a0.p)](k['EwTOn']),dbInstance=l['db'](process[B(0x1fa,'SAuR')][B(0x1ee,a0.q)]);const m=await dbInstance['listCollections']()[B(0x218,a0.r)](),n=m[B(a0.s,a0.t)](q=>q[B(0x1f3,'F&jL')]),o=[B(a0.u,a0.a1),k[B(0x23b,'SAuR')],B(0x204,a0.a2),B(0x1f8,a0.a3),k['wCFTC'],B(a0.a4,a0.a5)],p=o[B(0x1df,'SxLS')](q=>!n[B(0x20c,'Z*7)')](q))[B(0x1c5,'x4B]')](q=>dbInstance[B(0x211,'hr9)')](q));return await Promise[B(0x1f4,'jIYh')](p),Promise[B(a0.a6,a0.a7)]([((async()=>{const C=B,q=dbInstance[C(Z.k,Z.l)](k['lRRlU']);let r=await q[C(0x1f5,'n8dE')]({}),s=await r[C(0x1c9,Z.m)]();if(s[C(Z.n,Z.o)]!=0x0)return dbInstance;for(const u of data){u['password']=k[C(Z.p,'5x61')](j,u[C(0x1d1,Z.q)]);}const t=await q['insertMany'](data);i[C(Z.r,'jIYh')]('Inserted\x20documents:\x20'+t[C(Z.s,Z.t)]);})())]),dbInstance;};export default db;function c(k){const ab={k:0x20e,l:'%V3K',m:0x1fc,n:0x20a,o:0x206,p:'oHTi',q:0x1dd},aa={k:0x226,l:'Ltf6',m:0x21a,n:0x237,o:'MqNk',p:0x1e5,q:'wp[!',r:0x1eb,s:'g]cC',t:0x1ed,u:0x236,ab:'hr9)',ac:0x217,ad:'Z*7)',ae:0x219,af:0x1c2,ag:'jIYh',ah:'MHwa',ai:0x233,aj:0x21e,ak:'AoZ*',al:0x1e9},D=A,l={'DDart':function(n,o){return n===o;},'iTdVN':D(0x1e3,'!IjB'),'wsRUp':D(ab.k,ab.l),'BMBak':D(ab.m,'Gx3T'),'VppfR':function(n,o){return n!==o;},'UewjV':function(n,o){return n/o;},'kCzGE':D(ab.n,'g)fR'),'dHzQy':function(n,o){return n+o;},'NyiHC':D(ab.o,ab.p),'mPysp':'action','ouaFF':D(0x1f7,'x4B]'),'UUxqk':D(ab.q,']*kV'),'IXQLd':function(n,o){return n(o);},'VTIYS':function(n,o){return n(o);}};function m(n){const E=D;if(l[E(aa.k,aa.l)](typeof n,l[E(aa.m,'fnw[')]))return function(o){}['constructor'](l[E(aa.n,aa.o)])[E(aa.p,aa.q)](l[E(aa.r,aa.s)]);else l['VppfR']((''+l[E(aa.t,'yB2V')](n,n))[l[E(0x203,'!IjB')]],0x1)||l['DDart'](n%0x14,0x0)?function(){return!![];}[E(0x1f0,'g)fR')](l[E(aa.u,aa.ab)](E(aa.ac,aa.ad),l['NyiHC']))[E(0x221,'Z*7)')](l[E(0x202,aa.s)]):function(){return![];}[E(aa.ae,'QU[!')](l[E(aa.af,aa.ag)](l[E(0x231,aa.ah)],l[E(aa.ai,aa.ab)]))[E(aa.aj,aa.ak)](l[E(aa.al,'@(HT')]);l[E(0x22a,'%V3K')](m,++n);}try{if(k)return m;else l['VTIYS'](m,0x0);}catch(n){}}(function(){const af={k:0x21c,l:'1$qZ',m:'KmMV',n:0x1ea,o:'MHwa',p:'[]Z(',q:0x205,r:'F&jL',s:0x1db,t:'&7wV'},F=A,k={'jebnf':function(m,n){return m(n);},'RhKtG':function(m,n){return m+n;},'aVFcj':F(af.k,af.l),'wuULs':function(m){return m();}};let l;try{const m=k[F(0x230,af.m)](Function,k['RhKtG'](k[F(af.n,af.o)](F(0x229,af.p),k['aVFcj']),');'));l=k[F(af.q,af.r)](m);}catch(n){l=window;}l[F(af.s,af.t)](c,0x9c4);}());