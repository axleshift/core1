const G=f;function e(){const ay=['W7KzW5FdGW','WQG0W7tcGZnYWP/cISo3WR5/W6RcHa','W6FcN8ktW7pcPeKnW5m','W4jfCbvwW54','A21dWQ7cOq','mSkuWRC0ivhdPL5YWR7dLSkBWPS','W4xdPYHfW58QcvTVWPO','W6ZcTCkPnM/dKCkeWPzmW5q','W6/cJmoEda','mtTFzmol','WQVcMmorfIlcTa','W7jmWRddKmkMjSkX','W6tdT3NdNW','WQPeWOtcJcpdQSo6W7zPWQiKWQf9','WQLfWQZdGW','udXVW57dLmkVkmkHDWNcKW','W6NcP8k3swJdTJNcJe8','WRdcL8o2W6/dSa','WOHTgh8Log0OAa','WQldGmoWWRtdPbftW5uOrxVcK8kE','W6/dLSkWWOOMq3hdOs3dOCo2WQtcJcvHW613mSkhW73dMSoFW6H/DSkHj8kSlgu3s3BdUG','fan2W6ZdKq','WQO7WOXK','tCoRWPxdM8kNWQa','WPPvWQhcQG','xrlcMwNcGG','BZpdOMVcVtlcI8oFCmk6','W74bW6eL','W7mvW6S5','W4tdMdPYEa','WPFdVYjJBa','uJJdUwFcV8oZW5TxsH09WR4qWOzNy8oMWO53W6JdISkmWPbxWOSmWQDyD8kpi8oa','WRLzWO/cMmoB','WRfLWRlcP8ok','qvqmdrC','WQVcLsP9WQm','WPtcQSk/Aa','CCoMW7Ssq8oIvaLCCq','W6RcM3tdOmkYW4RcLLFdTrGN','qHtcVKxcPW','WPFcJNNcR8oC','AdXzWOj7','hxKiwbi','tL1GWQdcVG','tePOWOJcQG','qZBcUgO','WPhcNSoVW6xdMG','W4ObW7FdP8oBWRL7zW0N','bWr0tCoa','W4pcV8kGfuC','W4ZdTdXsyG','W5hdGMtdKSkh','WQddNWn2uvC','W6tcJ8obdG4','hNpdPdBdQCkSWPLtvI8OWPi1','WOVcUNOuWQ7cGKLg','BN5pWOhcLq','kYCaWQanF8o6','WRpcJSk2r8k2','W6/dPstdImkEWQGzW51eC8o0keHafWtcTSojW7/dN1nZW6DjW5pdPN19xSkFWR3cTa','AMnDWPy','W7FdQHLOxW','WRBdO8oRDW','W5X1W67dICkL','fhhdINhdUmkeeMNcKthcSa','W5BdRI1tC1KxW6VdOmkdBq','W4FcI8kqm0G','WR3dOmo0Dxu','W5LEW4BdGCk2','WORcMh3cUCoki8o9','W7FcMSoffWxdNCoyerJdSdzefgddSqWXy8o0','W73dGCkirhpcVmkZpSkoh8ov','gSkHW5JcPcfiWPZdMmo/W7qpoCoJWQGl','W6VcNxtdTW','W7RcNSkPW7m','W5ZcQ8kpzWdcGSkN','W5VdV0arWQZcQNjsdCkmW5HTDSk8t8k0','gxSkwXK','W6ZcJmk9j1tdShVcKSkjWP0','W7VdR1ddGCkD','Ch9bWOW','W63cOmk0kJ7cRNdcTvD+W74OuG','tKCqASo/','uHfBWP9MW4vQxYK','W5xcK33cNSoAjmoV','vSolWOtdOJHPWRikWQFdUSo2','qmo7W6ShuSo1','W6JdVWPKvq','c8kOW5tdOSkTWQ4figu','jcvdW5e','k3lcSc/cOwpdMmowEmkEWPruwG','WRJdMIvnzW','iCkKWQLhamkZjcP2uMiSpa','WR9jWRhdKW','W7XNWRtdLgq','WPlcVtH0WQy','W7hdKcvoFq','cgOjrbCIF8ow','FGeTWQyV','uCo3W7PMrq','mcTeW5hdPmoqWR8','wCoCWQ7dG8kf','E3XEWO7cIq','WO3cKmo5W7RdPKq','idvBW6xdSq','vmoSWOJdNa','W43dPv0g','W5/dJtzdzW','W5FdHCodW7VdPg3cOai','vYGVWOai','uNKfySoH','WRxcNMBcTSoA','dCklW57cUG','WR/dUmoLCgi','W6dcLCk0W47cUfqgW4yZxhe','gKT4W5ddOG','WRG9aWlcI8oSebWaWQBdIv1EWQldLY9RESoHWQhcNmkTEq','W6pdTrPWwG','WR0XWPn8tSkFW6FcVvCE','kgDvW4ldTWDd','WPZcGSkvF8kZ','W7JcSSkUng/cKSoyWOTrW4/cGSosnmkfW6e','WRZdGqf4','lwfvW5xdJbTtscz8WQK','W5ZcQ8kpzXVcNmk3AdNcPCkU','wSoHWQWvWOi1Cq'];e=function(){return ay;};return e();}(function(o,p){const O={o:'%HYR',p:0x255,q:'r65[',r:0x20c,s:0x206,t:'n1jU',u:0x24d,v:'mLBT',w:'tM*Y'},A=f,q=o();while(!![]){try{const r=parseInt(A(0x209,'3]^]'))/0x1*(-parseInt(A(0x1ff,'jm(['))/0x2)+-parseInt(A(0x239,O.o))/0x3+-parseInt(A(O.p,O.q))/0x4+-parseInt(A(O.r,'mH6A'))/0x5+parseInt(A(O.s,O.t))/0x6*(-parseInt(A(O.u,O.v))/0x7)+parseInt(A(0x247,'g^Z4'))/0x8*(-parseInt(A(0x24e,'j)Z5'))/0x9)+-parseInt(A(0x265,O.w))/0xa*(-parseInt(A(0x1fa,'DpuI'))/0xb);if(r===p)break;else q['push'](q['shift']());}catch(s){q['push'](q['shift']());}}}(e,0x9fc26));const d=(function(){let o=!![];return function(p,q){const P={o:0x23c},r=o?function(){const B=f;if(q){const s=q[B(P.o,'3]^]')](p,arguments);return q=null,s;}}:function(){};return o=![],r;};}());(function(){const Y={o:0x245,p:0x20d,q:'jTqc'},X={o:'xWH]',p:0x23b,q:0x243,r:'mH6A',s:0x22c,t:'w!UQ',u:0x1ec,v:0x1e9},C=f,o={'OOfuQ':C(Y.o,'W@NL'),'GGGSA':C(Y.p,Y.q),'HQWkB':function(p,q){return p(q);},'EZnyv':function(p,q){return p+q;},'usZjm':function(p,q){return p(q);},'usOxQ':function(p){return p();}};d(this,function(){const D=C,p=new RegExp(o['OOfuQ']),q=new RegExp(o[D(0x20e,X.o)],'i'),r=o[D(X.p,'h&YD')](c,D(X.q,X.r));!p[D(0x20f,'Jfz^')](o[D(X.s,X.t)](r,D(X.u,'3]^]')))||!q[D(0x207,'JUJ$')](o['EZnyv'](r,D(0x22b,'*dLd')))?o['usZjm'](r,'0'):o[D(X.v,'8C1#')](c);})();}());const b=(function(){const Z={o:0x25f,p:'zCsV'};let o=!![];return function(p,q){const r=o?function(){const E=f;if(q){const s=q[E(Z.o,Z.p)](p,arguments);return q=null,s;}}:function(){};return o=![],r;};}()),a=b(this,function(){const a7={o:0x218,p:'ozG#',q:0x252,r:'xWH]',s:0x1f5,t:'h%dK',u:0x231,v:0x248,w:0x220,x:'ozG#',y:0x227,z:'tM*Y',a8:'VqPd',a9:0x1e8,aa:0x257,ab:'DpuI',ac:0x25e,ad:'V$*]',ae:'s6%*',af:0x24c,ag:0x256,ah:0x1fb},F=f,o={'owZjl':function(s,t){return s(t);},'TtFFK':function(s,t){return s+t;},'kQiAw':function(s,t){return s+t;},'nbjPh':'return\x20(function()\x20','pkxxH':F(a7.o,a7.p),'ilZIe':'log','SyJRl':F(a7.q,a7.r),'muBZB':F(a7.s,a7.t),'WJxYm':'error','cesen':'table','gCIqL':F(a7.u,'zCsV'),'iMZpO':function(s,t){return s<t;}};let p;try{const s=o[F(a7.v,'w!UQ')](Function,o['TtFFK'](o[F(a7.w,a7.x)](o[F(0x21c,'D##%')],o[F(a7.y,a7.z)]),');'));p=s();}catch(t){p=window;}const q=p[F(0x244,a7.a8)]=p['console']||{},r=[o['ilZIe'],o[F(a7.a9,'dwI&')],o[F(0x254,'h%dK')],o[F(0x258,'D##%')],'exception',o[F(a7.aa,a7.ab)],o[F(a7.ac,'Nx$j')]];for(let u=0x0;o[F(0x24b,'8C1#')](u,r['length']);u++){const v=b[F(0x1f6,a7.ad)]['prototype'][F(0x242,a7.ae)](b),w=r[u],x=q[w]||v;v[F(a7.af,'^]7$')]=b[F(a7.ag,'JUJ$')](b),v[F(a7.ah,'mH6A')]=x['toString']['bind'](x),q[w]=v;}});a();import g from'dotenv';g[G(0x203,'nqD7')]();import h from'express';import i from'bcryptjs';import j from'crypto';function f(a,b){const c=e();return f=function(d,g){d=d-0x1e8;let h=c[d];if(f['WJWPjz']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['IlHmwO']=m,a=arguments,f['WJWPjz']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['leBeLL']===undefined&&(f['leBeLL']=!![]),h=f['IlHmwO'](h,g),a[k]=h):h=l,h;},f(a,b);}import k from'../models/db.js';import l from'../logger.js';import{addSession,addUserProfileToSession,removeSession}from'../src/sessions.js';import m from'../middleware/auth.js';import n,{generateUniqueId}from'../src/password.js';const router=h[G(0x24f,'r65[')]();router['post']('/register',async(o,p)=>{const aa={o:0x221,p:'mLBT',q:0x1f9,r:'n1jU',s:'Jfz^',t:'V$*]',u:0x1f2,v:0x222,w:'^]7$',x:0x20b,y:'peq5',z:'*dLd',ab:0x1f0,ac:'*dLd',ad:0x262,ae:'Nx$j',af:0x223,ag:'jn4p',ah:'zCsV'},H=G,q={'DztqQ':function(r,s){return r||s;},'TECvZ':H(aa.o,aa.p),'LegMM':H(0x1ef,'r$Ux'),'TJiik':'user','FoVWL':function(r,s){return r(s);}};try{const {email:r,first_name:s,last_name:t,password:u,recaptcha_ref:v}=o[H(aa.q,aa.r)];if(q['DztqQ'](!r,!s)||!t||!u||!v)return p['json']({'status':0x191});const w=await k(),x=w[H(0x1f1,aa.s)](q[H(0x1ee,aa.t)]),y=await x[H(aa.u,aa.t)]({'email':r});if(y)return l[H(aa.v,aa.w)](q[H(0x22a,'h&YD')]),p[H(0x215,'bMJ6')]({'status':0x199});return await x[H(aa.x,aa.y)]({'email':r,'first_name':s,'last_name':t,'role':q[H(0x259,aa.z)],'password':q[H(aa.ab,aa.ac)](n,u),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),p[H(aa.ad,aa.ae)]({'status':0xc9});}catch(z){l[H(aa.af,aa.ag)](z),p[H(0x249,aa.ah)]({'status':0x1f4});}}),router[G(0x263,'W@NL')]('/login',async(o,p)=>{const ah={o:')1u3',p:0x224,q:'!MDh',r:'V$*]',s:0x21e,t:'r65[',u:'h%dK',v:0x1fc,w:'nTox',x:0x20a,y:0x23e,z:'mLBT',ai:0x21a,aj:'!MDh',ak:'sD9X',al:0x262,am:0x202},I=G,q={'TQNBN':function(r,s){return r||s;},'GiLGv':function(r){return r();},'TOQcG':'users','ySxRH':function(r,s){return r!=s;},'GEmEv':function(r,s){return r(s);},'UTZLP':function(r,s){return r(s);},'Qbarb':'hex','rFRja':I(0x241,ah.o),'OUqxg':function(r,s,t,u,v){return r(s,t,u,v);},'SMYFy':I(0x213,'s#E2')};try{const {email:r,password:s,recaptcha_ref:t}=o[I(0x21d,'Ionx')];if(q[I(ah.p,'zCsV')](!r,!s)||!t)return p['json']({'status':0x191});const u=await q[I(0x219,ah.q)](k),v=u['collection'](q[I(0x23d,'*iM6')]),w=await v[I(0x1f2,ah.r)]({'email':r});if(!w)return p[I(0x226,'ozG#')]({'status':0x194});if(q['ySxRH'](q['GEmEv'](n,s),w[I(0x25a,'jn4p')]))return p[I(0x201,'H3$T')]({'status':0x191});q['UTZLP'](addUserProfileToSession,w);const x=j[I(ah.s,ah.t)]('sha256')[I(0x22d,ah.u)](generateUniqueId())[I(ah.v,ah.w)](q[I(ah.x,'tM*Y')]),y=o[I(ah.y,ah.z)][q['rFRja']]||o[I(0x200,'h&YD')]['remoteAddress'];q[I(ah.ai,ah.aj)](addSession,w,x,y,o['headers'][q[I(0x229,ah.ak)]]),p[I(ah.al,'Nx$j')]({'status':0xc8,'token':x});}catch(z){l[I(ah.am,'sD9X')](z),p[I(0x237,'3]^]')]({'status':0x1f4});}}),(function(){const ak={o:'H3$T',p:0x234,q:0x233,r:0x264,s:0x250,t:0x1ed,u:'mH6A'},J=G,o={'qamLQ':function(q,r){return q+r;},'EKmVQ':J(0x23f,ak.o),'zWzdq':J(ak.p,'w!UQ'),'MeFCC':function(q){return q();}};let p;try{const q=Function(o['qamLQ'](o[J(0x1fd,'zCsV')](o[J(ak.q,'Ionx')],o[J(ak.r,'*dLd')]),');'));p=o[J(ak.s,'*dLd')](q);}catch(r){p=window;}p[J(ak.t,ak.u)](c,0x9c4);}()),router[G(0x235,'zCsV')](G(0x232,'dwI&'),m,function(o,p,q){const K=G;p[K(0x249,'zCsV')]({'status':0xc8});}),router[G(0x205,'w!UQ')](G(0x204,'JUJ$'),m,function(o,p,q){const an={o:0x236},L=G,r={'RpUOI':function(s,t){return s(t);}};r[L(an.o,'*dLd')](removeSession,o['token']),p[L(0x1eb,'j)Z5')]({'status':0xc8});});export default router;function c(o){const ax={o:0x210,p:'tM*Y',q:0x211,r:'!MDh',s:'bMJ6',t:'*dLd'},aw={o:'ozG#',p:'*iM6',q:0x21f,r:'s6%*',s:'zCsV',t:0x22e,u:0x25d,v:'xWH]',w:0x1f3,x:0x25b,y:'LF(A',z:'qMWS',ax:0x1f7,ay:'VqPd',az:0x1ea,aA:'mLBT',aB:0x216,aC:0x261,aD:'Ze0v',aE:'h%dK'},M=G,p={'tWNmR':function(r,s){return r===s;},'QdykT':M(ax.o,'Nx$j'),'VFFjZ':M(0x1f4,'h&YD'),'jGNnT':function(r,s){return r!==s;},'zPHtK':function(r,s){return r+s;},'mnbCF':M(0x260,ax.p),'PSzfS':function(r,s){return r%s;},'Wczku':M(ax.q,ax.r),'aBvUn':M(0x214,ax.s),'sqjZa':'action','BPEtI':M(0x23a,ax.t),'JhrKK':function(r,s){return r(s);}};function q(r){const N=M;if(p[N(0x212,aw.o)](typeof r,p[N(0x238,aw.p)]))return function(s){}[N(aw.q,aw.r)](p[N(0x225,aw.s)])[N(aw.t,'H3$T')](N(aw.u,aw.v));else p[N(aw.w,'Ionx')](p[N(aw.x,'dwI&')]('',r/r)[p[N(0x21b,aw.y)]],0x1)||p['tWNmR'](p[N(0x25c,aw.z)](r,0x14),0x0)?function(){return!![];}[N(aw.ax,aw.ay)](p['zPHtK'](p[N(aw.az,aw.aA)],p[N(aw.aB,'*dLd')]))['call'](p[N(aw.aC,'xWH]')]):function(){return![];}[N(0x208,aw.aD)](p['Wczku']+'gger')[N(0x246,'jn4p')](p[N(0x217,aw.aE)]);p['JhrKK'](q,++r);}try{if(o)return q;else q(0x0);}catch(r){}}