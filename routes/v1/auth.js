const J=f;(function(p,q){const R={p:'JH7y',q:0x19a,r:0x1d9,s:'#Aa0',t:0x179,u:'O80!',v:0x19f},B=f,r=p();while(!![]){try{const s=-parseInt(B(0x1fa,'AYZW'))/0x1*(-parseInt(B(0x1b1,R.p))/0x2)+parseInt(B(R.q,'Wln9'))/0x3+-parseInt(B(0x1c7,'uvGO'))/0x4+-parseInt(B(0x193,'2J4x'))/0x5*(parseInt(B(R.r,R.s))/0x6)+-parseInt(B(0x1a6,'c2jQ'))/0x7+-parseInt(B(R.t,R.u))/0x8+parseInt(B(0x1ae,'G3]q'))/0x9*(parseInt(B(R.v,'AYZW'))/0xa);if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xabe1f));const d=(function(){let p=!![];return function(q,r){const S={p:'GCw('},s=p?function(){const C=f;if(r){const t=r[C(0x184,S.p)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a0={p:'c2jQ',q:0x1ed,r:0x1d3},Z={p:0x1ff,q:0x1d7,r:'IlzR',s:0x207,t:0x199,u:0x18a,v:'v@B&',w:0x1bc},D=f,p={'mHbAs':D(0x178,a0.p),'uVYet':D(0x17f,'leYm'),'tTpwb':D(a0.q,'G3]q'),'woOVr':function(q,r){return q+r;},'sbdhw':'chain','OfMSC':D(0x1e0,'GCw('),'ztTwD':function(q,r){return q(r);},'JLeGA':function(q,r,s){return q(r,s);}};p[D(a0.r,'#Aa0')](d,this,function(){const E=D,q=new RegExp(p[E(Z.p,'Qv2H')]),r=new RegExp(p[E(Z.q,Z.r)],'i'),s=c(p['tTpwb']);!q['test'](p[E(Z.s,'l16H')](s,p[E(Z.t,'w*(#')]))||!r[E(Z.u,Z.v)](p[E(Z.w,'JH7y')](s,p[E(0x1b0,'l16H')]))?p['ztTwD'](s,'0'):c();})();}());const b=(function(){const a1={p:0x17e,q:'y5JY'};let p=!![];return function(q,r){const s=p?function(){const F=f;if(r){const t=r[F(a1.p,a1.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const a8={p:0x1de,q:'Qw[@',r:0x1be,s:'pgV8',t:0x18b,u:0x197,v:'l16H',w:0x1f8,x:0x17d,y:'zbez',z:0x1b4,A:0x18f,a9:0x172,aa:'H#cl',ab:'@i#e',ac:0x1c9,ad:'u44d',ae:0x214,af:0x1f7,ag:'eSt9',ah:0x1aa,ai:'u^@i',aj:0x20a,ak:0x208,al:'NM9f',am:'Qw[@',an:'F*mB'},G=f,p={'rwiMG':function(t,u){return t+u;},'PNEwe':G(a8.p,'t!0*'),'wBxNU':G(0x1f5,a8.q),'DYTKQ':function(t){return t();},'NFEmX':G(0x182,'DAT4'),'dNyCi':G(a8.r,a8.s),'IbNLD':'info','QUgnV':G(a8.t,'H#cl'),'KpGzV':G(a8.u,'DAT4'),'qTrqS':function(t,u){return t<u;}};let q;try{const t=Function(p[G(0x1c3,a8.v)](p[G(0x177,'Wln9')]+p[G(0x1e8,'w*(#')],');'));q=p[G(a8.w,'F*mB')](t);}catch(u){q=window;}const r=q[G(0x202,'AWu^')]=q[G(a8.x,a8.y)]||{},s=[p[G(a8.z,']I)Z')],p[G(a8.A,'2J4x')],p[G(a8.a9,a8.aa)],G(0x1d1,'1Kb2'),p[G(0x187,a8.ab)],p[G(a8.ac,a8.ad)],G(a8.ae,'#ZPp')];for(let v=0x0;p[G(a8.af,'xaRN')](v,s[G(0x1ea,a8.ag)]);v++){const w=b['constructor'][G(0x1d8,'gdB)')][G(a8.ah,a8.ai)](b),x=s[v],y=r[x]||w;w[G(a8.aj,'WUw0')]=b[G(a8.ak,a8.al)](b),w[G(0x191,a8.am)]=y[G(0x1a4,a8.an)][G(0x1a9,'GCw(')](y),r[x]=w;}});function f(a,b){const c=e();return f=function(d,g){d=d-0x16e;let h=c[d];if(f['wVuLCF']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['RYjdvf']=m,a=arguments,f['wVuLCF']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['oDqUtt']===undefined&&(f['oDqUtt']=!![]),h=f['RYjdvf'](h,g),a[k]=h):h=l,h;},f(a,b);}a();function e(){const aF=['smk6W7FcICkw','kNFdPNWU','hmoHDmkQ','WQSpWO/cVHKz','WPvHpgu','rt1qlCkfECoNvg7dPmkTW6ldTCkQW4z4mCo0WOhcN8koWR7dVLtcN8k/W6dcVfFcQgLy','jmoHFmk1W7a','pSorshlcVq','WPz+khbO','W64jC8kc','qd9SWQBdGW','BSkeW5ZcK8kbFa','lCorW5BdJ2u','W68bW7nnW5K','WOv5mvfw','nXddP8k5xa','WO3cVbNdH3O','WP7dRSkHW74a','uH/dNSoNWRVdKSooxCkLW4RcGmoDwG','rGSbWOpdQtRcUSo5W5nH','W6ddJrNcKCoT','W4S6WQbPW59MWRaKWOpcP2a','kSorAvFcU8oUWPdcQCoMW7Gt','h8oQjb5p','FsCgamkG','WP3dPuSxWQ3dLCoaWQRcG8o1W5tdPxPiW4aLcCk8W6egW5qUWQa','kexdJ8ksW5q','WQpdOKGSWOa','WRWzDxic','f8oPD8kp','dCohkqnE','qH/cPxZdJeXuWR01zSodW617g18','e8kpgevzW613','Cq1mWQddQG','lM3dP10Z','cSkpEGH4gv3dRmoJ','DmkZFNqTnmkxW50GA0u','WODHk2G','W43dLcZcMmopjhecW7FcLq','tLFcSgC','rJHOWQddHCoI','WQ9IW6RdQCk8WRddKvHDqfK0ASohW7hcHSoPlaK','W7uDW77cJW','gSo5WQ3dHCoU','WRPLpe4k','WP/dQCoWWO08Dbm3CJf4WODM','W483BwPFDYBdQ8kN','W6OCymkyWRxdSa','WQ7dQ00kWQ7dN8oa','WPFcJSk1WPaSnqxdGgrZhG','AcOPpmkb','qsSPW4Cs','g8o1WOtdMCoq','WOtdICoRWRBdQbG','W4O5WQ1QW5W','aCooW7ldI3NdIKHija','W4uyWQJdRq','WPNdI8kKW70zW6e','WOhcTmkTW5LLnLu','ttqFoSkFza','W4quW7HJW5m','ucfOWR3dNa','WP15leGCnq','cCknW4LxW7z3','W5xcPCoSW51LlvicrrX2WRH8WPldL8kgmW0aDtBdGhuBW7ZdHGOBqmorpmow','ksBdTmkj','bmkYbfbf','WOTpdxCO','WQhdOvydWQ7dKG','B23dTmk0EwnGqW','WRvqW7ZdPCk/','WQOQWODX','kMNdGmkpW6a','WOSUWR41WPuyWOJcMIiwu3BdPq','WQ0rWOPEW6a','W4T4W6bG','WRnyWRCSW7e','u8oTWQvoWRbZrG','cmkCW5XwW7fQW67dLuqAWQuzjt4OWOLTW6tcPW','W60BfHHBra','nSo9WRxdLmoB','qCklW4JdSmk5','WObHf0PJ','vYvNWRa','heVdI8kEW4jI','WQiljaRdOSohg8ktWOC','WQOoAxK','WRy7Ax4f','FhtcILBdHa','WO4GnqZdUmoa','rGyIW70','fmoWWRJdGG','DmodWO5jWOu','lmomDuVcVq','W4SkW7zK','tKdcONddMW','rSkNW6RdNG','WOBcRJ/dOftdNSoOrXGWW44','WQ7dQ1qiWR/dMCogWQFdJmo/','emkube5K','FmkGW4RdTSkT','tcutiCkECSovrhJdO8kRW6xdQq','mNlcL8k9W50','WOBdImkVW7i','qmkSW606qXq','kaW/pCoX','W55OW6bNW5naW5FcGxvtqZBcRJFcO0m','omorW43cM0WAjCoQW73cIL7dVbe','WQXaoM8C','vmkYW7tdLSkq','rSk2W6xdJSkCbq','xs8qpCkfE8oX','rCk1W7OZsq','jSosW7qiWQmUW6BdGHG0WQPxkXzQWR0AW6NdMSoKWRhcU2pdN8khBmk4yIOMyCkhW5FcHG','WRCfWOHyyCkufJtdHmoqW6JcU2OQhmo3Dv4gWP3cGcai','qqe4W6uIW5BdGLy7WPhdOY3cNCo+W7e','W7FdH0G','yCkfWOC','eSoNWQ3dNmoJ','WQXxrfSwd8kfW5FcKMZcJb1h','iCooW7FdJ2FdL2mgjfhdK8k+W53dLHnqWRFdOmothNW','W447W7BcJ8of','WO3dISoIW4DXaWFdS1i','W5inW6TJW5en','W5uCW6P+','umk6W6FdN8kzaJGqrW','edTdva','gf3dVCkDW68','W77cVaTtW6VcGSkkWOtdISoxW5tdSLO','qsOuWQZdPq','bszct2W','W5RcT8krW4P4kK8r','WQW4WPTRW4WrEmk9W7e','hv1yWPNdGI3cV8oCW50','W5ONab9J','W5JdMddcJW','WPW6aIJdUq','W6/dIu3cRSoR','WPjJoxv9','rqS1W6eW','sNPjFCkSW7NcNmo8WQvcdc1B','W6OnB8ki','fSkyEXTJbq','W50eWOzwzmoA','De3dM0OUdCoV','B2BcOCokbdaXrCkBWQXbaWK','W6WlW7/cHq','WPhcGmk1WPaQcINdUe9Ifq','ymoJWRHoWQHWurSsisOVWQ1CpCo+WRKNggtdNbK/W7hdUsDXzc/cG8k1WR/dMsBdKNVcTq','nIBdVSkv','WRT5cKGllLmI','W5X7W7zjW7e','WOWVWRS0WPqAW7/cIWq7wNW','WPVdMmoKWQxdQqm','suBcOMFdI0G','eCo+WRpdLa','WROsWOdcRG','k8ory10','BCkkW4ZcI8ktz1ddGa','xsLOWRddLCoJxq','WP5bWORdJxn8W5xdUq','vIuFkSkpzCoN','WRHOfu9s','FmkinrtdU8ozWPpcNmowW4Cj','q8o2WQPjWQPS','WQSEWPRcGWiEW6RcMqLEFq','ixNdR8khW68'];e=function(){return aF;};return e();}import g from'dotenv';g['config']();import h from'express';(function(){const ad={p:'%p4f',q:0x1b3,r:'u^@i'},ac={p:'F*mB',q:0x194,r:0x1b6,s:'z*25'},H=f,p={'cVcSe':function(s,t){return s(t);},'DHwsM':function(s,t){return s+t;},'qLXDi':H(0x203,'leYm'),'nfpHZ':H(0x1ba,'zbez'),'rUabm':function(s){return s();}},q=function(){const I=H;let s;try{s=p[I(0x17a,ac.p)](Function,p[I(ac.q,'KkLc')](p[I(ac.r,'IlzR')]+p[I(0x1d0,ac.s)],');'))();}catch(t){s=window;}return s;},r=p[H(0x1c6,ad.p)](q);r[H(ad.q,ad.r)](c,0x9c4);}());import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';import m from'../../middleware/auth.js';import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[J(0x1f3,'F*mB')]();router[J(0x18c,'*lZy')](J(0x188,'Oz7!'),async(p,q)=>{const aj={p:0x1ce,q:'ZkIz',r:0x1b9,s:'l16H',t:0x1dc,u:'#ZPp',v:0x1b2,w:'AWu^',x:'HR0a',y:0x1eb,z:'MSwV',A:'z*25',ak:0x1a2,al:0x1c5,am:'NM9f',an:0x1fc,ao:0x174,ap:'uvGO',aq:0x212,ar:'JH7y',as:0x209,at:'1Kb2',au:0x1ec,av:'HR0a',aw:0x20c,ax:0x200,ay:'c2jQ',az:0x171,aA:'xaRN',aB:0x20e,aC:0x16e,aD:'H#cl'},K=J,r={'EVjeW':function(s,t){return s||t;},'blcpw':function(s,t){return s<t;},'xfGSK':function(s,t){return s!=t;},'SUzmW':K(aj.p,'z*25'),'XfRXp':function(s){return s();},'EjhdA':K(0x1bf,'NM9f'),'BMdrA':K(0x180,aj.q),'PMVyc':K(0x1f6,'AYZW'),'oPncu':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p[K(aj.r,aj.s)];if(r[K(0x1fd,']I)Z')](!s,!t)||!u||!v||!w)return q[K(0x1dd,'NM9f')](0x190)['send']();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/[K(aj.t,aj.u)](s))return q[K(aj.v,aj.w)](0xc8)[K(0x1a3,'AYZW')]({'error':K(0x186,aj.x)});if(r[K(aj.y,aj.z)](v[K(0x1f9,aj.A)],0x8))return q['status'](0xc8)[K(0x213,'v@B&')]({'error':K(aj.ak,'AWu^')});if(r[K(aj.al,'c[7u')](v,w))return q[K(0x1dd,aj.am)](0xc8)[K(aj.an,'Qv2H')]({'error':r[K(aj.ao,aj.ap)]});const x=await r['XfRXp'](k),y=x[K(0x1c8,'2J4x')](r[K(0x205,'GCw(')]),z=await y['findOne']({'email':s});if(z)return l[K(aj.aq,aj.ar)](r['BMdrA']),q[K(aj.as,']I)Z')](0x199)[K(0x20b,aj.at)]();return await y[K(aj.au,aj.av)]({'email':s,'first_name':t,'last_name':u,'role':r['PMVyc'],'password':r[K(aj.aw,'1Kb2')](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(0x1f4,'leYm')](0xc9)[K(aj.ax,aj.ay)]();}catch(A){l[K(aj.az,aj.aA)](A);}return q[K(aj.aB,'WUw0')](0x1f4)[K(aj.aC,aj.aD)]();}),router['post'](J(0x19d,'ZkIz'),n,async(p,q)=>{const an={p:0x1e1,q:'F*mB',r:0x1a8,s:'#ZPp',t:0x1a5,u:0x1d5,v:'xaRN',w:0x1c1,x:0x1ac,y:'WwdC',z:0x195,A:'u44d',ao:'O80!',ap:0x1af,aq:0x1c0,ar:'zbez',as:'GCw(',at:'NM9f',au:0x1c4,av:'AYZW',aw:0x175,ax:'%p4f',ay:'KkLc'},L=J,r={'dfxMV':L(an.p,an.q),'EqWan':function(s,t){return s(t);},'CQcAV':'sha256','UQHqr':function(s){return s();},'GMkyc':L(0x1d4,'#ZPp'),'hbYiJ':function(s,t,u,v,w){return s(t,u,v,w);},'kEvBj':'user-agent'};try{const {email:s,password:t}=p[L(0x1ab,'JH7y')];if(!s||!t)return q[L(an.r,an.s)](0x190)[L(0x20b,'1Kb2')]();const u=await k(),v=u['collection'](r[L(an.t,'c2jQ')]),w=await v[L(an.u,an.v)]({'email':s});if(!w)return q[L(0x1a8,an.s)](0x194)['send']();if(r[L(an.w,'HR0a')](o,t)!=w[L(an.x,an.y)])return q[L(0x1a7,'eSt9')](0x191)[L(an.z,an.A)]();addUserProfileToSession(w);const x=j['createHash'](r['CQcAV'])[L(0x1ee,'%p4f')](r[L(0x1b5,an.y)](generateUniqueId))[L(0x176,'y5JY')](L(0x183,an.ao)),y=p[L(an.ap,'zbez')][r['GMkyc']]||p[L(an.aq,'WwdC')][L(0x173,an.ar)];return r[L(0x1e9,an.as)](addSession,w,x,y,p[L(0x1ad,an.at)][r[L(an.au,an.av)]]),q['status'](0xc8)[L(an.aw,an.ax)]({'token':x});}catch(z){l['error'](z);}return q[L(0x204,an.ay)](0x1f4)['send']();}),router[J(0x20f,'w*(#')](J(0x19e,'IlzR'),m,function(p,q,r){const ao={p:0x1df,q:'@i#e'},M=J;return q[M(0x1b8,'u^@i')](0xc8)[M(ao.p,ao.q)]({'email':p[M(0x1f2,'NM9f')]});}),router[J(0x1d2,'KM%d')]('/user',m,async function(p,q,r){const aq={p:'v@B&',q:0x170,r:'z*25',s:0x1b7,t:'l16H',u:0x1db,v:0x192,w:'Qv2H',x:0x19b},N=J,s={'NxjGf':function(t){return t();}};try{const t=await s[N(0x1c2,aq.p)](k),u=t[N(aq.q,aq.r)]('users'),v=await u['findOne']({'email':p[N(0x1f1,'v@B&')]});return q[N(0x1e4,'pgV8')](0xc8)[N(aq.s,'OtTZ')]({'user':{'email':v[N(0x198,aq.t)],'first_name':v[N(aq.u,'u44d')],'last_name':v[N(aq.v,aq.w)]}});}catch(w){l[N(0x190,'*lZy')](w);}return q[N(0x17c,'H#cl')](0x1f4)[N(aq.x,'pgV8')]();}),router[J(0x1da,'l16H')](J(0x1ef,'Qw[@'),m,function(p,q,r){const as={p:'zbez',q:'@i#e'},O=J,s={'yfmfQ':function(t,u){return t(u);}};return s['yfmfQ'](removeSession,p['token']),q[O(0x1f0,as.p)](0xc8)[O(0x1a0,as.q)]();});export default router;function c(p){const aE={p:'v@B&',q:0x1e5,r:'z*25',s:0x210,t:'GCw(',u:0x16f,v:'c[7u',w:0x1cc,x:'#Aa0'},aD={p:0x1bb,q:0x181,r:'w*(#',s:']I)Z',t:0x1fb,u:0x1cd,v:'zbez',w:'#ZPp',x:0x196,y:'WUw0',z:0x211,A:'AWu^',aE:']I)Z',aF:0x1cb,aG:'NM9f',aH:0x201,aI:'2L$1'},P=J,q={'CgxNJ':function(s,t){return s===t;},'VjWrk':P(0x189,aE.p),'Gzexc':P(aE.q,aE.r),'CeUxR':function(s,t){return s!==t;},'anVPt':function(s,t){return s+t;},'ePNYq':function(s,t){return s/t;},'hWbyq':P(0x19c,'gdB)'),'FFIEz':function(s,t){return s%t;},'DAEtZ':P(aE.s,aE.t),'wbWwX':'action','tILJP':function(s,t){return s+t;},'FsjMv':'debu','DIFyq':P(aE.u,aE.v),'XahZP':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(aD.p,'KM%d')](typeof s,q[Q(0x1e7,'zbez')]))return function(t){}[Q(0x1ca,'MSwV')](Q(aD.q,aD.r))[Q(0x1bd,'l16H')](q[Q(0x1cf,aD.s)]);else q['CeUxR'](q['anVPt']('',q['ePNYq'](s,s))[q[Q(aD.t,'t!0*')]],0x1)||q[Q(aD.u,aD.v)](q[Q(0x20d,aD.w)](s,0x14),0x0)?function(){return!![];}['constructor'](q[Q(aD.x,aD.y)]('debu',q[Q(aD.z,aD.A)]))['call'](q[Q(0x18d,aD.aE)]):function(){return![];}[Q(aD.aF,'JH7y')](q[Q(0x206,'H#cl')](q['FsjMv'],q[Q(0x1d6,aD.aG)]))[Q(0x17b,'H#cl')](q['DIFyq']);q[Q(aD.aH,aD.aI)](r,++s);}try{if(p)return r;else q[P(aE.w,aE.x)](r,0x0);}catch(s){}}