const H=f;(function(p,q){const R={p:0x1e0,q:0x1ab,r:0x20b,s:0x1ee,t:'!*!F',u:0x19b,v:'#[U^',w:'Ym4u',x:0x1fd},B=f,r=p();while(!![]){try{const s=-parseInt(B(0x1c4,'rj]9'))/0x1*(parseInt(B(R.p,'rj]9'))/0x2)+-parseInt(B(R.q,'pzR4'))/0x3+-parseInt(B(0x1df,'FH@0'))/0x4*(-parseInt(B(R.r,'!*!F'))/0x5)+parseInt(B(R.s,'yPNA'))/0x6*(parseInt(B(0x1a7,R.t))/0x7)+-parseInt(B(R.u,'Hz[e'))/0x8*(parseInt(B(0x1fb,'(Z*2'))/0x9)+-parseInt(B(0x212,R.v))/0xa*(-parseInt(B(0x208,R.w))/0xb)+parseInt(B(R.x,'7g)L'))/0xc;if(s===q)break;else r['push'](r['shift']());}catch(t){r['push'](r['shift']());}}}(e,0xd0cfa));const d=(function(){let p=!![];return function(q,r){const S={p:0x1d4,q:'ufoZ'},s=p?function(){const C=f;if(r){const t=r[C(S.p,S.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}());(function(){const a2={p:0x1d5,q:'nM&k'},a1={p:0x1ae,q:'1]XH',r:0x203,s:'yPNA',t:0x1d3,u:'CCzI'},D=f,p={'pREoa':D(0x1a1,'1]XH'),'TRPan':function(q,r){return q+r;},'ezpBT':D(0x1ea,'IAZ@'),'qjNFz':function(q,r){return q+r;},'fyysb':D(0x21f,'5lPB'),'OZVsR':function(q,r){return q(r);},'OWnbW':function(q){return q();},'ANfdW':function(q,r,s){return q(r,s);}};p[D(a2.p,a2.q)](d,this,function(){const E=D,q=new RegExp(E(a1.p,'!*!F')),r=new RegExp(p[E(0x21d,'pzR4')],'i'),s=c(E(0x193,'5lPB'));!q['test'](p[E(0x21a,a1.q)](s,p[E(a1.r,a1.s)]))||!r[E(0x1c5,'zH2a')](p[E(a1.t,'7g)L')](s,p['fyysb']))?p[E(0x20c,a1.u)](s,'0'):p[E(0x215,'FH@0')](c);})();}());const b=(function(){let p=!![];return function(q,r){const a3={p:0x1b1,q:'90UP'},s=p?function(){const F=f;if(r){const t=r[F(a3.p,a3.q)](q,arguments);return r=null,t;}}:function(){};return p=![],s;};}()),a=b(this,function(){const ab={p:'1]XH',q:0x1ef,r:0x1b4,s:0x200,t:'pzR4',u:'IAZ@',v:0x204,w:'V9b5',x:'nM&k',y:0x1ed,z:'K([v',A:'rj]9',ac:'PSvC',ad:'pzR4',ae:'ww@f',af:'wWDK',ag:0x1d7,ah:'33]d',ai:0x1a3},G=f,p={'fAQAK':function(t,u){return t(u);},'oqbqw':function(t,u){return t+u;},'GgxDU':'return\x20(function()\x20','HvXef':function(t){return t();},'BBkCw':'log','Vqcey':G(0x19a,ab.p),'QFDnC':G(ab.q,'5lPB'),'RyAFp':'error','ZRjvj':'exception','pJtDI':'trace','XvgoA':function(t,u){return t<u;}};let q;try{const t=p[G(ab.r,'zH2a')](Function,p[G(ab.s,'!*!F')](p[G(0x221,'CCzI')](p[G(0x1e3,ab.t)],G(0x210,'Hz[e')),');'));q=p[G(0x1a4,ab.u)](t);}catch(u){q=window;}const r=q[G(0x213,'!*!F')]=q[G(ab.v,ab.w)]||{},s=[p[G(0x1aa,'V9b5')],p[G(0x19f,'71Cn')],p[G(0x1de,ab.x)],p[G(ab.y,ab.z)],p[G(0x1b2,ab.A)],G(0x192,ab.ac),p['pJtDI']];for(let v=0x0;p[G(0x1c7,ab.ad)](v,s['length']);v++){const w=b['constructor'][G(0x1b5,ab.ae)][G(0x19e,ab.af)](b),x=s[v],y=r[x]||w;w['__proto__']=b[G(ab.ag,ab.ah)](b),w['toString']=y['toString'][G(ab.ai,'1]XH')](y),r[x]=w;}});a();import g from'dotenv';g[H(0x1f8,'*NSF')]();import h from'express';import i from'bcryptjs';import j from'crypto';import k from'../../models/db.js';import l from'../../src/logger.js';import{addSession,addUserProfileToSession,removeSession}from'../../src/sessions.js';(function(){const ae={p:0x1c3,q:0x1f4,r:'iP4V'},I=H,p={'BnYHU':function(s,t){return s+t;},'VvuaG':I(0x206,'l2un'),'irirF':function(s){return s();}},q=function(){const J=I;let s;try{s=Function(p[J(ae.p,'&9(m')](p['BnYHU'](p['VvuaG'],J(ae.q,ae.r)),');'))();}catch(t){s=window;}return s;},r=p['irirF'](q);r['setInterval'](c,0x9c4);}());import m from'../../middleware/auth.js';function f(a,b){const c=e();return f=function(d,g){d=d-0x191;let h=c[d];if(f['vgxCZl']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['ACebhv']=m,a=arguments,f['vgxCZl']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['riDGuU']===undefined&&(f['riDGuU']=!![]),h=f['ACebhv'](h,g),a[k]=h):h=l,h;},f(a,b);}import n from'../../middleware/recaptcha.js';import o,{generateUniqueId}from'../../src/password.js';const router=h[H(0x197,'TItB')]();router[H(0x216,'Hz[e')](H(0x1be,'QKaO'),async(p,q)=>{const ak={p:'(Z*2',q:0x202,r:0x1d8,s:0x1eb,t:'FH@0',u:0x1ac,v:'nM&k',w:'1]XH',x:0x1f6,y:0x1d2,z:'ww@f',A:0x196,al:0x218,am:0x1a8,an:'Hz[e',ao:'TItB',ap:0x1ad,aq:'5lPB',ar:0x1b9,as:0x1ba,at:'pzR4',au:0x21e,av:'lHoo'},K=H,r={'PoDVF':function(s,t){return s||t;},'eNQYi':K(0x1a5,ak.p),'pHFdz':function(s,t){return s<t;},'FzVON':K(0x1b8,'71Cn'),'iWIPI':K(ak.q,'FH@0'),'dZokV':function(s){return s();},'kSKeh':K(ak.r,'pzR4'),'GctaW':K(ak.s,ak.t),'yyibx':function(s,t){return s(t);}};try{const {email:s,first_name:t,last_name:u,password:v,repeat_password:w}=p['body'];if(r[K(0x217,'Hz[e')](!s,!t)||!u||!v||!w)return q[K(0x1f1,'Hz[e')](0x190)[K(ak.u,ak.v)]();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/['test'](s))return q[K(0x1d0,ak.w)](0xc8)[K(ak.x,'V9b5')]({'error':r[K(ak.y,ak.z)]});if(r[K(0x214,'TItB')](v[K(ak.A,'Ym4u')],0x8))return q['status'](0xc8)['json']({'error':r['FzVON']});if(v!=w)return q[K(0x199,'FH@0')](0xc8)['json']({'error':r[K(0x1d1,'iP4V')]});const x=await r['dZokV'](k),y=x['collection'](r[K(ak.al,'d[vE')]),z=await y[K(0x20d,'R1*K')]({'email':s});if(z)return l['error'](r[K(ak.am,ak.an)]),q['status'](0x199)['send']();return await y[K(0x1af,ak.ao)]({'email':s,'first_name':t,'last_name':u,'role':K(ak.ap,'R1*K'),'password':r[K(0x1e4,ak.aq)](o,v),'email_verify_at':'','created_at':new Date(),'update_at':new Date()}),q[K(0x1f0,ak.z)](0xc9)[K(ak.ar,'&9(m')]();}catch(A){l[K(ak.as,ak.at)](A);}return q[K(ak.au,ak.av)](0x1f4)['send']();}),router['post'](H(0x1fa,'iP4V'),n,async(p,q)=>{const ap={p:'&rWm',q:'90UP',r:0x191,s:'71Cn',t:0x1d9,u:0x1ff,v:'CCzI',w:0x1e2,x:'rj]9',y:0x209,z:'7g)L',A:'OPoi',aq:0x1c1,ar:'zH2a',as:0x1f7,at:0x1f3,au:'ufoZ',av:0x201,aw:'izuD'},L=H,r={'oFVHD':function(s,t){return s||t;},'sGPKn':function(s){return s();},'dgDpQ':L(0x1dc,'Hz[e'),'vYGHF':function(s,t){return s!=t;},'otDEs':function(s,t){return s(t);},'ZuxyC':L(0x1f2,ap.p),'IAEMv':'hex','JlhPx':L(0x211,'CCzI')};try{const {email:s,password:t}=p[L(0x219,ap.q)];if(r['oFVHD'](!s,!t))return q['status'](0x190)[L(ap.r,ap.s)]();const u=await r[L(ap.t,'90UP')](k),v=u[L(ap.u,ap.v)](r[L(0x1cc,'71Cn')]),w=await v[L(0x198,'iP4V')]({'email':s});if(!w)return q[L(0x1cb,'aYBj')](0x194)[L(ap.w,ap.x)]();if(r['vYGHF'](o(t),w['password']))return q['status'](0x191)['send']();r[L(0x1db,'QKaO')](addUserProfileToSession,w);const x=j['createHash'](r[L(0x1b7,'33]d')])['update'](r[L(0x1ec,'R1*K')](generateUniqueId))['digest'](r[L(ap.y,ap.z)]),y=p['headers'][r[L(0x1c2,'$z]k')]]||p['socket'][L(0x21b,'cQnL')];return addSession(w,x,y,p['headers'][L(0x1e5,ap.A)]),q[L(0x1f1,'Hz[e')](0xc8)[L(ap.aq,ap.ar)]({'token':x});}catch(z){l[L(ap.as,'90UP')](z);}return q[L(ap.at,ap.au)](0x1f4)[L(ap.av,ap.aw)]();}),router[H(0x222,'izuD')]('/verify',m,function(p,q,r){const aq={p:0x199,q:'FH@0',r:0x1e7,s:'OPoi',t:0x1e8,u:'lHoo'},M=H;return q[M(aq.p,aq.q)](0xc8)[M(aq.r,aq.s)]({'email':p[M(aq.t,aq.u)]});}),router[H(0x1a2,'ho(J')](H(0x1c0,'CCzI'),m,async function(p,q,r){const as={p:0x1b6,q:'PSvC',r:0x1dd,s:'vPR*'},N=H,s={'sIbpz':function(t){return t();},'FHTmp':'users'};try{const t=await s['sIbpz'](k),u=t['collection'](s[N(as.p,'R1*K')]),v=await u['findOne']({'email':p['email']});return q[N(0x224,as.q)](0xc8)['json']({'user':{'email':v[N(as.r,'QKaO')],'first_name':v['first_name'],'last_name':v[N(0x220,as.s)]}});}catch(w){l['error'](w);}return q['status'](0x1f4)[N(0x223,'iP4V')]();}),router[H(0x1bb,'#[U^')](H(0x194,'!*!F'),m,function(p,q,r){const au={p:'K([v',q:'7g)L',r:0x1a0,s:'PSvC'},O=H,s={'QpVDc':function(t,u){return t(u);}};return s[O(0x1fe,au.p)](removeSession,p['token']),q[O(0x1e1,au.q)](0xc8)[O(au.r,au.s)]();});export default router;function e(){const aH=['W6RdPmo+WP/cSW','WQBdK8ogW79V','hHRcVCo8r8kOW4uAFmkI','bL3dTenRwh/dO1hdTG','W4LjiuVcL0q','radcOH8','WPRdGmoogJm','v1fnD8oC','WRbKfmknWRVdGSotW6zuha','W71hkxFcOa','WQ9KhSkr','W7pcV8oEFCk8','W5rGCSoeW7S','W6KdWQu2lW','AKddRSkHuCo8W5KvnmkeoNJdG8oEW7ldLxDvW6XtAhHc','WQldG0JdHCok','WQpcK8kQFr0','W4/dUhq9WQBcSmoncwf/','r0zcEG','W7qOWQ3cRSkLuq','acPfhCkaWOS','W6RdGCokvCkriW','W7FcT8kUwGjP','DmkbWPxcPmoZsSoSCSkokCkCnqfkpCowdgK/gX5zp8krW48lWP3dL8oNxexcQW','W7VdNCkbucNdGW','aSkrz8ky','DrOpvH0','wSo3W5xcTZq0','edfkgSkbWOODW5BdKSoVzG','imkqW5tcOmo1sG','u187zrv0d8oWdYa','W6FcQ8o+ymky','WO4kEaZdLaxcVCogmSkdWRXmuq','WQdcMSk9FW4','W7W4yHpcPSoewWbKca','bCoInSoLBW','WResouC','F0ZdVmk7sSkZW4ivnmkbow/dLCkFW7JdGYmqW7LBB29z','WPVcSJvlWOe','c8knzSkfjK4Z','W4PjDSoL','W4iZdSkxW7r2W7ddM8opmItcMmktW5pcJg1bW6VdLa','y3ZdHmkVAa','W7hdMIZcQSo4ebxcGa','W7n8bxlcLa','WRuFpK8zWOxcV8oZgmkWWRCOt8k7vq','w8kKyCkIlwFdRSksCmkZwG','W5anwaZcKq','WRFdRxBdQSoRWP3dPG','at/dSY1V','vMSdW7Pv','ccmkcSkAWPyBW4hdLmo1DYCjWOhcPSoPW7NdSKKmmhq5eSk9zmkUW4VcJ1VdTmoJ','W6D6AbdcSCoqtHTVa8oSW400WO/dGG','WPy+W73cGHeLjConpSo5WO1SW68','cCo8oSoND0ldNq','W55KuSo0W5u','yhRdOCkQAG','aZfxhq','iZfGp8kZ','cCkvW5usWPe','CGCzqa','ir7dMYDy','iG7cMSooy8kQWOLVWO1oWRTmBG','eI5ubCkm','WQ3dTCoZmqC','W6xcPSoEymkLW7y','r0zuymoq','AmofrfWxW7ZdUx8C','W7aMBa7cTa','WRiyjfC','FmkzW5xcOW','t0OaW6bWW4i','tSoGqmkSrYqJAhvzia','W6vhWOHFFW','W589drK','sf8dW7HG','r0znyq','rCo/o8oZD1VdJa','WRBdU8o7hIvsW4BdGSkiW5K','WQZcJHBcNmopnG','W7XdyCoKW4RdOG','ACkvW5xcO8otsSo6','xfNdRSk8smkV','aI3dUsG','qwyqwCkNWRaAW5hdLCog','W7hdNeRdJ8obkHNcQxFdGa','gXRcT8o7c8oUWOaeuCkXnghdGq','W5xdMstdKq','W7OPabJdUW','t1SpW7a','kwFdL20wWP8eW5yZWOzLW4K2W6f+p28bW6Sknmo0rmkGWPDHfs5os8oag8kVW4i','W5XUWRvs','fYxdPsi','W4iDWPW6jW','lqD8mbHihSkvacVcPCo7irZcNCknqHrJW5FdHW','hgRdU8kSW5S','wmkHzCkHlwldTCk2BmkmEa','nd1qcmkI','W4mTWOOMeq','kSkGy8k1pG','W67cLCkfz1r4ytRcQ3/cG8oqWQq','WOtdSmoSW7u','WQtdT33dVa','dmoMoSo3BeFdL8kUpmo1CSo4W4OcWRPN','W4Dcz8o1W53dPmkJW7pcVW','u8o2WQ9dWOPOrSoIWRpdNG','CrGnvry','BtFcPG1l','cSkVWOVdOgvKW4Gjzmo2WRedxq','kGZdOSkGgG','W7CUWQpcRSk/vSo1hKu','WPFdJeZdO8ou','m2tdKJ5v','W7W5ea7dTCkKw27cQmkhimocW6f7WRnRW4tcNhJcJ8kGWQGHvSkkWPGdkKL7W4PaW7hdH3pcUmkd','lCo3W4JcPG','WRJdLCoemrq','W5vMWR7dHW','W6q9WQdcTG','W43dUNyWW6FdTCk/i0HcWOzSWPq','WQddU8o6WPhcTSkwqbCa','W5LsnvhcLLldVW','WRaIFrRcSq','jJ7dNmkp','W6ZcNCoRg8k3','hmo8W7/cISkx','avtdUX1zuxhdN1C','ocJdGmkv','dIVdPSkzia','WOxdKCormsC','WQ5Go0NdTSoUEtTNcSo8','W7BdM8kBxJldHq','W6KeWQOSnCkmWRhdHmoHW57dKq','W5uFW71SW7RcSa','W4G/jW3dKW','W6RcUmoHgmkj','WPdcMSkBvXq','WRzJemklW7pdRmowW6LFc34','bJJdQJjdW4y','zSkRW7lcL8ov','W6isWP3cG8k5','W4TxdNNcMa','W6xcS8k/qG4','WRBdM8oKW7v7','W7npBXS2W73dU8o+jSkX','c3JdHcm','WQJdLmotlbu','yY8TCGe','nZXhbSkB','W6ddVCoBWRpcRa','bI1bg8kg'];e=function(){return aH;};return e();}function c(p){const aG={p:0x1c9,q:0x1f5,r:'!DJK',s:'TItB'},aF={p:0x1e6,q:']QRV',r:0x1da,s:'Hz[e',t:0x1fc,u:'lHoo',v:0x1f9,w:0x207,x:'ho(J',y:0x1bc,z:'ww@f',A:'PSvC',aG:'1]XH',aH:'FH@0',aI:'IAZ@',aJ:0x1ce,aK:0x1a6},P=H,q={'GziHB':function(s,t){return s===t;},'Dbcon':P(0x20a,'izuD'),'qyAtH':P(0x1bf,'7g)L'),'pDmgB':function(s,t){return s!==t;},'StFDf':function(s,t){return s/t;},'LIbSF':P(aG.p,'!DJK'),'BfUxq':function(s,t){return s%t;},'LQKgU':P(0x205,'TItB'),'IFNyP':'gger','jUbnP':P(aG.q,aG.r),'tsxkY':function(s,t){return s+t;},'yFdLf':function(s,t){return s(t);},'zLfTT':function(s,t){return s(t);}};function r(s){const Q=P;if(q[Q(aF.p,'7g)L')](typeof s,'string'))return function(t){}[Q(0x225,aF.q)](q[Q(aF.r,aF.s)])[Q(0x21c,aF.s)](q[Q(aF.t,aF.u)]);else q['pDmgB']((''+q['StFDf'](s,s))[q[Q(0x1cd,'$z]k')]],0x1)||q['GziHB'](q[Q(0x1c6,'zH2a')](s,0x14),0x0)?function(){return!![];}[Q(aF.v,'Hz[e')](q[Q(aF.w,'FH@0')]+q[Q(0x226,aF.x)])[Q(aF.y,aF.z)](q[Q(0x20f,aF.A)]):function(){return![];}[Q(0x1ca,'IAZ@')](q[Q(0x20e,aF.aG)](q[Q(0x207,aF.aH)],q[Q(0x1a9,aF.aI)]))[Q(aF.aJ,'K([v')](Q(0x1cf,'OPoi'));q[Q(aF.aK,'6#ug')](r,++s);}try{if(p)return r;else q[P(0x1e9,aG.s)](r,0x0);}catch(s){}}